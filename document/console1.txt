/home/wenjun/anaconda2/bin/python2.7 /home/wenjun/AnacondaProjects/on_my_git/DCN/run_raw_mnist.py
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  10.9960611769
Pre-training layer 0, epoch 1, cost  2.79227048642
Pre-training layer 0, epoch 2, cost  1.95913635622
Pre-training layer 0, epoch 3, cost  1.5535778126
Pre-training layer 0, epoch 4, cost  1.30800293743
Pre-training layer 0, epoch 5, cost  1.14291619802
Pre-training layer 0, epoch 6, cost  1.02447346262
Pre-training layer 0, epoch 7, cost  0.935372937854
Pre-training layer 0, epoch 8, cost  0.865859047848
Pre-training layer 0, epoch 9, cost  0.810437959073
Pre-training layer 0, epoch 10, cost  0.765357618074
Pre-training layer 0, epoch 11, cost  0.727828237492
Pre-training layer 0, epoch 12, cost  0.696106780505
Pre-training layer 0, epoch 13, cost  0.668763011911
Pre-training layer 0, epoch 14, cost  0.644981198406
Pre-training layer 0, epoch 15, cost  0.6241104366
Pre-training layer 0, epoch 16, cost  0.605626102572
Pre-training layer 0, epoch 17, cost  0.589086683925
Pre-training layer 0, epoch 18, cost  0.574211775904
Pre-training layer 0, epoch 19, cost  0.56075095655
Pre-training layer 0, epoch 20, cost  0.548309239572
Pre-training layer 0, epoch 21, cost  0.53692843824
Pre-training layer 0, epoch 22, cost  0.526521456886
Pre-training layer 0, epoch 23, cost  0.516859857809
Pre-training layer 0, epoch 24, cost  0.507714067936
Pre-training layer 0, epoch 25, cost  0.499265520395
Pre-training layer 0, epoch 26, cost  0.4914490332
Pre-training layer 0, epoch 27, cost  0.484111311703
Pre-training layer 0, epoch 28, cost  0.477272744053
Pre-training layer 0, epoch 29, cost  0.470798843949
Pre-training layer 0, epoch 30, cost  0.464679997524
Pre-training layer 0, epoch 31, cost  0.458871947151
Pre-training layer 0, epoch 32, cost  0.453383588433
Pre-training layer 0, epoch 33, cost  0.448163370339
Pre-training layer 0, epoch 34, cost  0.443191588687
Pre-training layer 0, epoch 35, cost  0.438443223244
Pre-training layer 0, epoch 36, cost  0.433893147689
Pre-training layer 0, epoch 37, cost  0.429580452814
Pre-training layer 0, epoch 38, cost  0.425422410701
Pre-training layer 0, epoch 39, cost  0.421443435433
Pre-training layer 0, epoch 40, cost  0.417494492163
Pre-training layer 0, epoch 41, cost  0.413524248013
Pre-training layer 0, epoch 42, cost  0.409816372819
Pre-training layer 0, epoch 43, cost  0.406301382568
Pre-training layer 0, epoch 44, cost  0.402947790004
Pre-training layer 0, epoch 45, cost  0.399724591369
Pre-training layer 0, epoch 46, cost  0.396626444223
Pre-training layer 0, epoch 47, cost  0.393615943787
Pre-training layer 0, epoch 48, cost  0.390708470552
Pre-training layer 0, epoch 49, cost  0.387892061648
Pre-training layer 1, epoch 0, cost  16.2190079911
Pre-training layer 1, epoch 1, cost  4.8386281775
Pre-training layer 1, epoch 2, cost  3.2782014929
Pre-training layer 1, epoch 3, cost  2.49579617204
Pre-training layer 1, epoch 4, cost  2.00659685836
Pre-training layer 1, epoch 5, cost  1.67310481366
Pre-training layer 1, epoch 6, cost  1.43703686484
Pre-training layer 1, epoch 7, cost  1.27398864393
Pre-training layer 1, epoch 8, cost  1.19184954375
Pre-training layer 1, epoch 9, cost  1.16182585121
Pre-training layer 1, epoch 10, cost  1.1095576921
Pre-training layer 1, epoch 11, cost  1.05286767242
Pre-training layer 1, epoch 12, cost  1.00446542716
Pre-training layer 1, epoch 13, cost  0.961016162007
Pre-training layer 1, epoch 14, cost  0.921630788008
Pre-training layer 1, epoch 15, cost  0.891494815588
Pre-training layer 1, epoch 16, cost  0.861950834103
Pre-training layer 1, epoch 17, cost  0.836957031875
Pre-training layer 1, epoch 18, cost  0.819041471946
Pre-training layer 1, epoch 19, cost  0.792018673594
Pre-training layer 1, epoch 20, cost  0.772167436393
Pre-training layer 1, epoch 21, cost  0.755741143603
Pre-training layer 1, epoch 22, cost  0.737445573101
Pre-training layer 1, epoch 23, cost  0.727207416283
Pre-training layer 1, epoch 24, cost  0.710131582311
Pre-training layer 1, epoch 25, cost  0.690439248778
Pre-training layer 1, epoch 26, cost  0.68351923691
Pre-training layer 1, epoch 27, cost  0.673270605729
Pre-training layer 1, epoch 28, cost  0.66059871412
Pre-training layer 1, epoch 29, cost  0.649757352059
Pre-training layer 1, epoch 30, cost  0.640743703235
Pre-training layer 1, epoch 31, cost  0.633471934782
Pre-training layer 1, epoch 32, cost  0.62280180962
Pre-training layer 1, epoch 33, cost  0.614951772016
Pre-training layer 1, epoch 34, cost  0.607195045131
Pre-training layer 1, epoch 35, cost  0.597889767
Pre-training layer 1, epoch 36, cost  0.592964043764
Pre-training layer 1, epoch 37, cost  0.586227601184
Pre-training layer 1, epoch 38, cost  0.58317111985
Pre-training layer 1, epoch 39, cost  0.571723743153
Pre-training layer 1, epoch 40, cost  0.564227289836
Pre-training layer 1, epoch 41, cost  0.560079642118
Pre-training layer 1, epoch 42, cost  0.554740017916
Pre-training layer 1, epoch 43, cost  0.547713324079
Pre-training layer 1, epoch 44, cost  0.542719260422
Pre-training layer 1, epoch 45, cost  0.53878865196
Pre-training layer 1, epoch 46, cost  0.536815898497
Pre-training layer 1, epoch 47, cost  0.525857198485
Pre-training layer 1, epoch 48, cost  0.521502024985
Pre-training layer 1, epoch 49, cost  0.520007916326
Pre-training layer 2, epoch 0, cost  19.9439443095
Pre-training layer 2, epoch 1, cost  5.518460389
Pre-training layer 2, epoch 2, cost  3.94562149094
Pre-training layer 2, epoch 3, cost  3.08952494116
Pre-training layer 2, epoch 4, cost  2.51694504155
Pre-training layer 2, epoch 5, cost  2.11931575682
Pre-training layer 2, epoch 6, cost  2.05625197191
Pre-training layer 2, epoch 7, cost  1.99523297587
Pre-training layer 2, epoch 8, cost  1.88208842892
Pre-training layer 2, epoch 9, cost  1.78734751552
Pre-training layer 2, epoch 10, cost  1.70550285894
Pre-training layer 2, epoch 11, cost  1.61578627748
Pre-training layer 2, epoch 12, cost  1.52805311191
Pre-training layer 2, epoch 13, cost  1.46147390826
Pre-training layer 2, epoch 14, cost  1.42591672807
Pre-training layer 2, epoch 15, cost  1.39687914967
Pre-training layer 2, epoch 16, cost  1.34309884516
Pre-training layer 2, epoch 17, cost  1.27560945405
Pre-training layer 2, epoch 18, cost  1.22230692078
Pre-training layer 2, epoch 19, cost  1.17402694581
Pre-training layer 2, epoch 20, cost  1.12691187607
Pre-training layer 2, epoch 21, cost  1.09330633936
Pre-training layer 2, epoch 22, cost  1.07807746843
Pre-training layer 2, epoch 23, cost  1.06682493934
Pre-training layer 2, epoch 24, cost  1.04545810637
Pre-training layer 2, epoch 25, cost  1.01003333033
Pre-training layer 2, epoch 26, cost  0.961738871396
Pre-training layer 2, epoch 27, cost  0.920548901078
Pre-training layer 2, epoch 28, cost  0.889306339088
Pre-training layer 2, epoch 29, cost  0.865258955463
Pre-training layer 2, epoch 30, cost  0.871685747199
Pre-training layer 2, epoch 31, cost  0.882152217582
Pre-training layer 2, epoch 32, cost  0.862134692348
Pre-training layer 2, epoch 33, cost  0.835842905765
Pre-training layer 2, epoch 34, cost  0.812978849808
Pre-training layer 2, epoch 35, cost  0.784001846018
Pre-training layer 2, epoch 36, cost  0.746317351728
Pre-training layer 2, epoch 37, cost  0.715503721279
Pre-training layer 2, epoch 38, cost  0.71497484837
Pre-training layer 2, epoch 39, cost  0.730945157661
Pre-training layer 2, epoch 40, cost  0.730359438326
Pre-training layer 2, epoch 41, cost  0.720128204819
Pre-training layer 2, epoch 42, cost  0.699246824644
Pre-training layer 2, epoch 43, cost  0.636115725237
Pre-training layer 2, epoch 44, cost  0.606006709834
Pre-training layer 2, epoch 45, cost  0.659916980445
Pre-training layer 2, epoch 46, cost  0.679713431122
Pre-training layer 2, epoch 47, cost  0.65813994601
Pre-training layer 2, epoch 48, cost  0.575438313036
Pre-training layer 2, epoch 49, cost  0.552323548234
Pre-training layer 3, epoch 0, cost  17.0463067678
Pre-training layer 3, epoch 1, cost  4.52168086575
Pre-training layer 3, epoch 2, cost  3.13066327321
Pre-training layer 3, epoch 3, cost  2.38726543001
Pre-training layer 3, epoch 4, cost  1.89565114607
Pre-training layer 3, epoch 5, cost  1.54576402836
Pre-training layer 3, epoch 6, cost  1.29383433133
Pre-training layer 3, epoch 7, cost  1.22951989642
Pre-training layer 3, epoch 8, cost  1.23505276614
Pre-training layer 3, epoch 9, cost  1.15431078062
Pre-training layer 3, epoch 10, cost  1.0670895013
Pre-training layer 3, epoch 11, cost  0.969083545347
Pre-training layer 3, epoch 12, cost  0.912016876684
Pre-training layer 3, epoch 13, cost  0.934133628014
Pre-training layer 3, epoch 14, cost  0.865804154
Pre-training layer 3, epoch 15, cost  0.822734919115
Pre-training layer 3, epoch 16, cost  0.786949198913
Pre-training layer 3, epoch 17, cost  0.755893107855
Pre-training layer 3, epoch 18, cost  0.72308290578
Pre-training layer 3, epoch 19, cost  0.668536920579
Pre-training layer 3, epoch 20, cost  0.58448270786
Pre-training layer 3, epoch 21, cost  0.609322767218
Pre-training layer 3, epoch 22, cost  0.632123447439
Pre-training layer 3, epoch 23, cost  0.607746779987
Pre-training layer 3, epoch 24, cost  0.582717117807
Pre-training layer 3, epoch 25, cost  0.558306272971
Pre-training layer 3, epoch 26, cost  0.528881530112
Pre-training layer 3, epoch 27, cost  0.488861325423
Pre-training layer 3, epoch 28, cost  0.467700304504
Pre-training layer 3, epoch 29, cost  0.491211175058
Pre-training layer 3, epoch 30, cost  0.504939327222
Pre-training layer 3, epoch 31, cost  0.49722883583
Pre-training layer 3, epoch 32, cost  0.371109791752
Pre-training layer 3, epoch 33, cost  0.427896215828
Pre-training layer 3, epoch 34, cost  0.452710701413
Pre-training layer 3, epoch 35, cost  0.446238499595
Pre-training layer 3, epoch 36, cost  0.431300421101
Pre-training layer 3, epoch 37, cost  0.381556672647
Pre-training layer 3, epoch 38, cost  0.299488312137
Pre-training layer 3, epoch 39, cost  0.387248737712
Pre-training layer 3, epoch 40, cost  0.420823889915
Pre-training layer 3, epoch 41, cost  0.292650167987
Pre-training layer 3, epoch 42, cost  0.285555580525
Pre-training layer 3, epoch 43, cost  0.394926002862
Pre-training layer 3, epoch 44, cost  0.338753576744
Pre-training layer 3, epoch 45, cost  0.290171767331
Pre-training layer 3, epoch 46, cost  0.325758185953
Pre-training layer 3, epoch 47, cost  0.34335743074
Pre-training layer 3, epoch 48, cost  0.32608333701
Pre-training layer 3, epoch 49, cost  0.263873248328
Pre-training layer 4, epoch 0, cost  18.3969741621
Pre-training layer 4, epoch 1, cost  5.37368601472
Pre-training layer 4, epoch 2, cost  3.75489229212
Pre-training layer 4, epoch 3, cost  2.87893502136
Pre-training layer 4, epoch 4, cost  2.32323344636
Pre-training layer 4, epoch 5, cost  1.95894989849
Pre-training layer 4, epoch 6, cost  1.84739598861
Pre-training layer 4, epoch 7, cost  1.79339387987
Pre-training layer 4, epoch 8, cost  1.69467568928
Pre-training layer 4, epoch 9, cost  1.60115248995
Pre-training layer 4, epoch 10, cost  1.5232164346
Pre-training layer 4, epoch 11, cost  1.46357725161
Pre-training layer 4, epoch 12, cost  1.41835513808
Pre-training layer 4, epoch 13, cost  1.38469267446
Pre-training layer 4, epoch 14, cost  1.35504195784
Pre-training layer 4, epoch 15, cost  1.32252255581
Pre-training layer 4, epoch 16, cost  1.29241859811
Pre-training layer 4, epoch 17, cost  1.27016329485
Pre-training layer 4, epoch 18, cost  1.25584410184
Pre-training layer 4, epoch 19, cost  1.24227562313
Pre-training layer 4, epoch 20, cost  1.22381214842
Pre-training layer 4, epoch 21, cost  1.20172369466
Pre-training layer 4, epoch 22, cost  1.18696515254
Pre-training layer 4, epoch 23, cost  1.18271492786
Pre-training layer 4, epoch 24, cost  1.17063807
Pre-training layer 4, epoch 25, cost  1.14570260222
Pre-training layer 4, epoch 26, cost  1.13690174244
Pre-training layer 4, epoch 27, cost  1.14421716576
Pre-training layer 4, epoch 28, cost  1.12915636068
Pre-training layer 4, epoch 29, cost  1.10180871335
Pre-training layer 4, epoch 30, cost  1.11532857299
Pre-training layer 4, epoch 31, cost  1.11162735408
Pre-training layer 4, epoch 32, cost  1.0769316168
Pre-training layer 4, epoch 33, cost  1.08534675605
Pre-training layer 4, epoch 34, cost  1.08833614498
Pre-training layer 4, epoch 35, cost  1.0550371587
Pre-training layer 4, epoch 36, cost  1.06646272026
Pre-training layer 4, epoch 37, cost  1.06632804404
Pre-training layer 4, epoch 38, cost  1.03621811127
Pre-training layer 4, epoch 39, cost  1.06137730769
Pre-training layer 4, epoch 40, cost  1.04413779458
Pre-training layer 4, epoch 41, cost  1.02862686071
Pre-training layer 4, epoch 42, cost  1.04405579111
Pre-training layer 4, epoch 43, cost  1.01485367752
Pre-training layer 4, epoch 44, cost  1.02847916186
Pre-training layer 4, epoch 45, cost  1.01561092246
Pre-training layer 4, epoch 46, cost  1.00883111293
Pre-training layer 4, epoch 47, cost  1.01540444159
Pre-training layer 4, epoch 48, cost  0.995531624933
Pre-training layer 4, epoch 49, cost  1.01069610155
Pre-training layer 5, epoch 0, cost  19.6852056414
Pre-training layer 5, epoch 1, cost  6.94454932345
Pre-training layer 5, epoch 2, cost  5.6773693465
Pre-training layer 5, epoch 3, cost  5.47981930037
Pre-training layer 5, epoch 4, cost  5.41549959321
Pre-training layer 5, epoch 5, cost  5.38504107759
Pre-training layer 5, epoch 6, cost  5.3679687972
Pre-training layer 5, epoch 7, cost  5.35745173212
Pre-training layer 5, epoch 8, cost  5.35060161614
Pre-training layer 5, epoch 9, cost  5.34585433675
Pre-training layer 5, epoch 10, cost  5.34242346757
Pre-training layer 5, epoch 11, cost  5.33979090132
Pre-training layer 5, epoch 12, cost  5.33776438936
Pre-training layer 5, epoch 13, cost  5.33604808838
Pre-training layer 5, epoch 14, cost  5.33453655219
Pre-training layer 5, epoch 15, cost  5.33313567465
Pre-training layer 5, epoch 16, cost  5.33175819816
Pre-training layer 5, epoch 17, cost  5.33045584379
Pre-training layer 5, epoch 18, cost  5.32920076366
Pre-training layer 5, epoch 19, cost  5.32795754092
Pre-training layer 5, epoch 20, cost  5.32675066355
Pre-training layer 5, epoch 21, cost  5.32552894437
Pre-training layer 5, epoch 22, cost  5.32430649961
Pre-training layer 5, epoch 23, cost  5.32305994861
Pre-training layer 5, epoch 24, cost  5.32189660684
Pre-training layer 5, epoch 25, cost  5.32074794093
Pre-training layer 5, epoch 26, cost  5.3196193523
Pre-training layer 5, epoch 27, cost  5.3185487134
Pre-training layer 5, epoch 28, cost  5.31745317406
Pre-training layer 5, epoch 29, cost  5.31637563821
Pre-training layer 5, epoch 30, cost  5.31534456003
Pre-training layer 5, epoch 31, cost  5.31437688868
Pre-training layer 5, epoch 32, cost  5.31338036639
Pre-training layer 5, epoch 33, cost  5.31238853182
Pre-training layer 5, epoch 34, cost  5.31144986426
Pre-training layer 5, epoch 35, cost  5.3105677917
Pre-training layer 5, epoch 36, cost  5.30964553189
Pre-training layer 5, epoch 37, cost  5.30875602712
Pre-training layer 5, epoch 38, cost  5.30786127184
Pre-training layer 5, epoch 39, cost  5.30704659471
Pre-training layer 5, epoch 40, cost  5.30622925071
Pre-training layer 5, epoch 41, cost  5.30543826299
Pre-training layer 5, epoch 42, cost  5.30468020969
Pre-training layer 5, epoch 43, cost  5.30393557563
Pre-training layer 5, epoch 44, cost  5.30317227653
Pre-training layer 5, epoch 45, cost  5.30246482537
Pre-training layer 5, epoch 46, cost  5.30175798803
Pre-training layer 5, epoch 47, cost  5.30108845172
Pre-training layer 5, epoch 48, cost  5.30039220326
Pre-training layer 5, epoch 49, cost  5.29974081731
The pretraining code for file multi_layer_km.pyc ran for 9.92m
Initial NMI for deep clustering: 0.50
ARI for deep clustering: 0.37
ACC for deep clustering: 0.55
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.92684, Reconstruction: 1.94085, Clustering: 0.98599, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.22482, Reconstruction: 1.71456, Clustering: 0.51027, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.11569, Reconstruction: 1.66661, Clustering: 0.44909, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.02790, Reconstruction: 1.60057, Clustering: 0.42733, 
Fine-tuning epoch 5 ++++ 
Total cost: 1.99141, Reconstruction: 1.58087, Clustering: 0.41054, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.92735, Reconstruction: 1.53174, Clustering: 0.39561, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.89646, Reconstruction: 1.51059, Clustering: 0.38587, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.84203, Reconstruction: 1.47052, Clustering: 0.37151, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.81882, Reconstruction: 1.45880, Clustering: 0.36003, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.76963, Reconstruction: 1.42136, Clustering: 0.34828, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.74982, Reconstruction: 1.40837, Clustering: 0.34146, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.69673, Reconstruction: 1.36976, Clustering: 0.32697, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.66164, Reconstruction: 1.34133, Clustering: 0.32031, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.64785, Reconstruction: 1.33507, Clustering: 0.31278, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.61331, Reconstruction: 1.30481, Clustering: 0.30849, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.59664, Reconstruction: 1.29511, Clustering: 0.30153, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.55950, Reconstruction: 1.26457, Clustering: 0.29493, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.52994, Reconstruction: 1.24020, Clustering: 0.28975, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.53668, Reconstruction: 1.24850, Clustering: 0.28818, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.49943, Reconstruction: 1.21671, Clustering: 0.28272, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.48712, Reconstruction: 1.20146, Clustering: 0.28566, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.48051, Reconstruction: 1.19746, Clustering: 0.28305, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.45286, Reconstruction: 1.17265, Clustering: 0.28021, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.44864, Reconstruction: 1.17124, Clustering: 0.27740, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.41929, Reconstruction: 1.14389, Clustering: 0.27540, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.40867, Reconstruction: 1.13685, Clustering: 0.27182, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.41757, Reconstruction: 1.13919, Clustering: 0.27838, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.37583, Reconstruction: 1.10941, Clustering: 0.26642, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.36646, Reconstruction: 1.09898, Clustering: 0.26748, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.35495, Reconstruction: 1.08833, Clustering: 0.26662, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.34496, Reconstruction: 1.07727, Clustering: 0.26769, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.33521, Reconstruction: 1.06769, Clustering: 0.26752, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.33142, Reconstruction: 1.06718, Clustering: 0.26424, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.28706, Reconstruction: 1.03172, Clustering: 0.25534, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.30966, Reconstruction: 1.04557, Clustering: 0.26409, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.29261, Reconstruction: 1.03010, Clustering: 0.26251, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.28601, Reconstruction: 1.02405, Clustering: 0.26196, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.26196, Reconstruction: 1.00611, Clustering: 0.25586, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.26689, Reconstruction: 1.00574, Clustering: 0.26116, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.24270, Reconstruction: 0.98515, Clustering: 0.25755, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.23325, Reconstruction: 0.97883, Clustering: 0.25441, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.25186, Reconstruction: 0.99226, Clustering: 0.25961, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.22074, Reconstruction: 0.96518, Clustering: 0.25556, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.23295, Reconstruction: 0.97111, Clustering: 0.26183, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.23399, Reconstruction: 0.97362, Clustering: 0.26036, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.19689, Reconstruction: 0.94321, Clustering: 0.25368, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.20828, Reconstruction: 0.95091, Clustering: 0.25737, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.20103, Reconstruction: 0.94643, Clustering: 0.25460, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.20089, Reconstruction: 0.94195, Clustering: 0.25895, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.20011, Reconstruction: 0.93870, Clustering: 0.26141, 
Average squared 2-D reconstruction error: 0.9387
NMI for deep clustering: 0.53
ARI for deep clustering: 0.39
ACC for deep clustering: 0.55
The training code for file multi_layer_km.pyc ran for 8.73m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  10.9471750438
Pre-training layer 0, epoch 1, cost  2.80886032671
Pre-training layer 0, epoch 2, cost  1.98228950132
Pre-training layer 0, epoch 3, cost  1.57803627322
Pre-training layer 0, epoch 4, cost  1.33224019377
Pre-training layer 0, epoch 5, cost  1.16623595363
Pre-training layer 0, epoch 6, cost  1.04675210116
Pre-training layer 0, epoch 7, cost  0.957292729932
Pre-training layer 0, epoch 8, cost  0.887477058949
Pre-training layer 0, epoch 9, cost  0.831185086746
Pre-training layer 0, epoch 10, cost  0.785585687439
Pre-training layer 0, epoch 11, cost  0.747639251721
Pre-training layer 0, epoch 12, cost  0.715491237847
Pre-training layer 0, epoch 13, cost  0.687778444529
Pre-training layer 0, epoch 14, cost  0.663699605138
Pre-training layer 0, epoch 15, cost  0.642591431976
Pre-training layer 0, epoch 16, cost  0.623813191272
Pre-training layer 0, epoch 17, cost  0.606977346225
Pre-training layer 0, epoch 18, cost  0.591853455845
Pre-training layer 0, epoch 19, cost  0.578131482803
Pre-training layer 0, epoch 20, cost  0.565642655059
Pre-training layer 0, epoch 21, cost  0.55420401673
Pre-training layer 0, epoch 22, cost  0.543595695236
Pre-training layer 0, epoch 23, cost  0.533795322807
Pre-training layer 0, epoch 24, cost  0.524689458978
Pre-training layer 0, epoch 25, cost  0.516173493394
Pre-training layer 0, epoch 26, cost  0.508242031666
Pre-training layer 0, epoch 27, cost  0.500766923718
Pre-training layer 0, epoch 28, cost  0.493708681625
Pre-training layer 0, epoch 29, cost  0.487091818119
Pre-training layer 0, epoch 30, cost  0.480816164855
Pre-training layer 0, epoch 31, cost  0.474851617504
Pre-training layer 0, epoch 32, cost  0.4692051997
Pre-training layer 0, epoch 33, cost  0.463745550129
Pre-training layer 0, epoch 34, cost  0.458557791546
Pre-training layer 0, epoch 35, cost  0.453618542391
Pre-training layer 0, epoch 36, cost  0.448780748847
Pre-training layer 0, epoch 37, cost  0.443662210918
Pre-training layer 0, epoch 38, cost  0.439184832234
Pre-training layer 0, epoch 39, cost  0.43488408968
Pre-training layer 0, epoch 40, cost  0.430325015281
Pre-training layer 0, epoch 41, cost  0.426153902302
Pre-training layer 0, epoch 42, cost  0.422235824263
Pre-training layer 0, epoch 43, cost  0.418457548039
Pre-training layer 0, epoch 44, cost  0.414865673621
Pre-training layer 0, epoch 45, cost  0.411441929107
Pre-training layer 0, epoch 46, cost  0.408114573468
Pre-training layer 0, epoch 47, cost  0.404909798832
Pre-training layer 0, epoch 48, cost  0.401835812417
Pre-training layer 0, epoch 49, cost  0.398832239899
Pre-training layer 1, epoch 0, cost  16.1958030657
Pre-training layer 1, epoch 1, cost  4.83932174339
Pre-training layer 1, epoch 2, cost  3.27950001266
Pre-training layer 1, epoch 3, cost  2.49649628933
Pre-training layer 1, epoch 4, cost  2.0074214248
Pre-training layer 1, epoch 5, cost  1.67476218542
Pre-training layer 1, epoch 6, cost  1.43986547892
Pre-training layer 1, epoch 7, cost  1.27820597933
Pre-training layer 1, epoch 8, cost  1.19777201265
Pre-training layer 1, epoch 9, cost  1.16533483932
Pre-training layer 1, epoch 10, cost  1.11284954817
Pre-training layer 1, epoch 11, cost  1.05583334119
Pre-training layer 1, epoch 12, cost  1.01016548731
Pre-training layer 1, epoch 13, cost  0.965427568997
Pre-training layer 1, epoch 14, cost  0.927075485658
Pre-training layer 1, epoch 15, cost  0.894670137569
Pre-training layer 1, epoch 16, cost  0.86998491755
Pre-training layer 1, epoch 17, cost  0.848788420794
Pre-training layer 1, epoch 18, cost  0.823745381036
Pre-training layer 1, epoch 19, cost  0.797538272622
Pre-training layer 1, epoch 20, cost  0.780151448857
Pre-training layer 1, epoch 21, cost  0.759411764639
Pre-training layer 1, epoch 22, cost  0.744765153251
Pre-training layer 1, epoch 23, cost  0.729332862629
Pre-training layer 1, epoch 24, cost  0.713312028091
Pre-training layer 1, epoch 25, cost  0.700080613616
Pre-training layer 1, epoch 26, cost  0.694002244138
Pre-training layer 1, epoch 27, cost  0.680075922152
Pre-training layer 1, epoch 28, cost  0.665959233852
Pre-training layer 1, epoch 29, cost  0.656679683538
Pre-training layer 1, epoch 30, cost  0.645232634456
Pre-training layer 1, epoch 31, cost  0.638956936828
Pre-training layer 1, epoch 32, cost  0.629039278668
Pre-training layer 1, epoch 33, cost  0.61855522707
Pre-training layer 1, epoch 34, cost  0.611876668617
Pre-training layer 1, epoch 35, cost  0.604976139165
Pre-training layer 1, epoch 36, cost  0.59945631074
Pre-training layer 1, epoch 37, cost  0.59392760963
Pre-training layer 1, epoch 38, cost  0.58323217729
Pre-training layer 1, epoch 39, cost  0.574318613247
Pre-training layer 1, epoch 40, cost  0.566982209342
Pre-training layer 1, epoch 41, cost  0.563243211678
Pre-training layer 1, epoch 42, cost  0.558273999907
Pre-training layer 1, epoch 43, cost  0.558813914582
Pre-training layer 1, epoch 44, cost  0.555031472086
Pre-training layer 1, epoch 45, cost  0.546776906505
Pre-training layer 1, epoch 46, cost  0.540725467469
Pre-training layer 1, epoch 47, cost  0.530427709011
Pre-training layer 1, epoch 48, cost  0.524225533118
Pre-training layer 1, epoch 49, cost  0.51920896726
Pre-training layer 2, epoch 0, cost  19.9575383109
Pre-training layer 2, epoch 1, cost  5.50634005899
Pre-training layer 2, epoch 2, cost  3.9296301762
Pre-training layer 2, epoch 3, cost  3.06929783754
Pre-training layer 2, epoch 4, cost  2.49998069348
Pre-training layer 2, epoch 5, cost  2.11095533282
Pre-training layer 2, epoch 6, cost  2.12765291711
Pre-training layer 2, epoch 7, cost  1.97765336895
Pre-training layer 2, epoch 8, cost  1.88787283925
Pre-training layer 2, epoch 9, cost  1.79640850496
Pre-training layer 2, epoch 10, cost  1.70429585797
Pre-training layer 2, epoch 11, cost  1.64364400681
Pre-training layer 2, epoch 12, cost  1.5378743691
Pre-training layer 2, epoch 13, cost  1.46220882434
Pre-training layer 2, epoch 14, cost  1.40271311353
Pre-training layer 2, epoch 15, cost  1.37521782787
Pre-training layer 2, epoch 16, cost  1.3521807267
Pre-training layer 2, epoch 17, cost  1.29334680632
Pre-training layer 2, epoch 18, cost  1.25038995785
Pre-training layer 2, epoch 19, cost  1.21093300722
Pre-training layer 2, epoch 20, cost  1.16831372838
Pre-training layer 2, epoch 21, cost  1.12923009997
Pre-training layer 2, epoch 22, cost  1.07521067286
Pre-training layer 2, epoch 23, cost  1.01296169057
Pre-training layer 2, epoch 24, cost  1.06107621403
Pre-training layer 2, epoch 25, cost  1.0405386104
Pre-training layer 2, epoch 26, cost  1.00211337054
Pre-training layer 2, epoch 27, cost  0.962600082464
Pre-training layer 2, epoch 28, cost  0.89401524363
Pre-training layer 2, epoch 29, cost  0.869008943445
Pre-training layer 2, epoch 30, cost  0.903275937877
Pre-training layer 2, epoch 31, cost  0.887342061868
Pre-training layer 2, epoch 32, cost  0.841607628774
Pre-training layer 2, epoch 33, cost  0.823978809522
Pre-training layer 2, epoch 34, cost  0.833903652033
Pre-training layer 2, epoch 35, cost  0.82381367193
Pre-training layer 2, epoch 36, cost  0.799024582239
Pre-training layer 2, epoch 37, cost  0.769822028422
Pre-training layer 2, epoch 38, cost  0.727537422903
Pre-training layer 2, epoch 39, cost  0.709168995056
Pre-training layer 2, epoch 40, cost  0.771996744938
Pre-training layer 2, epoch 41, cost  0.762105432039
Pre-training layer 2, epoch 42, cost  0.741383553398
Pre-training layer 2, epoch 43, cost  0.706541272238
Pre-training layer 2, epoch 44, cost  0.637996631648
Pre-training layer 2, epoch 45, cost  0.606242855077
Pre-training layer 2, epoch 46, cost  0.676993398784
Pre-training layer 2, epoch 47, cost  0.694285621853
Pre-training layer 2, epoch 48, cost  0.6823762355
Pre-training layer 2, epoch 49, cost  0.584063952577
Pre-training layer 3, epoch 0, cost  16.907635157
Pre-training layer 3, epoch 1, cost  4.50849022762
Pre-training layer 3, epoch 2, cost  3.13075153391
Pre-training layer 3, epoch 3, cost  2.39467866173
Pre-training layer 3, epoch 4, cost  1.90502042398
Pre-training layer 3, epoch 5, cost  1.55418537256
Pre-training layer 3, epoch 6, cost  1.29973759549
Pre-training layer 3, epoch 7, cost  1.2550268223
Pre-training layer 3, epoch 8, cost  1.23913928395
Pre-training layer 3, epoch 9, cost  1.16180441891
Pre-training layer 3, epoch 10, cost  1.06931657152
Pre-training layer 3, epoch 11, cost  0.979862668804
Pre-training layer 3, epoch 12, cost  0.917904915546
Pre-training layer 3, epoch 13, cost  0.882794578847
Pre-training layer 3, epoch 14, cost  0.851865655971
Pre-training layer 3, epoch 15, cost  0.860685503752
Pre-training layer 3, epoch 16, cost  0.777184297236
Pre-training layer 3, epoch 17, cost  0.705676855976
Pre-training layer 3, epoch 18, cost  0.669528125309
Pre-training layer 3, epoch 19, cost  0.673799180722
Pre-training layer 3, epoch 20, cost  0.6623300584
Pre-training layer 3, epoch 21, cost  0.638673641098
Pre-training layer 3, epoch 22, cost  0.596009031981
Pre-training layer 3, epoch 23, cost  0.535588274896
Pre-training layer 3, epoch 24, cost  0.581122257061
Pre-training layer 3, epoch 25, cost  0.601180866441
Pre-training layer 3, epoch 26, cost  0.558395833924
Pre-training layer 3, epoch 27, cost  0.533786272457
Pre-training layer 3, epoch 28, cost  0.513528086333
Pre-training layer 3, epoch 29, cost  0.492176358728
Pre-training layer 3, epoch 30, cost  0.467918184508
Pre-training layer 3, epoch 31, cost  0.442548341026
Pre-training layer 3, epoch 32, cost  0.426990783655
Pre-training layer 3, epoch 33, cost  0.439816637455
Pre-training layer 3, epoch 34, cost  0.456621801706
Pre-training layer 3, epoch 35, cost  0.422728036825
Pre-training layer 3, epoch 36, cost  0.309757725153
Pre-training layer 3, epoch 37, cost  0.437187355628
Pre-training layer 3, epoch 38, cost  0.414043511091
Pre-training layer 3, epoch 39, cost  0.395850364741
Pre-training layer 3, epoch 40, cost  0.367137541512
Pre-training layer 3, epoch 41, cost  0.333402900719
Pre-training layer 3, epoch 42, cost  0.336930529876
Pre-training layer 3, epoch 43, cost  0.358875911089
Pre-training layer 3, epoch 44, cost  0.358313736089
Pre-training layer 3, epoch 45, cost  0.31023897559
Pre-training layer 3, epoch 46, cost  0.256929699861
Pre-training layer 3, epoch 47, cost  0.35749757067
Pre-training layer 3, epoch 48, cost  0.317444389696
Pre-training layer 3, epoch 49, cost  0.254597179505
Pre-training layer 4, epoch 0, cost  18.3413762301
Pre-training layer 4, epoch 1, cost  5.32239305779
Pre-training layer 4, epoch 2, cost  3.74173381389
Pre-training layer 4, epoch 3, cost  2.88160352767
Pre-training layer 4, epoch 4, cost  2.33095232701
Pre-training layer 4, epoch 5, cost  1.96437507969
Pre-training layer 4, epoch 6, cost  1.82908219933
Pre-training layer 4, epoch 7, cost  1.81515435996
Pre-training layer 4, epoch 8, cost  1.71257008339
Pre-training layer 4, epoch 9, cost  1.61812761856
Pre-training layer 4, epoch 10, cost  1.5316530346
Pre-training layer 4, epoch 11, cost  1.4611662272
Pre-training layer 4, epoch 12, cost  1.41851742744
Pre-training layer 4, epoch 13, cost  1.39104890705
Pre-training layer 4, epoch 14, cost  1.36350062876
Pre-training layer 4, epoch 15, cost  1.33103290867
Pre-training layer 4, epoch 16, cost  1.29455278481
Pre-training layer 4, epoch 17, cost  1.2629438514
Pre-training layer 4, epoch 18, cost  1.25469985996
Pre-training layer 4, epoch 19, cost  1.25313889487
Pre-training layer 4, epoch 20, cost  1.23829874566
Pre-training layer 4, epoch 21, cost  1.20340031501
Pre-training layer 4, epoch 22, cost  1.173643259
Pre-training layer 4, epoch 23, cost  1.18772691904
Pre-training layer 4, epoch 24, cost  1.19148596007
Pre-training layer 4, epoch 25, cost  1.15656920507
Pre-training layer 4, epoch 26, cost  1.1211564736
Pre-training layer 4, epoch 27, cost  1.15138824005
Pre-training layer 4, epoch 28, cost  1.15083563918
Pre-training layer 4, epoch 29, cost  1.0895347989
Pre-training layer 4, epoch 30, cost  1.10369331621
Pre-training layer 4, epoch 31, cost  1.13364014975
Pre-training layer 4, epoch 32, cost  1.07479470398
Pre-training layer 4, epoch 33, cost  1.07416612706
Pre-training layer 4, epoch 34, cost  1.10662575581
Pre-training layer 4, epoch 35, cost  1.05295123514
Pre-training layer 4, epoch 36, cost  1.05917055351
Pre-training layer 4, epoch 37, cost  1.08355211543
Pre-training layer 4, epoch 38, cost  1.02329066741
Pre-training layer 4, epoch 39, cost  1.05953298254
Pre-training layer 4, epoch 40, cost  1.05770002856
Pre-training layer 4, epoch 41, cost  1.0109933781
Pre-training layer 4, epoch 42, cost  1.05842757278
Pre-training layer 4, epoch 43, cost  1.00955942632
Pre-training layer 4, epoch 44, cost  1.02817724312
Pre-training layer 4, epoch 45, cost  1.02899262997
Pre-training layer 4, epoch 46, cost  0.993915652305
Pre-training layer 4, epoch 47, cost  1.03447918868
Pre-training layer 4, epoch 48, cost  0.978578953814
Pre-training layer 4, epoch 49, cost  1.02576619949
Pre-training layer 5, epoch 0, cost  19.8089491107
Pre-training layer 5, epoch 1, cost  6.84201465535
Pre-training layer 5, epoch 2, cost  5.57440407276
Pre-training layer 5, epoch 3, cost  5.38770635463
Pre-training layer 5, epoch 4, cost  5.3200145936
Pre-training layer 5, epoch 5, cost  5.28461089
Pre-training layer 5, epoch 6, cost  5.26454555808
Pre-training layer 5, epoch 7, cost  5.25276992987
Pre-training layer 5, epoch 8, cost  5.24541582818
Pre-training layer 5, epoch 9, cost  5.24056802774
Pre-training layer 5, epoch 10, cost  5.23722068091
Pre-training layer 5, epoch 11, cost  5.23475934509
Pre-training layer 5, epoch 12, cost  5.23269802216
Pre-training layer 5, epoch 13, cost  5.23094533316
Pre-training layer 5, epoch 14, cost  5.22927600493
Pre-training layer 5, epoch 15, cost  5.22777686477
Pre-training layer 5, epoch 16, cost  5.22621878967
Pre-training layer 5, epoch 17, cost  5.2248189387
Pre-training layer 5, epoch 18, cost  5.22329688976
Pre-training layer 5, epoch 19, cost  5.22191809118
Pre-training layer 5, epoch 20, cost  5.22042019719
Pre-training layer 5, epoch 21, cost  5.21890175681
Pre-training layer 5, epoch 22, cost  5.217384085
Pre-training layer 5, epoch 23, cost  5.21591718859
Pre-training layer 5, epoch 24, cost  5.21455662249
Pre-training layer 5, epoch 25, cost  5.21321727947
Pre-training layer 5, epoch 26, cost  5.21185117596
Pre-training layer 5, epoch 27, cost  5.21050725405
Pre-training layer 5, epoch 28, cost  5.20925283781
Pre-training layer 5, epoch 29, cost  5.20800308046
Pre-training layer 5, epoch 30, cost  5.20681103023
Pre-training layer 5, epoch 31, cost  5.20564405696
Pre-training layer 5, epoch 32, cost  5.20452987234
Pre-training layer 5, epoch 33, cost  5.20350725672
Pre-training layer 5, epoch 34, cost  5.20248140968
Pre-training layer 5, epoch 35, cost  5.20146729626
Pre-training layer 5, epoch 36, cost  5.20054401178
Pre-training layer 5, epoch 37, cost  5.19962945364
Pre-training layer 5, epoch 38, cost  5.19877428336
Pre-training layer 5, epoch 39, cost  5.19790773087
Pre-training layer 5, epoch 40, cost  5.19707834331
Pre-training layer 5, epoch 41, cost  5.19628673595
Pre-training layer 5, epoch 42, cost  5.19547966572
Pre-training layer 5, epoch 43, cost  5.1947526042
Pre-training layer 5, epoch 44, cost  5.19399943237
Pre-training layer 5, epoch 45, cost  5.19330426539
Pre-training layer 5, epoch 46, cost  5.19260105651
Pre-training layer 5, epoch 47, cost  5.19195016971
Pre-training layer 5, epoch 48, cost  5.19132645131
The pretraining code for file multi_layer_km.pyc ran for 9.65m
Pre-training layer 5, epoch 49, cost  5.19071983832
Initial NMI for deep clustering: 0.52
ARI for deep clustering: 0.39
ACC for deep clustering: 0.54
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.90882, Reconstruction: 1.98343, Clustering: 0.92539, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.22026, Reconstruction: 1.74069, Clustering: 0.47957, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.11862, Reconstruction: 1.70111, Clustering: 0.41751, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.05421, Reconstruction: 1.65745, Clustering: 0.39677, 
Fine-tuning epoch 5 ++++ 
Total cost: 2.01683, Reconstruction: 1.63338, Clustering: 0.38345, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.96076, Reconstruction: 1.59232, Clustering: 0.36844, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.91375, Reconstruction: 1.55278, Clustering: 0.36097, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.90539, Reconstruction: 1.55179, Clustering: 0.35360, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.85283, Reconstruction: 1.51255, Clustering: 0.34029, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.81626, Reconstruction: 1.48185, Clustering: 0.33441, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.76385, Reconstruction: 1.43908, Clustering: 0.32476, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.74542, Reconstruction: 1.42599, Clustering: 0.31944, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.72464, Reconstruction: 1.41308, Clustering: 0.31156, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.68901, Reconstruction: 1.38266, Clustering: 0.30635, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.67189, Reconstruction: 1.36838, Clustering: 0.30351, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.62775, Reconstruction: 1.33329, Clustering: 0.29446, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.61069, Reconstruction: 1.31748, Clustering: 0.29321, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.57628, Reconstruction: 1.29192, Clustering: 0.28437, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.59110, Reconstruction: 1.30263, Clustering: 0.28847, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.53873, Reconstruction: 1.25977, Clustering: 0.27897, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.50616, Reconstruction: 1.22957, Clustering: 0.27659, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.48998, Reconstruction: 1.21669, Clustering: 0.27329, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.47524, Reconstruction: 1.20370, Clustering: 0.27155, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.45428, Reconstruction: 1.18330, Clustering: 0.27098, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.44994, Reconstruction: 1.17988, Clustering: 0.27006, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.42436, Reconstruction: 1.15602, Clustering: 0.26835, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.41188, Reconstruction: 1.14869, Clustering: 0.26319, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.40862, Reconstruction: 1.14106, Clustering: 0.26756, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.40720, Reconstruction: 1.13741, Clustering: 0.26979, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.37159, Reconstruction: 1.11081, Clustering: 0.26078, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.35962, Reconstruction: 1.09779, Clustering: 0.26183, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.36982, Reconstruction: 1.10331, Clustering: 0.26651, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.34648, Reconstruction: 1.08168, Clustering: 0.26480, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.32248, Reconstruction: 1.06508, Clustering: 0.25739, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.32116, Reconstruction: 1.06153, Clustering: 0.25962, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.31855, Reconstruction: 1.05993, Clustering: 0.25861, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.30065, Reconstruction: 1.03965, Clustering: 0.26100, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.29630, Reconstruction: 1.03724, Clustering: 0.25905, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.28229, Reconstruction: 1.02484, Clustering: 0.25745, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.26785, Reconstruction: 1.01408, Clustering: 0.25378, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.29093, Reconstruction: 1.02796, Clustering: 0.26297, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.26347, Reconstruction: 1.00781, Clustering: 0.25566, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.25265, Reconstruction: 0.99744, Clustering: 0.25521, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.24375, Reconstruction: 0.99125, Clustering: 0.25250, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.23407, Reconstruction: 0.97875, Clustering: 0.25532, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.22438, Reconstruction: 0.96961, Clustering: 0.25477, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.23132, Reconstruction: 0.97430, Clustering: 0.25702, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.20110, Reconstruction: 0.95042, Clustering: 0.25069, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.22680, Reconstruction: 0.97097, Clustering: 0.25583, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.21903, Reconstruction: 0.96114, Clustering: 0.25789, 
Average squared 2-D reconstruction error: 0.9611
NMI for deep clustering: 0.55
ARI for deep clustering: 0.41
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 8.76m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  10.9324005515
Pre-training layer 0, epoch 1, cost  2.77935037537
Pre-training layer 0, epoch 2, cost  1.9543455954
Pre-training layer 0, epoch 3, cost  1.55009947104
Pre-training layer 0, epoch 4, cost  1.30511590048
Pre-training layer 0, epoch 5, cost  1.14094838098
Pre-training layer 0, epoch 6, cost  1.02283161557
Pre-training layer 0, epoch 7, cost  0.934204165412
Pre-training layer 0, epoch 8, cost  0.865461606869
Pre-training layer 0, epoch 9, cost  0.810457462235
Pre-training layer 0, epoch 10, cost  0.765496680583
Pre-training layer 0, epoch 11, cost  0.728028084097
Pre-training layer 0, epoch 12, cost  0.696326738671
Pre-training layer 0, epoch 13, cost  0.669035470797
Pre-training layer 0, epoch 14, cost  0.645291941239
Pre-training layer 0, epoch 15, cost  0.624343699764
Pre-training layer 0, epoch 16, cost  0.605698275516
Pre-training layer 0, epoch 17, cost  0.588865087634
Pre-training layer 0, epoch 18, cost  0.573776724344
Pre-training layer 0, epoch 19, cost  0.560109541846
Pre-training layer 0, epoch 20, cost  0.547643591703
Pre-training layer 0, epoch 21, cost  0.536233533584
Pre-training layer 0, epoch 22, cost  0.525707604562
Pre-training layer 0, epoch 23, cost  0.51596453644
Pre-training layer 0, epoch 24, cost  0.506958501346
Pre-training layer 0, epoch 25, cost  0.498449566095
Pre-training layer 0, epoch 26, cost  0.49048713009
Pre-training layer 0, epoch 27, cost  0.482949089449
Pre-training layer 0, epoch 28, cost  0.47597034854
Pre-training layer 0, epoch 29, cost  0.469358923595
Pre-training layer 0, epoch 30, cost  0.463036778041
Pre-training layer 0, epoch 31, cost  0.457054073588
Pre-training layer 0, epoch 32, cost  0.451392575612
Pre-training layer 0, epoch 33, cost  0.446013186897
Pre-training layer 0, epoch 34, cost  0.440904160323
Pre-training layer 0, epoch 35, cost  0.436020824355
Pre-training layer 0, epoch 36, cost  0.431365902779
Pre-training layer 0, epoch 37, cost  0.4269187474
Pre-training layer 0, epoch 38, cost  0.422659218948
Pre-training layer 0, epoch 39, cost  0.418578056671
Pre-training layer 0, epoch 40, cost  0.41464917837
Pre-training layer 0, epoch 41, cost  0.410876062681
Pre-training layer 0, epoch 42, cost  0.407210915095
Pre-training layer 0, epoch 43, cost  0.403708920232
Pre-training layer 0, epoch 44, cost  0.400309622881
Pre-training layer 0, epoch 45, cost  0.397024157589
Pre-training layer 0, epoch 46, cost  0.393843124671
Pre-training layer 0, epoch 47, cost  0.390768369988
Pre-training layer 0, epoch 48, cost  0.387805408581
Pre-training layer 0, epoch 49, cost  0.384929477535
Pre-training layer 1, epoch 0, cost  16.2679207301
Pre-training layer 1, epoch 1, cost  4.84632172567
Pre-training layer 1, epoch 2, cost  3.27199436577
Pre-training layer 1, epoch 3, cost  2.49084939796
Pre-training layer 1, epoch 4, cost  2.00419551611
Pre-training layer 1, epoch 5, cost  1.67200691066
Pre-training layer 1, epoch 6, cost  1.43621062005
Pre-training layer 1, epoch 7, cost  1.27209433459
Pre-training layer 1, epoch 8, cost  1.18880180094
Pre-training layer 1, epoch 9, cost  1.1622822489
Pre-training layer 1, epoch 10, cost  1.10785500202
Pre-training layer 1, epoch 11, cost  1.05374694422
Pre-training layer 1, epoch 12, cost  1.00025336319
Pre-training layer 1, epoch 13, cost  0.960899053754
Pre-training layer 1, epoch 14, cost  0.924800498187
Pre-training layer 1, epoch 15, cost  0.891442601725
Pre-training layer 1, epoch 16, cost  0.862377668932
Pre-training layer 1, epoch 17, cost  0.836639918212
Pre-training layer 1, epoch 18, cost  0.813145573593
Pre-training layer 1, epoch 19, cost  0.793547985127
Pre-training layer 1, epoch 20, cost  0.776157184051
Pre-training layer 1, epoch 21, cost  0.757842175626
Pre-training layer 1, epoch 22, cost  0.736814868178
Pre-training layer 1, epoch 23, cost  0.718656782361
Pre-training layer 1, epoch 24, cost  0.706068163542
Pre-training layer 1, epoch 25, cost  0.693283605045
Pre-training layer 1, epoch 26, cost  0.695564748799
Pre-training layer 1, epoch 27, cost  0.676775568201
Pre-training layer 1, epoch 28, cost  0.657406292559
Pre-training layer 1, epoch 29, cost  0.650019715199
Pre-training layer 1, epoch 30, cost  0.642196731702
Pre-training layer 1, epoch 31, cost  0.633120958599
Pre-training layer 1, epoch 32, cost  0.620840076924
Pre-training layer 1, epoch 33, cost  0.61130225977
Pre-training layer 1, epoch 34, cost  0.604871815815
Pre-training layer 1, epoch 35, cost  0.598918327037
Pre-training layer 1, epoch 36, cost  0.597010696703
Pre-training layer 1, epoch 37, cost  0.588954666302
Pre-training layer 1, epoch 38, cost  0.580009397818
Pre-training layer 1, epoch 39, cost  0.574137801447
Pre-training layer 1, epoch 40, cost  0.563930241286
Pre-training layer 1, epoch 41, cost  0.557318576989
Pre-training layer 1, epoch 42, cost  0.551740529662
Pre-training layer 1, epoch 43, cost  0.546913815015
Pre-training layer 1, epoch 44, cost  0.541791624375
Pre-training layer 1, epoch 45, cost  0.538802155062
Pre-training layer 1, epoch 46, cost  0.532896525247
Pre-training layer 1, epoch 47, cost  0.529790541786
Pre-training layer 1, epoch 48, cost  0.528433461914
Pre-training layer 1, epoch 49, cost  0.520284085997
Pre-training layer 2, epoch 0, cost  19.9210461274
Pre-training layer 2, epoch 1, cost  5.52797213121
Pre-training layer 2, epoch 2, cost  3.95001370462
Pre-training layer 2, epoch 3, cost  3.08866342607
Pre-training layer 2, epoch 4, cost  2.51179758397
Pre-training layer 2, epoch 5, cost  2.11163548068
Pre-training layer 2, epoch 6, cost  2.07881043719
Pre-training layer 2, epoch 7, cost  1.99144258419
Pre-training layer 2, epoch 8, cost  1.87888954236
Pre-training layer 2, epoch 9, cost  1.77139743639
Pre-training layer 2, epoch 10, cost  1.67594011219
Pre-training layer 2, epoch 11, cost  1.62234561766
Pre-training layer 2, epoch 12, cost  1.55471295097
Pre-training layer 2, epoch 13, cost  1.47686522457
Pre-training layer 2, epoch 14, cost  1.39497852882
Pre-training layer 2, epoch 15, cost  1.34489897939
Pre-training layer 2, epoch 16, cost  1.32136578951
Pre-training layer 2, epoch 17, cost  1.27037865048
Pre-training layer 2, epoch 18, cost  1.20193089138
Pre-training layer 2, epoch 19, cost  1.16169594877
Pre-training layer 2, epoch 20, cost  1.10723077215
Pre-training layer 2, epoch 21, cost  1.067666743
Pre-training layer 2, epoch 22, cost  1.07473469293
Pre-training layer 2, epoch 23, cost  1.04656980381
Pre-training layer 2, epoch 24, cost  1.01618650849
Pre-training layer 2, epoch 25, cost  0.967250462712
Pre-training layer 2, epoch 26, cost  0.945724238247
Pre-training layer 2, epoch 27, cost  0.938012823205
Pre-training layer 2, epoch 28, cost  0.92382077469
Pre-training layer 2, epoch 29, cost  0.902533649168
Pre-training layer 2, epoch 30, cost  0.881846284719
Pre-training layer 2, epoch 31, cost  0.869421169883
Pre-training layer 2, epoch 32, cost  0.850683075716
Pre-training layer 2, epoch 33, cost  0.820922245716
Pre-training layer 2, epoch 34, cost  0.793213658907
Pre-training layer 2, epoch 35, cost  0.760620788111
Pre-training layer 2, epoch 36, cost  0.733954394375
Pre-training layer 2, epoch 37, cost  0.731683958874
Pre-training layer 2, epoch 38, cost  0.757111998394
Pre-training layer 2, epoch 39, cost  0.753147851566
Pre-training layer 2, epoch 40, cost  0.720649661639
Pre-training layer 2, epoch 41, cost  0.690228737122
Pre-training layer 2, epoch 42, cost  0.662251346189
Pre-training layer 2, epoch 43, cost  0.64418631567
Pre-training layer 2, epoch 44, cost  0.652857379028
Pre-training layer 2, epoch 45, cost  0.673378630774
Pre-training layer 2, epoch 46, cost  0.665812244785
Pre-training layer 2, epoch 47, cost  0.54144241135
Pre-training layer 2, epoch 48, cost  0.589342936122
Pre-training layer 2, epoch 49, cost  0.65593191827
Pre-training layer 3, epoch 0, cost  17.0001318997
Pre-training layer 3, epoch 1, cost  4.52919451152
Pre-training layer 3, epoch 2, cost  3.14118388056
Pre-training layer 3, epoch 3, cost  2.40211397997
Pre-training layer 3, epoch 4, cost  1.91093865239
Pre-training layer 3, epoch 5, cost  1.55820259335
Pre-training layer 3, epoch 6, cost  1.30425062527
Pre-training layer 3, epoch 7, cost  1.2496864902
Pre-training layer 3, epoch 8, cost  1.24483216197
Pre-training layer 3, epoch 9, cost  1.15918596547
Pre-training layer 3, epoch 10, cost  1.05571151106
Pre-training layer 3, epoch 11, cost  0.965498487313
Pre-training layer 3, epoch 12, cost  0.938347149373
Pre-training layer 3, epoch 13, cost  0.919519451031
Pre-training layer 3, epoch 14, cost  0.857740363394
Pre-training layer 3, epoch 15, cost  0.793710269701
Pre-training layer 3, epoch 16, cost  0.737623963343
Pre-training layer 3, epoch 17, cost  0.720765453143
Pre-training layer 3, epoch 18, cost  0.70968740431
Pre-training layer 3, epoch 19, cost  0.68623309274
Pre-training layer 3, epoch 20, cost  0.632135739845
Pre-training layer 3, epoch 21, cost  0.591298426225
Pre-training layer 3, epoch 22, cost  0.610223093353
Pre-training layer 3, epoch 23, cost  0.610819751155
Pre-training layer 3, epoch 24, cost  0.59187136331
Pre-training layer 3, epoch 25, cost  0.566082395951
Pre-training layer 3, epoch 26, cost  0.534721044526
Pre-training layer 3, epoch 27, cost  0.492399745923
Pre-training layer 3, epoch 28, cost  0.446916286818
Pre-training layer 3, epoch 29, cost  0.461620881334
Pre-training layer 3, epoch 30, cost  0.498517619439
Pre-training layer 3, epoch 31, cost  0.512780161195
Pre-training layer 3, epoch 32, cost  0.444291443451
Pre-training layer 3, epoch 33, cost  0.377169204756
Pre-training layer 3, epoch 34, cost  0.389574060398
Pre-training layer 3, epoch 35, cost  0.433387331372
Pre-training layer 3, epoch 36, cost  0.434927178009
Pre-training layer 3, epoch 37, cost  0.399514809407
Pre-training layer 3, epoch 38, cost  0.257896017456
Pre-training layer 3, epoch 39, cost  0.40251763531
Pre-training layer 3, epoch 40, cost  0.393565612141
Pre-training layer 3, epoch 41, cost  0.354192149453
Pre-training layer 3, epoch 42, cost  0.287034763552
Pre-training layer 3, epoch 43, cost  0.356788747991
Pre-training layer 3, epoch 44, cost  0.369548117134
Pre-training layer 3, epoch 45, cost  0.31879049233
Pre-training layer 3, epoch 46, cost  0.239115822082
Pre-training layer 3, epoch 47, cost  0.339529686975
Pre-training layer 3, epoch 48, cost  0.328609665418
Pre-training layer 3, epoch 49, cost  0.187933024884
Pre-training layer 4, epoch 0, cost  18.5653148503
Pre-training layer 4, epoch 1, cost  5.35132520256
Pre-training layer 4, epoch 2, cost  3.74804259854
Pre-training layer 4, epoch 3, cost  2.88028121467
Pre-training layer 4, epoch 4, cost  2.33009794599
Pre-training layer 4, epoch 5, cost  1.96822836137
Pre-training layer 4, epoch 6, cost  1.88572624767
Pre-training layer 4, epoch 7, cost  1.7960150955
Pre-training layer 4, epoch 8, cost  1.70785592382
Pre-training layer 4, epoch 9, cost  1.62104216887
Pre-training layer 4, epoch 10, cost  1.541426022
Pre-training layer 4, epoch 11, cost  1.47582911228
Pre-training layer 4, epoch 12, cost  1.42315082752
Pre-training layer 4, epoch 13, cost  1.38091668547
Pre-training layer 4, epoch 14, cost  1.35088569936
Pre-training layer 4, epoch 15, cost  1.32681559018
Pre-training layer 4, epoch 16, cost  1.30825652068
Pre-training layer 4, epoch 17, cost  1.28414108655
Pre-training layer 4, epoch 18, cost  1.25472335966
Pre-training layer 4, epoch 19, cost  1.22961803107
Pre-training layer 4, epoch 20, cost  1.22632675604
Pre-training layer 4, epoch 21, cost  1.22721256135
Pre-training layer 4, epoch 22, cost  1.20588089657
Pre-training layer 4, epoch 23, cost  1.16015276566
Pre-training layer 4, epoch 24, cost  1.16131414557
Pre-training layer 4, epoch 25, cost  1.18668530255
Pre-training layer 4, epoch 26, cost  1.15977180677
Pre-training layer 4, epoch 27, cost  1.0993622654
Pre-training layer 4, epoch 28, cost  1.14788087196
Pre-training layer 4, epoch 29, cost  1.15079208169
Pre-training layer 4, epoch 30, cost  1.08014112492
Pre-training layer 4, epoch 31, cost  1.10134815205
Pre-training layer 4, epoch 32, cost  1.13214305103
Pre-training layer 4, epoch 33, cost  1.05517683251
Pre-training layer 4, epoch 34, cost  1.08736911457
Pre-training layer 4, epoch 35, cost  1.11616192474
Pre-training layer 4, epoch 36, cost  1.02435735417
Pre-training layer 4, epoch 37, cost  1.08512502019
Pre-training layer 4, epoch 38, cost  1.07349585059
Pre-training layer 4, epoch 39, cost  1.01751266055
Pre-training layer 4, epoch 40, cost  1.08186465418
Pre-training layer 4, epoch 41, cost  1.01398974232
Pre-training layer 4, epoch 42, cost  1.04791114518
Pre-training layer 4, epoch 43, cost  1.04361982676
Pre-training layer 4, epoch 44, cost  1.00270870617
Pre-training layer 4, epoch 45, cost  1.0532980918
Pre-training layer 4, epoch 46, cost  0.985854148638
Pre-training layer 4, epoch 47, cost  1.04012233332
Pre-training layer 4, epoch 48, cost  0.994022506585
Pre-training layer 4, epoch 49, cost  1.01820727356
Pre-training layer 5, epoch 0, cost  19.6709239435
Pre-training layer 5, epoch 1, cost  6.90997789805
Pre-training layer 5, epoch 2, cost  5.62710375631
Pre-training layer 5, epoch 3, cost  5.43486763153
Pre-training layer 5, epoch 4, cost  5.37596247249
Pre-training layer 5, epoch 5, cost  5.34950664416
Pre-training layer 5, epoch 6, cost  5.33518596814
Pre-training layer 5, epoch 7, cost  5.32633120519
Pre-training layer 5, epoch 8, cost  5.32041091878
Pre-training layer 5, epoch 9, cost  5.31609686551
Pre-training layer 5, epoch 10, cost  5.31270084507
Pre-training layer 5, epoch 11, cost  5.30994000291
Pre-training layer 5, epoch 12, cost  5.30751583343
Pre-training layer 5, epoch 13, cost  5.30532125127
Pre-training layer 5, epoch 14, cost  5.3032329159
Pre-training layer 5, epoch 15, cost  5.3013389415
Pre-training layer 5, epoch 16, cost  5.29957755553
Pre-training layer 5, epoch 17, cost  5.29787117776
Pre-training layer 5, epoch 18, cost  5.29624340692
Pre-training layer 5, epoch 19, cost  5.29472700123
Pre-training layer 5, epoch 20, cost  5.29321507185
Pre-training layer 5, epoch 21, cost  5.2917307158
Pre-training layer 5, epoch 22, cost  5.2903774725
Pre-training layer 5, epoch 23, cost  5.28908605678
Pre-training layer 5, epoch 24, cost  5.28780308487
Pre-training layer 5, epoch 25, cost  5.28661875749
Pre-training layer 5, epoch 26, cost  5.28547278006
Pre-training layer 5, epoch 27, cost  5.28431727415
Pre-training layer 5, epoch 28, cost  5.28321750723
Pre-training layer 5, epoch 29, cost  5.28218664393
Pre-training layer 5, epoch 30, cost  5.281193131
Pre-training layer 5, epoch 31, cost  5.28020706699
Pre-training layer 5, epoch 32, cost  5.27930247183
Pre-training layer 5, epoch 33, cost  5.27839557547
Pre-training layer 5, epoch 34, cost  5.27750701597
Pre-training layer 5, epoch 35, cost  5.27668112861
Pre-training layer 5, epoch 36, cost  5.27586849358
Pre-training layer 5, epoch 37, cost  5.27509591017
Pre-training layer 5, epoch 38, cost  5.27435150808
Pre-training layer 5, epoch 39, cost  5.27360456117
Pre-training layer 5, epoch 40, cost  5.27287556211
Pre-training layer 5, epoch 41, cost  5.27220220553
Pre-training layer 5, epoch 42, cost  5.27151529277
Pre-training layer 5, epoch 43, cost  5.27084624889
Pre-training layer 5, epoch 44, cost  5.27021571266
Pre-training layer 5, epoch 45, cost  5.26961358078
Pre-training layer 5, epoch 46, cost  5.2690020794
Pre-training layer 5, epoch 47, cost  5.26842918162
Pre-training layer 5, epoch 48, cost  5.26785958977
Pre-training layer 5, epoch 49, cost  5.26729740114
The pretraining code for file multi_layer_km.pyc ran for 10.09m
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.37
... getting the finetuning functions
ACC for deep clustering: 0.52
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.85094, Reconstruction: 1.88125, Clustering: 0.96969, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.23237, Reconstruction: 1.69493, Clustering: 0.53744, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.12509, Reconstruction: 1.64776, Clustering: 0.47733, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.05814, Reconstruction: 1.60983, Clustering: 0.44831, 
Fine-tuning epoch 5 ++++ 
Total cost: 2.01491, Reconstruction: 1.59071, Clustering: 0.42420, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.95689, Reconstruction: 1.54796, Clustering: 0.40894, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.89757, Reconstruction: 1.50512, Clustering: 0.39245, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.86778, Reconstruction: 1.48549, Clustering: 0.38228, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.82175, Reconstruction: 1.45416, Clustering: 0.36759, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.76919, Reconstruction: 1.41484, Clustering: 0.35436, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.74989, Reconstruction: 1.40102, Clustering: 0.34887, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.71219, Reconstruction: 1.37415, Clustering: 0.33804, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.69042, Reconstruction: 1.35925, Clustering: 0.33117, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.65954, Reconstruction: 1.33364, Clustering: 0.32589, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.61702, Reconstruction: 1.30230, Clustering: 0.31472, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.61187, Reconstruction: 1.30042, Clustering: 0.31145, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.57882, Reconstruction: 1.27150, Clustering: 0.30731, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.56142, Reconstruction: 1.25973, Clustering: 0.30169, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.53074, Reconstruction: 1.23112, Clustering: 0.29963, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.49227, Reconstruction: 1.20354, Clustering: 0.28873, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.49223, Reconstruction: 1.20036, Clustering: 0.29187, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.47995, Reconstruction: 1.19142, Clustering: 0.28853, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.46920, Reconstruction: 1.17717, Clustering: 0.29203, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.42181, Reconstruction: 1.14196, Clustering: 0.27985, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.41353, Reconstruction: 1.13376, Clustering: 0.27977, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.40748, Reconstruction: 1.12914, Clustering: 0.27835, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.41215, Reconstruction: 1.12890, Clustering: 0.28325, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.36883, Reconstruction: 1.09317, Clustering: 0.27566, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.35956, Reconstruction: 1.08688, Clustering: 0.27267, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.36018, Reconstruction: 1.08329, Clustering: 0.27689, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.35633, Reconstruction: 1.08005, Clustering: 0.27627, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.32258, Reconstruction: 1.05320, Clustering: 0.26938, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.31491, Reconstruction: 1.04451, Clustering: 0.27040, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.30897, Reconstruction: 1.03770, Clustering: 0.27127, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.31196, Reconstruction: 1.03674, Clustering: 0.27522, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.29301, Reconstruction: 1.02435, Clustering: 0.26866, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.28250, Reconstruction: 1.01264, Clustering: 0.26986, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.26345, Reconstruction: 0.99821, Clustering: 0.26524, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.27738, Reconstruction: 1.00764, Clustering: 0.26974, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.24800, Reconstruction: 0.98360, Clustering: 0.26440, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.27140, Reconstruction: 0.99968, Clustering: 0.27173, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.26200, Reconstruction: 0.99218, Clustering: 0.26981, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.24516, Reconstruction: 0.97756, Clustering: 0.26759, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.22229, Reconstruction: 0.96174, Clustering: 0.26054, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.21006, Reconstruction: 0.95040, Clustering: 0.25966, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.21069, Reconstruction: 0.94748, Clustering: 0.26321, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.20842, Reconstruction: 0.94495, Clustering: 0.26347, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.25242, Reconstruction: 0.97890, Clustering: 0.27352, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.19026, Reconstruction: 0.93010, Clustering: 0.26016, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.20173, Reconstruction: 0.93533, Clustering: 0.26640, 
Average squared 2-D reconstruction error: 0.9353
NMI for deep clustering: 0.54
ARI for deep clustering: 0.38
ACC for deep clustering: 0.53
The training code for file multi_layer_km.pyc ran for 8.73m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  11.0376346047
Pre-training layer 0, epoch 1, cost  2.77137467007
Pre-training layer 0, epoch 2, cost  1.94507184836
Pre-training layer 0, epoch 3, cost  1.54031557657
Pre-training layer 0, epoch 4, cost  1.29467775541
Pre-training layer 0, epoch 5, cost  1.12997011457
Pre-training layer 0, epoch 6, cost  1.01233122987
Pre-training layer 0, epoch 7, cost  0.924024374786
Pre-training layer 0, epoch 8, cost  0.855462757993
Pre-training layer 0, epoch 9, cost  0.800688740845
Pre-training layer 0, epoch 10, cost  0.755912462486
Pre-training layer 0, epoch 11, cost  0.718780993365
Pre-training layer 0, epoch 12, cost  0.68739010797
Pre-training layer 0, epoch 13, cost  0.660438787155
Pre-training layer 0, epoch 14, cost  0.636960125544
Pre-training layer 0, epoch 15, cost  0.616358043671
Pre-training layer 0, epoch 16, cost  0.59809811606
Pre-training layer 0, epoch 17, cost  0.581752016306
Pre-training layer 0, epoch 18, cost  0.56700337016
Pre-training layer 0, epoch 19, cost  0.553694769646
Pre-training layer 0, epoch 20, cost  0.54148559326
Pre-training layer 0, epoch 21, cost  0.530354280711
Pre-training layer 0, epoch 22, cost  0.520044517693
Pre-training layer 0, epoch 23, cost  0.510533179763
Pre-training layer 0, epoch 24, cost  0.501721533782
Pre-training layer 0, epoch 25, cost  0.493505927677
Pre-training layer 0, epoch 26, cost  0.485817302257
Pre-training layer 0, epoch 27, cost  0.478600669769
Pre-training layer 0, epoch 28, cost  0.47159023725
Pre-training layer 0, epoch 29, cost  0.465093405394
Pre-training layer 0, epoch 30, cost  0.45900508355
Pre-training layer 0, epoch 31, cost  0.453210975507
Pre-training layer 0, epoch 32, cost  0.447760529888
Pre-training layer 0, epoch 33, cost  0.442554000008
Pre-training layer 0, epoch 34, cost  0.437617732766
Pre-training layer 0, epoch 35, cost  0.432895257907
Pre-training layer 0, epoch 36, cost  0.4283969652
Pre-training layer 0, epoch 37, cost  0.424080954659
Pre-training layer 0, epoch 38, cost  0.419935634543
Pre-training layer 0, epoch 39, cost  0.415964870843
Pre-training layer 0, epoch 40, cost  0.412161929053
Pre-training layer 0, epoch 41, cost  0.408504139962
Pre-training layer 0, epoch 42, cost  0.404981724992
Pre-training layer 0, epoch 43, cost  0.401579779285
Pre-training layer 0, epoch 44, cost  0.398260434306
Pre-training layer 0, epoch 45, cost  0.394961599581
Pre-training layer 0, epoch 46, cost  0.391869195329
Pre-training layer 0, epoch 47, cost  0.388868605939
Pre-training layer 0, epoch 48, cost  0.385965358222
Pre-training layer 0, epoch 49, cost  0.383140133058
Pre-training layer 1, epoch 0, cost  16.2879930771
Pre-training layer 1, epoch 1, cost  4.85446591007
Pre-training layer 1, epoch 2, cost  3.29313597884
Pre-training layer 1, epoch 3, cost  2.50638521573
Pre-training layer 1, epoch 4, cost  2.01507464071
Pre-training layer 1, epoch 5, cost  1.68020581595
Pre-training layer 1, epoch 6, cost  1.44303395867
Pre-training layer 1, epoch 7, cost  1.27993088832
Pre-training layer 1, epoch 8, cost  1.20298568957
Pre-training layer 1, epoch 9, cost  1.17545238952
Pre-training layer 1, epoch 10, cost  1.11738698801
Pre-training layer 1, epoch 11, cost  1.0618682232
Pre-training layer 1, epoch 12, cost  1.01074826427
Pre-training layer 1, epoch 13, cost  0.968306593925
Pre-training layer 1, epoch 14, cost  0.929756755774
Pre-training layer 1, epoch 15, cost  0.898913393063
Pre-training layer 1, epoch 16, cost  0.879516345825
Pre-training layer 1, epoch 17, cost  0.846477251938
Pre-training layer 1, epoch 18, cost  0.823028420743
Pre-training layer 1, epoch 19, cost  0.800498843573
Pre-training layer 1, epoch 20, cost  0.781512059881
Pre-training layer 1, epoch 21, cost  0.761817972719
Pre-training layer 1, epoch 22, cost  0.745617271862
Pre-training layer 1, epoch 23, cost  0.726522215745
Pre-training layer 1, epoch 24, cost  0.715837577997
Pre-training layer 1, epoch 25, cost  0.701694781627
Pre-training layer 1, epoch 26, cost  0.688304152761
Pre-training layer 1, epoch 27, cost  0.679758867141
Pre-training layer 1, epoch 28, cost  0.664694825962
Pre-training layer 1, epoch 29, cost  0.654500489942
Pre-training layer 1, epoch 30, cost  0.645057143172
Pre-training layer 1, epoch 31, cost  0.636817088415
Pre-training layer 1, epoch 32, cost  0.627648203549
Pre-training layer 1, epoch 33, cost  0.6206861462
Pre-training layer 1, epoch 34, cost  0.611022462223
Pre-training layer 1, epoch 35, cost  0.60763871393
Pre-training layer 1, epoch 36, cost  0.598444723798
Pre-training layer 1, epoch 37, cost  0.589686915953
Pre-training layer 1, epoch 38, cost  0.577332933122
Pre-training layer 1, epoch 39, cost  0.57238544812
Pre-training layer 1, epoch 40, cost  0.567532789605
Pre-training layer 1, epoch 41, cost  0.566017141663
Pre-training layer 1, epoch 42, cost  0.556603140216
Pre-training layer 1, epoch 43, cost  0.553395480177
Pre-training layer 1, epoch 44, cost  0.549301261101
Pre-training layer 1, epoch 45, cost  0.543042270377
Pre-training layer 1, epoch 46, cost  0.536286872975
Pre-training layer 1, epoch 47, cost  0.528679068539
Pre-training layer 1, epoch 48, cost  0.525690735119
Pre-training layer 1, epoch 49, cost  0.519742993005
Pre-training layer 2, epoch 0, cost  19.7943687641
Pre-training layer 2, epoch 1, cost  5.4983854838
Pre-training layer 2, epoch 2, cost  3.93149693222
Pre-training layer 2, epoch 3, cost  3.07661332138
Pre-training layer 2, epoch 4, cost  2.50611321641
Pre-training layer 2, epoch 5, cost  2.11065527716
Pre-training layer 2, epoch 6, cost  2.04402435498
Pre-training layer 2, epoch 7, cost  1.97975857496
Pre-training layer 2, epoch 8, cost  1.88617420569
Pre-training layer 2, epoch 9, cost  1.80218818201
Pre-training layer 2, epoch 10, cost  1.72044586579
Pre-training layer 2, epoch 11, cost  1.64119768797
Pre-training layer 2, epoch 12, cost  1.52314259033
Pre-training layer 2, epoch 13, cost  1.4513691376
Pre-training layer 2, epoch 14, cost  1.39952491883
Pre-training layer 2, epoch 15, cost  1.39887536045
Pre-training layer 2, epoch 16, cost  1.36767847891
Pre-training layer 2, epoch 17, cost  1.28869171085
Pre-training layer 2, epoch 18, cost  1.2161696732
Pre-training layer 2, epoch 19, cost  1.22766350456
Pre-training layer 2, epoch 20, cost  1.15763327639
Pre-training layer 2, epoch 21, cost  1.06628381741
Pre-training layer 2, epoch 22, cost  1.02722827545
Pre-training layer 2, epoch 23, cost  1.07530450999
Pre-training layer 2, epoch 24, cost  1.05137136071
Pre-training layer 2, epoch 25, cost  0.994418301312
Pre-training layer 2, epoch 26, cost  0.954809255111
Pre-training layer 2, epoch 27, cost  0.949203526921
Pre-training layer 2, epoch 28, cost  0.939482046178
Pre-training layer 2, epoch 29, cost  0.918724388325
Pre-training layer 2, epoch 30, cost  0.89727088322
Pre-training layer 2, epoch 31, cost  0.861904717525
Pre-training layer 2, epoch 32, cost  0.825436009039
Pre-training layer 2, epoch 33, cost  0.837975320024
Pre-training layer 2, epoch 34, cost  0.802117062438
Pre-training layer 2, epoch 35, cost  0.779726522061
Pre-training layer 2, epoch 36, cost  0.764978362344
Pre-training layer 2, epoch 37, cost  0.762148745917
Pre-training layer 2, epoch 38, cost  0.768055474029
Pre-training layer 2, epoch 39, cost  0.767043673422
Pre-training layer 2, epoch 40, cost  0.66868899543
Pre-training layer 2, epoch 41, cost  0.610289477763
Pre-training layer 2, epoch 42, cost  0.727339276305
Pre-training layer 2, epoch 43, cost  0.707547496858
Pre-training layer 2, epoch 44, cost  0.703846286084
Pre-training layer 2, epoch 45, cost  0.668207897101
Pre-training layer 2, epoch 46, cost  0.504728495017
Pre-training layer 2, epoch 47, cost  0.65995871392
Pre-training layer 2, epoch 48, cost  0.668848773221
Pre-training layer 2, epoch 49, cost  0.584877922086
Pre-training layer 3, epoch 0, cost  16.9152288575
Pre-training layer 3, epoch 1, cost  4.48594212726
Pre-training layer 3, epoch 2, cost  3.11489896226
Pre-training layer 3, epoch 3, cost  2.38638761666
Pre-training layer 3, epoch 4, cost  1.89782022702
Pre-training layer 3, epoch 5, cost  1.54602745338
Pre-training layer 3, epoch 6, cost  1.293939581
Pre-training layer 3, epoch 7, cost  1.25176304341
Pre-training layer 3, epoch 8, cost  1.23002277854
Pre-training layer 3, epoch 9, cost  1.16890325157
Pre-training layer 3, epoch 10, cost  1.05930437616
Pre-training layer 3, epoch 11, cost  0.965630901737
Pre-training layer 3, epoch 12, cost  0.92104522809
Pre-training layer 3, epoch 13, cost  0.908800691286
Pre-training layer 3, epoch 14, cost  0.881531832056
Pre-training layer 3, epoch 15, cost  0.82363867779
Pre-training layer 3, epoch 16, cost  0.757017878913
Pre-training layer 3, epoch 17, cost  0.691241833846
Pre-training layer 3, epoch 18, cost  0.660084919082
Pre-training layer 3, epoch 19, cost  0.667257272506
Pre-training layer 3, epoch 20, cost  0.655722877676
Pre-training layer 3, epoch 21, cost  0.634072099328
Pre-training layer 3, epoch 22, cost  0.604080962077
Pre-training layer 3, epoch 23, cost  0.53175443828
Pre-training layer 3, epoch 24, cost  0.493606195994
Pre-training layer 3, epoch 25, cost  0.598676290562
Pre-training layer 3, epoch 26, cost  0.547823930877
Pre-training layer 3, epoch 27, cost  0.522309460557
Pre-training layer 3, epoch 28, cost  0.497194196196
Pre-training layer 3, epoch 29, cost  0.469968589425
Pre-training layer 3, epoch 30, cost  0.441483067336
Pre-training layer 3, epoch 31, cost  0.431881724699
Pre-training layer 3, epoch 32, cost  0.446183887605
Pre-training layer 3, epoch 33, cost  0.454989160969
Pre-training layer 3, epoch 34, cost  0.420763677108
Pre-training layer 3, epoch 35, cost  0.289014606448
Pre-training layer 3, epoch 36, cost  0.414540846493
Pre-training layer 3, epoch 37, cost  0.462073283988
Pre-training layer 3, epoch 38, cost  0.402668149093
Pre-training layer 3, epoch 39, cost  0.318182415711
Pre-training layer 3, epoch 40, cost  0.324521109865
Pre-training layer 3, epoch 41, cost  0.373128623718
Pre-training layer 3, epoch 42, cost  0.375208910627
Pre-training layer 3, epoch 43, cost  0.316753423672
Pre-training layer 3, epoch 44, cost  0.253664581582
Pre-training layer 3, epoch 45, cost  0.356807553807
Pre-training layer 3, epoch 46, cost  0.357030356746
Pre-training layer 3, epoch 47, cost  0.176075734447
Pre-training layer 3, epoch 48, cost  0.354234863095
Pre-training layer 3, epoch 49, cost  0.327977117372
Pre-training layer 4, epoch 0, cost  18.2818487811
Pre-training layer 4, epoch 1, cost  5.33436532299
Pre-training layer 4, epoch 2, cost  3.72264281003
Pre-training layer 4, epoch 3, cost  2.85740577114
Pre-training layer 4, epoch 4, cost  2.31845440699
Pre-training layer 4, epoch 5, cost  1.96286093045
Pre-training layer 4, epoch 6, cost  1.88449685535
Pre-training layer 4, epoch 7, cost  1.79655466992
Pre-training layer 4, epoch 8, cost  1.70861201377
Pre-training layer 4, epoch 9, cost  1.61875236527
Pre-training layer 4, epoch 10, cost  1.54334363441
Pre-training layer 4, epoch 11, cost  1.47615185361
Pre-training layer 4, epoch 12, cost  1.4222926409
Pre-training layer 4, epoch 13, cost  1.38710039712
Pre-training layer 4, epoch 14, cost  1.36008247449
Pre-training layer 4, epoch 15, cost  1.3359402254
Pre-training layer 4, epoch 16, cost  1.30373935841
Pre-training layer 4, epoch 17, cost  1.26767087517
Pre-training layer 4, epoch 18, cost  1.2468539229
Pre-training layer 4, epoch 19, cost  1.24810492058
Pre-training layer 4, epoch 20, cost  1.2376107105
Pre-training layer 4, epoch 21, cost  1.21249248188
Pre-training layer 4, epoch 22, cost  1.18651068013
Pre-training layer 4, epoch 23, cost  1.18708964776
Pre-training layer 4, epoch 24, cost  1.19201993616
Pre-training layer 4, epoch 25, cost  1.1594916736
Pre-training layer 4, epoch 26, cost  1.12289339563
Pre-training layer 4, epoch 27, cost  1.15055628902
Pre-training layer 4, epoch 28, cost  1.14672012657
Pre-training layer 4, epoch 29, cost  1.07822668605
Pre-training layer 4, epoch 30, cost  1.11953000613
Pre-training layer 4, epoch 31, cost  1.14291357467
Pre-training layer 4, epoch 32, cost  1.06275291645
Pre-training layer 4, epoch 33, cost  1.08975630954
Pre-training layer 4, epoch 34, cost  1.11048450423
Pre-training layer 4, epoch 35, cost  1.03446051296
Pre-training layer 4, epoch 36, cost  1.0841241821
Pre-training layer 4, epoch 37, cost  1.07129698382
Pre-training layer 4, epoch 38, cost  1.02142829573
Pre-training layer 4, epoch 39, cost  1.08169121264
Pre-training layer 4, epoch 40, cost  1.00940916778
Pre-training layer 4, epoch 41, cost  1.05452827399
Pre-training layer 4, epoch 42, cost  1.03341564821
Pre-training layer 4, epoch 43, cost  1.0121454507
Pre-training layer 4, epoch 44, cost  1.04824948046
Pre-training layer 4, epoch 45, cost  0.995753743799
Pre-training layer 4, epoch 46, cost  1.03796705709
Pre-training layer 4, epoch 47, cost  0.996133606549
Pre-training layer 4, epoch 48, cost  1.01814478323
Pre-training layer 4, epoch 49, cost  0.997371460371
Pre-training layer 5, epoch 0, cost  19.9632352058
Pre-training layer 5, epoch 1, cost  7.01688783283
Pre-training layer 5, epoch 2, cost  5.69203445507
Pre-training layer 5, epoch 3, cost  5.4865050526
Pre-training layer 5, epoch 4, cost  5.42577617407
Pre-training layer 5, epoch 5, cost  5.39946398829
Pre-training layer 5, epoch 6, cost  5.38537584103
Pre-training layer 5, epoch 7, cost  5.37651937867
Pre-training layer 5, epoch 8, cost  5.37019546703
Pre-training layer 5, epoch 9, cost  5.36534958746
Pre-training layer 5, epoch 10, cost  5.36130060715
Pre-training layer 5, epoch 11, cost  5.35780862323
Pre-training layer 5, epoch 12, cost  5.35476112126
Pre-training layer 5, epoch 13, cost  5.35203620477
Pre-training layer 5, epoch 14, cost  5.34971606497
Pre-training layer 5, epoch 15, cost  5.34762979184
Pre-training layer 5, epoch 16, cost  5.34577324733
Pre-training layer 5, epoch 17, cost  5.34411486957
Pre-training layer 5, epoch 18, cost  5.34247583569
Pre-training layer 5, epoch 19, cost  5.34100253947
Pre-training layer 5, epoch 20, cost  5.33951562889
Pre-training layer 5, epoch 21, cost  5.33813034376
Pre-training layer 5, epoch 22, cost  5.33681767948
Pre-training layer 5, epoch 23, cost  5.33557548102
Pre-training layer 5, epoch 24, cost  5.33435546121
Pre-training layer 5, epoch 25, cost  5.33316659315
Pre-training layer 5, epoch 26, cost  5.33208201364
Pre-training layer 5, epoch 27, cost  5.33107282195
Pre-training layer 5, epoch 28, cost  5.32994522778
Pre-training layer 5, epoch 29, cost  5.32890887605
Pre-training layer 5, epoch 30, cost  5.32791739675
Pre-training layer 5, epoch 31, cost  5.32692689013
Pre-training layer 5, epoch 32, cost  5.32597274385
Pre-training layer 5, epoch 33, cost  5.32506460859
Pre-training layer 5, epoch 34, cost  5.32417343049
Pre-training layer 5, epoch 35, cost  5.32332061202
Pre-training layer 5, epoch 36, cost  5.32250043637
Pre-training layer 5, epoch 37, cost  5.3217056124
Pre-training layer 5, epoch 38, cost  5.32091806236
Pre-training layer 5, epoch 39, cost  5.32017454146
Pre-training layer 5, epoch 40, cost  5.31941825608
Pre-training layer 5, epoch 41, cost  5.31870717108
Pre-training layer 5, epoch 42, cost  5.31799949018
Pre-training layer 5, epoch 43, cost  5.31733209887
Pre-training layer 5, epoch 44, cost  5.31665172033
Pre-training layer 5, epoch 45, cost  5.31600412668
Pre-training layer 5, epoch 46, cost  5.31540470621
Pre-training layer 5, epoch 47, cost  5.31480756311
Pre-training layer 5, epoch 48, cost  5.31421253216
The pretraining code for file multi_layer_km.pyc ran for 9.89m
Pre-training layer 5, epoch 49, cost  5.31363603499
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
ACC for deep clustering: 0.54
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 3.23583, Reconstruction: 2.01366, Clustering: 1.22217, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.30057, Reconstruction: 1.77397, Clustering: 0.52660, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.14357, Reconstruction: 1.71707, Clustering: 0.42650, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.06392, Reconstruction: 1.66019, Clustering: 0.40373, 
Fine-tuning epoch 5 ++++ 
Total cost: 2.00645, Reconstruction: 1.61417, Clustering: 0.39228, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.95166, Reconstruction: 1.56775, Clustering: 0.38390, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.90597, Reconstruction: 1.53607, Clustering: 0.36991, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.87810, Reconstruction: 1.52038, Clustering: 0.35772, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.82368, Reconstruction: 1.47715, Clustering: 0.34653, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.78514, Reconstruction: 1.44660, Clustering: 0.33854, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.74322, Reconstruction: 1.41025, Clustering: 0.33298, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.72057, Reconstruction: 1.39574, Clustering: 0.32483, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.68389, Reconstruction: 1.36783, Clustering: 0.31606, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.66645, Reconstruction: 1.35271, Clustering: 0.31375, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.62999, Reconstruction: 1.32228, Clustering: 0.30771, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.61484, Reconstruction: 1.31114, Clustering: 0.30370, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.58603, Reconstruction: 1.28200, Clustering: 0.30403, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.55664, Reconstruction: 1.25910, Clustering: 0.29754, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.52885, Reconstruction: 1.23672, Clustering: 0.29213, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.52614, Reconstruction: 1.23389, Clustering: 0.29225, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.51298, Reconstruction: 1.22310, Clustering: 0.28988, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.47860, Reconstruction: 1.19256, Clustering: 0.28604, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.47624, Reconstruction: 1.19219, Clustering: 0.28405, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.45560, Reconstruction: 1.17112, Clustering: 0.28448, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.45147, Reconstruction: 1.16744, Clustering: 0.28403, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.41090, Reconstruction: 1.13327, Clustering: 0.27764, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.40681, Reconstruction: 1.12896, Clustering: 0.27785, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.39675, Reconstruction: 1.11958, Clustering: 0.27717, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.39416, Reconstruction: 1.11723, Clustering: 0.27693, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.36441, Reconstruction: 1.09055, Clustering: 0.27386, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.35316, Reconstruction: 1.08001, Clustering: 0.27315, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.34800, Reconstruction: 1.07277, Clustering: 0.27524, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.34130, Reconstruction: 1.06872, Clustering: 0.27258, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.33068, Reconstruction: 1.06051, Clustering: 0.27017, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.30584, Reconstruction: 1.03811, Clustering: 0.26773, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.29706, Reconstruction: 1.03182, Clustering: 0.26524, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.29030, Reconstruction: 1.02484, Clustering: 0.26546, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.29450, Reconstruction: 1.02495, Clustering: 0.26955, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.28176, Reconstruction: 1.01504, Clustering: 0.26672, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.27845, Reconstruction: 1.01048, Clustering: 0.26797, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.26882, Reconstruction: 1.00022, Clustering: 0.26860, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.25229, Reconstruction: 0.98672, Clustering: 0.26556, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.26453, Reconstruction: 0.99598, Clustering: 0.26855, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.23262, Reconstruction: 0.97047, Clustering: 0.26215, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.24571, Reconstruction: 0.98187, Clustering: 0.26385, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.22021, Reconstruction: 0.95739, Clustering: 0.26282, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.23712, Reconstruction: 0.96957, Clustering: 0.26755, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.22088, Reconstruction: 0.95356, Clustering: 0.26732, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.20384, Reconstruction: 0.94076, Clustering: 0.26307, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.22013, Reconstruction: 0.95254, Clustering: 0.26759, 
Average squared 2-D reconstruction error: 0.9525
NMI for deep clustering: 0.54
ARI for deep clustering: 0.38
ACC for deep clustering: 0.54
The training code for file multi_layer_km.pyc ran for 8.68m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  11.0543047613
Pre-training layer 0, epoch 1, cost  2.78497525551
Pre-training layer 0, epoch 2, cost  1.95246046049
Pre-training layer 0, epoch 3, cost  1.54622436766
Pre-training layer 0, epoch 4, cost  1.3004114367
Pre-training layer 0, epoch 5, cost  1.13571856315
Pre-training layer 0, epoch 6, cost  1.01761562717
Pre-training layer 0, epoch 7, cost  0.928965948525
Pre-training layer 0, epoch 8, cost  0.86005739239
Pre-training layer 0, epoch 9, cost  0.805007440157
Pre-training layer 0, epoch 10, cost  0.759780941249
Pre-training layer 0, epoch 11, cost  0.72113544727
Pre-training layer 0, epoch 12, cost  0.68911987933
Pre-training layer 0, epoch 13, cost  0.661633667692
Pre-training layer 0, epoch 14, cost  0.637839570319
Pre-training layer 0, epoch 15, cost  0.616841207068
Pre-training layer 0, epoch 16, cost  0.598293859198
Pre-training layer 0, epoch 17, cost  0.581503473746
Pre-training layer 0, epoch 18, cost  0.566296308168
Pre-training layer 0, epoch 19, cost  0.552593282326
Pre-training layer 0, epoch 20, cost  0.540018079227
Pre-training layer 0, epoch 21, cost  0.528444828122
Pre-training layer 0, epoch 22, cost  0.51777120388
Pre-training layer 0, epoch 23, cost  0.507977027108
Pre-training layer 0, epoch 24, cost  0.498895034667
Pre-training layer 0, epoch 25, cost  0.490434877775
Pre-training layer 0, epoch 26, cost  0.482396511072
Pre-training layer 0, epoch 27, cost  0.474658359888
Pre-training layer 0, epoch 28, cost  0.46759652129
Pre-training layer 0, epoch 29, cost  0.460996094744
Pre-training layer 0, epoch 30, cost  0.454755349369
Pre-training layer 0, epoch 31, cost  0.448822104478
Pre-training layer 0, epoch 32, cost  0.443202524751
Pre-training layer 0, epoch 33, cost  0.43784729489
Pre-training layer 0, epoch 34, cost  0.432771196426
Pre-training layer 0, epoch 35, cost  0.427897528615
Pre-training layer 0, epoch 36, cost  0.423240046179
Pre-training layer 0, epoch 37, cost  0.418784284411
Pre-training layer 0, epoch 38, cost  0.414529164189
Pre-training layer 0, epoch 39, cost  0.410444090756
Pre-training layer 0, epoch 40, cost  0.4065340696
Pre-training layer 0, epoch 41, cost  0.402765789961
Pre-training layer 0, epoch 42, cost  0.399144825212
Pre-training layer 0, epoch 43, cost  0.395676169727
Pre-training layer 0, epoch 44, cost  0.392308343588
Pre-training layer 0, epoch 45, cost  0.38906609687
Pre-training layer 0, epoch 46, cost  0.385929794567
Pre-training layer 0, epoch 47, cost  0.382894528603
Pre-training layer 0, epoch 48, cost  0.379946933242
Pre-training layer 0, epoch 49, cost  0.377131327491
Pre-training layer 1, epoch 0, cost  16.2982825843
Pre-training layer 1, epoch 1, cost  4.86169235973
Pre-training layer 1, epoch 2, cost  3.29047300728
Pre-training layer 1, epoch 3, cost  2.49798291823
Pre-training layer 1, epoch 4, cost  2.00392527975
Pre-training layer 1, epoch 5, cost  1.66825499723
Pre-training layer 1, epoch 6, cost  1.43267378144
Pre-training layer 1, epoch 7, cost  1.27503861249
Pre-training layer 1, epoch 8, cost  1.21135702583
Pre-training layer 1, epoch 9, cost  1.18619972632
Pre-training layer 1, epoch 10, cost  1.12294789656
Pre-training layer 1, epoch 11, cost  1.06610407306
Pre-training layer 1, epoch 12, cost  1.01270857571
Pre-training layer 1, epoch 13, cost  0.968706665745
Pre-training layer 1, epoch 14, cost  0.931940374425
Pre-training layer 1, epoch 15, cost  0.9008166422
Pre-training layer 1, epoch 16, cost  0.870830481251
Pre-training layer 1, epoch 17, cost  0.846101969018
Pre-training layer 1, epoch 18, cost  0.825139789403
Pre-training layer 1, epoch 19, cost  0.802017601963
Pre-training layer 1, epoch 20, cost  0.781730901601
Pre-training layer 1, epoch 21, cost  0.765520928929
Pre-training layer 1, epoch 22, cost  0.74408049969
Pre-training layer 1, epoch 23, cost  0.730572199072
Pre-training layer 1, epoch 24, cost  0.724098364753
Pre-training layer 1, epoch 25, cost  0.707478175105
Pre-training layer 1, epoch 26, cost  0.690710768146
Pre-training layer 1, epoch 27, cost  0.67718568256
Pre-training layer 1, epoch 28, cost  0.667231891417
Pre-training layer 1, epoch 29, cost  0.653467391422
Pre-training layer 1, epoch 30, cost  0.647873859642
Pre-training layer 1, epoch 31, cost  0.636473015974
Pre-training layer 1, epoch 32, cost  0.629413347687
Pre-training layer 1, epoch 33, cost  0.621050976945
Pre-training layer 1, epoch 34, cost  0.61385925898
Pre-training layer 1, epoch 35, cost  0.608342367658
Pre-training layer 1, epoch 36, cost  0.596349713716
Pre-training layer 1, epoch 37, cost  0.586898897002
Pre-training layer 1, epoch 38, cost  0.580629177656
Pre-training layer 1, epoch 39, cost  0.577122846139
Pre-training layer 1, epoch 40, cost  0.570637980913
Pre-training layer 1, epoch 41, cost  0.564552590458
Pre-training layer 1, epoch 42, cost  0.560130541914
Pre-training layer 1, epoch 43, cost  0.551227624937
Pre-training layer 1, epoch 44, cost  0.547923658755
Pre-training layer 1, epoch 45, cost  0.541477457619
Pre-training layer 1, epoch 46, cost  0.538466837166
Pre-training layer 1, epoch 47, cost  0.536295411312
Pre-training layer 1, epoch 48, cost  0.526879445474
Pre-training layer 1, epoch 49, cost  0.524980622673
Pre-training layer 2, epoch 0, cost  19.8493229737
Pre-training layer 2, epoch 1, cost  5.49762586197
Pre-training layer 2, epoch 2, cost  3.93931458674
Pre-training layer 2, epoch 3, cost  3.07777290503
Pre-training layer 2, epoch 4, cost  2.50380090452
Pre-training layer 2, epoch 5, cost  2.10704037399
Pre-training layer 2, epoch 6, cost  2.07779585788
Pre-training layer 2, epoch 7, cost  1.99914057532
Pre-training layer 2, epoch 8, cost  1.90409654145
Pre-training layer 2, epoch 9, cost  1.79627980387
Pre-training layer 2, epoch 10, cost  1.66601170583
Pre-training layer 2, epoch 11, cost  1.62589215476
Pre-training layer 2, epoch 12, cost  1.53739371332
Pre-training layer 2, epoch 13, cost  1.47125591967
Pre-training layer 2, epoch 14, cost  1.4210542138
Pre-training layer 2, epoch 15, cost  1.38866151948
Pre-training layer 2, epoch 16, cost  1.36184207256
Pre-training layer 2, epoch 17, cost  1.293038799
Pre-training layer 2, epoch 18, cost  1.23071102254
Pre-training layer 2, epoch 19, cost  1.1795624311
Pre-training layer 2, epoch 20, cost  1.14533808933
Pre-training layer 2, epoch 21, cost  1.1271579048
Pre-training layer 2, epoch 22, cost  1.1078492346
Pre-training layer 2, epoch 23, cost  1.07980929126
Pre-training layer 2, epoch 24, cost  1.05629830117
Pre-training layer 2, epoch 25, cost  1.03146405466
Pre-training layer 2, epoch 26, cost  0.994118883538
Pre-training layer 2, epoch 27, cost  0.959252485794
Pre-training layer 2, epoch 28, cost  0.93128905517
Pre-training layer 2, epoch 29, cost  0.907562885506
Pre-training layer 2, epoch 30, cost  0.885450623452
Pre-training layer 2, epoch 31, cost  0.870265662291
Pre-training layer 2, epoch 32, cost  0.877792487029
Pre-training layer 2, epoch 33, cost  0.861678665496
Pre-training layer 2, epoch 34, cost  0.838351133201
Pre-training layer 2, epoch 35, cost  0.821836130283
Pre-training layer 2, epoch 36, cost  0.808423763927
Pre-training layer 2, epoch 37, cost  0.786054803166
Pre-training layer 2, epoch 38, cost  0.74779787635
Pre-training layer 2, epoch 39, cost  0.714337692242
Pre-training layer 2, epoch 40, cost  0.706594921461
Pre-training layer 2, epoch 41, cost  0.709216633177
Pre-training layer 2, epoch 42, cost  0.709603296072
Pre-training layer 2, epoch 43, cost  0.698540937837
Pre-training layer 2, epoch 44, cost  0.673317130565
Pre-training layer 2, epoch 45, cost  0.650869800431
Pre-training layer 2, epoch 46, cost  0.645072266966
Pre-training layer 2, epoch 47, cost  0.646037605427
Pre-training layer 2, epoch 48, cost  0.647350999029
Pre-training layer 2, epoch 49, cost  0.642959420516
Pre-training layer 3, epoch 0, cost  16.7532195055
Pre-training layer 3, epoch 1, cost  4.46288208005
Pre-training layer 3, epoch 2, cost  3.10136394982
Pre-training layer 3, epoch 3, cost  2.37374494823
Pre-training layer 3, epoch 4, cost  1.88926087517
Pre-training layer 3, epoch 5, cost  1.54161411328
Pre-training layer 3, epoch 6, cost  1.29122906058
Pre-training layer 3, epoch 7, cost  1.24096061755
Pre-training layer 3, epoch 8, cost  1.23577041825
Pre-training layer 3, epoch 9, cost  1.16275285865
Pre-training layer 3, epoch 10, cost  1.04859959193
Pre-training layer 3, epoch 11, cost  0.965274251121
Pre-training layer 3, epoch 12, cost  0.929685484001
Pre-training layer 3, epoch 13, cost  0.904322148554
Pre-training layer 3, epoch 14, cost  0.880032928529
Pre-training layer 3, epoch 15, cost  0.809426534579
Pre-training layer 3, epoch 16, cost  0.75577471931
Pre-training layer 3, epoch 17, cost  0.710157500874
Pre-training layer 3, epoch 18, cost  0.683324684131
Pre-training layer 3, epoch 19, cost  0.668404825415
Pre-training layer 3, epoch 20, cost  0.654542940657
Pre-training layer 3, epoch 21, cost  0.635495439888
Pre-training layer 3, epoch 22, cost  0.601966288433
Pre-training layer 3, epoch 23, cost  0.539340529432
Pre-training layer 3, epoch 24, cost  0.501524000084
Pre-training layer 3, epoch 25, cost  0.577615404529
Pre-training layer 3, epoch 26, cost  0.57156261442
Pre-training layer 3, epoch 27, cost  0.541568578195
Pre-training layer 3, epoch 28, cost  0.514427908642
Pre-training layer 3, epoch 29, cost  0.481298549066
Pre-training layer 3, epoch 30, cost  0.446838131891
Pre-training layer 3, epoch 31, cost  0.43569691866
Pre-training layer 3, epoch 32, cost  0.445387089675
Pre-training layer 3, epoch 33, cost  0.448903450114
Pre-training layer 3, epoch 34, cost  0.439470357942
Pre-training layer 3, epoch 35, cost  0.376354845144
Pre-training layer 3, epoch 36, cost  0.328804879741
Pre-training layer 3, epoch 37, cost  0.417908344639
Pre-training layer 3, epoch 38, cost  0.427492122493
Pre-training layer 3, epoch 39, cost  0.386243577319
Pre-training layer 3, epoch 40, cost  0.292605057322
Pre-training layer 3, epoch 41, cost  0.378744731467
Pre-training layer 3, epoch 42, cost  0.378902204517
Pre-training layer 3, epoch 43, cost  0.349137388579
Pre-training layer 3, epoch 44, cost  0.294090258986
Pre-training layer 3, epoch 45, cost  0.299614444696
Pre-training layer 3, epoch 46, cost  0.337777502847
Pre-training layer 3, epoch 47, cost  0.334220194112
Pre-training layer 3, epoch 48, cost  0.246499367286
Pre-training layer 3, epoch 49, cost  0.271684921346
Pre-training layer 4, epoch 0, cost  18.2135866541
Pre-training layer 4, epoch 1, cost  5.27410265534
Pre-training layer 4, epoch 2, cost  3.70117425466
Pre-training layer 4, epoch 3, cost  2.85131497103
Pre-training layer 4, epoch 4, cost  2.30973746162
Pre-training layer 4, epoch 5, cost  1.95115307069
Pre-training layer 4, epoch 6, cost  1.78839116496
Pre-training layer 4, epoch 7, cost  1.8044429573
Pre-training layer 4, epoch 8, cost  1.69208068303
Pre-training layer 4, epoch 9, cost  1.59267175075
Pre-training layer 4, epoch 10, cost  1.51235938834
Pre-training layer 4, epoch 11, cost  1.44932451207
Pre-training layer 4, epoch 12, cost  1.39871627695
Pre-training layer 4, epoch 13, cost  1.36429233082
Pre-training layer 4, epoch 14, cost  1.33769978761
Pre-training layer 4, epoch 15, cost  1.31144093051
Pre-training layer 4, epoch 16, cost  1.28185325727
Pre-training layer 4, epoch 17, cost  1.24919185257
Pre-training layer 4, epoch 18, cost  1.22528074787
Pre-training layer 4, epoch 19, cost  1.21749961921
Pre-training layer 4, epoch 20, cost  1.21475017999
Pre-training layer 4, epoch 21, cost  1.20004497945
Pre-training layer 4, epoch 22, cost  1.15787336042
Pre-training layer 4, epoch 23, cost  1.14338438215
Pre-training layer 4, epoch 24, cost  1.16885320561
Pre-training layer 4, epoch 25, cost  1.16887983404
Pre-training layer 4, epoch 26, cost  1.08352064936
Pre-training layer 4, epoch 27, cost  1.1144913751
Pre-training layer 4, epoch 28, cost  1.15689948088
Pre-training layer 4, epoch 29, cost  1.06586869214
Pre-training layer 4, epoch 30, cost  1.07811283433
Pre-training layer 4, epoch 31, cost  1.12910195031
Pre-training layer 4, epoch 32, cost  1.05618321334
Pre-training layer 4, epoch 33, cost  1.05112141355
Pre-training layer 4, epoch 34, cost  1.10485761227
Pre-training layer 4, epoch 35, cost  1.01073344808
Pre-training layer 4, epoch 36, cost  1.06019924317
Pre-training layer 4, epoch 37, cost  1.07016059229
Pre-training layer 4, epoch 38, cost  0.985896755043
Pre-training layer 4, epoch 39, cost  1.07380193403
Pre-training layer 4, epoch 40, cost  1.00755459548
Pre-training layer 4, epoch 41, cost  1.01804856062
Pre-training layer 4, epoch 42, cost  1.04594047086
Pre-training layer 4, epoch 43, cost  0.967996484732
Pre-training layer 4, epoch 44, cost  1.04506699704
Pre-training layer 4, epoch 45, cost  0.965983269268
Pre-training layer 4, epoch 46, cost  1.02092881964
Pre-training layer 4, epoch 47, cost  0.98303970092
Pre-training layer 4, epoch 48, cost  0.98853054193
Pre-training layer 4, epoch 49, cost  0.998377002967
Pre-training layer 5, epoch 0, cost  19.8636536579
Pre-training layer 5, epoch 1, cost  6.85436771468
Pre-training layer 5, epoch 2, cost  5.50054886484
Pre-training layer 5, epoch 3, cost  5.3039522218
Pre-training layer 5, epoch 4, cost  5.24488562746
Pre-training layer 5, epoch 5, cost  5.21819058837
Pre-training layer 5, epoch 6, cost  5.20394890003
Pre-training layer 5, epoch 7, cost  5.19557635124
Pre-training layer 5, epoch 8, cost  5.19024235899
Pre-training layer 5, epoch 9, cost  5.18658737632
Pre-training layer 5, epoch 10, cost  5.18392176769
Pre-training layer 5, epoch 11, cost  5.18185843097
Pre-training layer 5, epoch 12, cost  5.18018023089
Pre-training layer 5, epoch 13, cost  5.17868487233
Pre-training layer 5, epoch 14, cost  5.17736388735
Pre-training layer 5, epoch 15, cost  5.17596780432
Pre-training layer 5, epoch 16, cost  5.17464859089
Pre-training layer 5, epoch 17, cost  5.17326922748
Pre-training layer 5, epoch 18, cost  5.17184353134
Pre-training layer 5, epoch 19, cost  5.17040576087
Pre-training layer 5, epoch 20, cost  5.16892038218
Pre-training layer 5, epoch 21, cost  5.16746399014
Pre-training layer 5, epoch 22, cost  5.16597908361
Pre-training layer 5, epoch 23, cost  5.16452250063
Pre-training layer 5, epoch 24, cost  5.16301605521
Pre-training layer 5, epoch 25, cost  5.16153682671
Pre-training layer 5, epoch 26, cost  5.16007227471
Pre-training layer 5, epoch 27, cost  5.15869079788
Pre-training layer 5, epoch 28, cost  5.15726401762
Pre-training layer 5, epoch 29, cost  5.15586059891
Pre-training layer 5, epoch 30, cost  5.15451302438
Pre-training layer 5, epoch 31, cost  5.15321463712
Pre-training layer 5, epoch 32, cost  5.15189964695
Pre-training layer 5, epoch 33, cost  5.15070597335
Pre-training layer 5, epoch 34, cost  5.14953694347
Pre-training layer 5, epoch 35, cost  5.14836354628
Pre-training layer 5, epoch 36, cost  5.14732242526
Pre-training layer 5, epoch 37, cost  5.14626900172
Pre-training layer 5, epoch 38, cost  5.14528612107
Pre-training layer 5, epoch 39, cost  5.14430417436
Pre-training layer 5, epoch 40, cost  5.143407356
Pre-training layer 5, epoch 41, cost  5.14252540217
Pre-training layer 5, epoch 42, cost  5.14170713749
Pre-training layer 5, epoch 43, cost  5.1408816259
Pre-training layer 5, epoch 44, cost  5.1401012049
Pre-training layer 5, epoch 45, cost  5.13937774286
Pre-training layer 5, epoch 46, cost  5.1386417673
Pre-training layer 5, epoch 47, cost  5.1379501563
Pre-training layer 5, epoch 48, cost  5.13727701751
The pretraining code for file multi_layer_km.pyc ran for 9.05m
Pre-training layer 5, epoch 49, cost  5.1366295174
Initial NMI for deep clustering: 0.52
ARI for deep clustering: 0.39
... getting the finetuning functions
ACC for deep clustering: 0.54
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.93152, Reconstruction: 1.97758, Clustering: 0.95394, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.19959, Reconstruction: 1.70610, Clustering: 0.49349, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.10190, Reconstruction: 1.67148, Clustering: 0.43042, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.02809, Reconstruction: 1.62368, Clustering: 0.40441, 
Fine-tuning epoch 5 ++++ 
Total cost: 1.98002, Reconstruction: 1.58943, Clustering: 0.39059, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.93207, Reconstruction: 1.55309, Clustering: 0.37898, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.89460, Reconstruction: 1.53190, Clustering: 0.36270, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.87070, Reconstruction: 1.51654, Clustering: 0.35416, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.80425, Reconstruction: 1.46472, Clustering: 0.33954, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.77403, Reconstruction: 1.43990, Clustering: 0.33413, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.73253, Reconstruction: 1.40711, Clustering: 0.32542, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.71042, Reconstruction: 1.39007, Clustering: 0.32035, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.68754, Reconstruction: 1.37592, Clustering: 0.31162, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.64420, Reconstruction: 1.34300, Clustering: 0.30120, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.60617, Reconstruction: 1.30782, Clustering: 0.29834, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.60504, Reconstruction: 1.30842, Clustering: 0.29663, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.57931, Reconstruction: 1.28900, Clustering: 0.29031, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.53808, Reconstruction: 1.25378, Clustering: 0.28431, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.51497, Reconstruction: 1.23818, Clustering: 0.27679, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.50137, Reconstruction: 1.22310, Clustering: 0.27827, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.48279, Reconstruction: 1.20891, Clustering: 0.27388, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.47411, Reconstruction: 1.20148, Clustering: 0.27263, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.45095, Reconstruction: 1.18113, Clustering: 0.26982, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.44026, Reconstruction: 1.17280, Clustering: 0.26746, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.41355, Reconstruction: 1.14751, Clustering: 0.26604, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.41500, Reconstruction: 1.14879, Clustering: 0.26621, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.41956, Reconstruction: 1.15089, Clustering: 0.26867, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.39117, Reconstruction: 1.12439, Clustering: 0.26678, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.37880, Reconstruction: 1.11547, Clustering: 0.26334, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.36690, Reconstruction: 1.10476, Clustering: 0.26214, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.36290, Reconstruction: 1.10051, Clustering: 0.26239, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.33679, Reconstruction: 1.07515, Clustering: 0.26164, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.34606, Reconstruction: 1.08181, Clustering: 0.26425, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.32873, Reconstruction: 1.06924, Clustering: 0.25949, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.31066, Reconstruction: 1.05334, Clustering: 0.25732, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.30475, Reconstruction: 1.04345, Clustering: 0.26130, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.28260, Reconstruction: 1.02936, Clustering: 0.25324, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.27731, Reconstruction: 1.02330, Clustering: 0.25401, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.26500, Reconstruction: 1.00895, Clustering: 0.25605, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.27681, Reconstruction: 1.01987, Clustering: 0.25694, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.27166, Reconstruction: 1.01496, Clustering: 0.25671, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.24942, Reconstruction: 0.99450, Clustering: 0.25492, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.25777, Reconstruction: 0.99810, Clustering: 0.25968, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.23802, Reconstruction: 0.98564, Clustering: 0.25237, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.21528, Reconstruction: 0.96874, Clustering: 0.24654, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.22392, Reconstruction: 0.96744, Clustering: 0.25648, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.20700, Reconstruction: 0.95730, Clustering: 0.24970, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.23622, Reconstruction: 0.97587, Clustering: 0.26035, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.20541, Reconstruction: 0.95609, Clustering: 0.24932, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.21271, Reconstruction: 0.95342, Clustering: 0.25930, 
Average squared 2-D reconstruction error: 0.9534
NMI for deep clustering: 0.55
ARI for deep clustering: 0.40
ACC for deep clustering: 0.55
The training code for file multi_layer_km.pyc ran for 6.84m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  11.1027914372
Pre-training layer 0, epoch 1, cost  2.79660309622
Pre-training layer 0, epoch 2, cost  1.96589855682
Pre-training layer 0, epoch 3, cost  1.56134248467
Pre-training layer 0, epoch 4, cost  1.31578587133
Pre-training layer 0, epoch 5, cost  1.1502752919
Pre-training layer 0, epoch 6, cost  1.03129853466
Pre-training layer 0, epoch 7, cost  0.9422841089
Pre-training layer 0, epoch 8, cost  0.872997045764
Pre-training layer 0, epoch 9, cost  0.817596424998
Pre-training layer 0, epoch 10, cost  0.772209782847
Pre-training layer 0, epoch 11, cost  0.734329145909
Pre-training layer 0, epoch 12, cost  0.702152632091
Pre-training layer 0, epoch 13, cost  0.674481240378
Pre-training layer 0, epoch 14, cost  0.650419799567
Pre-training layer 0, epoch 15, cost  0.629302566008
Pre-training layer 0, epoch 16, cost  0.610494163196
Pre-training layer 0, epoch 17, cost  0.593696349564
Pre-training layer 0, epoch 18, cost  0.57860309587
Pre-training layer 0, epoch 19, cost  0.5648611912
Pre-training layer 0, epoch 20, cost  0.552345123632
Pre-training layer 0, epoch 21, cost  0.540868185105
Pre-training layer 0, epoch 22, cost  0.530279690743
Pre-training layer 0, epoch 23, cost  0.520468388924
Pre-training layer 0, epoch 24, cost  0.511358323184
Pre-training layer 0, epoch 25, cost  0.502823604599
Pre-training layer 0, epoch 26, cost  0.49487581267
Pre-training layer 0, epoch 27, cost  0.487389297624
Pre-training layer 0, epoch 28, cost  0.480355572765
Pre-training layer 0, epoch 29, cost  0.473684560626
Pre-training layer 0, epoch 30, cost  0.46738950864
Pre-training layer 0, epoch 31, cost  0.461422953894
Pre-training layer 0, epoch 32, cost  0.455772391299
Pre-training layer 0, epoch 33, cost  0.450395735053
Pre-training layer 0, epoch 34, cost  0.44527160613
Pre-training layer 0, epoch 35, cost  0.440388309378
Pre-training layer 0, epoch 36, cost  0.435722077587
Pre-training layer 0, epoch 37, cost  0.431268650896
Pre-training layer 0, epoch 38, cost  0.426944588964
Pre-training layer 0, epoch 39, cost  0.422824726443
Pre-training layer 0, epoch 40, cost  0.418855473436
Pre-training layer 0, epoch 41, cost  0.415035865364
Pre-training layer 0, epoch 42, cost  0.411322210209
Pre-training layer 0, epoch 43, cost  0.40776147629
Pre-training layer 0, epoch 44, cost  0.404338610526
Pre-training layer 0, epoch 45, cost  0.400968891722
Pre-training layer 0, epoch 46, cost  0.397738200524
Pre-training layer 0, epoch 47, cost  0.394604465123
Pre-training layer 0, epoch 48, cost  0.391600072501
Pre-training layer 0, epoch 49, cost  0.38868730247
Pre-training layer 1, epoch 0, cost  16.3534397896
Pre-training layer 1, epoch 1, cost  4.86090264992
Pre-training layer 1, epoch 2, cost  3.29235896054
Pre-training layer 1, epoch 3, cost  2.50506667749
Pre-training layer 1, epoch 4, cost  2.01305362479
Pre-training layer 1, epoch 5, cost  1.67677132788
Pre-training layer 1, epoch 6, cost  1.43820377167
Pre-training layer 1, epoch 7, cost  1.27479169365
Pre-training layer 1, epoch 8, cost  1.20383371743
Pre-training layer 1, epoch 9, cost  1.17270340832
Pre-training layer 1, epoch 10, cost  1.11705219314
Pre-training layer 1, epoch 11, cost  1.05813901313
Pre-training layer 1, epoch 12, cost  1.00789818226
Pre-training layer 1, epoch 13, cost  0.964180667976
Pre-training layer 1, epoch 14, cost  0.924800846966
Pre-training layer 1, epoch 15, cost  0.893559262095
Pre-training layer 1, epoch 16, cost  0.8654188673
Pre-training layer 1, epoch 17, cost  0.842483413522
Pre-training layer 1, epoch 18, cost  0.819193719417
Pre-training layer 1, epoch 19, cost  0.79677601825
Pre-training layer 1, epoch 20, cost  0.777623265651
Pre-training layer 1, epoch 21, cost  0.75996277733
Pre-training layer 1, epoch 22, cost  0.742114591203
Pre-training layer 1, epoch 23, cost  0.726268335561
Pre-training layer 1, epoch 24, cost  0.709993076812
Pre-training layer 1, epoch 25, cost  0.697390487608
Pre-training layer 1, epoch 26, cost  0.681906616643
Pre-training layer 1, epoch 27, cost  0.67474864625
Pre-training layer 1, epoch 28, cost  0.664217255754
Pre-training layer 1, epoch 29, cost  0.657557825972
Pre-training layer 1, epoch 30, cost  0.646717793605
Pre-training layer 1, epoch 31, cost  0.634172741094
Pre-training layer 1, epoch 32, cost  0.621265011257
Pre-training layer 1, epoch 33, cost  0.617370857296
Pre-training layer 1, epoch 34, cost  0.611946214657
Pre-training layer 1, epoch 35, cost  0.604222565169
Pre-training layer 1, epoch 36, cost  0.59610303117
Pre-training layer 1, epoch 37, cost  0.585074938581
Pre-training layer 1, epoch 38, cost  0.578749104306
Pre-training layer 1, epoch 39, cost  0.571620568407
Pre-training layer 1, epoch 40, cost  0.567311215672
Pre-training layer 1, epoch 41, cost  0.559750779734
Pre-training layer 1, epoch 42, cost  0.556505222182
Pre-training layer 1, epoch 43, cost  0.550389633134
Pre-training layer 1, epoch 44, cost  0.544764481959
Pre-training layer 1, epoch 45, cost  0.541228360677
Pre-training layer 1, epoch 46, cost  0.536574679561
Pre-training layer 1, epoch 47, cost  0.531246124825
Pre-training layer 1, epoch 48, cost  0.526132424321
Pre-training layer 1, epoch 49, cost  0.522097561537
Pre-training layer 2, epoch 0, cost  19.899499101
Pre-training layer 2, epoch 1, cost  5.52575446882
Pre-training layer 2, epoch 2, cost  3.94735585065
Pre-training layer 2, epoch 3, cost  3.08839634174
Pre-training layer 2, epoch 4, cost  2.51070845925
Pre-training layer 2, epoch 5, cost  2.10889368752
Pre-training layer 2, epoch 6, cost  2.06862675351
Pre-training layer 2, epoch 7, cost  1.9983979782
Pre-training layer 2, epoch 8, cost  1.8819731418
Pre-training layer 2, epoch 9, cost  1.77187529875
Pre-training layer 2, epoch 10, cost  1.68641559178
Pre-training layer 2, epoch 11, cost  1.60229757636
Pre-training layer 2, epoch 12, cost  1.53149019638
Pre-training layer 2, epoch 13, cost  1.4691115684
Pre-training layer 2, epoch 14, cost  1.41133472962
Pre-training layer 2, epoch 15, cost  1.35024026681
Pre-training layer 2, epoch 16, cost  1.29988560163
Pre-training layer 2, epoch 17, cost  1.25557695325
Pre-training layer 2, epoch 18, cost  1.20412660687
Pre-training layer 2, epoch 19, cost  1.15597233706
Pre-training layer 2, epoch 20, cost  1.12288212704
Pre-training layer 2, epoch 21, cost  1.10799053246
Pre-training layer 2, epoch 22, cost  1.08185910974
Pre-training layer 2, epoch 23, cost  1.04090613289
Pre-training layer 2, epoch 24, cost  1.00653731789
Pre-training layer 2, epoch 25, cost  0.981616971512
Pre-training layer 2, epoch 26, cost  0.956996145296
Pre-training layer 2, epoch 27, cost  0.922174395281
Pre-training layer 2, epoch 28, cost  0.889745274303
Pre-training layer 2, epoch 29, cost  0.873574048776
Pre-training layer 2, epoch 30, cost  0.869408639473
Pre-training layer 2, epoch 31, cost  0.849661614208
Pre-training layer 2, epoch 32, cost  0.827876521082
Pre-training layer 2, epoch 33, cost  0.808081227833
Pre-training layer 2, epoch 34, cost  0.789017866773
Pre-training layer 2, epoch 35, cost  0.777017588584
Pre-training layer 2, epoch 36, cost  0.768771611086
Pre-training layer 2, epoch 37, cost  0.759215217866
Pre-training layer 2, epoch 38, cost  0.72871271463
Pre-training layer 2, epoch 39, cost  0.687304052503
Pre-training layer 2, epoch 40, cost  0.649810126829
Pre-training layer 2, epoch 41, cost  0.665813110184
Pre-training layer 2, epoch 42, cost  0.695365859386
Pre-training layer 2, epoch 43, cost  0.696976764922
Pre-training layer 2, epoch 44, cost  0.674705393159
Pre-training layer 2, epoch 45, cost  0.525891498234
Pre-training layer 2, epoch 46, cost  0.63388164141
Pre-training layer 2, epoch 47, cost  0.681654537895
Pre-training layer 2, epoch 48, cost  0.611461492639
Pre-training layer 2, epoch 49, cost  0.477425672495
Pre-training layer 3, epoch 0, cost  17.1750255631
Pre-training layer 3, epoch 1, cost  4.53177470703
Pre-training layer 3, epoch 2, cost  3.14771983059
Pre-training layer 3, epoch 3, cost  2.40606508512
Pre-training layer 3, epoch 4, cost  1.91240176817
Pre-training layer 3, epoch 5, cost  1.55832350489
Pre-training layer 3, epoch 6, cost  1.30715260539
Pre-training layer 3, epoch 7, cost  1.32091812834
Pre-training layer 3, epoch 8, cost  1.23431068141
Pre-training layer 3, epoch 9, cost  1.14767692427
Pre-training layer 3, epoch 10, cost  1.0790331559
Pre-training layer 3, epoch 11, cost  1.01359544634
Pre-training layer 3, epoch 12, cost  0.943268086625
Pre-training layer 3, epoch 13, cost  0.878089025541
Pre-training layer 3, epoch 14, cost  0.903589815998
Pre-training layer 3, epoch 15, cost  0.813817289612
Pre-training layer 3, epoch 16, cost  0.770341193921
Pre-training layer 3, epoch 17, cost  0.73318069818
Pre-training layer 3, epoch 18, cost  0.699873686129
Pre-training layer 3, epoch 19, cost  0.673788594374
Pre-training layer 3, epoch 20, cost  0.652594553962
Pre-training layer 3, epoch 21, cost  0.637938025139
Pre-training layer 3, epoch 22, cost  0.624037669949
Pre-training layer 3, epoch 23, cost  0.544535709432
Pre-training layer 3, epoch 24, cost  0.519632728826
Pre-training layer 3, epoch 25, cost  0.562094017174
Pre-training layer 3, epoch 26, cost  0.544363130592
Pre-training layer 3, epoch 27, cost  0.525776686092
Pre-training layer 3, epoch 28, cost  0.508953036207
Pre-training layer 3, epoch 29, cost  0.491135006661
Pre-training layer 3, epoch 30, cost  0.46653831667
Pre-training layer 3, epoch 31, cost  0.428726566349
Pre-training layer 3, epoch 32, cost  0.410977709197
Pre-training layer 3, epoch 33, cost  0.4458101632
Pre-training layer 3, epoch 34, cost  0.45910722224
Pre-training layer 3, epoch 35, cost  0.387937055286
Pre-training layer 3, epoch 36, cost  0.36621711624
Pre-training layer 3, epoch 37, cost  0.386137197502
Pre-training layer 3, epoch 38, cost  0.421567659415
Pre-training layer 3, epoch 39, cost  0.409522671951
Pre-training layer 3, epoch 40, cost  0.365886651693
Pre-training layer 3, epoch 41, cost  0.283506643772
Pre-training layer 3, epoch 42, cost  0.342253862697
Pre-training layer 3, epoch 43, cost  0.39235659397
Pre-training layer 3, epoch 44, cost  0.33736531536
Pre-training layer 3, epoch 45, cost  0.211776849764
Pre-training layer 3, epoch 46, cost  0.361607837394
Pre-training layer 3, epoch 47, cost  0.380707992894
Pre-training layer 3, epoch 48, cost  0.207940644439
Pre-training layer 3, epoch 49, cost  0.306779353457
Pre-training layer 4, epoch 0, cost  18.3980861144
Pre-training layer 4, epoch 1, cost  5.38584045922
Pre-training layer 4, epoch 2, cost  3.74385396644
Pre-training layer 4, epoch 3, cost  2.86568932128
Pre-training layer 4, epoch 4, cost  2.31557166139
Pre-training layer 4, epoch 5, cost  1.95773759878
Pre-training layer 4, epoch 6, cost  1.9169891246
Pre-training layer 4, epoch 7, cost  1.78251118887
Pre-training layer 4, epoch 8, cost  1.70341718163
Pre-training layer 4, epoch 9, cost  1.62469746602
Pre-training layer 4, epoch 10, cost  1.55146556812
Pre-training layer 4, epoch 11, cost  1.48705698817
Pre-training layer 4, epoch 12, cost  1.43201353621
Pre-training layer 4, epoch 13, cost  1.39006107267
Pre-training layer 4, epoch 14, cost  1.36086302362
Pre-training layer 4, epoch 15, cost  1.34240304342
Pre-training layer 4, epoch 16, cost  1.32488241247
Pre-training layer 4, epoch 17, cost  1.29839398001
Pre-training layer 4, epoch 18, cost  1.25947802806
Pre-training layer 4, epoch 19, cost  1.23196618075
Pre-training layer 4, epoch 20, cost  1.2519376047
Pre-training layer 4, epoch 21, cost  1.26154194756
Pre-training layer 4, epoch 22, cost  1.22338589801
Pre-training layer 4, epoch 23, cost  1.16350785377
Pre-training layer 4, epoch 24, cost  1.18621518955
Pre-training layer 4, epoch 25, cost  1.20877785895
Pre-training layer 4, epoch 26, cost  1.16578971061
Pre-training layer 4, epoch 27, cost  1.10241736886
Pre-training layer 4, epoch 28, cost  1.17754205171
Pre-training layer 4, epoch 29, cost  1.15367121806
Pre-training layer 4, epoch 30, cost  1.0668844348
Pre-training layer 4, epoch 31, cost  1.15537169227
Pre-training layer 4, epoch 32, cost  1.12956399265
Pre-training layer 4, epoch 33, cost  1.06326170927
Pre-training layer 4, epoch 34, cost  1.12434582656
Pre-training layer 4, epoch 35, cost  1.09831932495
Pre-training layer 4, epoch 36, cost  1.04952105709
Pre-training layer 4, epoch 37, cost  1.11049060395
Pre-training layer 4, epoch 38, cost  1.04616019065
Pre-training layer 4, epoch 39, cost  1.06610701844
Pre-training layer 4, epoch 40, cost  1.08217141415
Pre-training layer 4, epoch 41, cost  1.01470957862
Pre-training layer 4, epoch 42, cost  1.08409139589
Pre-training layer 4, epoch 43, cost  1.0128966093
Pre-training layer 4, epoch 44, cost  1.05993890127
Pre-training layer 4, epoch 45, cost  1.04888844884
Pre-training layer 4, epoch 46, cost  1.01347537521
Pre-training layer 4, epoch 47, cost  1.0518654609
Pre-training layer 4, epoch 48, cost  0.999304433033
Pre-training layer 4, epoch 49, cost  1.04180548652
Pre-training layer 5, epoch 0, cost  19.7674801903
Pre-training layer 5, epoch 1, cost  6.98976364372
Pre-training layer 5, epoch 2, cost  5.73852060611
Pre-training layer 5, epoch 3, cost  5.55794347096
Pre-training layer 5, epoch 4, cost  5.49957475586
Pre-training layer 5, epoch 5, cost  5.4702753309
Pre-training layer 5, epoch 6, cost  5.45304086645
Pre-training layer 5, epoch 7, cost  5.44224868729
Pre-training layer 5, epoch 8, cost  5.43520155634
Pre-training layer 5, epoch 9, cost  5.43025552006
Pre-training layer 5, epoch 10, cost  5.42657757502
Pre-training layer 5, epoch 11, cost  5.423836669
Pre-training layer 5, epoch 12, cost  5.42165262943
Pre-training layer 5, epoch 13, cost  5.41979634726
Pre-training layer 5, epoch 14, cost  5.41818157483
Pre-training layer 5, epoch 15, cost  5.41665635018
Pre-training layer 5, epoch 16, cost  5.41527857709
Pre-training layer 5, epoch 17, cost  5.41392596532
Pre-training layer 5, epoch 18, cost  5.41260092118
Pre-training layer 5, epoch 19, cost  5.4112869257
Pre-training layer 5, epoch 20, cost  5.41005956432
Pre-training layer 5, epoch 21, cost  5.40881859776
Pre-training layer 5, epoch 22, cost  5.40760373848
Pre-training layer 5, epoch 23, cost  5.40641619209
Pre-training layer 5, epoch 24, cost  5.40525358351
Pre-training layer 5, epoch 25, cost  5.40408959441
Pre-training layer 5, epoch 26, cost  5.40301420561
Pre-training layer 5, epoch 27, cost  5.40196204192
Pre-training layer 5, epoch 28, cost  5.40089055636
Pre-training layer 5, epoch 29, cost  5.3998341685
Pre-training layer 5, epoch 30, cost  5.39878936394
Pre-training layer 5, epoch 31, cost  5.39780491974
Pre-training layer 5, epoch 32, cost  5.39682596885
Pre-training layer 5, epoch 33, cost  5.39587114207
Pre-training layer 5, epoch 34, cost  5.39498201859
Pre-training layer 5, epoch 35, cost  5.39409553366
Pre-training layer 5, epoch 36, cost  5.39326589472
Pre-training layer 5, epoch 37, cost  5.39242676277
Pre-training layer 5, epoch 38, cost  5.39159430095
Pre-training layer 5, epoch 39, cost  5.39076820054
Pre-training layer 5, epoch 40, cost  5.38997931815
Pre-training layer 5, epoch 41, cost  5.38923828819
Pre-training layer 5, epoch 42, cost  5.38850145459
Pre-training layer 5, epoch 43, cost  5.38780062333
Pre-training layer 5, epoch 44, cost  5.38710456854
Pre-training layer 5, epoch 45, cost  5.38643049423
Pre-training layer 5, epoch 46, cost  5.38574814182
Pre-training layer 5, epoch 47, cost  5.38510174409
Pre-training layer 5, epoch 48, cost  5.38448977293
The pretraining code for file multi_layer_km.pyc ran for 6.90m
Pre-training layer 5, epoch 49, cost  5.38385816427
Initial NMI for deep clustering: 0.50
ARI for deep clustering: 0.35
... getting the finetuning functions
ACC for deep clustering: 0.49
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.91887, Reconstruction: 1.97198, Clustering: 0.94689, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.21990, Reconstruction: 1.71871, Clustering: 0.50119, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.10075, Reconstruction: 1.66099, Clustering: 0.43976, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.02907, Reconstruction: 1.61463, Clustering: 0.41444, 
Fine-tuning epoch 5 ++++ 
Total cost: 1.97932, Reconstruction: 1.58034, Clustering: 0.39898, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.93828, Reconstruction: 1.55288, Clustering: 0.38540, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.89832, Reconstruction: 1.52811, Clustering: 0.37020, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.85677, Reconstruction: 1.50440, Clustering: 0.35237, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.82646, Reconstruction: 1.47780, Clustering: 0.34866, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.78725, Reconstruction: 1.45026, Clustering: 0.33699, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.74154, Reconstruction: 1.41845, Clustering: 0.32309, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.71348, Reconstruction: 1.39650, Clustering: 0.31698, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.71034, Reconstruction: 1.39201, Clustering: 0.31832, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.66374, Reconstruction: 1.35685, Clustering: 0.30690, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.62484, Reconstruction: 1.32663, Clustering: 0.29821, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.63494, Reconstruction: 1.33254, Clustering: 0.30240, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.59191, Reconstruction: 1.29700, Clustering: 0.29491, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.56369, Reconstruction: 1.27351, Clustering: 0.29019, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.55064, Reconstruction: 1.26212, Clustering: 0.28852, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.52449, Reconstruction: 1.23943, Clustering: 0.28506, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.52375, Reconstruction: 1.23962, Clustering: 0.28413, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.48928, Reconstruction: 1.20932, Clustering: 0.27996, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.46205, Reconstruction: 1.18476, Clustering: 0.27730, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.47284, Reconstruction: 1.19251, Clustering: 0.28033, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.43658, Reconstruction: 1.16331, Clustering: 0.27327, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.44751, Reconstruction: 1.16890, Clustering: 0.27861, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.44433, Reconstruction: 1.16791, Clustering: 0.27642, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.38625, Reconstruction: 1.11947, Clustering: 0.26678, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.39343, Reconstruction: 1.12382, Clustering: 0.26961, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.38281, Reconstruction: 1.11256, Clustering: 0.27025, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.38055, Reconstruction: 1.10693, Clustering: 0.27362, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.34792, Reconstruction: 1.08202, Clustering: 0.26590, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.33192, Reconstruction: 1.06896, Clustering: 0.26296, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.33835, Reconstruction: 1.07099, Clustering: 0.26735, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.32226, Reconstruction: 1.05593, Clustering: 0.26633, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.29448, Reconstruction: 1.03444, Clustering: 0.26004, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.31253, Reconstruction: 1.04225, Clustering: 0.27028, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.29036, Reconstruction: 1.02522, Clustering: 0.26514, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.30927, Reconstruction: 1.04434, Clustering: 0.26493, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.27170, Reconstruction: 1.01228, Clustering: 0.25942, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.25982, Reconstruction: 0.99991, Clustering: 0.25991, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.28219, Reconstruction: 1.01383, Clustering: 0.26835, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.24986, Reconstruction: 0.98936, Clustering: 0.26050, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.25105, Reconstruction: 0.98728, Clustering: 0.26377, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.23468, Reconstruction: 0.97291, Clustering: 0.26178, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.23156, Reconstruction: 0.96977, Clustering: 0.26180, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.25363, Reconstruction: 0.98714, Clustering: 0.26649, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.22096, Reconstruction: 0.95994, Clustering: 0.26102, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.21728, Reconstruction: 0.95674, Clustering: 0.26055, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.20818, Reconstruction: 0.94844, Clustering: 0.25974, 
Average squared 2-D reconstruction error: 0.9484
NMI for deep clustering: 0.53
ARI for deep clustering: 0.36
ACC for deep clustering: 0.50
The training code for file multi_layer_km.pyc ran for 6.80m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  11.0776030001
Pre-training layer 0, epoch 1, cost  2.78006685685
Pre-training layer 0, epoch 2, cost  1.94937901517
Pre-training layer 0, epoch 3, cost  1.54370828256
Pre-training layer 0, epoch 4, cost  1.29720016588
Pre-training layer 0, epoch 5, cost  1.13203774219
Pre-training layer 0, epoch 6, cost  1.01367161805
Pre-training layer 0, epoch 7, cost  0.924758716608
Pre-training layer 0, epoch 8, cost  0.855675530449
Pre-training layer 0, epoch 9, cost  0.80056967762
Pre-training layer 0, epoch 10, cost  0.755521795671
Pre-training layer 0, epoch 11, cost  0.718080601706
Pre-training layer 0, epoch 12, cost  0.686311609876
Pre-training layer 0, epoch 13, cost  0.659000133449
Pre-training layer 0, epoch 14, cost  0.635023102182
Pre-training layer 0, epoch 15, cost  0.61404472289
Pre-training layer 0, epoch 16, cost  0.595520628419
Pre-training layer 0, epoch 17, cost  0.578946549492
Pre-training layer 0, epoch 18, cost  0.563915632915
Pre-training layer 0, epoch 19, cost  0.550224077439
Pre-training layer 0, epoch 20, cost  0.537891995608
Pre-training layer 0, epoch 21, cost  0.526637345116
Pre-training layer 0, epoch 22, cost  0.516229335374
Pre-training layer 0, epoch 23, cost  0.506542855366
Pre-training layer 0, epoch 24, cost  0.497614908193
Pre-training layer 0, epoch 25, cost  0.489313313119
Pre-training layer 0, epoch 26, cost  0.481571314248
Pre-training layer 0, epoch 27, cost  0.474316524478
Pre-training layer 0, epoch 28, cost  0.467499317945
Pre-training layer 0, epoch 29, cost  0.4610719947
Pre-training layer 0, epoch 30, cost  0.454724156233
Pre-training layer 0, epoch 31, cost  0.448643418407
Pre-training layer 0, epoch 32, cost  0.443085473633
Pre-training layer 0, epoch 33, cost  0.437654773126
Pre-training layer 0, epoch 34, cost  0.432598045239
Pre-training layer 0, epoch 35, cost  0.427822468511
Pre-training layer 0, epoch 36, cost  0.423193609735
Pre-training layer 0, epoch 37, cost  0.418819762922
Pre-training layer 0, epoch 38, cost  0.414638145548
Pre-training layer 0, epoch 39, cost  0.410640996528
Pre-training layer 0, epoch 40, cost  0.406764736256
Pre-training layer 0, epoch 41, cost  0.403071361457
Pre-training layer 0, epoch 42, cost  0.399411136897
Pre-training layer 0, epoch 43, cost  0.395811575148
Pre-training layer 0, epoch 44, cost  0.392421814935
Pre-training layer 0, epoch 45, cost  0.389188680607
Pre-training layer 0, epoch 46, cost  0.386084004145
Pre-training layer 0, epoch 47, cost  0.383083470053
Pre-training layer 0, epoch 48, cost  0.380153926239
Pre-training layer 0, epoch 49, cost  0.377343920966
Pre-training layer 1, epoch 0, cost  16.3016400034
Pre-training layer 1, epoch 1, cost  4.84682599656
Pre-training layer 1, epoch 2, cost  3.27739035209
Pre-training layer 1, epoch 3, cost  2.49171910404
Pre-training layer 1, epoch 4, cost  2.00232694351
Pre-training layer 1, epoch 5, cost  1.66870859236
Pre-training layer 1, epoch 6, cost  1.43262135232
Pre-training layer 1, epoch 7, cost  1.2715447162
Pre-training layer 1, epoch 8, cost  1.19986322072
Pre-training layer 1, epoch 9, cost  1.1747624451
Pre-training layer 1, epoch 10, cost  1.11657018169
Pre-training layer 1, epoch 11, cost  1.05996984462
Pre-training layer 1, epoch 12, cost  1.00809688532
Pre-training layer 1, epoch 13, cost  0.964704047304
Pre-training layer 1, epoch 14, cost  0.926585102342
Pre-training layer 1, epoch 15, cost  0.891918639298
Pre-training layer 1, epoch 16, cost  0.865579951985
Pre-training layer 1, epoch 17, cost  0.8421076368
Pre-training layer 1, epoch 18, cost  0.820094408261
Pre-training layer 1, epoch 19, cost  0.799374706294
Pre-training layer 1, epoch 20, cost  0.778482031246
Pre-training layer 1, epoch 21, cost  0.760331836566
Pre-training layer 1, epoch 22, cost  0.738273144964
Pre-training layer 1, epoch 23, cost  0.724524693871
Pre-training layer 1, epoch 24, cost  0.706558469369
Pre-training layer 1, epoch 25, cost  0.695192394377
Pre-training layer 1, epoch 26, cost  0.683960081196
Pre-training layer 1, epoch 27, cost  0.676051947019
Pre-training layer 1, epoch 28, cost  0.663661725295
Pre-training layer 1, epoch 29, cost  0.655629091164
Pre-training layer 1, epoch 30, cost  0.642205079748
Pre-training layer 1, epoch 31, cost  0.629795648505
Pre-training layer 1, epoch 32, cost  0.621209587065
Pre-training layer 1, epoch 33, cost  0.610151242954
Pre-training layer 1, epoch 34, cost  0.606102133979
Pre-training layer 1, epoch 35, cost  0.598570298474
Pre-training layer 1, epoch 36, cost  0.59321323891
Pre-training layer 1, epoch 37, cost  0.585800752639
Pre-training layer 1, epoch 38, cost  0.577554186081
Pre-training layer 1, epoch 39, cost  0.571800785902
Pre-training layer 1, epoch 40, cost  0.563946762897
Pre-training layer 1, epoch 41, cost  0.559603801023
Pre-training layer 1, epoch 42, cost  0.55316968815
Pre-training layer 1, epoch 43, cost  0.545721747769
Pre-training layer 1, epoch 44, cost  0.547615317562
Pre-training layer 1, epoch 45, cost  0.540085390696
Pre-training layer 1, epoch 46, cost  0.537722447834
Pre-training layer 1, epoch 47, cost  0.530583385085
Pre-training layer 1, epoch 48, cost  0.526183477485
Pre-training layer 1, epoch 49, cost  0.515077703223
Pre-training layer 2, epoch 0, cost  19.9324869528
Pre-training layer 2, epoch 1, cost  5.49375151852
Pre-training layer 2, epoch 2, cost  3.92116124962
Pre-training layer 2, epoch 3, cost  3.06695097823
Pre-training layer 2, epoch 4, cost  2.49845711361
Pre-training layer 2, epoch 5, cost  2.10282303085
Pre-training layer 2, epoch 6, cost  2.04735007923
Pre-training layer 2, epoch 7, cost  1.99590370996
Pre-training layer 2, epoch 8, cost  1.87757914853
Pre-training layer 2, epoch 9, cost  1.7696042283
Pre-training layer 2, epoch 10, cost  1.64891607951
Pre-training layer 2, epoch 11, cost  1.57403851391
Pre-training layer 2, epoch 12, cost  1.54426576988
Pre-training layer 2, epoch 13, cost  1.4799125142
Pre-training layer 2, epoch 14, cost  1.41432122921
Pre-training layer 2, epoch 15, cost  1.35462145592
Pre-training layer 2, epoch 16, cost  1.31044426981
Pre-training layer 2, epoch 17, cost  1.24891245746
Pre-training layer 2, epoch 18, cost  1.19548960746
Pre-training layer 2, epoch 19, cost  1.14973889362
Pre-training layer 2, epoch 20, cost  1.11584745355
Pre-training layer 2, epoch 21, cost  1.09880957837
Pre-training layer 2, epoch 22, cost  1.08199415969
Pre-training layer 2, epoch 23, cost  1.03949450895
Pre-training layer 2, epoch 24, cost  0.998932712814
Pre-training layer 2, epoch 25, cost  0.967496480595
Pre-training layer 2, epoch 26, cost  0.937135304491
Pre-training layer 2, epoch 27, cost  0.91040728324
Pre-training layer 2, epoch 28, cost  0.878396596483
Pre-training layer 2, epoch 29, cost  0.835711248469
Pre-training layer 2, epoch 30, cost  0.809797570693
Pre-training layer 2, epoch 31, cost  0.815896521527
Pre-training layer 2, epoch 32, cost  0.820707958757
Pre-training layer 2, epoch 33, cost  0.808104618982
Pre-training layer 2, epoch 34, cost  0.796403523274
Pre-training layer 2, epoch 35, cost  0.782997503375
Pre-training layer 2, epoch 36, cost  0.767934876812
Pre-training layer 2, epoch 37, cost  0.73578779232
Pre-training layer 2, epoch 38, cost  0.621235022801
Pre-training layer 2, epoch 39, cost  0.658575379737
Pre-training layer 2, epoch 40, cost  0.72756175959
Pre-training layer 2, epoch 41, cost  0.721998956919
Pre-training layer 2, epoch 42, cost  0.692689970393
Pre-training layer 2, epoch 43, cost  0.601521458522
Pre-training layer 2, epoch 44, cost  0.573019664151
Pre-training layer 2, epoch 45, cost  0.666239477419
Pre-training layer 2, epoch 46, cost  0.657489302049
Pre-training layer 2, epoch 47, cost  0.573066347503
Pre-training layer 2, epoch 48, cost  0.535058031982
Pre-training layer 2, epoch 49, cost  0.643837098246
Pre-training layer 3, epoch 0, cost  16.9869563217
Pre-training layer 3, epoch 1, cost  4.53069844622
Pre-training layer 3, epoch 2, cost  3.13355943686
Pre-training layer 3, epoch 3, cost  2.38310565457
Pre-training layer 3, epoch 4, cost  1.89049761824
Pre-training layer 3, epoch 5, cost  1.54091704707
Pre-training layer 3, epoch 6, cost  1.29318362813
Pre-training layer 3, epoch 7, cost  1.28634359937
Pre-training layer 3, epoch 8, cost  1.23017525707
Pre-training layer 3, epoch 9, cost  1.16480487137
Pre-training layer 3, epoch 10, cost  1.08556105916
Pre-training layer 3, epoch 11, cost  0.983884883083
Pre-training layer 3, epoch 12, cost  0.895446354338
Pre-training layer 3, epoch 13, cost  0.88202871983
Pre-training layer 3, epoch 14, cost  0.869379341749
Pre-training layer 3, epoch 15, cost  0.827027083318
Pre-training layer 3, epoch 16, cost  0.769040850041
Pre-training layer 3, epoch 17, cost  0.71326889933
Pre-training layer 3, epoch 18, cost  0.662701886208
Pre-training layer 3, epoch 19, cost  0.652274010222
Pre-training layer 3, epoch 20, cost  0.650290329022
Pre-training layer 3, epoch 21, cost  0.629289264966
Pre-training layer 3, epoch 22, cost  0.595629364592
Pre-training layer 3, epoch 23, cost  0.528983609856
Pre-training layer 3, epoch 24, cost  0.525954487257
Pre-training layer 3, epoch 25, cost  0.592951218193
Pre-training layer 3, epoch 26, cost  0.56250786291
Pre-training layer 3, epoch 27, cost  0.53707452908
Pre-training layer 3, epoch 28, cost  0.509916200247
Pre-training layer 3, epoch 29, cost  0.461367811848
Pre-training layer 3, epoch 30, cost  0.413145021608
Pre-training layer 3, epoch 31, cost  0.429794495338
Pre-training layer 3, epoch 32, cost  0.458248652468
Pre-training layer 3, epoch 33, cost  0.464778615103
Pre-training layer 3, epoch 34, cost  0.398736684563
Pre-training layer 3, epoch 35, cost  0.299283050678
Pre-training layer 3, epoch 36, cost  0.423899433541
Pre-training layer 3, epoch 37, cost  0.448624059375
Pre-training layer 3, epoch 38, cost  0.393761895778
Pre-training layer 3, epoch 39, cost  0.310061754396
Pre-training layer 3, epoch 40, cost  0.3274435449
Pre-training layer 3, epoch 41, cost  0.38150700007
Pre-training layer 3, epoch 42, cost  0.381572157871
Pre-training layer 3, epoch 43, cost  0.243687856712
Pre-training layer 3, epoch 44, cost  0.318591590574
Pre-training layer 3, epoch 45, cost  0.359065550677
Pre-training layer 3, epoch 46, cost  0.328044331412
Pre-training layer 3, epoch 47, cost  0.233994552848
Pre-training layer 3, epoch 48, cost  0.340458294894
Pre-training layer 3, epoch 49, cost  0.335087891889
Pre-training layer 4, epoch 0, cost  18.5340878287
Pre-training layer 4, epoch 1, cost  5.41127590942
Pre-training layer 4, epoch 2, cost  3.77244693363
Pre-training layer 4, epoch 3, cost  2.87810698204
Pre-training layer 4, epoch 4, cost  2.31916525549
Pre-training layer 4, epoch 5, cost  1.95895709149
Pre-training layer 4, epoch 6, cost  1.93380768819
Pre-training layer 4, epoch 7, cost  1.792927336
Pre-training layer 4, epoch 8, cost  1.7111433393
Pre-training layer 4, epoch 9, cost  1.63061710449
Pre-training layer 4, epoch 10, cost  1.553768624
Pre-training layer 4, epoch 11, cost  1.48536474646
Pre-training layer 4, epoch 12, cost  1.42642736816
Pre-training layer 4, epoch 13, cost  1.38701809052
Pre-training layer 4, epoch 14, cost  1.36310871508
Pre-training layer 4, epoch 15, cost  1.34260576414
Pre-training layer 4, epoch 16, cost  1.31829434777
Pre-training layer 4, epoch 17, cost  1.27323982609
Pre-training layer 4, epoch 18, cost  1.24409875121
Pre-training layer 4, epoch 19, cost  1.25482761551
Pre-training layer 4, epoch 20, cost  1.25334799562
Pre-training layer 4, epoch 21, cost  1.22082442971
Pre-training layer 4, epoch 22, cost  1.1695007291
Pre-training layer 4, epoch 23, cost  1.19221466317
Pre-training layer 4, epoch 24, cost  1.20941238688
Pre-training layer 4, epoch 25, cost  1.17282807936
Pre-training layer 4, epoch 26, cost  1.12036369216
Pre-training layer 4, epoch 27, cost  1.17242534171
Pre-training layer 4, epoch 28, cost  1.15922386639
Pre-training layer 4, epoch 29, cost  1.07882925148
Pre-training layer 4, epoch 30, cost  1.14752925329
Pre-training layer 4, epoch 31, cost  1.14946228236
Pre-training layer 4, epoch 32, cost  1.06466116453
Pre-training layer 4, epoch 33, cost  1.11303069858
Pre-training layer 4, epoch 34, cost  1.12191191894
Pre-training layer 4, epoch 35, cost  1.03386393586
Pre-training layer 4, epoch 36, cost  1.10862962318
Pre-training layer 4, epoch 37, cost  1.0694211686
Pre-training layer 4, epoch 38, cost  1.04147035814
Pre-training layer 4, epoch 39, cost  1.09670909914
Pre-training layer 4, epoch 40, cost  1.00894992432
Pre-training layer 4, epoch 41, cost  1.07919257289
Pre-training layer 4, epoch 42, cost  1.02709459707
Pre-training layer 4, epoch 43, cost  1.04105633401
Pre-training layer 4, epoch 44, cost  1.04481342537
Pre-training layer 4, epoch 45, cost  1.01118403131
Pre-training layer 4, epoch 46, cost  1.04337950158
Pre-training layer 4, epoch 47, cost  1.00490506527
Pre-training layer 4, epoch 48, cost  1.03515361609
Pre-training layer 4, epoch 49, cost  1.00440601018
Pre-training layer 5, epoch 0, cost  20.0510815593
Pre-training layer 5, epoch 1, cost  7.12442981026
Pre-training layer 5, epoch 2, cost  5.79184873275
Pre-training layer 5, epoch 3, cost  5.59655980695
Pre-training layer 5, epoch 4, cost  5.53628008645
Pre-training layer 5, epoch 5, cost  5.50814133949
Pre-training layer 5, epoch 6, cost  5.49231561637
Pre-training layer 5, epoch 7, cost  5.48214546263
Pre-training layer 5, epoch 8, cost  5.47512117685
Pre-training layer 5, epoch 9, cost  5.46984961535
Pre-training layer 5, epoch 10, cost  5.46582816882
Pre-training layer 5, epoch 11, cost  5.46254170655
Pre-training layer 5, epoch 12, cost  5.45989511298
Pre-training layer 5, epoch 13, cost  5.45755043678
Pre-training layer 5, epoch 14, cost  5.45544026735
Pre-training layer 5, epoch 15, cost  5.45354174696
Pre-training layer 5, epoch 16, cost  5.45175991835
Pre-training layer 5, epoch 17, cost  5.45001260857
Pre-training layer 5, epoch 18, cost  5.44834264239
Pre-training layer 5, epoch 19, cost  5.44668381573
Pre-training layer 5, epoch 20, cost  5.44509462574
Pre-training layer 5, epoch 21, cost  5.44356103155
Pre-training layer 5, epoch 22, cost  5.44205814244
Pre-training layer 5, epoch 23, cost  5.44065450329
Pre-training layer 5, epoch 24, cost  5.43932436785
Pre-training layer 5, epoch 25, cost  5.43796253735
Pre-training layer 5, epoch 26, cost  5.43670077232
Pre-training layer 5, epoch 27, cost  5.43554889985
Pre-training layer 5, epoch 28, cost  5.43438703539
Pre-training layer 5, epoch 29, cost  5.4332223794
Pre-training layer 5, epoch 30, cost  5.43213742422
Pre-training layer 5, epoch 31, cost  5.43102689404
Pre-training layer 5, epoch 32, cost  5.43001345388
Pre-training layer 5, epoch 33, cost  5.42903311711
Pre-training layer 5, epoch 34, cost  5.42808158264
Pre-training layer 5, epoch 35, cost  5.4272037698
Pre-training layer 5, epoch 36, cost  5.42631579133
Pre-training layer 5, epoch 37, cost  5.42544037874
Pre-training layer 5, epoch 38, cost  5.4246238074
Pre-training layer 5, epoch 39, cost  5.42382207054
Pre-training layer 5, epoch 40, cost  5.42304222212
Pre-training layer 5, epoch 41, cost  5.42226591526
Pre-training layer 5, epoch 42, cost  5.42153637095
Pre-training layer 5, epoch 43, cost  5.42082586485
Pre-training layer 5, epoch 44, cost  5.42014733043
Pre-training layer 5, epoch 45, cost  5.41947935247
Pre-training layer 5, epoch 46, cost  5.41883262787
Pre-training layer 5, epoch 47, cost  5.41819498879
Pre-training layer 5, epoch 48, cost  5.41757351511
Pre-training layer 5, epoch 49, cost  5.41698640483
The pretraining code for file multi_layer_km.pyc ran for 7.06m
Initial NMI for deep clustering: 0.49
ARI for deep clustering: 0.36
... getting the finetuning functions
ACC for deep clustering: 0.53
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.94527, Reconstruction: 1.95563, Clustering: 0.98964, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.22793, Reconstruction: 1.70279, Clustering: 0.52514, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.14474, Reconstruction: 1.66367, Clustering: 0.48107, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.08302, Reconstruction: 1.62190, Clustering: 0.46112, 
Fine-tuning epoch 5 ++++ 
Total cost: 2.02908, Reconstruction: 1.58237, Clustering: 0.44671, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.99053, Reconstruction: 1.55034, Clustering: 0.44018, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.97230, Reconstruction: 1.54004, Clustering: 0.43226, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.93934, Reconstruction: 1.50529, Clustering: 0.43405, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.95719, Reconstruction: 1.53819, Clustering: 0.41900, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.88607, Reconstruction: 1.48072, Clustering: 0.40534, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.82336, Reconstruction: 1.43903, Clustering: 0.38433, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.80067, Reconstruction: 1.42195, Clustering: 0.37872, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.76996, Reconstruction: 1.39793, Clustering: 0.37203, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.75009, Reconstruction: 1.38579, Clustering: 0.36429, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.73178, Reconstruction: 1.37857, Clustering: 0.35321, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.68004, Reconstruction: 1.33565, Clustering: 0.34439, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.69349, Reconstruction: 1.34277, Clustering: 0.35072, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.65073, Reconstruction: 1.30642, Clustering: 0.34431, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.62654, Reconstruction: 1.28177, Clustering: 0.34477, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.62437, Reconstruction: 1.28547, Clustering: 0.33890, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.59485, Reconstruction: 1.25718, Clustering: 0.33767, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.59567, Reconstruction: 1.25786, Clustering: 0.33781, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.56289, Reconstruction: 1.23129, Clustering: 0.33160, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.54853, Reconstruction: 1.21738, Clustering: 0.33115, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.52215, Reconstruction: 1.19731, Clustering: 0.32484, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.51794, Reconstruction: 1.19155, Clustering: 0.32640, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.50053, Reconstruction: 1.18255, Clustering: 0.31798, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.47260, Reconstruction: 1.17015, Clustering: 0.30245, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.43247, Reconstruction: 1.14951, Clustering: 0.28296, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.40916, Reconstruction: 1.13625, Clustering: 0.27291, 
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 31 ++++ 
Total cost: 1.42011, Reconstruction: 1.13917, Clustering: 0.28094, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.38877, Reconstruction: 1.11871, Clustering: 0.27006, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.36929, Reconstruction: 1.10360, Clustering: 0.26569, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.36835, Reconstruction: 1.10051, Clustering: 0.26784, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.35483, Reconstruction: 1.08823, Clustering: 0.26660, 
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 36 ++++ 
Total cost: 1.32426, Reconstruction: 1.06254, Clustering: 0.26172, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.36390, Reconstruction: 1.09219, Clustering: 0.27171, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.32034, Reconstruction: 1.05622, Clustering: 0.26411, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.32861, Reconstruction: 1.06232, Clustering: 0.26629, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.30262, Reconstruction: 1.04099, Clustering: 0.26164, 
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 41 ++++ 
Total cost: 1.30732, Reconstruction: 1.04345, Clustering: 0.26387, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.31172, Reconstruction: 1.04334, Clustering: 0.26838, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.28097, Reconstruction: 1.01828, Clustering: 0.26269, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.27535, Reconstruction: 1.01661, Clustering: 0.25874, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.26429, Reconstruction: 1.00292, Clustering: 0.26137, 
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 46 ++++ 
Total cost: 1.27010, Reconstruction: 1.00937, Clustering: 0.26073, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.26035, Reconstruction: 1.00004, Clustering: 0.26031, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.27231, Reconstruction: 1.00196, Clustering: 0.27035, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.27244, Reconstruction: 1.00440, Clustering: 0.26803, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.24632, Reconstruction: 0.98225, Clustering: 0.26407, 
Number of predicted cluster mismatch with ground truth.
Average squared 2-D reconstruction error: 0.9823
NMI for deep clustering: 0.48
ARI for deep clustering: 0.31
ACC for deep clustering: 0.00
Number of predicted cluster mismatch with ground truth.
The training code for file multi_layer_km.pyc ran for 6.82m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  11.0631218006
Pre-training layer 0, epoch 1, cost  2.8011006794
Pre-training layer 0, epoch 2, cost  1.97107876984
Pre-training layer 0, epoch 3, cost  1.56618987254
Pre-training layer 0, epoch 4, cost  1.32030247771
Pre-training layer 0, epoch 5, cost  1.15478275716
Pre-training layer 0, epoch 6, cost  1.03516205595
Pre-training layer 0, epoch 7, cost  0.945625472402
Pre-training layer 0, epoch 8, cost  0.876097128875
Pre-training layer 0, epoch 9, cost  0.820554672219
Pre-training layer 0, epoch 10, cost  0.774990215005
Pre-training layer 0, epoch 11, cost  0.736809512802
Pre-training layer 0, epoch 12, cost  0.704660869614
Pre-training layer 0, epoch 13, cost  0.677119610051
Pre-training layer 0, epoch 14, cost  0.653047959745
Pre-training layer 0, epoch 15, cost  0.631880694234
Pre-training layer 0, epoch 16, cost  0.613183217705
Pre-training layer 0, epoch 17, cost  0.596388851789
Pre-training layer 0, epoch 18, cost  0.581281041481
Pre-training layer 0, epoch 19, cost  0.567585523519
Pre-training layer 0, epoch 20, cost  0.555102299186
Pre-training layer 0, epoch 21, cost  0.543629203622
Pre-training layer 0, epoch 22, cost  0.532963336197
Pre-training layer 0, epoch 23, cost  0.523195497969
Pre-training layer 0, epoch 24, cost  0.514114440102
Pre-training layer 0, epoch 25, cost  0.505656970487
Pre-training layer 0, epoch 26, cost  0.497735764003
Pre-training layer 0, epoch 27, cost  0.490299611974
Pre-training layer 0, epoch 28, cost  0.483305972357
Pre-training layer 0, epoch 29, cost  0.476737731066
Pre-training layer 0, epoch 30, cost  0.47054122888
Pre-training layer 0, epoch 31, cost  0.464637766772
Pre-training layer 0, epoch 32, cost  0.459032213951
Pre-training layer 0, epoch 33, cost  0.453648678193
Pre-training layer 0, epoch 34, cost  0.448554934521
Pre-training layer 0, epoch 35, cost  0.443695989177
Pre-training layer 0, epoch 36, cost  0.439048126288
Pre-training layer 0, epoch 37, cost  0.434614331298
Pre-training layer 0, epoch 38, cost  0.430360328023
Pre-training layer 0, epoch 39, cost  0.426264729182
Pre-training layer 0, epoch 40, cost  0.422305901993
Pre-training layer 0, epoch 41, cost  0.418529032848
Pre-training layer 0, epoch 42, cost  0.414867317208
Pre-training layer 0, epoch 43, cost  0.411361378669
Pre-training layer 0, epoch 44, cost  0.407964331668
Pre-training layer 0, epoch 45, cost  0.404681593137
Pre-training layer 0, epoch 46, cost  0.401506131002
Pre-training layer 0, epoch 47, cost  0.398427908993
Pre-training layer 0, epoch 48, cost  0.395462331211
Pre-training layer 0, epoch 49, cost  0.392582632377
Pre-training layer 1, epoch 0, cost  16.2089473632
Pre-training layer 1, epoch 1, cost  4.85880227649
Pre-training layer 1, epoch 2, cost  3.28489148236
Pre-training layer 1, epoch 3, cost  2.49773932959
Pre-training layer 1, epoch 4, cost  2.00724935574
Pre-training layer 1, epoch 5, cost  1.67295618896
Pre-training layer 1, epoch 6, cost  1.43604631681
Pre-training layer 1, epoch 7, cost  1.27141293917
Pre-training layer 1, epoch 8, cost  1.1899855366
Pre-training layer 1, epoch 9, cost  1.15971390946
Pre-training layer 1, epoch 10, cost  1.10711272465
Pre-training layer 1, epoch 11, cost  1.05151729644
Pre-training layer 1, epoch 12, cost  1.00036009432
Pre-training layer 1, epoch 13, cost  0.958168555897
Pre-training layer 1, epoch 14, cost  0.919805807892
Pre-training layer 1, epoch 15, cost  0.888957637107
Pre-training layer 1, epoch 16, cost  0.858157089629
Pre-training layer 1, epoch 17, cost  0.835297143259
Pre-training layer 1, epoch 18, cost  0.813960490979
Pre-training layer 1, epoch 19, cost  0.790427101807
Pre-training layer 1, epoch 20, cost  0.775248937366
Pre-training layer 1, epoch 21, cost  0.754737590129
Pre-training layer 1, epoch 22, cost  0.741597419131
Pre-training layer 1, epoch 23, cost  0.725609754174
Pre-training layer 1, epoch 24, cost  0.712290653169
Pre-training layer 1, epoch 25, cost  0.693799548333
Pre-training layer 1, epoch 26, cost  0.681115063724
Pre-training layer 1, epoch 27, cost  0.668207075075
Pre-training layer 1, epoch 28, cost  0.65914041712
Pre-training layer 1, epoch 29, cost  0.65006194137
Pre-training layer 1, epoch 30, cost  0.642197849467
Pre-training layer 1, epoch 31, cost  0.635731444527
Pre-training layer 1, epoch 32, cost  0.622811694807
Pre-training layer 1, epoch 33, cost  0.617103059726
Pre-training layer 1, epoch 34, cost  0.60554567946
Pre-training layer 1, epoch 35, cost  0.599723350067
Pre-training layer 1, epoch 36, cost  0.588904594036
Pre-training layer 1, epoch 37, cost  0.581330536518
Pre-training layer 1, epoch 38, cost  0.57840913406
Pre-training layer 1, epoch 39, cost  0.572838887127
Pre-training layer 1, epoch 40, cost  0.570873515386
Pre-training layer 1, epoch 41, cost  0.559494541404
Pre-training layer 1, epoch 42, cost  0.552925691775
Pre-training layer 1, epoch 43, cost  0.547129263134
Pre-training layer 1, epoch 44, cost  0.542549370468
Pre-training layer 1, epoch 45, cost  0.539152803287
Pre-training layer 1, epoch 46, cost  0.537178743728
Pre-training layer 1, epoch 47, cost  0.532577061656
Pre-training layer 1, epoch 48, cost  0.526879391861
Pre-training layer 1, epoch 49, cost  0.523094671632
Pre-training layer 2, epoch 0, cost  20.0032647054
Pre-training layer 2, epoch 1, cost  5.53203061997
Pre-training layer 2, epoch 2, cost  3.95566491162
Pre-training layer 2, epoch 3, cost  3.09170599525
Pre-training layer 2, epoch 4, cost  2.51524625575
Pre-training layer 2, epoch 5, cost  2.11593848132
Pre-training layer 2, epoch 6, cost  2.04810187801
Pre-training layer 2, epoch 7, cost  1.99314937947
Pre-training layer 2, epoch 8, cost  1.87934750079
Pre-training layer 2, epoch 9, cost  1.77115492653
Pre-training layer 2, epoch 10, cost  1.67792659764
Pre-training layer 2, epoch 11, cost  1.59509856555
Pre-training layer 2, epoch 12, cost  1.55511148156
Pre-training layer 2, epoch 13, cost  1.49085909009
Pre-training layer 2, epoch 14, cost  1.4079920703
Pre-training layer 2, epoch 15, cost  1.34583015718
Pre-training layer 2, epoch 16, cost  1.296325643
Pre-training layer 2, epoch 17, cost  1.27637194147
Pre-training layer 2, epoch 18, cost  1.26088017495
Pre-training layer 2, epoch 19, cost  1.21286979625
Pre-training layer 2, epoch 20, cost  1.16508712797
Pre-training layer 2, epoch 21, cost  1.13294260965
Pre-training layer 2, epoch 22, cost  1.08690226255
Pre-training layer 2, epoch 23, cost  1.04177041458
Pre-training layer 2, epoch 24, cost  1.00590762274
Pre-training layer 2, epoch 25, cost  0.997227524342
Pre-training layer 2, epoch 26, cost  1.00379802131
Pre-training layer 2, epoch 27, cost  0.973458435353
Pre-training layer 2, epoch 28, cost  0.936197918369
Pre-training layer 2, epoch 29, cost  0.907149416044
Pre-training layer 2, epoch 30, cost  0.883610292609
Pre-training layer 2, epoch 31, cost  0.857759241054
Pre-training layer 2, epoch 32, cost  0.831197623552
Pre-training layer 2, epoch 33, cost  0.808851589308
Pre-training layer 2, epoch 34, cost  0.80863849435
Pre-training layer 2, epoch 35, cost  0.814260729275
Pre-training layer 2, epoch 36, cost  0.810646825482
Pre-training layer 2, epoch 37, cost  0.790488998756
Pre-training layer 2, epoch 38, cost  0.754344130511
Pre-training layer 2, epoch 39, cost  0.666439454893
Pre-training layer 2, epoch 40, cost  0.648944011227
Pre-training layer 2, epoch 41, cost  0.734461046801
Pre-training layer 2, epoch 42, cost  0.734540172372
Pre-training layer 2, epoch 43, cost  0.712678145927
Pre-training layer 2, epoch 44, cost  0.657987878417
Pre-training layer 2, epoch 45, cost  0.578255023272
Pre-training layer 2, epoch 46, cost  0.631976922038
Pre-training layer 2, epoch 47, cost  0.685346296667
Pre-training layer 2, epoch 48, cost  0.641712565301
Pre-training layer 2, epoch 49, cost  0.572617815699
Pre-training layer 3, epoch 0, cost  16.9768821875
Pre-training layer 3, epoch 1, cost  4.55004096478
Pre-training layer 3, epoch 2, cost  3.16279858876
Pre-training layer 3, epoch 3, cost  2.41514026917
Pre-training layer 3, epoch 4, cost  1.91970526687
Pre-training layer 3, epoch 5, cost  1.56484061783
Pre-training layer 3, epoch 6, cost  1.30632287882
Pre-training layer 3, epoch 7, cost  1.21225007172
Pre-training layer 3, epoch 8, cost  1.25281318565
Pre-training layer 3, epoch 9, cost  1.15995389451
Pre-training layer 3, epoch 10, cost  1.06138291342
Pre-training layer 3, epoch 11, cost  0.977395926088
Pre-training layer 3, epoch 12, cost  0.92095800989
Pre-training layer 3, epoch 13, cost  0.892732046239
Pre-training layer 3, epoch 14, cost  0.872294288748
Pre-training layer 3, epoch 15, cost  0.823027355533
Pre-training layer 3, epoch 16, cost  0.781089509286
Pre-training layer 3, epoch 17, cost  0.742429432866
Pre-training layer 3, epoch 18, cost  0.707462383308
Pre-training layer 3, epoch 19, cost  0.67385774792
Pre-training layer 3, epoch 20, cost  0.642557048966
Pre-training layer 3, epoch 21, cost  0.613441344194
Pre-training layer 3, epoch 22, cost  0.580708288775
Pre-training layer 3, epoch 23, cost  0.557490114197
Pre-training layer 3, epoch 24, cost  0.554766305616
Pre-training layer 3, epoch 25, cost  0.561193859242
Pre-training layer 3, epoch 26, cost  0.53644199907
Pre-training layer 3, epoch 27, cost  0.51358307858
Pre-training layer 3, epoch 28, cost  0.493718414473
Pre-training layer 3, epoch 29, cost  0.474501308579
Pre-training layer 3, epoch 30, cost  0.456458266247
Pre-training layer 3, epoch 31, cost  0.440302597572
Pre-training layer 3, epoch 32, cost  0.430483474019
Pre-training layer 3, epoch 33, cost  0.427889175299
Pre-training layer 3, epoch 34, cost  0.424832794732
Pre-training layer 3, epoch 35, cost  0.398629926167
Pre-training layer 3, epoch 36, cost  0.377645151573
Pre-training layer 3, epoch 37, cost  0.406033971144
Pre-training layer 3, epoch 38, cost  0.396561212429
Pre-training layer 3, epoch 39, cost  0.383518187402
Pre-training layer 3, epoch 40, cost  0.36721133326
Pre-training layer 3, epoch 41, cost  0.346177436781
Pre-training layer 3, epoch 42, cost  0.331876057775
Pre-training layer 3, epoch 43, cost  0.337106331119
Pre-training layer 3, epoch 44, cost  0.342845518118
Pre-training layer 3, epoch 45, cost  0.327366947835
Pre-training layer 3, epoch 46, cost  0.274384553143
Pre-training layer 3, epoch 47, cost  0.296190390459
Pre-training layer 3, epoch 48, cost  0.346885621673
Pre-training layer 3, epoch 49, cost  0.267823765078
Pre-training layer 4, epoch 0, cost  18.4247088411
Pre-training layer 4, epoch 1, cost  5.33181777088
Pre-training layer 4, epoch 2, cost  3.74249693058
Pre-training layer 4, epoch 3, cost  2.86177700424
Pre-training layer 4, epoch 4, cost  2.31048471792
Pre-training layer 4, epoch 5, cost  1.9576976101
Pre-training layer 4, epoch 6, cost  1.95100047231
Pre-training layer 4, epoch 7, cost  1.80303143272
Pre-training layer 4, epoch 8, cost  1.70964965699
Pre-training layer 4, epoch 9, cost  1.63237332641
Pre-training layer 4, epoch 10, cost  1.56351457497
Pre-training layer 4, epoch 11, cost  1.49902469846
Pre-training layer 4, epoch 12, cost  1.4415502558
Pre-training layer 4, epoch 13, cost  1.39640624863
Pre-training layer 4, epoch 14, cost  1.36425294966
Pre-training layer 4, epoch 15, cost  1.34323228416
Pre-training layer 4, epoch 16, cost  1.3249590012
Pre-training layer 4, epoch 17, cost  1.30181202609
Pre-training layer 4, epoch 18, cost  1.26985254121
Pre-training layer 4, epoch 19, cost  1.24466407152
Pre-training layer 4, epoch 20, cost  1.23830802406
Pre-training layer 4, epoch 21, cost  1.23433602626
Pre-training layer 4, epoch 22, cost  1.21666940315
Pre-training layer 4, epoch 23, cost  1.18109796839
Pre-training layer 4, epoch 24, cost  1.17191698743
Pre-training layer 4, epoch 25, cost  1.19051699379
Pre-training layer 4, epoch 26, cost  1.17695345862
Pre-training layer 4, epoch 27, cost  1.11430301024
Pre-training layer 4, epoch 28, cost  1.14655841602
Pre-training layer 4, epoch 29, cost  1.16552565654
Pre-training layer 4, epoch 30, cost  1.09039851638
Pre-training layer 4, epoch 31, cost  1.10915743338
Pre-training layer 4, epoch 32, cost  1.14004949634
Pre-training layer 4, epoch 33, cost  1.06809773174
Pre-training layer 4, epoch 34, cost  1.08632335786
Pre-training layer 4, epoch 35, cost  1.11662946532
Pre-training layer 4, epoch 36, cost  1.03280418902
Pre-training layer 4, epoch 37, cost  1.09158749328
Pre-training layer 4, epoch 38, cost  1.08152474221
Pre-training layer 4, epoch 39, cost  1.02522703003
Pre-training layer 4, epoch 40, cost  1.08799466657
Pre-training layer 4, epoch 41, cost  1.02896311263
Pre-training layer 4, epoch 42, cost  1.04710254254
Pre-training layer 4, epoch 43, cost  1.0522169998
Pre-training layer 4, epoch 44, cost  1.00973669118
Pre-training layer 4, epoch 45, cost  1.0511303867
Pre-training layer 4, epoch 46, cost  1.0043842914
Pre-training layer 4, epoch 47, cost  1.03276093593
Pre-training layer 4, epoch 48, cost  1.01123397084
Pre-training layer 4, epoch 49, cost  1.01208616236
Pre-training layer 5, epoch 0, cost  19.7748887294
Pre-training layer 5, epoch 1, cost  6.86476030228
Pre-training layer 5, epoch 2, cost  5.59744740874
Pre-training layer 5, epoch 3, cost  5.40838573322
Pre-training layer 5, epoch 4, cost  5.34642617001
Pre-training layer 5, epoch 5, cost  5.31690608612
Pre-training layer 5, epoch 6, cost  5.30056867514
Pre-training layer 5, epoch 7, cost  5.29032330839
Pre-training layer 5, epoch 8, cost  5.28330084744
Pre-training layer 5, epoch 9, cost  5.27788695989
Pre-training layer 5, epoch 10, cost  5.27351558663
Pre-training layer 5, epoch 11, cost  5.26987718051
Pre-training layer 5, epoch 12, cost  5.26672523068
Pre-training layer 5, epoch 13, cost  5.26411397865
Pre-training layer 5, epoch 14, cost  5.26183640049
Pre-training layer 5, epoch 15, cost  5.25970400272
Pre-training layer 5, epoch 16, cost  5.25786310047
Pre-training layer 5, epoch 17, cost  5.25621355452
Pre-training layer 5, epoch 18, cost  5.25464595358
Pre-training layer 5, epoch 19, cost  5.25319291551
Pre-training layer 5, epoch 20, cost  5.25171276415
Pre-training layer 5, epoch 21, cost  5.25041557837
Pre-training layer 5, epoch 22, cost  5.24906824297
Pre-training layer 5, epoch 23, cost  5.24786483698
Pre-training layer 5, epoch 24, cost  5.24663824961
Pre-training layer 5, epoch 25, cost  5.2454465486
Pre-training layer 5, epoch 26, cost  5.24430323644
Pre-training layer 5, epoch 27, cost  5.24321571305
Pre-training layer 5, epoch 28, cost  5.24216327583
Pre-training layer 5, epoch 29, cost  5.24116412317
Pre-training layer 5, epoch 30, cost  5.24017788548
Pre-training layer 5, epoch 31, cost  5.23920392322
Pre-training layer 5, epoch 32, cost  5.23825925848
Pre-training layer 5, epoch 33, cost  5.23736333147
Pre-training layer 5, epoch 34, cost  5.23648794878
Pre-training layer 5, epoch 35, cost  5.23565264836
Pre-training layer 5, epoch 36, cost  5.23486133348
Pre-training layer 5, epoch 37, cost  5.23407250132
Pre-training layer 5, epoch 38, cost  5.23329771373
Pre-training layer 5, epoch 39, cost  5.23254914204
Pre-training layer 5, epoch 40, cost  5.23181665372
Pre-training layer 5, epoch 41, cost  5.23111414805
Pre-training layer 5, epoch 42, cost  5.2304419914
Pre-training layer 5, epoch 43, cost  5.22976876089
Pre-training layer 5, epoch 44, cost  5.22911011808
Pre-training layer 5, epoch 45, cost  5.22845996507
Pre-training layer 5, epoch 46, cost  5.22784886915
Pre-training layer 5, epoch 47, cost  5.2272407217
Pre-training layer 5, epoch 48, cost  5.22666331863
Pre-training layer 5, epoch 49, cost  5.22608166356
The pretraining code for file multi_layer_km.pyc ran for 7.06m
Initial NMI for deep clustering: 0.53
ARI for deep clustering: 0.41
ACC for deep clustering: 0.55
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.89622, Reconstruction: 1.98125, Clustering: 0.91497, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.20270, Reconstruction: 1.72941, Clustering: 0.47329, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.09963, Reconstruction: 1.67398, Clustering: 0.42565, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.04467, Reconstruction: 1.63314, Clustering: 0.41153, 
Fine-tuning epoch 5 ++++ 
Total cost: 1.98167, Reconstruction: 1.58768, Clustering: 0.39399, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.93340, Reconstruction: 1.55142, Clustering: 0.38198, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.90039, Reconstruction: 1.52941, Clustering: 0.37098, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.84969, Reconstruction: 1.48971, Clustering: 0.35998, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.80637, Reconstruction: 1.45907, Clustering: 0.34730, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.78295, Reconstruction: 1.44204, Clustering: 0.34092, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.74714, Reconstruction: 1.41676, Clustering: 0.33038, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.70854, Reconstruction: 1.38283, Clustering: 0.32571, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.68826, Reconstruction: 1.37131, Clustering: 0.31695, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.66095, Reconstruction: 1.34712, Clustering: 0.31383, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.63454, Reconstruction: 1.32451, Clustering: 0.31003, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.62947, Reconstruction: 1.31913, Clustering: 0.31033, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.58698, Reconstruction: 1.28610, Clustering: 0.30088, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.56517, Reconstruction: 1.26839, Clustering: 0.29678, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.55091, Reconstruction: 1.25630, Clustering: 0.29461, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.50403, Reconstruction: 1.21789, Clustering: 0.28614, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.49865, Reconstruction: 1.21190, Clustering: 0.28675, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.49085, Reconstruction: 1.20511, Clustering: 0.28574, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.45477, Reconstruction: 1.17525, Clustering: 0.27951, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.44530, Reconstruction: 1.16323, Clustering: 0.28206, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.45653, Reconstruction: 1.17376, Clustering: 0.28277, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.44367, Reconstruction: 1.15979, Clustering: 0.28388, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.40509, Reconstruction: 1.12921, Clustering: 0.27588, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.39227, Reconstruction: 1.11618, Clustering: 0.27609, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.37838, Reconstruction: 1.10782, Clustering: 0.27055, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.36744, Reconstruction: 1.09580, Clustering: 0.27165, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.34097, Reconstruction: 1.07301, Clustering: 0.26796, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.34187, Reconstruction: 1.07553, Clustering: 0.26634, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.31935, Reconstruction: 1.05710, Clustering: 0.26225, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.33186, Reconstruction: 1.06170, Clustering: 0.27016, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.33248, Reconstruction: 1.05999, Clustering: 0.27249, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.29908, Reconstruction: 1.03640, Clustering: 0.26268, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.28659, Reconstruction: 1.02355, Clustering: 0.26304, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.28569, Reconstruction: 1.02063, Clustering: 0.26506, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.26927, Reconstruction: 1.00533, Clustering: 0.26394, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.27289, Reconstruction: 1.00952, Clustering: 0.26337, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.25553, Reconstruction: 0.99348, Clustering: 0.26205, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.25029, Reconstruction: 0.98782, Clustering: 0.26247, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.24584, Reconstruction: 0.98101, Clustering: 0.26483, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.24501, Reconstruction: 0.98124, Clustering: 0.26377, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.24276, Reconstruction: 0.97896, Clustering: 0.26380, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.21597, Reconstruction: 0.95443, Clustering: 0.26154, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.21736, Reconstruction: 0.95789, Clustering: 0.25947, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.22429, Reconstruction: 0.95978, Clustering: 0.26452, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.21254, Reconstruction: 0.95261, Clustering: 0.25993, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.20592, Reconstruction: 0.94495, Clustering: 0.26096, 
Average squared 2-D reconstruction error: 0.9450
NMI for deep clustering: 0.56
ARI for deep clustering: 0.42
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 6.88m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  10.9392588634
Pre-training layer 0, epoch 1, cost  2.79479343718
Pre-training layer 0, epoch 2, cost  1.96601101877
Pre-training layer 0, epoch 3, cost  1.56046520534
Pre-training layer 0, epoch 4, cost  1.31446362034
Pre-training layer 0, epoch 5, cost  1.14962721383
Pre-training layer 0, epoch 6, cost  1.03160113522
Pre-training layer 0, epoch 7, cost  0.943015294559
Pre-training layer 0, epoch 8, cost  0.873985098772
Pre-training layer 0, epoch 9, cost  0.818888597702
Pre-training layer 0, epoch 10, cost  0.773204054404
Pre-training layer 0, epoch 11, cost  0.734278655951
Pre-training layer 0, epoch 12, cost  0.701830290546
Pre-training layer 0, epoch 13, cost  0.674224167245
Pre-training layer 0, epoch 14, cost  0.65028403344
Pre-training layer 0, epoch 15, cost  0.629101352474
Pre-training layer 0, epoch 16, cost  0.61018325576
Pre-training layer 0, epoch 17, cost  0.593429023664
Pre-training layer 0, epoch 18, cost  0.578271552663
Pre-training layer 0, epoch 19, cost  0.564528787837
Pre-training layer 0, epoch 20, cost  0.552017333241
Pre-training layer 0, epoch 21, cost  0.540526836862
Pre-training layer 0, epoch 22, cost  0.529960056507
Pre-training layer 0, epoch 23, cost  0.520155216936
Pre-training layer 0, epoch 24, cost  0.511073195086
Pre-training layer 0, epoch 25, cost  0.502579973647
Pre-training layer 0, epoch 26, cost  0.494662638037
Pre-training layer 0, epoch 27, cost  0.487168762916
Pre-training layer 0, epoch 28, cost  0.480153393503
Pre-training layer 0, epoch 29, cost  0.473510634645
Pre-training layer 0, epoch 30, cost  0.467266183879
Pre-training layer 0, epoch 31, cost  0.461337766465
Pre-training layer 0, epoch 32, cost  0.455684368128
Pre-training layer 0, epoch 33, cost  0.450322533347
Pre-training layer 0, epoch 34, cost  0.445221620451
Pre-training layer 0, epoch 35, cost  0.440361688852
Pre-training layer 0, epoch 36, cost  0.43562728346
Pre-training layer 0, epoch 37, cost  0.431097890057
Pre-training layer 0, epoch 38, cost  0.426813948828
Pre-training layer 0, epoch 39, cost  0.422700542551
Pre-training layer 0, epoch 40, cost  0.418769569137
Pre-training layer 0, epoch 41, cost  0.414970296082
Pre-training layer 0, epoch 42, cost  0.411325347758
Pre-training layer 0, epoch 43, cost  0.407793340315
Pre-training layer 0, epoch 44, cost  0.404388658413
Pre-training layer 0, epoch 45, cost  0.40108508198
Pre-training layer 0, epoch 46, cost  0.397908158389
Pre-training layer 0, epoch 47, cost  0.39484461438
Pre-training layer 0, epoch 48, cost  0.391869130162
Pre-training layer 0, epoch 49, cost  0.388968283842
Pre-training layer 1, epoch 0, cost  16.1976611459
Pre-training layer 1, epoch 1, cost  4.87534938585
Pre-training layer 1, epoch 2, cost  3.29933559821
Pre-training layer 1, epoch 3, cost  2.50764680303
Pre-training layer 1, epoch 4, cost  2.01558554147
Pre-training layer 1, epoch 5, cost  1.68104596111
Pre-training layer 1, epoch 6, cost  1.4443610093
Pre-training layer 1, epoch 7, cost  1.28076496338
Pre-training layer 1, epoch 8, cost  1.20310631864
Pre-training layer 1, epoch 9, cost  1.16936504684
Pre-training layer 1, epoch 10, cost  1.1176712838
Pre-training layer 1, epoch 11, cost  1.0607593365
Pre-training layer 1, epoch 12, cost  1.00929699654
Pre-training layer 1, epoch 13, cost  0.966296854117
Pre-training layer 1, epoch 14, cost  0.924603313474
Pre-training layer 1, epoch 15, cost  0.895547115048
Pre-training layer 1, epoch 16, cost  0.864045408746
Pre-training layer 1, epoch 17, cost  0.84119565173
Pre-training layer 1, epoch 18, cost  0.82003350275
Pre-training layer 1, epoch 19, cost  0.798734367017
Pre-training layer 1, epoch 20, cost  0.779182637594
Pre-training layer 1, epoch 21, cost  0.759346227921
Pre-training layer 1, epoch 22, cost  0.738311912527
Pre-training layer 1, epoch 23, cost  0.725965606242
Pre-training layer 1, epoch 24, cost  0.71002590545
Pre-training layer 1, epoch 25, cost  0.704150409261
Pre-training layer 1, epoch 26, cost  0.691755260449
Pre-training layer 1, epoch 27, cost  0.676736997211
Pre-training layer 1, epoch 28, cost  0.6645520238
Pre-training layer 1, epoch 29, cost  0.651394636746
Pre-training layer 1, epoch 30, cost  0.641239361849
Pre-training layer 1, epoch 31, cost  0.629260285751
Pre-training layer 1, epoch 32, cost  0.620595613093
Pre-training layer 1, epoch 33, cost  0.614309142888
Pre-training layer 1, epoch 34, cost  0.609789180775
Pre-training layer 1, epoch 35, cost  0.602961345025
Pre-training layer 1, epoch 36, cost  0.596797341582
Pre-training layer 1, epoch 37, cost  0.585885320023
Pre-training layer 1, epoch 38, cost  0.578851849771
Pre-training layer 1, epoch 39, cost  0.572676144606
Pre-training layer 1, epoch 40, cost  0.565001313892
Pre-training layer 1, epoch 41, cost  0.559114735776
Pre-training layer 1, epoch 42, cost  0.554489941002
Pre-training layer 1, epoch 43, cost  0.553045212942
Pre-training layer 1, epoch 44, cost  0.54716729518
Pre-training layer 1, epoch 45, cost  0.538967251622
Pre-training layer 1, epoch 46, cost  0.534852162548
Pre-training layer 1, epoch 47, cost  0.531725266436
Pre-training layer 1, epoch 48, cost  0.525290055392
Pre-training layer 1, epoch 49, cost  0.519004158392
Pre-training layer 2, epoch 0, cost  19.953430722
Pre-training layer 2, epoch 1, cost  5.54559647212
Pre-training layer 2, epoch 2, cost  3.9587856883
Pre-training layer 2, epoch 3, cost  3.09232243586
Pre-training layer 2, epoch 4, cost  2.5168786329
Pre-training layer 2, epoch 5, cost  2.11940051866
Pre-training layer 2, epoch 6, cost  2.0520307736
Pre-training layer 2, epoch 7, cost  1.99073685344
Pre-training layer 2, epoch 8, cost  1.87826054463
Pre-training layer 2, epoch 9, cost  1.79141404873
Pre-training layer 2, epoch 10, cost  1.72623260298
Pre-training layer 2, epoch 11, cost  1.6319324379
Pre-training layer 2, epoch 12, cost  1.56025148029
Pre-training layer 2, epoch 13, cost  1.48009024816
Pre-training layer 2, epoch 14, cost  1.40946889808
Pre-training layer 2, epoch 15, cost  1.34334970272
Pre-training layer 2, epoch 16, cost  1.28491030951
Pre-training layer 2, epoch 17, cost  1.27575457744
Pre-training layer 2, epoch 18, cost  1.28007599621
Pre-training layer 2, epoch 19, cost  1.21936724129
Pre-training layer 2, epoch 20, cost  1.16786614874
Pre-training layer 2, epoch 21, cost  1.13398612958
Pre-training layer 2, epoch 22, cost  1.0983584061
Pre-training layer 2, epoch 23, cost  1.05914098335
Pre-training layer 2, epoch 24, cost  1.01713297112
Pre-training layer 2, epoch 25, cost  1.00289564613
Pre-training layer 2, epoch 26, cost  0.969102014157
Pre-training layer 2, epoch 27, cost  0.929493183887
Pre-training layer 2, epoch 28, cost  0.879479855494
Pre-training layer 2, epoch 29, cost  0.85694763259
Pre-training layer 2, epoch 30, cost  0.848424738656
Pre-training layer 2, epoch 31, cost  0.855098130998
Pre-training layer 2, epoch 32, cost  0.844892053356
Pre-training layer 2, epoch 33, cost  0.82369308778
Pre-training layer 2, epoch 34, cost  0.802108390133
Pre-training layer 2, epoch 35, cost  0.779205085261
Pre-training layer 2, epoch 36, cost  0.739825969017
Pre-training layer 2, epoch 37, cost  0.736887847014
Pre-training layer 2, epoch 38, cost  0.749062764072
Pre-training layer 2, epoch 39, cost  0.753714865022
Pre-training layer 2, epoch 40, cost  0.743978304623
Pre-training layer 2, epoch 41, cost  0.727179188155
Pre-training layer 2, epoch 42, cost  0.685268364081
Pre-training layer 2, epoch 43, cost  0.557137584642
Pre-training layer 2, epoch 44, cost  0.681149777701
Pre-training layer 2, epoch 45, cost  0.710969905174
Pre-training layer 2, epoch 46, cost  0.695683013976
Pre-training layer 2, epoch 47, cost  0.523441574543
Pre-training layer 2, epoch 48, cost  0.602385660799
Pre-training layer 2, epoch 49, cost  0.666724589412
Pre-training layer 3, epoch 0, cost  17.0741548433
Pre-training layer 3, epoch 1, cost  4.56511372568
Pre-training layer 3, epoch 2, cost  3.16271213305
Pre-training layer 3, epoch 3, cost  2.41732252711
Pre-training layer 3, epoch 4, cost  1.92399507817
Pre-training layer 3, epoch 5, cost  1.57077829905
Pre-training layer 3, epoch 6, cost  1.31429135678
Pre-training layer 3, epoch 7, cost  1.23048820957
Pre-training layer 3, epoch 8, cost  1.2551493546
Pre-training layer 3, epoch 9, cost  1.16341805108
Pre-training layer 3, epoch 10, cost  1.0610574838
Pre-training layer 3, epoch 11, cost  0.973781951265
Pre-training layer 3, epoch 12, cost  0.948150249766
Pre-training layer 3, epoch 13, cost  0.902094758683
Pre-training layer 3, epoch 14, cost  0.863806552699
Pre-training layer 3, epoch 15, cost  0.806312136125
Pre-training layer 3, epoch 16, cost  0.757828378766
Pre-training layer 3, epoch 17, cost  0.73019422856
Pre-training layer 3, epoch 18, cost  0.706234520856
Pre-training layer 3, epoch 19, cost  0.679614017876
Pre-training layer 3, epoch 20, cost  0.657022363875
Pre-training layer 3, epoch 21, cost  0.652422078661
Pre-training layer 3, epoch 22, cost  0.619627918069
Pre-training layer 3, epoch 23, cost  0.577224642988
Pre-training layer 3, epoch 24, cost  0.531437487869
Pre-training layer 3, epoch 25, cost  0.51375407245
Pre-training layer 3, epoch 26, cost  0.527359370929
Pre-training layer 3, epoch 27, cost  0.534737718037
Pre-training layer 3, epoch 28, cost  0.528846074196
Pre-training layer 3, epoch 29, cost  0.44751238172
Pre-training layer 3, epoch 30, cost  0.437012059367
Pre-training layer 3, epoch 31, cost  0.467204272919
Pre-training layer 3, epoch 32, cost  0.473979641736
Pre-training layer 3, epoch 33, cost  0.456414294104
Pre-training layer 3, epoch 34, cost  0.433850882772
Pre-training layer 3, epoch 35, cost  0.396643846099
Pre-training layer 3, epoch 36, cost  0.356566664465
Pre-training layer 3, epoch 37, cost  0.379522784426
Pre-training layer 3, epoch 38, cost  0.410344562332
Pre-training layer 3, epoch 39, cost  0.403073087462
Pre-training layer 3, epoch 40, cost  0.274512249559
Pre-training layer 3, epoch 41, cost  0.335538516857
Pre-training layer 3, epoch 42, cost  0.430308253394
Pre-training layer 3, epoch 43, cost  0.352400455917
Pre-training layer 3, epoch 44, cost  0.273561962631
Pre-training layer 3, epoch 45, cost  0.318486953288
Pre-training layer 3, epoch 46, cost  0.352154323547
Pre-training layer 3, epoch 47, cost  0.33382269065
Pre-training layer 3, epoch 48, cost  0.231315669393
Pre-training layer 3, epoch 49, cost  0.299451275951
Pre-training layer 4, epoch 0, cost  18.7530225465
Pre-training layer 4, epoch 1, cost  5.43827445107
Pre-training layer 4, epoch 2, cost  3.786822306
Pre-training layer 4, epoch 3, cost  2.89756902908
Pre-training layer 4, epoch 4, cost  2.33404596884
Pre-training layer 4, epoch 5, cost  1.96813984952
Pre-training layer 4, epoch 6, cost  1.82759235096
Pre-training layer 4, epoch 7, cost  1.81418978118
Pre-training layer 4, epoch 8, cost  1.69853564264
Pre-training layer 4, epoch 9, cost  1.59679248095
Pre-training layer 4, epoch 10, cost  1.51465175506
Pre-training layer 4, epoch 11, cost  1.45715724675
Pre-training layer 4, epoch 12, cost  1.41922430739
Pre-training layer 4, epoch 13, cost  1.38396441105
Pre-training layer 4, epoch 14, cost  1.3465369232
Pre-training layer 4, epoch 15, cost  1.311881078
Pre-training layer 4, epoch 16, cost  1.29180722772
Pre-training layer 4, epoch 17, cost  1.2778694978
Pre-training layer 4, epoch 18, cost  1.26019800574
Pre-training layer 4, epoch 19, cost  1.23517268718
Pre-training layer 4, epoch 20, cost  1.21472501705
Pre-training layer 4, epoch 21, cost  1.21470570166
Pre-training layer 4, epoch 22, cost  1.2070357714
Pre-training layer 4, epoch 23, cost  1.17676028169
Pre-training layer 4, epoch 24, cost  1.16052126991
Pre-training layer 4, epoch 25, cost  1.17416359354
Pre-training layer 4, epoch 26, cost  1.15869706097
Pre-training layer 4, epoch 27, cost  1.11650765495
Pre-training layer 4, epoch 28, cost  1.14259335364
Pre-training layer 4, epoch 29, cost  1.14040440478
Pre-training layer 4, epoch 30, cost  1.08356927188
Pre-training layer 4, epoch 31, cost  1.12280246384
Pre-training layer 4, epoch 32, cost  1.11821188171
Pre-training layer 4, epoch 33, cost  1.05613129791
Pre-training layer 4, epoch 34, cost  1.11321607715
Pre-training layer 4, epoch 35, cost  1.08091343589
Pre-training layer 4, epoch 36, cost  1.05051379734
Pre-training layer 4, epoch 37, cost  1.0952819722
Pre-training layer 4, epoch 38, cost  1.03734200151
Pre-training layer 4, epoch 39, cost  1.06574549164
Pre-training layer 4, epoch 40, cost  1.06303106354
Pre-training layer 4, epoch 41, cost  1.02643171769
Pre-training layer 4, epoch 42, cost  1.065706387
Pre-training layer 4, epoch 43, cost  1.01379660146
Pre-training layer 4, epoch 44, cost  1.05054548484
Pre-training layer 4, epoch 45, cost  1.02051240846
Pre-training layer 4, epoch 46, cost  1.02810441665
Pre-training layer 4, epoch 47, cost  1.0260790334
Pre-training layer 4, epoch 48, cost  1.00839610646
Pre-training layer 4, epoch 49, cost  1.02635345247
Pre-training layer 5, epoch 0, cost  20.0668293096
Pre-training layer 5, epoch 1, cost  7.03015540969
Pre-training layer 5, epoch 2, cost  5.72564293841
Pre-training layer 5, epoch 3, cost  5.54026000571
Pre-training layer 5, epoch 4, cost  5.48786098342
Pre-training layer 5, epoch 5, cost  5.46494031313
Pre-training layer 5, epoch 6, cost  5.45254177045
Pre-training layer 5, epoch 7, cost  5.44477204431
Pre-training layer 5, epoch 8, cost  5.43959846333
Pre-training layer 5, epoch 9, cost  5.43599456553
Pre-training layer 5, epoch 10, cost  5.43327492652
Pre-training layer 5, epoch 11, cost  5.43108379774
Pre-training layer 5, epoch 12, cost  5.42931738761
Pre-training layer 5, epoch 13, cost  5.42772543883
Pre-training layer 5, epoch 14, cost  5.42619837838
Pre-training layer 5, epoch 15, cost  5.42462003478
Pre-training layer 5, epoch 16, cost  5.42314197626
Pre-training layer 5, epoch 17, cost  5.42162411007
Pre-training layer 5, epoch 18, cost  5.42015786428
Pre-training layer 5, epoch 19, cost  5.41870945222
Pre-training layer 5, epoch 20, cost  5.41728300631
Pre-training layer 5, epoch 21, cost  5.41587956005
Pre-training layer 5, epoch 22, cost  5.41446022873
Pre-training layer 5, epoch 23, cost  5.41309241006
Pre-training layer 5, epoch 24, cost  5.41169856038
Pre-training layer 5, epoch 25, cost  5.41046028222
Pre-training layer 5, epoch 26, cost  5.40920906197
Pre-training layer 5, epoch 27, cost  5.40797740521
Pre-training layer 5, epoch 28, cost  5.40677255163
Pre-training layer 5, epoch 29, cost  5.40563041225
Pre-training layer 5, epoch 30, cost  5.40456121279
Pre-training layer 5, epoch 31, cost  5.40352136199
Pre-training layer 5, epoch 32, cost  5.4025189083
Pre-training layer 5, epoch 33, cost  5.40156117465
Pre-training layer 5, epoch 34, cost  5.40059228964
Pre-training layer 5, epoch 35, cost  5.39966078385
Pre-training layer 5, epoch 36, cost  5.39876138963
Pre-training layer 5, epoch 37, cost  5.39787971764
Pre-training layer 5, epoch 38, cost  5.39703867839
Pre-training layer 5, epoch 39, cost  5.39620629932
Pre-training layer 5, epoch 40, cost  5.3954089822
Pre-training layer 5, epoch 41, cost  5.3946501828
Pre-training layer 5, epoch 42, cost  5.39391600466
Pre-training layer 5, epoch 43, cost  5.39320897556
Pre-training layer 5, epoch 44, cost  5.39251076376
Pre-training layer 5, epoch 45, cost  5.39183418116
Pre-training layer 5, epoch 46, cost  5.39117830666
Pre-training layer 5, epoch 47, cost  5.39051113346
Pre-training layer 5, epoch 48, cost  5.38987788531
Pre-training layer 5, epoch 49, cost  5.38926657185
The pretraining code for file multi_layer_km.pyc ran for 6.96m
Initial NMI for deep clustering: 0.50
ARI for deep clustering: 0.36
... getting the finetuning functions
ACC for deep clustering: 0.51
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.91149, Reconstruction: 1.97199, Clustering: 0.93950, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.22856, Reconstruction: 1.72623, Clustering: 0.50233, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.12828, Reconstruction: 1.69494, Clustering: 0.43334, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.05034, Reconstruction: 1.64671, Clustering: 0.40362, 
Fine-tuning epoch 5 ++++ 
Total cost: 1.99566, Reconstruction: 1.60778, Clustering: 0.38788, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.94680, Reconstruction: 1.57320, Clustering: 0.37360, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.90840, Reconstruction: 1.54076, Clustering: 0.36763, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.86595, Reconstruction: 1.51342, Clustering: 0.35253, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.82166, Reconstruction: 1.47431, Clustering: 0.34735, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.81001, Reconstruction: 1.47169, Clustering: 0.33832, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.76604, Reconstruction: 1.43437, Clustering: 0.33168, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.74480, Reconstruction: 1.41881, Clustering: 0.32600, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.69970, Reconstruction: 1.38486, Clustering: 0.31484, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.67761, Reconstruction: 1.36768, Clustering: 0.30993, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.63303, Reconstruction: 1.32500, Clustering: 0.30803, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.65440, Reconstruction: 1.34501, Clustering: 0.30939, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.60016, Reconstruction: 1.30110, Clustering: 0.29906, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.58075, Reconstruction: 1.28399, Clustering: 0.29676, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.55662, Reconstruction: 1.26321, Clustering: 0.29341, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.55608, Reconstruction: 1.26439, Clustering: 0.29169, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.51002, Reconstruction: 1.22551, Clustering: 0.28451, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.51834, Reconstruction: 1.22808, Clustering: 0.29026, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.49363, Reconstruction: 1.20902, Clustering: 0.28460, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.44527, Reconstruction: 1.16998, Clustering: 0.27528, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.46458, Reconstruction: 1.18265, Clustering: 0.28193, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.42644, Reconstruction: 1.15051, Clustering: 0.27593, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.42078, Reconstruction: 1.14626, Clustering: 0.27452, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.42694, Reconstruction: 1.14646, Clustering: 0.28048, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.39864, Reconstruction: 1.12386, Clustering: 0.27478, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.39213, Reconstruction: 1.11603, Clustering: 0.27609, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.37791, Reconstruction: 1.10134, Clustering: 0.27657, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.38122, Reconstruction: 1.10543, Clustering: 0.27579, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.34212, Reconstruction: 1.07497, Clustering: 0.26715, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.33556, Reconstruction: 1.06726, Clustering: 0.26830, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.33214, Reconstruction: 1.06466, Clustering: 0.26749, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.33039, Reconstruction: 1.05882, Clustering: 0.27157, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.31492, Reconstruction: 1.04665, Clustering: 0.26827, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.30791, Reconstruction: 1.03925, Clustering: 0.26865, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.30107, Reconstruction: 1.03166, Clustering: 0.26941, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.27779, Reconstruction: 1.01332, Clustering: 0.26447, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.28066, Reconstruction: 1.01462, Clustering: 0.26604, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.27206, Reconstruction: 1.00813, Clustering: 0.26392, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.28572, Reconstruction: 1.01457, Clustering: 0.27115, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.27255, Reconstruction: 1.00188, Clustering: 0.27067, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.25717, Reconstruction: 0.98817, Clustering: 0.26900, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.24309, Reconstruction: 0.97946, Clustering: 0.26363, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.24758, Reconstruction: 0.97844, Clustering: 0.26914, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.22482, Reconstruction: 0.95766, Clustering: 0.26716, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.24840, Reconstruction: 0.97951, Clustering: 0.26889, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.20896, Reconstruction: 0.94683, Clustering: 0.26213, 
Average squared 2-D reconstruction error: 0.9468
NMI for deep clustering: 0.53
ARI for deep clustering: 0.38
ACC for deep clustering: 0.52
The training code for file multi_layer_km.pyc ran for 6.78m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  10.9711859097
Pre-training layer 0, epoch 1, cost  2.76907088851
Pre-training layer 0, epoch 2, cost  1.9521446256
Pre-training layer 0, epoch 3, cost  1.54981562329
Pre-training layer 0, epoch 4, cost  1.30562881621
Pre-training layer 0, epoch 5, cost  1.14147462073
Pre-training layer 0, epoch 6, cost  1.0238152208
Pre-training layer 0, epoch 7, cost  0.93560491242
Pre-training layer 0, epoch 8, cost  0.866989322127
Pre-training layer 0, epoch 9, cost  0.811925325289
Pre-training layer 0, epoch 10, cost  0.76694375233
Pre-training layer 0, epoch 11, cost  0.729504545035
Pre-training layer 0, epoch 12, cost  0.697827106955
Pre-training layer 0, epoch 13, cost  0.670638387202
Pre-training layer 0, epoch 14, cost  0.647011664823
Pre-training layer 0, epoch 15, cost  0.626159504827
Pre-training layer 0, epoch 16, cost  0.607622170388
Pre-training layer 0, epoch 17, cost  0.591118397432
Pre-training layer 0, epoch 18, cost  0.576302885964
Pre-training layer 0, epoch 19, cost  0.562809782415
Pre-training layer 0, epoch 20, cost  0.550485736451
Pre-training layer 0, epoch 21, cost  0.539168287381
Pre-training layer 0, epoch 22, cost  0.528777672469
Pre-training layer 0, epoch 23, cost  0.51915765856
Pre-training layer 0, epoch 24, cost  0.510193976278
Pre-training layer 0, epoch 25, cost  0.501895157935
Pre-training layer 0, epoch 26, cost  0.494095235229
Pre-training layer 0, epoch 27, cost  0.486798320579
Pre-training layer 0, epoch 28, cost  0.479866406599
Pre-training layer 0, epoch 29, cost  0.473351608642
Pre-training layer 0, epoch 30, cost  0.4669678581
Pre-training layer 0, epoch 31, cost  0.460930236644
Pre-training layer 0, epoch 32, cost  0.455330712642
Pre-training layer 0, epoch 33, cost  0.450013892489
Pre-training layer 0, epoch 34, cost  0.444969526773
Pre-training layer 0, epoch 35, cost  0.440142665593
Pre-training layer 0, epoch 36, cost  0.435558593787
Pre-training layer 0, epoch 37, cost  0.431184697041
Pre-training layer 0, epoch 38, cost  0.426980956785
Pre-training layer 0, epoch 39, cost  0.422967904174
Pre-training layer 0, epoch 40, cost  0.419130949147
Pre-training layer 0, epoch 41, cost  0.415395799909
Pre-training layer 0, epoch 42, cost  0.411766832562
Pre-training layer 0, epoch 43, cost  0.408186687483
Pre-training layer 0, epoch 44, cost  0.404821307916
Pre-training layer 0, epoch 45, cost  0.401575809575
Pre-training layer 0, epoch 46, cost  0.398451941474
Pre-training layer 0, epoch 47, cost  0.395419112173
Pre-training layer 0, epoch 48, cost  0.392435809001
Pre-training layer 0, epoch 49, cost  0.38959947184
Pre-training layer 1, epoch 0, cost  16.1386800328
Pre-training layer 1, epoch 1, cost  4.8211508942
Pre-training layer 1, epoch 2, cost  3.26604519163
Pre-training layer 1, epoch 3, cost  2.48617253174
Pre-training layer 1, epoch 4, cost  1.9998780734
Pre-training layer 1, epoch 5, cost  1.66776253633
Pre-training layer 1, epoch 6, cost  1.4321984329
Pre-training layer 1, epoch 7, cost  1.2708346985
Pre-training layer 1, epoch 8, cost  1.19740284367
Pre-training layer 1, epoch 9, cost  1.16715429541
Pre-training layer 1, epoch 10, cost  1.11112638283
Pre-training layer 1, epoch 11, cost  1.05549179809
Pre-training layer 1, epoch 12, cost  1.00461872144
Pre-training layer 1, epoch 13, cost  0.960979434773
Pre-training layer 1, epoch 14, cost  0.921881398315
Pre-training layer 1, epoch 15, cost  0.889755572889
Pre-training layer 1, epoch 16, cost  0.86545196282
Pre-training layer 1, epoch 17, cost  0.835894348711
Pre-training layer 1, epoch 18, cost  0.811037324495
Pre-training layer 1, epoch 19, cost  0.792634635988
Pre-training layer 1, epoch 20, cost  0.775150014116
Pre-training layer 1, epoch 21, cost  0.75713367837
Pre-training layer 1, epoch 22, cost  0.74312004712
Pre-training layer 1, epoch 23, cost  0.723838537611
Pre-training layer 1, epoch 24, cost  0.706946606294
Pre-training layer 1, epoch 25, cost  0.697972718356
Pre-training layer 1, epoch 26, cost  0.680933869848
Pre-training layer 1, epoch 27, cost  0.667552541703
Pre-training layer 1, epoch 28, cost  0.655384284956
Pre-training layer 1, epoch 29, cost  0.651398717235
Pre-training layer 1, epoch 30, cost  0.643131107398
Pre-training layer 1, epoch 31, cost  0.631774302569
Pre-training layer 1, epoch 32, cost  0.6243896373
Pre-training layer 1, epoch 33, cost  0.612394290228
Pre-training layer 1, epoch 34, cost  0.602934114834
Pre-training layer 1, epoch 35, cost  0.597143059111
Pre-training layer 1, epoch 36, cost  0.589085121425
Pre-training layer 1, epoch 37, cost  0.586070918538
Pre-training layer 1, epoch 38, cost  0.5783274848
Pre-training layer 1, epoch 39, cost  0.569390538794
Pre-training layer 1, epoch 40, cost  0.569191377994
Pre-training layer 1, epoch 41, cost  0.559483942616
Pre-training layer 1, epoch 42, cost  0.553045637139
Pre-training layer 1, epoch 43, cost  0.545764044362
Pre-training layer 1, epoch 44, cost  0.545664677127
Pre-training layer 1, epoch 45, cost  0.537136805909
Pre-training layer 1, epoch 46, cost  0.53459216554
Pre-training layer 1, epoch 47, cost  0.530087790137
Pre-training layer 1, epoch 48, cost  0.522518097392
Pre-training layer 1, epoch 49, cost  0.521613862521
Pre-training layer 2, epoch 0, cost  19.795617677
Pre-training layer 2, epoch 1, cost  5.49373579555
Pre-training layer 2, epoch 2, cost  3.9173414193
Pre-training layer 2, epoch 3, cost  3.05669845309
Pre-training layer 2, epoch 4, cost  2.48880590291
Pre-training layer 2, epoch 5, cost  2.10094257035
Pre-training layer 2, epoch 6, cost  2.11293248895
Pre-training layer 2, epoch 7, cost  1.99667679876
Pre-training layer 2, epoch 8, cost  1.88944891432
Pre-training layer 2, epoch 9, cost  1.79406752019
Pre-training layer 2, epoch 10, cost  1.69913694137
Pre-training layer 2, epoch 11, cost  1.62647158209
Pre-training layer 2, epoch 12, cost  1.56839682123
Pre-training layer 2, epoch 13, cost  1.48316053204
Pre-training layer 2, epoch 14, cost  1.41867590773
Pre-training layer 2, epoch 15, cost  1.35638245357
Pre-training layer 2, epoch 16, cost  1.30402054121
Pre-training layer 2, epoch 17, cost  1.27343011315
Pre-training layer 2, epoch 18, cost  1.23023085321
Pre-training layer 2, epoch 19, cost  1.19281230726
Pre-training layer 2, epoch 20, cost  1.15684418566
Pre-training layer 2, epoch 21, cost  1.11815203271
Pre-training layer 2, epoch 22, cost  1.08568103165
Pre-training layer 2, epoch 23, cost  1.06052309795
Pre-training layer 2, epoch 24, cost  1.02657418238
Pre-training layer 2, epoch 25, cost  0.971641880294
Pre-training layer 2, epoch 26, cost  0.934113405523
Pre-training layer 2, epoch 27, cost  0.923602467382
Pre-training layer 2, epoch 28, cost  0.917419222261
Pre-training layer 2, epoch 29, cost  0.893546729015
Pre-training layer 2, epoch 30, cost  0.870450924514
Pre-training layer 2, epoch 31, cost  0.876839634588
Pre-training layer 2, epoch 32, cost  0.849296346945
Pre-training layer 2, epoch 33, cost  0.811935106724
Pre-training layer 2, epoch 34, cost  0.771387002141
Pre-training layer 2, epoch 35, cost  0.738067366224
Pre-training layer 2, epoch 36, cost  0.760007993603
Pre-training layer 2, epoch 37, cost  0.782068339801
Pre-training layer 2, epoch 38, cost  0.778536305377
Pre-training layer 2, epoch 39, cost  0.722934290521
Pre-training layer 2, epoch 40, cost  0.650217917235
Pre-training layer 2, epoch 41, cost  0.670865998715
Pre-training layer 2, epoch 42, cost  0.694898447641
Pre-training layer 2, epoch 43, cost  0.713307875554
Pre-training layer 2, epoch 44, cost  0.709147178316
Pre-training layer 2, epoch 45, cost  0.650958546345
Pre-training layer 2, epoch 46, cost  0.514864606788
Pre-training layer 2, epoch 47, cost  0.667399343688
Pre-training layer 2, epoch 48, cost  0.670306227728
Pre-training layer 2, epoch 49, cost  0.650790930279
Pre-training layer 3, epoch 0, cost  16.7391714948
Pre-training layer 3, epoch 1, cost  4.48710314771
Pre-training layer 3, epoch 2, cost  3.10136678425
Pre-training layer 3, epoch 3, cost  2.36922982262
Pre-training layer 3, epoch 4, cost  1.88443916896
Pre-training layer 3, epoch 5, cost  1.53661486793
Pre-training layer 3, epoch 6, cost  1.28604619689
Pre-training layer 3, epoch 7, cost  1.24033305893
Pre-training layer 3, epoch 8, cost  1.21453311321
Pre-training layer 3, epoch 9, cost  1.14869541973
Pre-training layer 3, epoch 10, cost  1.06994817512
Pre-training layer 3, epoch 11, cost  0.989986678994
Pre-training layer 3, epoch 12, cost  0.917424588767
Pre-training layer 3, epoch 13, cost  0.887327634399
Pre-training layer 3, epoch 14, cost  0.866520956883
Pre-training layer 3, epoch 15, cost  0.793802915595
Pre-training layer 3, epoch 16, cost  0.744704698927
Pre-training layer 3, epoch 17, cost  0.703556545645
Pre-training layer 3, epoch 18, cost  0.677838648526
Pre-training layer 3, epoch 19, cost  0.668976852482
Pre-training layer 3, epoch 20, cost  0.66243621813
Pre-training layer 3, epoch 21, cost  0.638127671838
Pre-training layer 3, epoch 22, cost  0.572303259024
Pre-training layer 3, epoch 23, cost  0.578055225815
Pre-training layer 3, epoch 24, cost  0.548596791026
Pre-training layer 3, epoch 25, cost  0.537695995627
Pre-training layer 3, epoch 26, cost  0.525109696291
Pre-training layer 3, epoch 27, cost  0.511755441876
Pre-training layer 3, epoch 28, cost  0.497324187716
Pre-training layer 3, epoch 29, cost  0.474972271512
Pre-training layer 3, epoch 30, cost  0.43926015204
Pre-training layer 3, epoch 31, cost  0.410957190648
Pre-training layer 3, epoch 32, cost  0.436112121645
Pre-training layer 3, epoch 33, cost  0.459001974516
Pre-training layer 3, epoch 34, cost  0.458103791033
Pre-training layer 3, epoch 35, cost  0.360634367733
Pre-training layer 3, epoch 36, cost  0.370562914523
Pre-training layer 3, epoch 37, cost  0.398282062757
Pre-training layer 3, epoch 38, cost  0.399381451964
Pre-training layer 3, epoch 39, cost  0.377001818676
Pre-training layer 3, epoch 40, cost  0.327519359948
Pre-training layer 3, epoch 41, cost  0.312717021982
Pre-training layer 3, epoch 42, cost  0.361917468677
Pre-training layer 3, epoch 43, cost  0.370244235055
Pre-training layer 3, epoch 44, cost  0.259052592868
Pre-training layer 3, epoch 45, cost  0.292453130406
Pre-training layer 3, epoch 46, cost  0.369796404551
Pre-training layer 3, epoch 47, cost  0.315986970042
Pre-training layer 3, epoch 48, cost  0.260272022942
Pre-training layer 3, epoch 49, cost  0.293361363431
Pre-training layer 4, epoch 0, cost  18.4819590869
Pre-training layer 4, epoch 1, cost  5.36332991437
Pre-training layer 4, epoch 2, cost  3.75868391528
Pre-training layer 4, epoch 3, cost  2.88735837264
Pre-training layer 4, epoch 4, cost  2.33163935753
Pre-training layer 4, epoch 5, cost  1.96535126536
Pre-training layer 4, epoch 6, cost  1.83652151622
Pre-training layer 4, epoch 7, cost  1.79997724912
Pre-training layer 4, epoch 8, cost  1.70863929451
Pre-training layer 4, epoch 9, cost  1.61449488722
Pre-training layer 4, epoch 10, cost  1.53474206777
Pre-training layer 4, epoch 11, cost  1.4682200791
Pre-training layer 4, epoch 12, cost  1.41571727556
Pre-training layer 4, epoch 13, cost  1.37797048335
Pre-training layer 4, epoch 14, cost  1.35026736587
Pre-training layer 4, epoch 15, cost  1.3273521804
Pre-training layer 4, epoch 16, cost  1.30220790228
Pre-training layer 4, epoch 17, cost  1.27018586201
Pre-training layer 4, epoch 18, cost  1.23920788551
Pre-training layer 4, epoch 19, cost  1.23195250615
Pre-training layer 4, epoch 20, cost  1.23516907612
Pre-training layer 4, epoch 21, cost  1.22123314322
Pre-training layer 4, epoch 22, cost  1.18747936994
Pre-training layer 4, epoch 23, cost  1.16182980885
Pre-training layer 4, epoch 24, cost  1.1763250451
Pre-training layer 4, epoch 25, cost  1.18013679015
Pre-training layer 4, epoch 26, cost  1.13030649203
Pre-training layer 4, epoch 27, cost  1.10644613876
Pre-training layer 4, epoch 28, cost  1.15817026164
Pre-training layer 4, epoch 29, cost  1.12304323897
Pre-training layer 4, epoch 30, cost  1.07214942308
Pre-training layer 4, epoch 31, cost  1.13526381154
Pre-training layer 4, epoch 32, cost  1.11335935017
Pre-training layer 4, epoch 33, cost  1.05038203317
Pre-training layer 4, epoch 34, cost  1.09806337647
Pre-training layer 4, epoch 35, cost  1.08667151241
Pre-training layer 4, epoch 36, cost  1.03070867003
Pre-training layer 4, epoch 37, cost  1.08669210692
Pre-training layer 4, epoch 38, cost  1.04341727644
Pre-training layer 4, epoch 39, cost  1.03507047231
Pre-training layer 4, epoch 40, cost  1.07167299655
Pre-training layer 4, epoch 41, cost  1.00031813283
Pre-training layer 4, epoch 42, cost  1.05849679848
Pre-training layer 4, epoch 43, cost  1.01369918338
Pre-training layer 4, epoch 44, cost  1.02550753936
Pre-training layer 4, epoch 45, cost  1.03406974897
Pre-training layer 4, epoch 46, cost  1.00015528561
Pre-training layer 4, epoch 47, cost  1.03166756929
Pre-training layer 4, epoch 48, cost  0.99037862564
Pre-training layer 4, epoch 49, cost  1.01961178655
Pre-training layer 5, epoch 0, cost  19.9489002033
Pre-training layer 5, epoch 1, cost  6.98810775366
Pre-training layer 5, epoch 2, cost  5.6959129901
Pre-training layer 5, epoch 3, cost  5.49832225606
Pre-training layer 5, epoch 4, cost  5.42861994255
Pre-training layer 5, epoch 5, cost  5.39290126275
Pre-training layer 5, epoch 6, cost  5.37189606564
Pre-training layer 5, epoch 7, cost  5.35892952827
Pre-training layer 5, epoch 8, cost  5.35054075729
Pre-training layer 5, epoch 9, cost  5.34502150156
Pre-training layer 5, epoch 10, cost  5.34113828939
Pre-training layer 5, epoch 11, cost  5.33838782888
Pre-training layer 5, epoch 12, cost  5.33627921093
Pre-training layer 5, epoch 13, cost  5.33455177787
Pre-training layer 5, epoch 14, cost  5.3330754048
Pre-training layer 5, epoch 15, cost  5.33179718594
Pre-training layer 5, epoch 16, cost  5.33056612827
Pre-training layer 5, epoch 17, cost  5.32940903859
Pre-training layer 5, epoch 18, cost  5.32823136452
Pre-training layer 5, epoch 19, cost  5.32708504517
Pre-training layer 5, epoch 20, cost  5.32594635421
Pre-training layer 5, epoch 21, cost  5.32482345716
Pre-training layer 5, epoch 22, cost  5.32373108819
Pre-training layer 5, epoch 23, cost  5.32262552956
Pre-training layer 5, epoch 24, cost  5.32159981047
Pre-training layer 5, epoch 25, cost  5.3205693623
Pre-training layer 5, epoch 26, cost  5.31953111132
Pre-training layer 5, epoch 27, cost  5.31853423219
Pre-training layer 5, epoch 28, cost  5.31754512687
Pre-training layer 5, epoch 29, cost  5.31658437664
Pre-training layer 5, epoch 30, cost  5.31566659111
Pre-training layer 5, epoch 31, cost  5.31476083304
Pre-training layer 5, epoch 32, cost  5.31388321765
Pre-training layer 5, epoch 33, cost  5.31299296844
Pre-training layer 5, epoch 34, cost  5.31214497983
Pre-training layer 5, epoch 35, cost  5.31130084482
Pre-training layer 5, epoch 36, cost  5.31049569732
Pre-training layer 5, epoch 37, cost  5.30970615394
Pre-training layer 5, epoch 38, cost  5.30893491806
Pre-training layer 5, epoch 39, cost  5.30820191061
Pre-training layer 5, epoch 40, cost  5.30747502558
Pre-training layer 5, epoch 41, cost  5.30676369974
Pre-training layer 5, epoch 42, cost  5.30607429853
Pre-training layer 5, epoch 43, cost  5.30540182216
Pre-training layer 5, epoch 44, cost  5.30476591403
Pre-training layer 5, epoch 45, cost  5.30413560677
Pre-training layer 5, epoch 46, cost  5.30352362768
Pre-training layer 5, epoch 47, cost  5.30293136128
Pre-training layer 5, epoch 48, cost  5.3023617299
The pretraining code for file multi_layer_km.pyc ran for 6.92m
Pre-training layer 5, epoch 49, cost  5.30177590562
Initial NMI for deep clustering: 0.53
ARI for deep clustering: 0.41
... getting the finetuning functions
ACC for deep clustering: 0.56
... finetunning the model
Fine-tuning epoch 1 ++++ 
Total cost: 2.85912, Reconstruction: 1.93266, Clustering: 0.92646, 
Fine-tuning epoch 2 ++++ 
Total cost: 2.21083, Reconstruction: 1.72625, Clustering: 0.48458, 
Fine-tuning epoch 3 ++++ 
Total cost: 2.11136, Reconstruction: 1.68075, Clustering: 0.43061, 
Fine-tuning epoch 4 ++++ 
Total cost: 2.04349, Reconstruction: 1.63356, Clustering: 0.40994, 
Fine-tuning epoch 5 ++++ 
Total cost: 1.97764, Reconstruction: 1.58248, Clustering: 0.39516, 
Fine-tuning epoch 6 ++++ 
Total cost: 1.93219, Reconstruction: 1.54872, Clustering: 0.38347, 
Fine-tuning epoch 7 ++++ 
Total cost: 1.88473, Reconstruction: 1.51788, Clustering: 0.36685, 
Fine-tuning epoch 8 ++++ 
Total cost: 1.85055, Reconstruction: 1.49091, Clustering: 0.35964, 
Fine-tuning epoch 9 ++++ 
Total cost: 1.79917, Reconstruction: 1.45145, Clustering: 0.34772, 
Fine-tuning epoch 10 ++++ 
Total cost: 1.77993, Reconstruction: 1.43668, Clustering: 0.34325, 
Fine-tuning epoch 11 ++++ 
Total cost: 1.73692, Reconstruction: 1.40383, Clustering: 0.33309, 
Fine-tuning epoch 12 ++++ 
Total cost: 1.72600, Reconstruction: 1.39895, Clustering: 0.32705, 
Fine-tuning epoch 13 ++++ 
Total cost: 1.68556, Reconstruction: 1.36365, Clustering: 0.32191, 
Fine-tuning epoch 14 ++++ 
Total cost: 1.65077, Reconstruction: 1.33579, Clustering: 0.31499, 
Fine-tuning epoch 15 ++++ 
Total cost: 1.62395, Reconstruction: 1.31324, Clustering: 0.31070, 
Fine-tuning epoch 16 ++++ 
Total cost: 1.61774, Reconstruction: 1.30987, Clustering: 0.30786, 
Fine-tuning epoch 17 ++++ 
Total cost: 1.59002, Reconstruction: 1.28609, Clustering: 0.30394, 
Fine-tuning epoch 18 ++++ 
Total cost: 1.55507, Reconstruction: 1.25450, Clustering: 0.30058, 
Fine-tuning epoch 19 ++++ 
Total cost: 1.54275, Reconstruction: 1.24652, Clustering: 0.29623, 
Fine-tuning epoch 20 ++++ 
Total cost: 1.50430, Reconstruction: 1.21458, Clustering: 0.28973, 
Fine-tuning epoch 21 ++++ 
Total cost: 1.52534, Reconstruction: 1.23133, Clustering: 0.29401, 
Fine-tuning epoch 22 ++++ 
Total cost: 1.48028, Reconstruction: 1.19072, Clustering: 0.28957, 
Fine-tuning epoch 23 ++++ 
Total cost: 1.47080, Reconstruction: 1.18366, Clustering: 0.28714, 
Fine-tuning epoch 24 ++++ 
Total cost: 1.43788, Reconstruction: 1.15664, Clustering: 0.28125, 
Fine-tuning epoch 25 ++++ 
Total cost: 1.43155, Reconstruction: 1.14954, Clustering: 0.28201, 
Fine-tuning epoch 26 ++++ 
Total cost: 1.40464, Reconstruction: 1.12649, Clustering: 0.27814, 
Fine-tuning epoch 27 ++++ 
Total cost: 1.40011, Reconstruction: 1.12334, Clustering: 0.27677, 
Fine-tuning epoch 28 ++++ 
Total cost: 1.39382, Reconstruction: 1.11824, Clustering: 0.27558, 
Fine-tuning epoch 29 ++++ 
Total cost: 1.37028, Reconstruction: 1.09560, Clustering: 0.27468, 
Fine-tuning epoch 30 ++++ 
Total cost: 1.36166, Reconstruction: 1.08956, Clustering: 0.27209, 
Fine-tuning epoch 31 ++++ 
Total cost: 1.33853, Reconstruction: 1.07093, Clustering: 0.26761, 
Fine-tuning epoch 32 ++++ 
Total cost: 1.32721, Reconstruction: 1.06018, Clustering: 0.26703, 
Fine-tuning epoch 33 ++++ 
Total cost: 1.32398, Reconstruction: 1.05474, Clustering: 0.26924, 
Fine-tuning epoch 34 ++++ 
Total cost: 1.30965, Reconstruction: 1.04279, Clustering: 0.26685, 
Fine-tuning epoch 35 ++++ 
Total cost: 1.31481, Reconstruction: 1.04460, Clustering: 0.27021, 
Fine-tuning epoch 36 ++++ 
Total cost: 1.30018, Reconstruction: 1.03214, Clustering: 0.26803, 
Fine-tuning epoch 37 ++++ 
Total cost: 1.28552, Reconstruction: 1.02227, Clustering: 0.26325, 
Fine-tuning epoch 38 ++++ 
Total cost: 1.27849, Reconstruction: 1.01145, Clustering: 0.26704, 
Fine-tuning epoch 39 ++++ 
Total cost: 1.27991, Reconstruction: 1.01065, Clustering: 0.26926, 
Fine-tuning epoch 40 ++++ 
Total cost: 1.25391, Reconstruction: 0.99181, Clustering: 0.26210, 
Fine-tuning epoch 41 ++++ 
Total cost: 1.26449, Reconstruction: 1.00132, Clustering: 0.26317, 
Fine-tuning epoch 42 ++++ 
Total cost: 1.23214, Reconstruction: 0.97503, Clustering: 0.25711, 
Fine-tuning epoch 43 ++++ 
Total cost: 1.24451, Reconstruction: 0.97783, Clustering: 0.26668, 
Fine-tuning epoch 44 ++++ 
Total cost: 1.24579, Reconstruction: 0.97897, Clustering: 0.26682, 
Fine-tuning epoch 45 ++++ 
Total cost: 1.23373, Reconstruction: 0.96663, Clustering: 0.26710, 
Fine-tuning epoch 46 ++++ 
Total cost: 1.21317, Reconstruction: 0.95568, Clustering: 0.25749, 
Fine-tuning epoch 47 ++++ 
Total cost: 1.21848, Reconstruction: 0.95687, Clustering: 0.26161, 
Fine-tuning epoch 48 ++++ 
Total cost: 1.20441, Reconstruction: 0.94319, Clustering: 0.26122, 
Fine-tuning epoch 49 ++++ 
Total cost: 1.20730, Reconstruction: 0.94281, Clustering: 0.26450, 
Fine-tuning epoch 50 ++++ 
Total cost: 1.21949, Reconstruction: 0.95151, Clustering: 0.26798, 
Average squared 2-D reconstruction error: 0.9515
NMI for deep clustering: 0.56
ARI for deep clustering: 0.43
ACC for deep clustering: 0.58
The training code for file multi_layer_km.pyc ran for 6.82m
KM avg. NMI = 0.51, ARI = 0.39, ACC = 0.55
SAE+KM avg. NMI = 0.51, ARI = 0.38, ACC = 0.53
DCN    avg. NMI = 0.54, ARI = 0.39, ACC = 0.49
