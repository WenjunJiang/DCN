/home/wenjun/anaconda2/bin/python2.7 /home/wenjun/AnacondaProjects/on_my_git/DCN/run_raw_mnist.py
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.15267800487
Pre-training layer 0, epoch 1, cost  0.991764164041
Pre-training layer 0, epoch 2, cost  0.799933000926
Pre-training layer 0, epoch 3, cost  0.71198573921
Pre-training layer 0, epoch 4, cost  0.658190103177
Pre-training layer 0, epoch 5, cost  0.620414624909
Pre-training layer 0, epoch 6, cost  0.591696143351
Pre-training layer 0, epoch 7, cost  0.568614750238
Pre-training layer 0, epoch 8, cost  0.549416573265
Pre-training layer 0, epoch 9, cost  0.533128426043
Pre-training layer 0, epoch 10, cost  0.519093007673
Pre-training layer 0, epoch 11, cost  0.506725088621
Pre-training layer 0, epoch 12, cost  0.495733883494
Pre-training layer 0, epoch 13, cost  0.485865229677
Pre-training layer 0, epoch 14, cost  0.476965698691
Pre-training layer 0, epoch 15, cost  0.468842326116
Pre-training layer 0, epoch 16, cost  0.461391073666
Pre-training layer 0, epoch 17, cost  0.454482322928
Pre-training layer 0, epoch 18, cost  0.448136376886
Pre-training layer 0, epoch 19, cost  0.442217970508
Pre-training layer 0, epoch 20, cost  0.436719971018
Pre-training layer 0, epoch 21, cost  0.431562760918
Pre-training layer 0, epoch 22, cost  0.426733156059
Pre-training layer 0, epoch 23, cost  0.422197551164
Pre-training layer 0, epoch 24, cost  0.417903328511
Pre-training layer 0, epoch 25, cost  0.413845742162
Pre-training layer 0, epoch 26, cost  0.409971744601
Pre-training layer 0, epoch 27, cost  0.406304393509
Pre-training layer 0, epoch 28, cost  0.402819503629
Pre-training layer 0, epoch 29, cost  0.399497864549
Pre-training layer 0, epoch 30, cost  0.396327730473
Pre-training layer 0, epoch 31, cost  0.393298613994
Pre-training layer 0, epoch 32, cost  0.390404022003
Pre-training layer 0, epoch 33, cost  0.387640430289
Pre-training layer 0, epoch 34, cost  0.38498097236
Pre-training layer 0, epoch 35, cost  0.382438136819
Pre-training layer 0, epoch 36, cost  0.379990580281
Pre-training layer 0, epoch 37, cost  0.377627784019
Pre-training layer 0, epoch 38, cost  0.375341316495
Pre-training layer 0, epoch 39, cost  0.373153585079
Pre-training layer 0, epoch 40, cost  0.371047114315
Pre-training layer 0, epoch 41, cost  0.368999018894
Pre-training layer 0, epoch 42, cost  0.367029600048
Pre-training layer 0, epoch 43, cost  0.365123442661
Pre-training layer 0, epoch 44, cost  0.363283137941
Pre-training layer 0, epoch 45, cost  0.361484514082
Pre-training layer 0, epoch 46, cost  0.359748348417
Pre-training layer 0, epoch 47, cost  0.358071715555
Pre-training layer 0, epoch 48, cost  0.356433466997
Pre-training layer 0, epoch 49, cost  0.354844904846
Pre-training layer 1, epoch 0, cost  3.85263479667
Pre-training layer 1, epoch 1, cost  1.00791857454
Pre-training layer 1, epoch 2, cost  0.726893964228
Pre-training layer 1, epoch 3, cost  0.607875079967
Pre-training layer 1, epoch 4, cost  0.539580490428
Pre-training layer 1, epoch 5, cost  0.492764039261
Pre-training layer 1, epoch 6, cost  0.458349276895
Pre-training layer 1, epoch 7, cost  0.431261716639
Pre-training layer 1, epoch 8, cost  0.409065400468
Pre-training layer 1, epoch 9, cost  0.389992390905
Pre-training layer 1, epoch 10, cost  0.373983293801
Pre-training layer 1, epoch 11, cost  0.359786830936
Pre-training layer 1, epoch 12, cost  0.347746990508
Pre-training layer 1, epoch 13, cost  0.336447069758
Pre-training layer 1, epoch 14, cost  0.326663332044
Pre-training layer 1, epoch 15, cost  0.317900055809
Pre-training layer 1, epoch 16, cost  0.309611119631
Pre-training layer 1, epoch 17, cost  0.302473725243
Pre-training layer 1, epoch 18, cost  0.295246173271
Pre-training layer 1, epoch 19, cost  0.289239209937
Pre-training layer 1, epoch 20, cost  0.283418216594
Pre-training layer 1, epoch 21, cost  0.278432088052
Pre-training layer 1, epoch 22, cost  0.273345789311
Pre-training layer 1, epoch 23, cost  0.2683890553
Pre-training layer 1, epoch 24, cost  0.264099519982
Pre-training layer 1, epoch 25, cost  0.259623304183
Pre-training layer 1, epoch 26, cost  0.255941457828
Pre-training layer 1, epoch 27, cost  0.252318779512
Pre-training layer 1, epoch 28, cost  0.248898622872
Pre-training layer 1, epoch 29, cost  0.24555769308
Pre-training layer 1, epoch 30, cost  0.242301363112
Pre-training layer 1, epoch 31, cost  0.239533575041
Pre-training layer 1, epoch 32, cost  0.236890999941
Pre-training layer 1, epoch 33, cost  0.234057388699
Pre-training layer 1, epoch 34, cost  0.231554853885
Pre-training layer 1, epoch 35, cost  0.228879787364
Pre-training layer 1, epoch 36, cost  0.22711094944
Pre-training layer 1, epoch 37, cost  0.224111254234
Pre-training layer 1, epoch 38, cost  0.222743387477
Pre-training layer 1, epoch 39, cost  0.22035098781
Pre-training layer 1, epoch 40, cost  0.218555718402
Pre-training layer 1, epoch 41, cost  0.216885346438
Pre-training layer 1, epoch 42, cost  0.214840040174
Pre-training layer 1, epoch 43, cost  0.213132514019
Pre-training layer 1, epoch 44, cost  0.211549057016
Pre-training layer 1, epoch 45, cost  0.209957511873
Pre-training layer 1, epoch 46, cost  0.208428967509
Pre-training layer 1, epoch 47, cost  0.206911859098
Pre-training layer 1, epoch 48, cost  0.205552511149
Pre-training layer 1, epoch 49, cost  0.2042111098
Pre-training layer 2, epoch 0, cost  4.82297394235
Pre-training layer 2, epoch 1, cost  1.39407689338
Pre-training layer 2, epoch 2, cost  1.063153786
Pre-training layer 2, epoch 3, cost  0.902993670798
Pre-training layer 2, epoch 4, cost  0.807722677404
Pre-training layer 2, epoch 5, cost  0.74859095253
Pre-training layer 2, epoch 6, cost  0.681574811163
Pre-training layer 2, epoch 7, cost  0.66339211064
Pre-training layer 2, epoch 8, cost  0.629746787068
Pre-training layer 2, epoch 9, cost  0.600473677651
Pre-training layer 2, epoch 10, cost  0.58338976374
Pre-training layer 2, epoch 11, cost  0.573317813632
Pre-training layer 2, epoch 12, cost  0.550879650619
Pre-training layer 2, epoch 13, cost  0.538406665595
Pre-training layer 2, epoch 14, cost  0.530120337403
Pre-training layer 2, epoch 15, cost  0.520634076404
Pre-training layer 2, epoch 16, cost  0.514172638858
Pre-training layer 2, epoch 17, cost  0.507004360535
Pre-training layer 2, epoch 18, cost  0.495241511304
Pre-training layer 2, epoch 19, cost  0.492634270282
Pre-training layer 2, epoch 20, cost  0.4829350281
Pre-training layer 2, epoch 21, cost  0.483308079959
Pre-training layer 2, epoch 22, cost  0.474156342028
Pre-training layer 2, epoch 23, cost  0.470317124326
Pre-training layer 2, epoch 24, cost  0.467065402154
Pre-training layer 2, epoch 25, cost  0.463493089277
Pre-training layer 2, epoch 26, cost  0.45837144574
Pre-training layer 2, epoch 27, cost  0.454957387887
Pre-training layer 2, epoch 28, cost  0.452528037627
Pre-training layer 2, epoch 29, cost  0.450231619034
Pre-training layer 2, epoch 30, cost  0.448397845066
Pre-training layer 2, epoch 31, cost  0.444985258617
Pre-training layer 2, epoch 32, cost  0.44353564598
Pre-training layer 2, epoch 33, cost  0.441138717986
Pre-training layer 2, epoch 34, cost  0.440338318779
Pre-training layer 2, epoch 35, cost  0.437027342101
Pre-training layer 2, epoch 36, cost  0.436298714535
Pre-training layer 2, epoch 37, cost  0.434101339602
Pre-training layer 2, epoch 38, cost  0.432519229733
Pre-training layer 2, epoch 39, cost  0.431261106179
Pre-training layer 2, epoch 40, cost  0.4297463268
Pre-training layer 2, epoch 41, cost  0.428300819769
Pre-training layer 2, epoch 42, cost  0.4270297114
Pre-training layer 2, epoch 43, cost  0.425715577802
Pre-training layer 2, epoch 44, cost  0.424344875578
Pre-training layer 2, epoch 45, cost  0.423311849575
Pre-training layer 2, epoch 46, cost  0.422530245011
Pre-training layer 2, epoch 47, cost  0.421826527172
Pre-training layer 2, epoch 48, cost  0.420924571616
Pre-training layer 2, epoch 49, cost  0.419514586755
Pre-training layer 3, epoch 0, cost  3.6342408954
Pre-training layer 3, epoch 1, cost  0.698463220597
Pre-training layer 3, epoch 2, cost  0.44051308753
Pre-training layer 3, epoch 3, cost  0.310027601924
Pre-training layer 3, epoch 4, cost  0.241551024075
Pre-training layer 3, epoch 5, cost  0.194930006832
Pre-training layer 3, epoch 6, cost  0.16383935836
Pre-training layer 3, epoch 7, cost  0.143717989507
Pre-training layer 3, epoch 8, cost  0.127704250496
Pre-training layer 3, epoch 9, cost  0.115120324471
Pre-training layer 3, epoch 10, cost  0.105672993259
Pre-training layer 3, epoch 11, cost  0.0975978793291
Pre-training layer 3, epoch 12, cost  0.0896629139685
Pre-training layer 3, epoch 13, cost  0.0838579659609
Pre-training layer 3, epoch 14, cost  0.0797279152478
Pre-training layer 3, epoch 15, cost  0.0749637576101
Pre-training layer 3, epoch 16, cost  0.0714972825911
Pre-training layer 3, epoch 17, cost  0.0679803968158
Pre-training layer 3, epoch 18, cost  0.0648913319201
Pre-training layer 3, epoch 19, cost  0.0620498560992
Pre-training layer 3, epoch 20, cost  0.0594055247372
Pre-training layer 3, epoch 21, cost  0.0569104355555
Pre-training layer 3, epoch 22, cost  0.0545004675251
Pre-training layer 3, epoch 23, cost  0.0520078219432
Pre-training layer 3, epoch 24, cost  0.0496735470096
Pre-training layer 3, epoch 25, cost  0.0478872577077
Pre-training layer 3, epoch 26, cost  0.0464963809444
Pre-training layer 3, epoch 27, cost  0.0449529031672
Pre-training layer 3, epoch 28, cost  0.0433254705849
Pre-training layer 3, epoch 29, cost  0.0419993229547
Pre-training layer 3, epoch 30, cost  0.0406545224813
Pre-training layer 3, epoch 31, cost  0.0394085594271
Pre-training layer 3, epoch 32, cost  0.0382000480182
Pre-training layer 3, epoch 33, cost  0.0370490333711
Pre-training layer 3, epoch 34, cost  0.0359818770559
Pre-training layer 3, epoch 35, cost  0.0349391500267
Pre-training layer 3, epoch 36, cost  0.0339725489873
Pre-training layer 3, epoch 37, cost  0.0330361230032
Pre-training layer 3, epoch 38, cost  0.0321286526683
Pre-training layer 3, epoch 39, cost  0.0312494709697
Pre-training layer 3, epoch 40, cost  0.0304270629923
Pre-training layer 3, epoch 41, cost  0.0296138420448
Pre-training layer 3, epoch 42, cost  0.0287562673862
Pre-training layer 3, epoch 43, cost  0.0278428667713
Pre-training layer 3, epoch 44, cost  0.0269040381537
Pre-training layer 3, epoch 45, cost  0.026287209882
Pre-training layer 3, epoch 46, cost  0.0259976640994
Pre-training layer 3, epoch 47, cost  0.0256878128495
Pre-training layer 3, epoch 48, cost  0.0252098387657
Pre-training layer 3, epoch 49, cost  0.0246598124467
Pre-training layer 4, epoch 0, cost  4.21191434271
Pre-training layer 4, epoch 1, cost  1.15845480057
Pre-training layer 4, epoch 2, cost  0.958747205508
Pre-training layer 4, epoch 3, cost  0.923076527841
Pre-training layer 4, epoch 4, cost  0.905791297335
Pre-training layer 4, epoch 5, cost  0.893375609791
Pre-training layer 4, epoch 6, cost  0.884304473664
Pre-training layer 4, epoch 7, cost  0.877361756518
Pre-training layer 4, epoch 8, cost  0.871742127841
Pre-training layer 4, epoch 9, cost  0.867056134219
Pre-training layer 4, epoch 10, cost  0.862987446712
Pre-training layer 4, epoch 11, cost  0.859361355531
Pre-training layer 4, epoch 12, cost  0.856155575773
Pre-training layer 4, epoch 13, cost  0.853338146238
Pre-training layer 4, epoch 14, cost  0.850853272439
Pre-training layer 4, epoch 15, cost  0.848582927808
Pre-training layer 4, epoch 16, cost  0.846485552468
Pre-training layer 4, epoch 17, cost  0.844591769358
Pre-training layer 4, epoch 18, cost  0.842839724015
Pre-training layer 4, epoch 19, cost  0.841239475561
Pre-training layer 4, epoch 20, cost  0.839782063131
Pre-training layer 4, epoch 21, cost  0.83841651847
Pre-training layer 4, epoch 22, cost  0.837118984612
Pre-training layer 4, epoch 23, cost  0.835912501101
Pre-training layer 4, epoch 24, cost  0.834818865205
Pre-training layer 4, epoch 25, cost  0.833806872713
Pre-training layer 4, epoch 26, cost  0.83281072325
Pre-training layer 4, epoch 27, cost  0.83188608732
Pre-training layer 4, epoch 28, cost  0.831024286917
Pre-training layer 4, epoch 29, cost  0.830214973889
Pre-training layer 4, epoch 30, cost  0.829450694188
Pre-training layer 4, epoch 31, cost  0.828713863003
Pre-training layer 4, epoch 32, cost  0.828031590286
Pre-training layer 4, epoch 33, cost  0.827392268267
Pre-training layer 4, epoch 34, cost  0.826764422607
Pre-training layer 4, epoch 35, cost  0.826185706657
Pre-training layer 4, epoch 36, cost  0.825612556785
Pre-training layer 4, epoch 37, cost  0.825082929754
Pre-training layer 4, epoch 38, cost  0.824560781736
Pre-training layer 4, epoch 39, cost  0.82410676228
Pre-training layer 4, epoch 40, cost  0.823618286081
Pre-training layer 4, epoch 41, cost  0.823166380307
Pre-training layer 4, epoch 42, cost  0.822762412118
Pre-training layer 4, epoch 43, cost  0.822366031391
Pre-training layer 4, epoch 44, cost  0.821981030632
Pre-training layer 4, epoch 45, cost  0.821592038855
Pre-training layer 4, epoch 46, cost  0.821251894216
Pre-training layer 4, epoch 47, cost  0.820888290353
Pre-training layer 4, epoch 48, cost  0.820580752801
Pre-training layer 4, epoch 49, cost  0.820261993026
Pre-training layer 5, epoch 0, cost  5.41473464153
Pre-training layer 5, epoch 1, cost  3.44885021934
Pre-training layer 5, epoch 2, cost  3.43614111494
Pre-training layer 5, epoch 3, cost  3.4318583572
Pre-training layer 5, epoch 4, cost  3.42937894492
Pre-training layer 5, epoch 5, cost  3.42749131453
Pre-training layer 5, epoch 6, cost  3.4258201726
Pre-training layer 5, epoch 7, cost  3.42424179589
Pre-training layer 5, epoch 8, cost  3.42270530217
Pre-training layer 5, epoch 9, cost  3.42114426434
Pre-training layer 5, epoch 10, cost  3.41946075663
Pre-training layer 5, epoch 11, cost  3.4175165892
Pre-training layer 5, epoch 12, cost  3.41512006092
Pre-training layer 5, epoch 13, cost  3.41199097486
Pre-training layer 5, epoch 14, cost  3.40770556014
Pre-training layer 5, epoch 15, cost  3.40164933595
Pre-training layer 5, epoch 16, cost  3.39322165572
Pre-training layer 5, epoch 17, cost  3.38307566358
Pre-training layer 5, epoch 18, cost  3.37449094993
Pre-training layer 5, epoch 19, cost  3.36951284702
Pre-training layer 5, epoch 20, cost  3.36672754711
Pre-training layer 5, epoch 21, cost  3.3648909747
Pre-training layer 5, epoch 22, cost  3.36353772974
Pre-training layer 5, epoch 23, cost  3.36247112911
Pre-training layer 5, epoch 24, cost  3.3615892509
Pre-training layer 5, epoch 25, cost  3.360834951
Pre-training layer 5, epoch 26, cost  3.36017345308
Pre-training layer 5, epoch 27, cost  3.35958236039
Pre-training layer 5, epoch 28, cost  3.35904634942
Pre-training layer 5, epoch 29, cost  3.35855485486
Pre-training layer 5, epoch 30, cost  3.35810040147
Pre-training layer 5, epoch 31, cost  3.35767751284
Pre-training layer 5, epoch 32, cost  3.35728094057
Pre-training layer 5, epoch 33, cost  3.35690879433
Pre-training layer 5, epoch 34, cost  3.35655678917
Pre-training layer 5, epoch 35, cost  3.35622352041
Pre-training layer 5, epoch 36, cost  3.35590681631
Pre-training layer 5, epoch 37, cost  3.3556051054
Pre-training layer 5, epoch 38, cost  3.35531814938
Pre-training layer 5, epoch 39, cost  3.35504363009
Pre-training layer 5, epoch 40, cost  3.35478046178
Pre-training layer 5, epoch 41, cost  3.35452875951
Pre-training layer 5, epoch 42, cost  3.35428689723
Pre-training layer 5, epoch 43, cost  3.35405460605
Pre-training layer 5, epoch 44, cost  3.35383073324
Pre-training layer 5, epoch 45, cost  3.35361535793
Pre-training layer 5, epoch 46, cost  3.35340783375
Pre-training layer 5, epoch 47, cost  3.3532076947
Pre-training layer 5, epoch 48, cost  3.3530146594
Pre-training layer 5, epoch 49, cost  3.35282812299
The pretraining code for file multi_layer_km.pyc ran for 70.40m
Initial NMI for deep clustering: 0.49
ARI for deep clustering: 0.35
ACC for deep clustering: 0.52
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 1.98069, Reconstruction: 1.64912, Clustering: 0.33157,
Fine-tuning epoch 2 ++++
Total cost: 1.56924, Reconstruction: 1.25945, Clustering: 0.30979,
Fine-tuning epoch 3 ++++
Total cost: 1.43313, Reconstruction: 1.14037, Clustering: 0.29276,
Fine-tuning epoch 4 ++++
Total cost: 1.33870, Reconstruction: 1.05831, Clustering: 0.28039,
Fine-tuning epoch 5 ++++
Total cost: 1.28530, Reconstruction: 1.01323, Clustering: 0.27207,
Fine-tuning epoch 6 ++++
Total cost: 1.23367, Reconstruction: 0.97124, Clustering: 0.26243,
Fine-tuning epoch 7 ++++
Total cost: 1.20204, Reconstruction: 0.94545, Clustering: 0.25659,
Fine-tuning epoch 8 ++++
Total cost: 1.17895, Reconstruction: 0.92669, Clustering: 0.25225,
Fine-tuning epoch 9 ++++
Total cost: 1.15907, Reconstruction: 0.90997, Clustering: 0.24910,
Fine-tuning epoch 10 ++++
Total cost: 1.13562, Reconstruction: 0.89070, Clustering: 0.24492,
Fine-tuning epoch 11 ++++
Total cost: 1.12191, Reconstruction: 0.87943, Clustering: 0.24248,
Fine-tuning epoch 12 ++++
Total cost: 1.10955, Reconstruction: 0.86800, Clustering: 0.24155,
Fine-tuning epoch 13 ++++
Total cost: 1.08971, Reconstruction: 0.85150, Clustering: 0.23822,
Fine-tuning epoch 14 ++++
Total cost: 1.07593, Reconstruction: 0.84039, Clustering: 0.23553,
Fine-tuning epoch 15 ++++
Total cost: 1.06600, Reconstruction: 0.83123, Clustering: 0.23477,
Fine-tuning epoch 16 ++++
Total cost: 1.05581, Reconstruction: 0.82235, Clustering: 0.23346,
Fine-tuning epoch 17 ++++
Total cost: 1.04642, Reconstruction: 0.81482, Clustering: 0.23160,
Fine-tuning epoch 18 ++++
Total cost: 1.02832, Reconstruction: 0.80068, Clustering: 0.22764,
Fine-tuning epoch 19 ++++
Total cost: 1.02776, Reconstruction: 0.79794, Clustering: 0.22982,
Fine-tuning epoch 20 ++++
Total cost: 1.01496, Reconstruction: 0.78796, Clustering: 0.22700,
Fine-tuning epoch 21 ++++
Total cost: 1.00716, Reconstruction: 0.78048, Clustering: 0.22669,
Fine-tuning epoch 22 ++++
Total cost: 1.00348, Reconstruction: 0.77532, Clustering: 0.22816,
Fine-tuning epoch 23 ++++
Total cost: 0.99172, Reconstruction: 0.76689, Clustering: 0.22483,
Fine-tuning epoch 24 ++++
Total cost: 0.98082, Reconstruction: 0.75692, Clustering: 0.22390,
Fine-tuning epoch 25 ++++
Total cost: 0.97890, Reconstruction: 0.75509, Clustering: 0.22381,
Fine-tuning epoch 26 ++++
Total cost: 0.96844, Reconstruction: 0.74652, Clustering: 0.22192,
Fine-tuning epoch 27 ++++
Total cost: 0.96729, Reconstruction: 0.74596, Clustering: 0.22133,
Fine-tuning epoch 28 ++++
Total cost: 0.95990, Reconstruction: 0.73829, Clustering: 0.22161,
Fine-tuning epoch 29 ++++
Total cost: 0.94886, Reconstruction: 0.72942, Clustering: 0.21945,
Fine-tuning epoch 30 ++++
Total cost: 0.94824, Reconstruction: 0.72748, Clustering: 0.22075,
Fine-tuning epoch 31 ++++
Total cost: 0.93782, Reconstruction: 0.72024, Clustering: 0.21758,
Fine-tuning epoch 32 ++++
Total cost: 0.93317, Reconstruction: 0.71678, Clustering: 0.21638,
Fine-tuning epoch 33 ++++
Total cost: 0.92698, Reconstruction: 0.71054, Clustering: 0.21644,
Fine-tuning epoch 34 ++++
Total cost: 0.91609, Reconstruction: 0.70255, Clustering: 0.21355,
Fine-tuning epoch 35 ++++
Total cost: 0.91710, Reconstruction: 0.70142, Clustering: 0.21568,
Fine-tuning epoch 36 ++++
Total cost: 0.90584, Reconstruction: 0.69361, Clustering: 0.21223,
Fine-tuning epoch 37 ++++
Total cost: 0.90364, Reconstruction: 0.69037, Clustering: 0.21327,
Fine-tuning epoch 38 ++++
Total cost: 0.89805, Reconstruction: 0.68596, Clustering: 0.21209,
Fine-tuning epoch 39 ++++
Total cost: 0.89091, Reconstruction: 0.68015, Clustering: 0.21075,
Fine-tuning epoch 40 ++++
Total cost: 0.88640, Reconstruction: 0.67624, Clustering: 0.21016,
Fine-tuning epoch 41 ++++
Total cost: 0.88077, Reconstruction: 0.67169, Clustering: 0.20908,
Fine-tuning epoch 42 ++++
Total cost: 0.87646, Reconstruction: 0.66758, Clustering: 0.20888,
Fine-tuning epoch 43 ++++
Total cost: 0.86888, Reconstruction: 0.66162, Clustering: 0.20726,
Fine-tuning epoch 44 ++++
Total cost: 0.86421, Reconstruction: 0.65817, Clustering: 0.20604,
Fine-tuning epoch 45 ++++
Total cost: 0.85771, Reconstruction: 0.65260, Clustering: 0.20511,
Fine-tuning epoch 46 ++++
Total cost: 0.85151, Reconstruction: 0.64793, Clustering: 0.20358,
Fine-tuning epoch 47 ++++
Total cost: 0.84772, Reconstruction: 0.64414, Clustering: 0.20358,
Fine-tuning epoch 48 ++++
Total cost: 0.84398, Reconstruction: 0.64083, Clustering: 0.20314,
Fine-tuning epoch 49 ++++
Total cost: 0.83865, Reconstruction: 0.63641, Clustering: 0.20224,
Fine-tuning epoch 50 ++++
Total cost: 0.83111, Reconstruction: 0.63109, Clustering: 0.20002,
Average squared 2-D reconstruction error: 0.6311
NMI for deep clustering: 0.57
ARI for deep clustering: 0.39
ACC for deep clustering: 0.54
The training code for file multi_layer_km.pyc ran for 61.63m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.15317328557
Pre-training layer 0, epoch 1, cost  0.982551262783
Pre-training layer 0, epoch 2, cost  0.791125094699
Pre-training layer 0, epoch 3, cost  0.703620867601
Pre-training layer 0, epoch 4, cost  0.650091831753
Pre-training layer 0, epoch 5, cost  0.612223999783
Pre-training layer 0, epoch 6, cost  0.583424337406
Pre-training layer 0, epoch 7, cost  0.560515108479
Pre-training layer 0, epoch 8, cost  0.541593477623
Pre-training layer 0, epoch 9, cost  0.525587401434
Pre-training layer 0, epoch 10, cost  0.511636563512
Pre-training layer 0, epoch 11, cost  0.499427025094
Pre-training layer 0, epoch 12, cost  0.488613222472
Pre-training layer 0, epoch 13, cost  0.478905377345
Pre-training layer 0, epoch 14, cost  0.47001927851
Pre-training layer 0, epoch 15, cost  0.461966523972
Pre-training layer 0, epoch 16, cost  0.454475368695
Pre-training layer 0, epoch 17, cost  0.447566798975
Pre-training layer 0, epoch 18, cost  0.441228492453
Pre-training layer 0, epoch 19, cost  0.435311419657
Pre-training layer 0, epoch 20, cost  0.429853915504
Pre-training layer 0, epoch 21, cost  0.42473518462
Pre-training layer 0, epoch 22, cost  0.419904575946
Pre-training layer 0, epoch 23, cost  0.415245057682
Pre-training layer 0, epoch 24, cost  0.410944601199
Pre-training layer 0, epoch 25, cost  0.406908137408
Pre-training layer 0, epoch 26, cost  0.403079154641
Pre-training layer 0, epoch 27, cost  0.39937688798
Pre-training layer 0, epoch 28, cost  0.395868023809
Pre-training layer 0, epoch 29, cost  0.392546969833
Pre-training layer 0, epoch 30, cost  0.389404326626
Pre-training layer 0, epoch 31, cost  0.386401915797
Pre-training layer 0, epoch 32, cost  0.38353479064
Pre-training layer 0, epoch 33, cost  0.380788079733
Pre-training layer 0, epoch 34, cost  0.378162914851
Pre-training layer 0, epoch 35, cost  0.375645818263
Pre-training layer 0, epoch 36, cost  0.373214704989
Pre-training layer 0, epoch 37, cost  0.370882592267
Pre-training layer 0, epoch 38, cost  0.368637786781
Pre-training layer 0, epoch 39, cost  0.366472094921
Pre-training layer 0, epoch 40, cost  0.364380251898
Pre-training layer 0, epoch 41, cost  0.362358973974
Pre-training layer 0, epoch 42, cost  0.360401884344
Pre-training layer 0, epoch 43, cost  0.358509329324
Pre-training layer 0, epoch 44, cost  0.356683171498
Pre-training layer 0, epoch 45, cost  0.354910559602
Pre-training layer 0, epoch 46, cost  0.353191848404
Pre-training layer 0, epoch 47, cost  0.351522521568
Pre-training layer 0, epoch 48, cost  0.349900572484
Pre-training layer 0, epoch 49, cost  0.348319968555
Pre-training layer 1, epoch 0, cost  3.89271164053
Pre-training layer 1, epoch 1, cost  1.03470667182
Pre-training layer 1, epoch 2, cost  0.747481574146
Pre-training layer 1, epoch 3, cost  0.624098126742
Pre-training layer 1, epoch 4, cost  0.553107528355
Pre-training layer 1, epoch 5, cost  0.504397257691
Pre-training layer 1, epoch 6, cost  0.468171517563
Pre-training layer 1, epoch 7, cost  0.439525372392
Pre-training layer 1, epoch 8, cost  0.416050159593
Pre-training layer 1, epoch 9, cost  0.396088146901
Pre-training layer 1, epoch 10, cost  0.379314652381
Pre-training layer 1, epoch 11, cost  0.364849117429
Pre-training layer 1, epoch 12, cost  0.35213882115
Pre-training layer 1, epoch 13, cost  0.340854754173
Pre-training layer 1, epoch 14, cost  0.330428640305
Pre-training layer 1, epoch 15, cost  0.321919259189
Pre-training layer 1, epoch 16, cost  0.313253179483
Pre-training layer 1, epoch 17, cost  0.305460570953
Pre-training layer 1, epoch 18, cost  0.29858219647
Pre-training layer 1, epoch 19, cost  0.292046881561
Pre-training layer 1, epoch 20, cost  0.286261758247
Pre-training layer 1, epoch 21, cost  0.281041065692
Pre-training layer 1, epoch 22, cost  0.275441357479
Pre-training layer 1, epoch 23, cost  0.270979055284
Pre-training layer 1, epoch 24, cost  0.266487858445
Pre-training layer 1, epoch 25, cost  0.262298819327
Pre-training layer 1, epoch 26, cost  0.258378731156
Pre-training layer 1, epoch 27, cost  0.254463574156
Pre-training layer 1, epoch 28, cost  0.25116990003
Pre-training layer 1, epoch 29, cost  0.247380089178
Pre-training layer 1, epoch 30, cost  0.244450288928
Pre-training layer 1, epoch 31, cost  0.241584596872
Pre-training layer 1, epoch 32, cost  0.238687634149
Pre-training layer 1, epoch 33, cost  0.2359999072
Pre-training layer 1, epoch 34, cost  0.233562825397
Pre-training layer 1, epoch 35, cost  0.230724954094
Pre-training layer 1, epoch 36, cost  0.228577366006
Pre-training layer 1, epoch 37, cost  0.226200615521
Pre-training layer 1, epoch 38, cost  0.224062772328
Pre-training layer 1, epoch 39, cost  0.222457057123
Pre-training layer 1, epoch 40, cost  0.220340644247
Pre-training layer 1, epoch 41, cost  0.21824414421
Pre-training layer 1, epoch 42, cost  0.21654993797
Pre-training layer 1, epoch 43, cost  0.214714895846
Pre-training layer 1, epoch 44, cost  0.213285436505
Pre-training layer 1, epoch 45, cost  0.211685355981
Pre-training layer 1, epoch 46, cost  0.210142246722
Pre-training layer 1, epoch 47, cost  0.208534953803
Pre-training layer 1, epoch 48, cost  0.207003490353
Pre-training layer 1, epoch 49, cost  0.205871933386
Pre-training layer 2, epoch 0, cost  4.80997737757
Pre-training layer 2, epoch 1, cost  1.43244493736
Pre-training layer 2, epoch 2, cost  1.09603833553
Pre-training layer 2, epoch 3, cost  0.929856190288
Pre-training layer 2, epoch 4, cost  0.82237148931
Pre-training layer 2, epoch 5, cost  0.752005030649
Pre-training layer 2, epoch 6, cost  0.721471801158
Pre-training layer 2, epoch 7, cost  0.664995216151
Pre-training layer 2, epoch 8, cost  0.64383071982
Pre-training layer 2, epoch 9, cost  0.623103526567
Pre-training layer 2, epoch 10, cost  0.607072503087
Pre-training layer 2, epoch 11, cost  0.576387805488
Pre-training layer 2, epoch 12, cost  0.57656744949
Pre-training layer 2, epoch 13, cost  0.553922329027
Pre-training layer 2, epoch 14, cost  0.546651161638
Pre-training layer 2, epoch 15, cost  0.536907016981
Pre-training layer 2, epoch 16, cost  0.526314121639
Pre-training layer 2, epoch 17, cost  0.516826642318
Pre-training layer 2, epoch 18, cost  0.512365123743
Pre-training layer 2, epoch 19, cost  0.505441163056
Pre-training layer 2, epoch 20, cost  0.499882703055
Pre-training layer 2, epoch 21, cost  0.4913567231
Pre-training layer 2, epoch 22, cost  0.489670718291
Pre-training layer 2, epoch 23, cost  0.484336391543
Pre-training layer 2, epoch 24, cost  0.479824361975
Pre-training layer 2, epoch 25, cost  0.477199787234
Pre-training layer 2, epoch 26, cost  0.475395752541
Pre-training layer 2, epoch 27, cost  0.471308946494
Pre-training layer 2, epoch 28, cost  0.466613105131
Pre-training layer 2, epoch 29, cost  0.464419004754
Pre-training layer 2, epoch 30, cost  0.462327038498
Pre-training layer 2, epoch 31, cost  0.460017154157
Pre-training layer 2, epoch 32, cost  0.458217058269
Pre-training layer 2, epoch 33, cost  0.455304147791
Pre-training layer 2, epoch 34, cost  0.45386498825
Pre-training layer 2, epoch 35, cost  0.451490254317
Pre-training layer 2, epoch 36, cost  0.449808195058
Pre-training layer 2, epoch 37, cost  0.448325267122
Pre-training layer 2, epoch 38, cost  0.446382743205
Pre-training layer 2, epoch 39, cost  0.444958332014
Pre-training layer 2, epoch 40, cost  0.443742315135
Pre-training layer 2, epoch 41, cost  0.442462370212
Pre-training layer 2, epoch 42, cost  0.441106918109
Pre-training layer 2, epoch 43, cost  0.439876685349
Pre-training layer 2, epoch 44, cost  0.438738754373
Pre-training layer 2, epoch 45, cost  0.437623545643
Pre-training layer 2, epoch 46, cost  0.436789475591
Pre-training layer 2, epoch 47, cost  0.435599783826
Pre-training layer 2, epoch 48, cost  0.434659152662
Pre-training layer 2, epoch 49, cost  0.434099241516
Pre-training layer 3, epoch 0, cost  3.59825870544
Pre-training layer 3, epoch 1, cost  0.700088182377
Pre-training layer 3, epoch 2, cost  0.439782498798
Pre-training layer 3, epoch 3, cost  0.310006824033
Pre-training layer 3, epoch 4, cost  0.2386849538
Pre-training layer 3, epoch 5, cost  0.192001888052
Pre-training layer 3, epoch 6, cost  0.161618522317
Pre-training layer 3, epoch 7, cost  0.141547618315
Pre-training layer 3, epoch 8, cost  0.124253588963
Pre-training layer 3, epoch 9, cost  0.110778667906
Pre-training layer 3, epoch 10, cost  0.101777602268
Pre-training layer 3, epoch 11, cost  0.094974548793
Pre-training layer 3, epoch 12, cost  0.0879690196396
Pre-training layer 3, epoch 13, cost  0.0815203824376
Pre-training layer 3, epoch 14, cost  0.0774777446045
Pre-training layer 3, epoch 15, cost  0.0729912058995
Pre-training layer 3, epoch 16, cost  0.0697428900063
Pre-training layer 3, epoch 17, cost  0.066394582426
Pre-training layer 3, epoch 18, cost  0.0632992895306
Pre-training layer 3, epoch 19, cost  0.0604494379485
Pre-training layer 3, epoch 20, cost  0.0576671200738
Pre-training layer 3, epoch 21, cost  0.0549942079575
Pre-training layer 3, epoch 22, cost  0.052437417738
Pre-training layer 3, epoch 23, cost  0.0503003876337
Pre-training layer 3, epoch 24, cost  0.0486972298303
Pre-training layer 3, epoch 25, cost  0.047252491218
Pre-training layer 3, epoch 26, cost  0.045514047067
Pre-training layer 3, epoch 27, cost  0.0437390183098
Pre-training layer 3, epoch 28, cost  0.0424900459853
Pre-training layer 3, epoch 29, cost  0.0410019813784
Pre-training layer 3, epoch 30, cost  0.0397352296282
Pre-training layer 3, epoch 31, cost  0.0384677978753
Pre-training layer 3, epoch 32, cost  0.0373598242783
Pre-training layer 3, epoch 33, cost  0.036156353829
Pre-training layer 3, epoch 34, cost  0.0351942572507
Pre-training layer 3, epoch 35, cost  0.0341444077917
Pre-training layer 3, epoch 36, cost  0.0331652788539
Pre-training layer 3, epoch 37, cost  0.0322813738221
Pre-training layer 3, epoch 38, cost  0.031418547017
Pre-training layer 3, epoch 39, cost  0.0305838529446
Pre-training layer 3, epoch 40, cost  0.0297831667041
Pre-training layer 3, epoch 41, cost  0.0290302884774
Pre-training layer 3, epoch 42, cost  0.0283155233834
Pre-training layer 3, epoch 43, cost  0.0276394716084
Pre-training layer 3, epoch 44, cost  0.0269770354877
Pre-training layer 3, epoch 45, cost  0.0263409322153
Pre-training layer 3, epoch 46, cost  0.0257219999518
Pre-training layer 3, epoch 47, cost  0.0250202248642
Pre-training layer 3, epoch 48, cost  0.0241199549468
Pre-training layer 3, epoch 49, cost  0.0231348918519
Pre-training layer 4, epoch 0, cost  4.21857594711
Pre-training layer 4, epoch 1, cost  1.16712745318
Pre-training layer 4, epoch 2, cost  0.962491609877
Pre-training layer 4, epoch 3, cost  0.926804231792
Pre-training layer 4, epoch 4, cost  0.909608145395
Pre-training layer 4, epoch 5, cost  0.897014124285
Pre-training layer 4, epoch 6, cost  0.888039991682
Pre-training layer 4, epoch 7, cost  0.88102328142
Pre-training layer 4, epoch 8, cost  0.875210054274
Pre-training layer 4, epoch 9, cost  0.870414681653
Pre-training layer 4, epoch 10, cost  0.866304584723
Pre-training layer 4, epoch 11, cost  0.86271277749
Pre-training layer 4, epoch 12, cost  0.859554531158
Pre-training layer 4, epoch 13, cost  0.856742540391
Pre-training layer 4, epoch 14, cost  0.854210654789
Pre-training layer 4, epoch 15, cost  0.851965421958
Pre-training layer 4, epoch 16, cost  0.84984942639
Pre-training layer 4, epoch 17, cost  0.847991804822
Pre-training layer 4, epoch 18, cost  0.846225910686
Pre-training layer 4, epoch 19, cost  0.844588962328
Pre-training layer 4, epoch 20, cost  0.843134359756
Pre-training layer 4, epoch 21, cost  0.841766892413
Pre-training layer 4, epoch 22, cost  0.840506270115
Pre-training layer 4, epoch 23, cost  0.839290399085
Pre-training layer 4, epoch 24, cost  0.838172026123
Pre-training layer 4, epoch 25, cost  0.837135169141
Pre-training layer 4, epoch 26, cost  0.836155256541
Pre-training layer 4, epoch 27, cost  0.8352337002
Pre-training layer 4, epoch 28, cost  0.834373897152
Pre-training layer 4, epoch 29, cost  0.833566441867
Pre-training layer 4, epoch 30, cost  0.832785563279
Pre-training layer 4, epoch 31, cost  0.832074985706
Pre-training layer 4, epoch 32, cost  0.831385596616
Pre-training layer 4, epoch 33, cost  0.830728679332
Pre-training layer 4, epoch 34, cost  0.830118922507
Pre-training layer 4, epoch 35, cost  0.829519056151
Pre-training layer 4, epoch 36, cost  0.828965258952
Pre-training layer 4, epoch 37, cost  0.828436647244
Pre-training layer 4, epoch 38, cost  0.827929319142
Pre-training layer 4, epoch 39, cost  0.827451014199
Pre-training layer 4, epoch 40, cost  0.826975911393
Pre-training layer 4, epoch 41, cost  0.826548056104
Pre-training layer 4, epoch 42, cost  0.826116600344
Pre-training layer 4, epoch 43, cost  0.825715111097
Pre-training layer 4, epoch 44, cost  0.825334188992
Pre-training layer 4, epoch 45, cost  0.82495911032
Pre-training layer 4, epoch 46, cost  0.824607360549
Pre-training layer 4, epoch 47, cost  0.824257966509
Pre-training layer 4, epoch 48, cost  0.823951082328
Pre-training layer 4, epoch 49, cost  0.823633587741
Pre-training layer 5, epoch 0, cost  5.4155245581
Pre-training layer 5, epoch 1, cost  3.44236964665
Pre-training layer 5, epoch 2, cost  3.4288918631
Pre-training layer 5, epoch 3, cost  3.42434181594
Pre-training layer 5, epoch 4, cost  3.42165511674
Pre-training layer 5, epoch 5, cost  3.4198467236
Pre-training layer 5, epoch 6, cost  3.41852227294
Pre-training layer 5, epoch 7, cost  3.41742229018
Pre-training layer 5, epoch 8, cost  3.41640568169
Pre-training layer 5, epoch 9, cost  3.41538152858
Pre-training layer 5, epoch 10, cost  3.41428201758
Pre-training layer 5, epoch 11, cost  3.41304019832
Pre-training layer 5, epoch 12, cost  3.411576846
Pre-training layer 5, epoch 13, cost  3.40978087285
Pre-training layer 5, epoch 14, cost  3.40749018995
Pre-training layer 5, epoch 15, cost  3.40445353517
Pre-training layer 5, epoch 16, cost  3.40027730806
Pre-training layer 5, epoch 17, cost  3.39437298064
Pre-training layer 5, epoch 18, cost  3.38614521536
Pre-training layer 5, epoch 19, cost  3.37618697163
Pre-training layer 5, epoch 20, cost  3.36771239383
Pre-training layer 5, epoch 21, cost  3.36283382599
Pre-training layer 5, epoch 22, cost  3.36016063035
Pre-training layer 5, epoch 23, cost  3.35842931823
Pre-training layer 5, epoch 24, cost  3.35717246212
Pre-training layer 5, epoch 25, cost  3.35619352104
Pre-training layer 5, epoch 26, cost  3.35539316155
Pre-training layer 5, epoch 27, cost  3.35471414331
Pre-training layer 5, epoch 28, cost  3.35412417511
Pre-training layer 5, epoch 29, cost  3.35359974435
Pre-training layer 5, epoch 30, cost  3.35312711321
Pre-training layer 5, epoch 31, cost  3.35269529002
Pre-training layer 5, epoch 32, cost  3.35229741572
Pre-training layer 5, epoch 33, cost  3.35192819501
Pre-training layer 5, epoch 34, cost  3.35158320734
Pre-training layer 5, epoch 35, cost  3.35125925465
Pre-training layer 5, epoch 36, cost  3.35095378627
Pre-training layer 5, epoch 37, cost  3.35066424651
Pre-training layer 5, epoch 38, cost  3.35038953521
Pre-training layer 5, epoch 39, cost  3.35012791999
Pre-training layer 5, epoch 40, cost  3.34987794338
Pre-training layer 5, epoch 41, cost  3.34963897923
Pre-training layer 5, epoch 42, cost  3.3494102971
Pre-training layer 5, epoch 43, cost  3.34919087714
Pre-training layer 5, epoch 44, cost  3.34897976856
Pre-training layer 5, epoch 45, cost  3.34877725873
Pre-training layer 5, epoch 46, cost  3.34858217286
Pre-training layer 5, epoch 47, cost  3.34839422582
Pre-training layer 5, epoch 48, cost  3.34821299433
The pretraining code for file multi_layer_km.pyc ran for 69.50m
Pre-training layer 5, epoch 49, cost  3.34803810895
Initial NMI for deep clustering: 0.50
ARI for deep clustering: 0.37
ACC for deep clustering: 0.53
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.28495, Reconstruction: 1.97517, Clustering: 0.30978,
Fine-tuning epoch 2 ++++
Total cost: 1.60890, Reconstruction: 1.29234, Clustering: 0.31656,
Fine-tuning epoch 3 ++++
Total cost: 1.45209, Reconstruction: 1.15239, Clustering: 0.29970,
Fine-tuning epoch 4 ++++
Total cost: 1.35808, Reconstruction: 1.07278, Clustering: 0.28530,
Fine-tuning epoch 5 ++++
Total cost: 1.28415, Reconstruction: 1.01148, Clustering: 0.27267,
Fine-tuning epoch 6 ++++
Total cost: 1.23767, Reconstruction: 0.97307, Clustering: 0.26460,
Fine-tuning epoch 7 ++++
Total cost: 1.20381, Reconstruction: 0.94575, Clustering: 0.25806,
Fine-tuning epoch 8 ++++
Total cost: 1.17268, Reconstruction: 0.92074, Clustering: 0.25194,
Fine-tuning epoch 9 ++++
Total cost: 1.15509, Reconstruction: 0.90608, Clustering: 0.24901,
Fine-tuning epoch 10 ++++
Total cost: 1.13454, Reconstruction: 0.88911, Clustering: 0.24544,
Fine-tuning epoch 11 ++++
Total cost: 1.11695, Reconstruction: 0.87450, Clustering: 0.24245,
Fine-tuning epoch 12 ++++
Total cost: 1.10440, Reconstruction: 0.86385, Clustering: 0.24056,
Fine-tuning epoch 13 ++++
Total cost: 1.08548, Reconstruction: 0.84849, Clustering: 0.23698,
Fine-tuning epoch 14 ++++
Total cost: 1.07549, Reconstruction: 0.84039, Clustering: 0.23510,
Fine-tuning epoch 15 ++++
Total cost: 1.06242, Reconstruction: 0.82962, Clustering: 0.23280,
Fine-tuning epoch 16 ++++
Total cost: 1.05033, Reconstruction: 0.81850, Clustering: 0.23182,
Fine-tuning epoch 17 ++++
Total cost: 1.04014, Reconstruction: 0.80934, Clustering: 0.23080,
Fine-tuning epoch 18 ++++
Total cost: 1.02510, Reconstruction: 0.79692, Clustering: 0.22817,
Fine-tuning epoch 19 ++++
Total cost: 1.02424, Reconstruction: 0.79391, Clustering: 0.23034,
Fine-tuning epoch 20 ++++
Total cost: 1.01293, Reconstruction: 0.78406, Clustering: 0.22887,
Fine-tuning epoch 21 ++++
Total cost: 1.00412, Reconstruction: 0.77693, Clustering: 0.22719,
Fine-tuning epoch 22 ++++
Total cost: 0.99598, Reconstruction: 0.76981, Clustering: 0.22617,
Fine-tuning epoch 23 ++++
Total cost: 0.99405, Reconstruction: 0.76654, Clustering: 0.22751,
Fine-tuning epoch 24 ++++
Total cost: 0.98353, Reconstruction: 0.75832, Clustering: 0.22522,
Fine-tuning epoch 25 ++++
Total cost: 0.97600, Reconstruction: 0.75254, Clustering: 0.22346,
Fine-tuning epoch 26 ++++
Total cost: 0.96805, Reconstruction: 0.74550, Clustering: 0.22254,
Fine-tuning epoch 27 ++++
Total cost: 0.96482, Reconstruction: 0.74272, Clustering: 0.22209,
Fine-tuning epoch 28 ++++
Total cost: 0.96139, Reconstruction: 0.73838, Clustering: 0.22301,
Fine-tuning epoch 29 ++++
Total cost: 0.95215, Reconstruction: 0.73096, Clustering: 0.22119,
Fine-tuning epoch 30 ++++
Total cost: 0.94509, Reconstruction: 0.72552, Clustering: 0.21957,
Fine-tuning epoch 31 ++++
Total cost: 0.94063, Reconstruction: 0.72116, Clustering: 0.21947,
Fine-tuning epoch 32 ++++
Total cost: 0.93296, Reconstruction: 0.71597, Clustering: 0.21699,
Fine-tuning epoch 33 ++++
Total cost: 0.93560, Reconstruction: 0.71602, Clustering: 0.21958,
Fine-tuning epoch 34 ++++
Total cost: 0.92411, Reconstruction: 0.70724, Clustering: 0.21687,
Fine-tuning epoch 35 ++++
Total cost: 0.92258, Reconstruction: 0.70538, Clustering: 0.21720,
Fine-tuning epoch 36 ++++
Total cost: 0.91565, Reconstruction: 0.69930, Clustering: 0.21635,
Fine-tuning epoch 37 ++++
Total cost: 0.90920, Reconstruction: 0.69484, Clustering: 0.21436,
Fine-tuning epoch 38 ++++
Total cost: 0.90821, Reconstruction: 0.69245, Clustering: 0.21576,
Fine-tuning epoch 39 ++++
Total cost: 0.89806, Reconstruction: 0.68526, Clustering: 0.21281,
Fine-tuning epoch 40 ++++
Total cost: 0.88904, Reconstruction: 0.67806, Clustering: 0.21098,
Fine-tuning epoch 41 ++++
Total cost: 0.89159, Reconstruction: 0.67967, Clustering: 0.21192,
Fine-tuning epoch 42 ++++
Total cost: 0.88180, Reconstruction: 0.67101, Clustering: 0.21079,
Fine-tuning epoch 43 ++++
Total cost: 0.87291, Reconstruction: 0.66430, Clustering: 0.20861,
Fine-tuning epoch 44 ++++
Total cost: 0.87284, Reconstruction: 0.66310, Clustering: 0.20974,
Fine-tuning epoch 45 ++++
Total cost: 0.86256, Reconstruction: 0.65508, Clustering: 0.20748,
Fine-tuning epoch 46 ++++
Total cost: 0.86145, Reconstruction: 0.65437, Clustering: 0.20707,
Fine-tuning epoch 47 ++++
Total cost: 0.85613, Reconstruction: 0.64916, Clustering: 0.20698,
Fine-tuning epoch 48 ++++
Total cost: 0.84842, Reconstruction: 0.64317, Clustering: 0.20525,
Fine-tuning epoch 49 ++++
Total cost: 0.84763, Reconstruction: 0.64235, Clustering: 0.20527,
Fine-tuning epoch 50 ++++
Total cost: 0.84901, Reconstruction: 0.64190, Clustering: 0.20711,
Average squared 2-D reconstruction error: 0.6419
NMI for deep clustering: 0.57
ARI for deep clustering: 0.40
ACC for deep clustering: 0.54
The training code for file multi_layer_km.pyc ran for 62.82m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.14632460456
Pre-training layer 0, epoch 1, cost  0.978122635623
Pre-training layer 0, epoch 2, cost  0.787316266284
Pre-training layer 0, epoch 3, cost  0.700300543793
Pre-training layer 0, epoch 4, cost  0.647134075884
Pre-training layer 0, epoch 5, cost  0.609748136058
Pre-training layer 0, epoch 6, cost  0.581128182843
Pre-training layer 0, epoch 7, cost  0.557973839371
Pre-training layer 0, epoch 8, cost  0.538688558631
Pre-training layer 0, epoch 9, cost  0.522355804253
Pre-training layer 0, epoch 10, cost  0.508146415124
Pre-training layer 0, epoch 11, cost  0.495811967541
Pre-training layer 0, epoch 12, cost  0.484784904195
Pre-training layer 0, epoch 13, cost  0.474913801525
Pre-training layer 0, epoch 14, cost  0.46601179597
Pre-training layer 0, epoch 15, cost  0.457916113981
Pre-training layer 0, epoch 16, cost  0.450533903176
Pre-training layer 0, epoch 17, cost  0.443705340671
Pre-training layer 0, epoch 18, cost  0.437397322925
Pre-training layer 0, epoch 19, cost  0.431457361095
Pre-training layer 0, epoch 20, cost  0.425946086453
Pre-training layer 0, epoch 21, cost  0.420751414061
Pre-training layer 0, epoch 22, cost  0.415974479124
Pre-training layer 0, epoch 23, cost  0.411486046697
Pre-training layer 0, epoch 24, cost  0.407243743342
Pre-training layer 0, epoch 25, cost  0.403232243215
Pre-training layer 0, epoch 26, cost  0.399436041245
Pre-training layer 0, epoch 27, cost  0.395687677817
Pre-training layer 0, epoch 28, cost  0.392138488859
Pre-training layer 0, epoch 29, cost  0.388823376921
Pre-training layer 0, epoch 30, cost  0.385656905503
Pre-training layer 0, epoch 31, cost  0.382662364593
Pre-training layer 0, epoch 32, cost  0.37978366105
Pre-training layer 0, epoch 33, cost  0.377043082176
Pre-training layer 0, epoch 34, cost  0.374425631507
Pre-training layer 0, epoch 35, cost  0.371906532295
Pre-training layer 0, epoch 36, cost  0.369489892802
Pre-training layer 0, epoch 37, cost  0.367158871977
Pre-training layer 0, epoch 38, cost  0.364925679431
Pre-training layer 0, epoch 39, cost  0.362773045193
Pre-training layer 0, epoch 40, cost  0.360698333852
Pre-training layer 0, epoch 41, cost  0.358700451509
Pre-training layer 0, epoch 42, cost  0.356763884683
Pre-training layer 0, epoch 43, cost  0.354910192462
Pre-training layer 0, epoch 44, cost  0.353106080886
Pre-training layer 0, epoch 45, cost  0.351371732098
Pre-training layer 0, epoch 46, cost  0.349684611985
Pre-training layer 0, epoch 47, cost  0.348045230238
Pre-training layer 0, epoch 48, cost  0.346458816712
Pre-training layer 0, epoch 49, cost  0.344907151596
Pre-training layer 1, epoch 0, cost  3.87984319863
Pre-training layer 1, epoch 1, cost  1.01526592022
Pre-training layer 1, epoch 2, cost  0.735191081256
Pre-training layer 1, epoch 3, cost  0.613891780695
Pre-training layer 1, epoch 4, cost  0.545083924982
Pre-training layer 1, epoch 5, cost  0.498151204037
Pre-training layer 1, epoch 6, cost  0.462858543282
Pre-training layer 1, epoch 7, cost  0.434762003276
Pre-training layer 1, epoch 8, cost  0.412008201844
Pre-training layer 1, epoch 9, cost  0.39324562274
Pre-training layer 1, epoch 10, cost  0.376478262057
Pre-training layer 1, epoch 11, cost  0.362183575188
Pre-training layer 1, epoch 12, cost  0.349064841261
Pre-training layer 1, epoch 13, cost  0.338158817756
Pre-training layer 1, epoch 14, cost  0.328207971592
Pre-training layer 1, epoch 15, cost  0.318997336836
Pre-training layer 1, epoch 16, cost  0.310415545296
Pre-training layer 1, epoch 17, cost  0.30346704228
Pre-training layer 1, epoch 18, cost  0.295844740123
Pre-training layer 1, epoch 19, cost  0.289910734004
Pre-training layer 1, epoch 20, cost  0.28347819277
Pre-training layer 1, epoch 21, cost  0.278371430744
Pre-training layer 1, epoch 22, cost  0.27341823112
Pre-training layer 1, epoch 23, cost  0.268034001032
Pre-training layer 1, epoch 24, cost  0.263929141084
Pre-training layer 1, epoch 25, cost  0.2597124929
Pre-training layer 1, epoch 26, cost  0.256041581499
Pre-training layer 1, epoch 27, cost  0.252198108584
Pre-training layer 1, epoch 28, cost  0.248611593087
Pre-training layer 1, epoch 29, cost  0.244813373229
Pre-training layer 1, epoch 30, cost  0.241934486127
Pre-training layer 1, epoch 31, cost  0.23896118763
Pre-training layer 1, epoch 32, cost  0.236229446405
Pre-training layer 1, epoch 33, cost  0.233474417896
Pre-training layer 1, epoch 34, cost  0.230936586524
Pre-training layer 1, epoch 35, cost  0.228624203304
Pre-training layer 1, epoch 36, cost  0.226125796165
Pre-training layer 1, epoch 37, cost  0.224013449603
Pre-training layer 1, epoch 38, cost  0.221889317661
Pre-training layer 1, epoch 39, cost  0.219740252267
Pre-training layer 1, epoch 40, cost  0.217648513309
Pre-training layer 1, epoch 41, cost  0.215811612887
Pre-training layer 1, epoch 42, cost  0.214155890411
Pre-training layer 1, epoch 43, cost  0.212361463382
Pre-training layer 1, epoch 44, cost  0.210515177294
Pre-training layer 1, epoch 45, cost  0.208957229528
Pre-training layer 1, epoch 46, cost  0.207459541301
Pre-training layer 1, epoch 47, cost  0.205902123652
Pre-training layer 1, epoch 48, cost  0.204575765495
Pre-training layer 1, epoch 49, cost  0.203324776972
Pre-training layer 2, epoch 0, cost  4.81215904533
Pre-training layer 2, epoch 1, cost  1.40662226705
Pre-training layer 2, epoch 2, cost  1.06955228088
Pre-training layer 2, epoch 3, cost  0.90781427085
Pre-training layer 2, epoch 4, cost  0.810803637977
Pre-training layer 2, epoch 5, cost  0.752920611337
Pre-training layer 2, epoch 6, cost  0.686976414785
Pre-training layer 2, epoch 7, cost  0.670886398324
Pre-training layer 2, epoch 8, cost  0.631011506623
Pre-training layer 2, epoch 9, cost  0.60439704528
Pre-training layer 2, epoch 10, cost  0.584974025638
Pre-training layer 2, epoch 11, cost  0.579376089462
Pre-training layer 2, epoch 12, cost  0.555598156828
Pre-training layer 2, epoch 13, cost  0.541650223542
Pre-training layer 2, epoch 14, cost  0.533966271736
Pre-training layer 2, epoch 15, cost  0.525982551235
Pre-training layer 2, epoch 16, cost  0.518482427797
Pre-training layer 2, epoch 17, cost  0.507147736942
Pre-training layer 2, epoch 18, cost  0.498538822386
Pre-training layer 2, epoch 19, cost  0.494069201345
Pre-training layer 2, epoch 20, cost  0.49052073965
Pre-training layer 2, epoch 21, cost  0.480269440174
Pre-training layer 2, epoch 22, cost  0.476431047803
Pre-training layer 2, epoch 23, cost  0.474656077309
Pre-training layer 2, epoch 24, cost  0.473843248952
Pre-training layer 2, epoch 25, cost  0.467290232116
Pre-training layer 2, epoch 26, cost  0.463173352799
Pre-training layer 2, epoch 27, cost  0.460378578076
Pre-training layer 2, epoch 28, cost  0.457545273019
Pre-training layer 2, epoch 29, cost  0.453184796567
Pre-training layer 2, epoch 30, cost  0.450556657547
Pre-training layer 2, epoch 31, cost  0.449902575177
Pre-training layer 2, epoch 32, cost  0.446276658185
Pre-training layer 2, epoch 33, cost  0.444224775444
Pre-training layer 2, epoch 34, cost  0.442648012007
Pre-training layer 2, epoch 35, cost  0.440697663759
Pre-training layer 2, epoch 36, cost  0.437884065411
Pre-training layer 2, epoch 37, cost  0.438288774212
Pre-training layer 2, epoch 38, cost  0.434897967534
Pre-training layer 2, epoch 39, cost  0.433584755119
Pre-training layer 2, epoch 40, cost  0.433047663902
Pre-training layer 2, epoch 41, cost  0.431857995264
Pre-training layer 2, epoch 42, cost  0.430275946679
Pre-training layer 2, epoch 43, cost  0.42900824104
Pre-training layer 2, epoch 44, cost  0.427255568687
Pre-training layer 2, epoch 45, cost  0.426019057948
Pre-training layer 2, epoch 46, cost  0.42515902394
Pre-training layer 2, epoch 47, cost  0.424738679952
Pre-training layer 2, epoch 48, cost  0.42411987795
Pre-training layer 2, epoch 49, cost  0.423175194107
Pre-training layer 3, epoch 0, cost  3.61634694582
Pre-training layer 3, epoch 1, cost  0.697733248586
Pre-training layer 3, epoch 2, cost  0.436680139847
Pre-training layer 3, epoch 3, cost  0.30894936464
Pre-training layer 3, epoch 4, cost  0.238755926385
Pre-training layer 3, epoch 5, cost  0.191548053481
Pre-training layer 3, epoch 6, cost  0.162465510602
Pre-training layer 3, epoch 7, cost  0.143193223148
Pre-training layer 3, epoch 8, cost  0.126478781417
Pre-training layer 3, epoch 9, cost  0.113948552821
Pre-training layer 3, epoch 10, cost  0.103723867543
Pre-training layer 3, epoch 11, cost  0.0959960294034
Pre-training layer 3, epoch 12, cost  0.0890822503904
Pre-training layer 3, epoch 13, cost  0.0822740541539
Pre-training layer 3, epoch 14, cost  0.078161811767
Pre-training layer 3, epoch 15, cost  0.0733375469313
Pre-training layer 3, epoch 16, cost  0.0698866767831
Pre-training layer 3, epoch 17, cost  0.066284341995
Pre-training layer 3, epoch 18, cost  0.0630963974549
Pre-training layer 3, epoch 19, cost  0.0601662530708
Pre-training layer 3, epoch 20, cost  0.057343666074
Pre-training layer 3, epoch 21, cost  0.0546123153356
Pre-training layer 3, epoch 22, cost  0.0524093456638
Pre-training layer 3, epoch 23, cost  0.0508569072558
Pre-training layer 3, epoch 24, cost  0.0494354220904
Pre-training layer 3, epoch 25, cost  0.047820925274
Pre-training layer 3, epoch 26, cost  0.0460064790828
Pre-training layer 3, epoch 27, cost  0.0443380847282
Pre-training layer 3, epoch 28, cost  0.0429980852973
Pre-training layer 3, epoch 29, cost  0.0415306575695
Pre-training layer 3, epoch 30, cost  0.04023656635
Pre-training layer 3, epoch 31, cost  0.0389767019778
Pre-training layer 3, epoch 32, cost  0.0378215364085
Pre-training layer 3, epoch 33, cost  0.0366688615659
Pre-training layer 3, epoch 34, cost  0.0356211103603
Pre-training layer 3, epoch 35, cost  0.0346144139901
Pre-training layer 3, epoch 36, cost  0.0336338214699
Pre-training layer 3, epoch 37, cost  0.0327157328813
Pre-training layer 3, epoch 38, cost  0.0318296681936
Pre-training layer 3, epoch 39, cost  0.0309384716916
Pre-training layer 3, epoch 40, cost  0.0300293855062
Pre-training layer 3, epoch 41, cost  0.029039875689
Pre-training layer 3, epoch 42, cost  0.0278974895981
Pre-training layer 3, epoch 43, cost  0.0271750646217
Pre-training layer 3, epoch 44, cost  0.0269976170282
Pre-training layer 3, epoch 45, cost  0.0266258138963
Pre-training layer 3, epoch 46, cost  0.0260408220553
Pre-training layer 3, epoch 47, cost  0.0255228555469
Pre-training layer 3, epoch 48, cost  0.0249719757006
Pre-training layer 3, epoch 49, cost  0.0243897592868
Pre-training layer 4, epoch 0, cost  4.24596892332
Pre-training layer 4, epoch 1, cost  1.16739356529
Pre-training layer 4, epoch 2, cost  0.960526000443
Pre-training layer 4, epoch 3, cost  0.926100392599
Pre-training layer 4, epoch 4, cost  0.908548738818
Pre-training layer 4, epoch 5, cost  0.896019148398
Pre-training layer 4, epoch 6, cost  0.887155038893
Pre-training layer 4, epoch 7, cost  0.880233641435
Pre-training layer 4, epoch 8, cost  0.874601503523
Pre-training layer 4, epoch 9, cost  0.86988327743
Pre-training layer 4, epoch 10, cost  0.865781753935
Pre-training layer 4, epoch 11, cost  0.862210968304
Pre-training layer 4, epoch 12, cost  0.859067411351
Pre-training layer 4, epoch 13, cost  0.856287329543
Pre-training layer 4, epoch 14, cost  0.853804616235
Pre-training layer 4, epoch 15, cost  0.851535402967
Pre-training layer 4, epoch 16, cost  0.849497028244
Pre-training layer 4, epoch 17, cost  0.847603815943
Pre-training layer 4, epoch 18, cost  0.845888180171
Pre-training layer 4, epoch 19, cost  0.844330746315
Pre-training layer 4, epoch 20, cost  0.842852497322
Pre-training layer 4, epoch 21, cost  0.841508898294
Pre-training layer 4, epoch 22, cost  0.840232833029
Pre-training layer 4, epoch 23, cost  0.839043664438
Pre-training layer 4, epoch 24, cost  0.837962941263
Pre-training layer 4, epoch 25, cost  0.836941439376
Pre-training layer 4, epoch 26, cost  0.835986074369
Pre-training layer 4, epoch 27, cost  0.835059655388
Pre-training layer 4, epoch 28, cost  0.834233268795
Pre-training layer 4, epoch 29, cost  0.83339567457
Pre-training layer 4, epoch 30, cost  0.832651540352
Pre-training layer 4, epoch 31, cost  0.831918370365
Pre-training layer 4, epoch 32, cost  0.83123483828
Pre-training layer 4, epoch 33, cost  0.830560524124
Pre-training layer 4, epoch 34, cost  0.82996229851
Pre-training layer 4, epoch 35, cost  0.829379597791
Pre-training layer 4, epoch 36, cost  0.828811560357
Pre-training layer 4, epoch 37, cost  0.828271765715
Pre-training layer 4, epoch 38, cost  0.827743439067
Pre-training layer 4, epoch 39, cost  0.827253003777
Pre-training layer 4, epoch 40, cost  0.826798966351
Pre-training layer 4, epoch 41, cost  0.826344683401
Pre-training layer 4, epoch 42, cost  0.825925881918
Pre-training layer 4, epoch 43, cost  0.825510460425
Pre-training layer 4, epoch 44, cost  0.825120217732
Pre-training layer 4, epoch 45, cost  0.824734662875
Pre-training layer 4, epoch 46, cost  0.824375915622
Pre-training layer 4, epoch 47, cost  0.824028759111
Pre-training layer 4, epoch 48, cost  0.823679656041
Pre-training layer 4, epoch 49, cost  0.823378484597
Pre-training layer 5, epoch 0, cost  5.47293329491
Pre-training layer 5, epoch 1, cost  3.46447645103
Pre-training layer 5, epoch 2, cost  3.44821128963
Pre-training layer 5, epoch 3, cost  3.44374333151
Pre-training layer 5, epoch 4, cost  3.44171456904
Pre-training layer 5, epoch 5, cost  3.4403802569
Pre-training layer 5, epoch 6, cost  3.43929209508
Pre-training layer 5, epoch 7, cost  3.43829368747
Pre-training layer 5, epoch 8, cost  3.43730819872
Pre-training layer 5, epoch 9, cost  3.43628081135
Pre-training layer 5, epoch 10, cost  3.4351594364
Pre-training layer 5, epoch 11, cost  3.4338830484
Pre-training layer 5, epoch 12, cost  3.4323737092
Pre-training layer 5, epoch 13, cost  3.43052021212
Pre-training layer 5, epoch 14, cost  3.42815784784
Pre-training layer 5, epoch 15, cost  3.42503782193
Pre-training layer 5, epoch 16, cost  3.42077578707
Pre-training layer 5, epoch 17, cost  3.41483242396
Pre-training layer 5, epoch 18, cost  3.4067640103
Pre-training layer 5, epoch 19, cost  3.39737929124
Pre-training layer 5, epoch 20, cost  3.38959802847
Pre-training layer 5, epoch 21, cost  3.38503485108
Pre-training layer 5, epoch 22, cost  3.38245420639
Pre-training layer 5, epoch 23, cost  3.38075900315
Pre-training layer 5, epoch 24, cost  3.37951971788
Pre-training layer 5, epoch 25, cost  3.37855181309
Pre-training layer 5, epoch 26, cost  3.37776000195
Pre-training layer 5, epoch 27, cost  3.37708919827
Pre-training layer 5, epoch 28, cost  3.37650446284
Pre-training layer 5, epoch 29, cost  3.37598488627
Pre-training layer 5, epoch 30, cost  3.37551586134
Pre-training layer 5, epoch 31, cost  3.37508762476
Pre-training layer 5, epoch 32, cost  3.37469186264
Pre-training layer 5, epoch 33, cost  3.37432374458
Pre-training layer 5, epoch 34, cost  3.37397925602
Pre-training layer 5, epoch 35, cost  3.37365553555
Pre-training layer 5, epoch 36, cost  3.37334950851
Pre-training layer 5, epoch 37, cost  3.37305948856
Pre-training layer 5, epoch 38, cost  3.37278365506
Pre-training layer 5, epoch 39, cost  3.37252045838
Pre-training layer 5, epoch 40, cost  3.37226895511
Pre-training layer 5, epoch 41, cost  3.37202821186
Pre-training layer 5, epoch 42, cost  3.37179801281
Pre-training layer 5, epoch 43, cost  3.37157673968
Pre-training layer 5, epoch 44, cost  3.37136324524
Pre-training layer 5, epoch 45, cost  3.37115789752
Pre-training layer 5, epoch 46, cost  3.37095988859
Pre-training layer 5, epoch 47, cost  3.37076891653
Pre-training layer 5, epoch 48, cost  3.37058428168
Pre-training layer 5, epoch 49, cost  3.37040593359
The pretraining code for file multi_layer_km.pyc ran for 71.90m
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
ACC for deep clustering: 0.53
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 4.54803, Reconstruction: 4.35766, Clustering: 0.19038,
Fine-tuning epoch 2 ++++
Total cost: 2.27415, Reconstruction: 2.10804, Clustering: 0.16611,
Fine-tuning epoch 3 ++++
Total cost: 1.69089, Reconstruction: 1.45797, Clustering: 0.23291,
Fine-tuning epoch 4 ++++
Total cost: 1.53349, Reconstruction: 1.28081, Clustering: 0.25269,
Fine-tuning epoch 5 ++++
Total cost: 1.42460, Reconstruction: 1.17031, Clustering: 0.25429,
Fine-tuning epoch 6 ++++
Total cost: 1.34734, Reconstruction: 1.09713, Clustering: 0.25021,
Fine-tuning epoch 7 ++++
Total cost: 1.29353, Reconstruction: 1.04776, Clustering: 0.24578,
Fine-tuning epoch 8 ++++
Total cost: 1.24928, Reconstruction: 1.00666, Clustering: 0.24263,
Fine-tuning epoch 9 ++++
Total cost: 1.21387, Reconstruction: 0.97399, Clustering: 0.23988,
Fine-tuning epoch 10 ++++
Total cost: 1.18741, Reconstruction: 0.94873, Clustering: 0.23868,
Fine-tuning epoch 11 ++++
Total cost: 1.16113, Reconstruction: 0.92547, Clustering: 0.23565,
Fine-tuning epoch 12 ++++
Total cost: 1.14110, Reconstruction: 0.90679, Clustering: 0.23431,
Fine-tuning epoch 13 ++++
Total cost: 1.12240, Reconstruction: 0.89128, Clustering: 0.23111,
Fine-tuning epoch 14 ++++
Total cost: 1.11268, Reconstruction: 0.88203, Clustering: 0.23065,
Fine-tuning epoch 15 ++++
Total cost: 1.09004, Reconstruction: 0.86299, Clustering: 0.22704,
Fine-tuning epoch 16 ++++
Total cost: 1.08132, Reconstruction: 0.85466, Clustering: 0.22666,
Fine-tuning epoch 17 ++++
Total cost: 1.07053, Reconstruction: 0.84516, Clustering: 0.22537,
Fine-tuning epoch 18 ++++
Total cost: 1.06056, Reconstruction: 0.83600, Clustering: 0.22456,
Fine-tuning epoch 19 ++++
Total cost: 1.04431, Reconstruction: 0.82195, Clustering: 0.22236,
Fine-tuning epoch 20 ++++
Total cost: 1.03651, Reconstruction: 0.81428, Clustering: 0.22222,
Fine-tuning epoch 21 ++++
Total cost: 1.02570, Reconstruction: 0.80650, Clustering: 0.21920,
Fine-tuning epoch 22 ++++
Total cost: 1.01673, Reconstruction: 0.79653, Clustering: 0.22020,
Fine-tuning epoch 23 ++++
Total cost: 1.00867, Reconstruction: 0.78944, Clustering: 0.21923,
Fine-tuning epoch 24 ++++
Total cost: 0.99571, Reconstruction: 0.77934, Clustering: 0.21637,
Fine-tuning epoch 25 ++++
Total cost: 0.99334, Reconstruction: 0.77619, Clustering: 0.21715,
Fine-tuning epoch 26 ++++
Total cost: 0.98725, Reconstruction: 0.77046, Clustering: 0.21679,
Fine-tuning epoch 27 ++++
Total cost: 0.97892, Reconstruction: 0.76301, Clustering: 0.21591,
Fine-tuning epoch 28 ++++
Total cost: 0.97168, Reconstruction: 0.75737, Clustering: 0.21431,
Fine-tuning epoch 29 ++++
Total cost: 0.96629, Reconstruction: 0.75218, Clustering: 0.21411,
Fine-tuning epoch 30 ++++
Total cost: 0.96375, Reconstruction: 0.74939, Clustering: 0.21436,
Fine-tuning epoch 31 ++++
Total cost: 0.95968, Reconstruction: 0.74578, Clustering: 0.21390,
Fine-tuning epoch 32 ++++
Total cost: 0.95008, Reconstruction: 0.73819, Clustering: 0.21189,
Fine-tuning epoch 33 ++++
Total cost: 0.94922, Reconstruction: 0.73619, Clustering: 0.21303,
Fine-tuning epoch 34 ++++
Total cost: 0.94309, Reconstruction: 0.73071, Clustering: 0.21238,
Fine-tuning epoch 35 ++++
Total cost: 0.94239, Reconstruction: 0.72880, Clustering: 0.21359,
Fine-tuning epoch 36 ++++
Total cost: 0.93721, Reconstruction: 0.72522, Clustering: 0.21199,
Fine-tuning epoch 37 ++++
Total cost: 0.93227, Reconstruction: 0.72026, Clustering: 0.21201,
Fine-tuning epoch 38 ++++
Total cost: 0.92954, Reconstruction: 0.71856, Clustering: 0.21099,
Fine-tuning epoch 39 ++++
Total cost: 0.92586, Reconstruction: 0.71439, Clustering: 0.21146,
Fine-tuning epoch 40 ++++
Total cost: 0.92464, Reconstruction: 0.71355, Clustering: 0.21109,
Fine-tuning epoch 41 ++++
Total cost: 0.91632, Reconstruction: 0.70582, Clustering: 0.21051,
Fine-tuning epoch 42 ++++
Total cost: 0.91687, Reconstruction: 0.70570, Clustering: 0.21117,
Fine-tuning epoch 43 ++++
Total cost: 0.91952, Reconstruction: 0.70675, Clustering: 0.21277,
Fine-tuning epoch 44 ++++
Total cost: 0.90896, Reconstruction: 0.69873, Clustering: 0.21024,
Fine-tuning epoch 45 ++++
Total cost: 0.90620, Reconstruction: 0.69589, Clustering: 0.21030,
Fine-tuning epoch 46 ++++
Total cost: 0.90786, Reconstruction: 0.69650, Clustering: 0.21136,
Fine-tuning epoch 47 ++++
Total cost: 0.90184, Reconstruction: 0.69162, Clustering: 0.21021,
Fine-tuning epoch 48 ++++
Total cost: 0.89763, Reconstruction: 0.68843, Clustering: 0.20920,
Fine-tuning epoch 49 ++++
Total cost: 0.89241, Reconstruction: 0.68354, Clustering: 0.20888,
Fine-tuning epoch 50 ++++
Total cost: 0.88816, Reconstruction: 0.68059, Clustering: 0.20757,
Average squared 2-D reconstruction error: 0.6806
NMI for deep clustering: 0.59
ARI for deep clustering: 0.42
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 62.10m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.14851271862
Pre-training layer 0, epoch 1, cost  0.983744259431
Pre-training layer 0, epoch 2, cost  0.791843990794
Pre-training layer 0, epoch 3, cost  0.703756818947
Pre-training layer 0, epoch 4, cost  0.649193611965
Pre-training layer 0, epoch 5, cost  0.610503603633
Pre-training layer 0, epoch 6, cost  0.58096791771
Pre-training layer 0, epoch 7, cost  0.557475642547
Pre-training layer 0, epoch 8, cost  0.538083466666
Pre-training layer 0, epoch 9, cost  0.521691532956
Pre-training layer 0, epoch 10, cost  0.507496080406
Pre-training layer 0, epoch 11, cost  0.495100698665
Pre-training layer 0, epoch 12, cost  0.484064764355
Pre-training layer 0, epoch 13, cost  0.474176680629
Pre-training layer 0, epoch 14, cost  0.465243284602
Pre-training layer 0, epoch 15, cost  0.457098843374
Pre-training layer 0, epoch 16, cost  0.449659646699
Pre-training layer 0, epoch 17, cost  0.442753816149
Pre-training layer 0, epoch 18, cost  0.436294892575
Pre-training layer 0, epoch 19, cost  0.430330704502
Pre-training layer 0, epoch 20, cost  0.424789461584
Pre-training layer 0, epoch 21, cost  0.419635337543
Pre-training layer 0, epoch 22, cost  0.414795339969
Pre-training layer 0, epoch 23, cost  0.410248829254
Pre-training layer 0, epoch 24, cost  0.405955250896
Pre-training layer 0, epoch 25, cost  0.401902847998
Pre-training layer 0, epoch 26, cost  0.398051356064
Pre-training layer 0, epoch 27, cost  0.394387718752
Pre-training layer 0, epoch 28, cost  0.390926469621
Pre-training layer 0, epoch 29, cost  0.387619500623
Pre-training layer 0, epoch 30, cost  0.384476932019
Pre-training layer 0, epoch 31, cost  0.38147096031
Pre-training layer 0, epoch 32, cost  0.378593314347
Pre-training layer 0, epoch 33, cost  0.375833953234
Pre-training layer 0, epoch 34, cost  0.373184558302
Pre-training layer 0, epoch 35, cost  0.370648133477
Pre-training layer 0, epoch 36, cost  0.368215361039
Pre-training layer 0, epoch 37, cost  0.365841797041
Pre-training layer 0, epoch 38, cost  0.3635856849
Pre-training layer 0, epoch 39, cost  0.361397535764
Pre-training layer 0, epoch 40, cost  0.359306477699
Pre-training layer 0, epoch 41, cost  0.357275763115
Pre-training layer 0, epoch 42, cost  0.355307452047
Pre-training layer 0, epoch 43, cost  0.353412024199
Pre-training layer 0, epoch 44, cost  0.351568231313
Pre-training layer 0, epoch 45, cost  0.349779055819
Pre-training layer 0, epoch 46, cost  0.348055877761
Pre-training layer 0, epoch 47, cost  0.346376743711
Pre-training layer 0, epoch 48, cost  0.344761287563
Pre-training layer 0, epoch 49, cost  0.343185622311
Pre-training layer 1, epoch 0, cost  3.91171625722
Pre-training layer 1, epoch 1, cost  1.04977622514
Pre-training layer 1, epoch 2, cost  0.76465839571
Pre-training layer 1, epoch 3, cost  0.642060005614
Pre-training layer 1, epoch 4, cost  0.571001090191
Pre-training layer 1, epoch 5, cost  0.522048446686
Pre-training layer 1, epoch 6, cost  0.485468374013
Pre-training layer 1, epoch 7, cost  0.456801274857
Pre-training layer 1, epoch 8, cost  0.432859799764
Pre-training layer 1, epoch 9, cost  0.413481408158
Pre-training layer 1, epoch 10, cost  0.396950723977
Pre-training layer 1, epoch 11, cost  0.38197096434
Pre-training layer 1, epoch 12, cost  0.368908076692
Pre-training layer 1, epoch 13, cost  0.357715602712
Pre-training layer 1, epoch 14, cost  0.346778109309
Pre-training layer 1, epoch 15, cost  0.337561875528
Pre-training layer 1, epoch 16, cost  0.329337742905
Pre-training layer 1, epoch 17, cost  0.321804216791
Pre-training layer 1, epoch 18, cost  0.315053925695
Pre-training layer 1, epoch 19, cost  0.308581706406
Pre-training layer 1, epoch 20, cost  0.302606429857
Pre-training layer 1, epoch 21, cost  0.296801143825
Pre-training layer 1, epoch 22, cost  0.291384978095
Pre-training layer 1, epoch 23, cost  0.286760724487
Pre-training layer 1, epoch 24, cost  0.28218402825
Pre-training layer 1, epoch 25, cost  0.277894540641
Pre-training layer 1, epoch 26, cost  0.274166077445
Pre-training layer 1, epoch 27, cost  0.270202649546
Pre-training layer 1, epoch 28, cost  0.266503843179
Pre-training layer 1, epoch 29, cost  0.263240975099
Pre-training layer 1, epoch 30, cost  0.260037451026
Pre-training layer 1, epoch 31, cost  0.256900884665
Pre-training layer 1, epoch 32, cost  0.254366207723
Pre-training layer 1, epoch 33, cost  0.251709674202
Pre-training layer 1, epoch 34, cost  0.248756278729
Pre-training layer 1, epoch 35, cost  0.246530324592
Pre-training layer 1, epoch 36, cost  0.244076617129
Pre-training layer 1, epoch 37, cost  0.241789388762
Pre-training layer 1, epoch 38, cost  0.239898712768
Pre-training layer 1, epoch 39, cost  0.23774319607
Pre-training layer 1, epoch 40, cost  0.235634688291
Pre-training layer 1, epoch 41, cost  0.23374780049
Pre-training layer 1, epoch 42, cost  0.232012853155
Pre-training layer 1, epoch 43, cost  0.230392407254
Pre-training layer 1, epoch 44, cost  0.228578707094
Pre-training layer 1, epoch 45, cost  0.227104756041
Pre-training layer 1, epoch 46, cost  0.225563029384
Pre-training layer 1, epoch 47, cost  0.223947931563
Pre-training layer 1, epoch 48, cost  0.222728863075
Pre-training layer 1, epoch 49, cost  0.221249789043
Pre-training layer 2, epoch 0, cost  4.80831123055
Pre-training layer 2, epoch 1, cost  1.41304340691
Pre-training layer 2, epoch 2, cost  1.07697106593
Pre-training layer 2, epoch 3, cost  0.914395985769
Pre-training layer 2, epoch 4, cost  0.818897594132
Pre-training layer 2, epoch 5, cost  0.757467916357
Pre-training layer 2, epoch 6, cost  0.693169780611
Pre-training layer 2, epoch 7, cost  0.665365224498
Pre-training layer 2, epoch 8, cost  0.636280426473
Pre-training layer 2, epoch 9, cost  0.610492969912
Pre-training layer 2, epoch 10, cost  0.600960485104
Pre-training layer 2, epoch 11, cost  0.56837750727
Pre-training layer 2, epoch 12, cost  0.563793328984
Pre-training layer 2, epoch 13, cost  0.550229814933
Pre-training layer 2, epoch 14, cost  0.533810293996
Pre-training layer 2, epoch 15, cost  0.527783551059
Pre-training layer 2, epoch 16, cost  0.522931468287
Pre-training layer 2, epoch 17, cost  0.508275457235
Pre-training layer 2, epoch 18, cost  0.503518389556
Pre-training layer 2, epoch 19, cost  0.495005878192
Pre-training layer 2, epoch 20, cost  0.495686724395
Pre-training layer 2, epoch 21, cost  0.484149826244
Pre-training layer 2, epoch 22, cost  0.479541615987
Pre-training layer 2, epoch 23, cost  0.476267547049
Pre-training layer 2, epoch 24, cost  0.473241221137
Pre-training layer 2, epoch 25, cost  0.470332261861
Pre-training layer 2, epoch 26, cost  0.463813786855
Pre-training layer 2, epoch 27, cost  0.459716869248
Pre-training layer 2, epoch 28, cost  0.460638771244
Pre-training layer 2, epoch 29, cost  0.458371805459
Pre-training layer 2, epoch 30, cost  0.451526278089
Pre-training layer 2, epoch 31, cost  0.454419628641
Pre-training layer 2, epoch 32, cost  0.449876180549
Pre-training layer 2, epoch 33, cost  0.447887731413
Pre-training layer 2, epoch 34, cost  0.446122498181
Pre-training layer 2, epoch 35, cost  0.444022883872
Pre-training layer 2, epoch 36, cost  0.441983916606
Pre-training layer 2, epoch 37, cost  0.440846773557
Pre-training layer 2, epoch 38, cost  0.438745057557
Pre-training layer 2, epoch 39, cost  0.43734919707
Pre-training layer 2, epoch 40, cost  0.436037511333
Pre-training layer 2, epoch 41, cost  0.434647770055
Pre-training layer 2, epoch 42, cost  0.433258979989
Pre-training layer 2, epoch 43, cost  0.431944206281
Pre-training layer 2, epoch 44, cost  0.430736158521
Pre-training layer 2, epoch 45, cost  0.429641249303
Pre-training layer 2, epoch 46, cost  0.428414383578
Pre-training layer 2, epoch 47, cost  0.427700661976
Pre-training layer 2, epoch 48, cost  0.427088938004
Pre-training layer 2, epoch 49, cost  0.425938148195
Pre-training layer 3, epoch 0, cost  3.59842186822
Pre-training layer 3, epoch 1, cost  0.698162395212
Pre-training layer 3, epoch 2, cost  0.440234961625
Pre-training layer 3, epoch 3, cost  0.310408092222
Pre-training layer 3, epoch 4, cost  0.24058835083
Pre-training layer 3, epoch 5, cost  0.192833721855
Pre-training layer 3, epoch 6, cost  0.161753791874
Pre-training layer 3, epoch 7, cost  0.141012020488
Pre-training layer 3, epoch 8, cost  0.124548761231
Pre-training layer 3, epoch 9, cost  0.110691420697
Pre-training layer 3, epoch 10, cost  0.101202113276
Pre-training layer 3, epoch 11, cost  0.0939757755102
Pre-training layer 3, epoch 12, cost  0.0876960364995
Pre-training layer 3, epoch 13, cost  0.0812498482428
Pre-training layer 3, epoch 14, cost  0.077348765603
Pre-training layer 3, epoch 15, cost  0.0728084254856
Pre-training layer 3, epoch 16, cost  0.0694977608694
Pre-training layer 3, epoch 17, cost  0.066291363225
Pre-training layer 3, epoch 18, cost  0.0633990686484
Pre-training layer 3, epoch 19, cost  0.0608092910432
Pre-training layer 3, epoch 20, cost  0.0584409005341
Pre-training layer 3, epoch 21, cost  0.0560778412468
Pre-training layer 3, epoch 22, cost  0.0535608472006
Pre-training layer 3, epoch 23, cost  0.0508183670588
Pre-training layer 3, epoch 24, cost  0.0483595045447
Pre-training layer 3, epoch 25, cost  0.0467671055093
Pre-training layer 3, epoch 26, cost  0.0453367145106
Pre-training layer 3, epoch 27, cost  0.0435140118215
Pre-training layer 3, epoch 28, cost  0.0421563366634
Pre-training layer 3, epoch 29, cost  0.0408215687308
Pre-training layer 3, epoch 30, cost  0.0394548265381
Pre-training layer 3, epoch 31, cost  0.038293224456
Pre-training layer 3, epoch 32, cost  0.0370963335325
Pre-training layer 3, epoch 33, cost  0.0359925753498
Pre-training layer 3, epoch 34, cost  0.0349834513003
Pre-training layer 3, epoch 35, cost  0.0339292866483
Pre-training layer 3, epoch 36, cost  0.0330076081089
Pre-training layer 3, epoch 37, cost  0.0321216568518
Pre-training layer 3, epoch 38, cost  0.0312277264442
Pre-training layer 3, epoch 39, cost  0.0304015375041
Pre-training layer 3, epoch 40, cost  0.0296234885722
Pre-training layer 3, epoch 41, cost  0.0288716740355
Pre-training layer 3, epoch 42, cost  0.0281495016041
Pre-training layer 3, epoch 43, cost  0.0274573349615
Pre-training layer 3, epoch 44, cost  0.0268006359118
Pre-training layer 3, epoch 45, cost  0.0261651592951
Pre-training layer 3, epoch 46, cost  0.0255626232057
Pre-training layer 3, epoch 47, cost  0.0249583358352
Pre-training layer 3, epoch 48, cost  0.0243565451696
Pre-training layer 3, epoch 49, cost  0.0236837370311
Pre-training layer 4, epoch 0, cost  4.19825120983
Pre-training layer 4, epoch 1, cost  1.16099734942
Pre-training layer 4, epoch 2, cost  0.961567999339
Pre-training layer 4, epoch 3, cost  0.926446135899
Pre-training layer 4, epoch 4, cost  0.908057598047
Pre-training layer 4, epoch 5, cost  0.895939906432
Pre-training layer 4, epoch 6, cost  0.886919253098
Pre-training layer 4, epoch 7, cost  0.87987836727
Pre-training layer 4, epoch 8, cost  0.874032433111
Pre-training layer 4, epoch 9, cost  0.869171297398
Pre-training layer 4, epoch 10, cost  0.865024229077
Pre-training layer 4, epoch 11, cost  0.861395330953
Pre-training layer 4, epoch 12, cost  0.858289741546
Pre-training layer 4, epoch 13, cost  0.85542962589
Pre-training layer 4, epoch 14, cost  0.852919951161
Pre-training layer 4, epoch 15, cost  0.850635983452
Pre-training layer 4, epoch 16, cost  0.848599528729
Pre-training layer 4, epoch 17, cost  0.846691876796
Pre-training layer 4, epoch 18, cost  0.844939404463
Pre-training layer 4, epoch 19, cost  0.843331364884
Pre-training layer 4, epoch 20, cost  0.841872856501
Pre-training layer 4, epoch 21, cost  0.840492059878
Pre-training layer 4, epoch 22, cost  0.839211972695
Pre-training layer 4, epoch 23, cost  0.838030885579
Pre-training layer 4, epoch 24, cost  0.836889560237
Pre-training layer 4, epoch 25, cost  0.835889052836
Pre-training layer 4, epoch 26, cost  0.834855959606
Pre-training layer 4, epoch 27, cost  0.833952770052
Pre-training layer 4, epoch 28, cost  0.833095344959
Pre-training layer 4, epoch 29, cost  0.832270915747
Pre-training layer 4, epoch 30, cost  0.831486936573
Pre-training layer 4, epoch 31, cost  0.83077182491
Pre-training layer 4, epoch 32, cost  0.830073448823
Pre-training layer 4, epoch 33, cost  0.829415135678
Pre-training layer 4, epoch 34, cost  0.828801942112
Pre-training layer 4, epoch 35, cost  0.82820031631
Pre-training layer 4, epoch 36, cost  0.827637109834
Pre-training layer 4, epoch 37, cost  0.827076403163
Pre-training layer 4, epoch 38, cost  0.826578254618
Pre-training layer 4, epoch 39, cost  0.826085623654
Pre-training layer 4, epoch 40, cost  0.825629943336
Pre-training layer 4, epoch 41, cost  0.825162482071
Pre-training layer 4, epoch 42, cost  0.824758248786
Pre-training layer 4, epoch 43, cost  0.824350230838
Pre-training layer 4, epoch 44, cost  0.823942397064
Pre-training layer 4, epoch 45, cost  0.823587666404
Pre-training layer 4, epoch 46, cost  0.823214219275
Pre-training layer 4, epoch 47, cost  0.822867962158
Pre-training layer 4, epoch 48, cost  0.822535863129
Pre-training layer 4, epoch 49, cost  0.822223864953
Pre-training layer 5, epoch 0, cost  5.45695361573
Pre-training layer 5, epoch 1, cost  3.4567547779
Pre-training layer 5, epoch 2, cost  3.44038713574
Pre-training layer 5, epoch 3, cost  3.43387917718
Pre-training layer 5, epoch 4, cost  3.43061370008
Pre-training layer 5, epoch 5, cost  3.42883627295
Pre-training layer 5, epoch 6, cost  3.42759132896
Pre-training layer 5, epoch 7, cost  3.4265382411
Pre-training layer 5, epoch 8, cost  3.42554456695
Pre-training layer 5, epoch 9, cost  3.42454301157
Pre-training layer 5, epoch 10, cost  3.4234809777
Pre-training layer 5, epoch 11, cost  3.42230430529
Pre-training layer 5, epoch 12, cost  3.42094388547
Pre-training layer 5, epoch 13, cost  3.41930899381
Pre-training layer 5, epoch 14, cost  3.41726758124
Pre-training layer 5, epoch 15, cost  3.41461913914
Pre-training layer 5, epoch 16, cost  3.41105488774
Pre-training layer 5, epoch 17, cost  3.40610303281
Pre-training layer 5, epoch 18, cost  3.39916319117
Pre-training layer 5, epoch 19, cost  3.39009307954
Pre-training layer 5, epoch 20, cost  3.38083945997
Pre-training layer 5, epoch 21, cost  3.37458726713
Pre-training layer 5, epoch 22, cost  3.37123541114
Pre-training layer 5, epoch 23, cost  3.36920665741
Pre-training layer 5, epoch 24, cost  3.36778397726
Pre-training layer 5, epoch 25, cost  3.36669848802
Pre-training layer 5, epoch 26, cost  3.36582390938
Pre-training layer 5, epoch 27, cost  3.36509165641
Pre-training layer 5, epoch 28, cost  3.36446050581
Pre-training layer 5, epoch 29, cost  3.3639037886
Pre-training layer 5, epoch 30, cost  3.3634048546
Pre-training layer 5, epoch 31, cost  3.36295165536
Pre-training layer 5, epoch 32, cost  3.36253615307
Pre-training layer 5, epoch 33, cost  3.3621512479
Pre-training layer 5, epoch 34, cost  3.3617917308
Pre-training layer 5, epoch 35, cost  3.36145516752
Pre-training layer 5, epoch 36, cost  3.3611378142
Pre-training layer 5, epoch 37, cost  3.36083788311
Pre-training layer 5, epoch 38, cost  3.36055355469
Pre-training layer 5, epoch 39, cost  3.36028255259
Pre-training layer 5, epoch 40, cost  3.36002457283
Pre-training layer 5, epoch 41, cost  3.35977791179
Pre-training layer 5, epoch 42, cost  3.35954204878
Pre-training layer 5, epoch 43, cost  3.35931555834
Pre-training layer 5, epoch 44, cost  3.35909796841
Pre-training layer 5, epoch 45, cost  3.35888860437
Pre-training layer 5, epoch 46, cost  3.35868696539
Pre-training layer 5, epoch 47, cost  3.35849279287
Pre-training layer 5, epoch 48, cost  3.35830535065
Pre-training layer 5, epoch 49, cost  3.35812415325
The pretraining code for file multi_layer_km.pyc ran for 69.48m
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
... getting the finetuning functions
ACC for deep clustering: 0.56
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 4.55823, Reconstruction: 4.35744, Clustering: 0.20079,
Fine-tuning epoch 2 ++++
Total cost: 2.32834, Reconstruction: 2.15919, Clustering: 0.16915,
Fine-tuning epoch 3 ++++
Total cost: 1.73834, Reconstruction: 1.49259, Clustering: 0.24575,
Fine-tuning epoch 4 ++++
Total cost: 1.57519, Reconstruction: 1.32283, Clustering: 0.25235,
Fine-tuning epoch 5 ++++
Total cost: 1.47584, Reconstruction: 1.22656, Clustering: 0.24928,
Fine-tuning epoch 6 ++++
Total cost: 1.40762, Reconstruction: 1.16360, Clustering: 0.24403,
Fine-tuning epoch 7 ++++
Total cost: 1.34991, Reconstruction: 1.10894, Clustering: 0.24097,
Fine-tuning epoch 8 ++++
Total cost: 1.30820, Reconstruction: 1.06955, Clustering: 0.23865,
Fine-tuning epoch 9 ++++
Total cost: 1.27400, Reconstruction: 1.03824, Clustering: 0.23576,
Fine-tuning epoch 10 ++++
Total cost: 1.24308, Reconstruction: 1.00946, Clustering: 0.23362,
Fine-tuning epoch 11 ++++
Total cost: 1.21486, Reconstruction: 0.98410, Clustering: 0.23077,
Fine-tuning epoch 12 ++++
Total cost: 1.19202, Reconstruction: 0.96351, Clustering: 0.22850,
Fine-tuning epoch 13 ++++
Total cost: 1.16937, Reconstruction: 0.94204, Clustering: 0.22733,
Fine-tuning epoch 14 ++++
Total cost: 1.14880, Reconstruction: 0.92302, Clustering: 0.22578,
Fine-tuning epoch 15 ++++
Total cost: 1.13256, Reconstruction: 0.90788, Clustering: 0.22468,
Fine-tuning epoch 16 ++++
Total cost: 1.11811, Reconstruction: 0.89443, Clustering: 0.22368,
Fine-tuning epoch 17 ++++
Total cost: 1.10349, Reconstruction: 0.88102, Clustering: 0.22248,
Fine-tuning epoch 18 ++++
Total cost: 1.09396, Reconstruction: 0.87147, Clustering: 0.22249,
Fine-tuning epoch 19 ++++
Total cost: 1.08503, Reconstruction: 0.86339, Clustering: 0.22164,
Fine-tuning epoch 20 ++++
Total cost: 1.07289, Reconstruction: 0.85250, Clustering: 0.22039,
Fine-tuning epoch 21 ++++
Total cost: 1.06128, Reconstruction: 0.84182, Clustering: 0.21946,
Fine-tuning epoch 22 ++++
Total cost: 1.05050, Reconstruction: 0.83171, Clustering: 0.21879,
Fine-tuning epoch 23 ++++
Total cost: 1.03864, Reconstruction: 0.82195, Clustering: 0.21669,
Fine-tuning epoch 24 ++++
Total cost: 1.03220, Reconstruction: 0.81573, Clustering: 0.21647,
Fine-tuning epoch 25 ++++
Total cost: 1.02450, Reconstruction: 0.80905, Clustering: 0.21545,
Fine-tuning epoch 26 ++++
Total cost: 1.01665, Reconstruction: 0.80107, Clustering: 0.21558,
Fine-tuning epoch 27 ++++
Total cost: 1.01429, Reconstruction: 0.79838, Clustering: 0.21591,
Fine-tuning epoch 28 ++++
Total cost: 0.99946, Reconstruction: 0.78554, Clustering: 0.21392,
Fine-tuning epoch 29 ++++
Total cost: 0.99475, Reconstruction: 0.78159, Clustering: 0.21317,
Fine-tuning epoch 30 ++++
Total cost: 0.99184, Reconstruction: 0.77844, Clustering: 0.21340,
Fine-tuning epoch 31 ++++
Total cost: 0.98612, Reconstruction: 0.77325, Clustering: 0.21287,
Fine-tuning epoch 32 ++++
Total cost: 0.97797, Reconstruction: 0.76542, Clustering: 0.21255,
Fine-tuning epoch 33 ++++
Total cost: 0.97300, Reconstruction: 0.76158, Clustering: 0.21141,
Fine-tuning epoch 34 ++++
Total cost: 0.97339, Reconstruction: 0.76009, Clustering: 0.21330,
Fine-tuning epoch 35 ++++
Total cost: 0.96121, Reconstruction: 0.75090, Clustering: 0.21030,
Fine-tuning epoch 36 ++++
Total cost: 0.96144, Reconstruction: 0.74933, Clustering: 0.21210,
Fine-tuning epoch 37 ++++
Total cost: 0.95497, Reconstruction: 0.74412, Clustering: 0.21086,
Fine-tuning epoch 38 ++++
Total cost: 0.95012, Reconstruction: 0.74004, Clustering: 0.21007,
Fine-tuning epoch 39 ++++
Total cost: 0.94206, Reconstruction: 0.73396, Clustering: 0.20810,
Fine-tuning epoch 40 ++++
Total cost: 0.94255, Reconstruction: 0.73294, Clustering: 0.20961,
Fine-tuning epoch 41 ++++
Total cost: 0.93637, Reconstruction: 0.72739, Clustering: 0.20899,
Fine-tuning epoch 42 ++++
Total cost: 0.93459, Reconstruction: 0.72499, Clustering: 0.20960,
Fine-tuning epoch 43 ++++
Total cost: 0.92273, Reconstruction: 0.71711, Clustering: 0.20562,
Fine-tuning epoch 44 ++++
Total cost: 0.91704, Reconstruction: 0.71112, Clustering: 0.20592,
Fine-tuning epoch 45 ++++
Total cost: 0.91106, Reconstruction: 0.70431, Clustering: 0.20675,
Fine-tuning epoch 46 ++++
Total cost: 0.89305, Reconstruction: 0.68957, Clustering: 0.20348,
Fine-tuning epoch 47 ++++
Total cost: 0.88519, Reconstruction: 0.68192, Clustering: 0.20327,
Fine-tuning epoch 48 ++++
Total cost: 0.88462, Reconstruction: 0.68014, Clustering: 0.20448,
Fine-tuning epoch 49 ++++
Total cost: 0.87561, Reconstruction: 0.67366, Clustering: 0.20195,
Fine-tuning epoch 50 ++++
Total cost: 0.87578, Reconstruction: 0.67213, Clustering: 0.20366,
Average squared 2-D reconstruction error: 0.6721
NMI for deep clustering: 0.58
ARI for deep clustering: 0.42
ACC for deep clustering: 0.57
The training code for file multi_layer_km.pyc ran for 62.05m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.14886202206
Pre-training layer 0, epoch 1, cost  0.983303130618
Pre-training layer 0, epoch 2, cost  0.791225246804
Pre-training layer 0, epoch 3, cost  0.703819833612
Pre-training layer 0, epoch 4, cost  0.649892928811
Pre-training layer 0, epoch 5, cost  0.61199714132
Pre-training layer 0, epoch 6, cost  0.583224574042
Pre-training layer 0, epoch 7, cost  0.560174506942
Pre-training layer 0, epoch 8, cost  0.541064009964
Pre-training layer 0, epoch 9, cost  0.524845802459
Pre-training layer 0, epoch 10, cost  0.51078478605
Pre-training layer 0, epoch 11, cost  0.498434850876
Pre-training layer 0, epoch 12, cost  0.487163526296
Pre-training layer 0, epoch 13, cost  0.477200521702
Pre-training layer 0, epoch 14, cost  0.468179917545
Pre-training layer 0, epoch 15, cost  0.459998970635
Pre-training layer 0, epoch 16, cost  0.452592370409
Pre-training layer 0, epoch 17, cost  0.445763548992
Pre-training layer 0, epoch 18, cost  0.439470441698
Pre-training layer 0, epoch 19, cost  0.433624863319
Pre-training layer 0, epoch 20, cost  0.428176585421
Pre-training layer 0, epoch 21, cost  0.423077152512
Pre-training layer 0, epoch 22, cost  0.418298605128
Pre-training layer 0, epoch 23, cost  0.413817585531
Pre-training layer 0, epoch 24, cost  0.409568580768
Pre-training layer 0, epoch 25, cost  0.405448119215
Pre-training layer 0, epoch 26, cost  0.401580412795
Pre-training layer 0, epoch 27, cost  0.397936364608
Pre-training layer 0, epoch 28, cost  0.394483608008
Pre-training layer 0, epoch 29, cost  0.391198941305
Pre-training layer 0, epoch 30, cost  0.388049103857
Pre-training layer 0, epoch 31, cost  0.385020570035
Pre-training layer 0, epoch 32, cost  0.382116393052
Pre-training layer 0, epoch 33, cost  0.379348472225
Pre-training layer 0, epoch 34, cost  0.376691194841
Pre-training layer 0, epoch 35, cost  0.374133261178
Pre-training layer 0, epoch 36, cost  0.371672031855
Pre-training layer 0, epoch 37, cost  0.369287147767
Pre-training layer 0, epoch 38, cost  0.366988233312
Pre-training layer 0, epoch 39, cost  0.364753945573
Pre-training layer 0, epoch 40, cost  0.362600233807
Pre-training layer 0, epoch 41, cost  0.360524031115
Pre-training layer 0, epoch 42, cost  0.358520963958
Pre-training layer 0, epoch 43, cost  0.356575583053
Pre-training layer 0, epoch 44, cost  0.354697437395
Pre-training layer 0, epoch 45, cost  0.352870370593
Pre-training layer 0, epoch 46, cost  0.351107144446
Pre-training layer 0, epoch 47, cost  0.349390529545
Pre-training layer 0, epoch 48, cost  0.347723868244
Pre-training layer 0, epoch 49, cost  0.346116288495
Pre-training layer 1, epoch 0, cost  3.87289687762
Pre-training layer 1, epoch 1, cost  1.01670441198
Pre-training layer 1, epoch 2, cost  0.735098623538
Pre-training layer 1, epoch 3, cost  0.613778562329
Pre-training layer 1, epoch 4, cost  0.544447376525
Pre-training layer 1, epoch 5, cost  0.496824747907
Pre-training layer 1, epoch 6, cost  0.461718017052
Pre-training layer 1, epoch 7, cost  0.433844396533
Pre-training layer 1, epoch 8, cost  0.411014100976
Pre-training layer 1, epoch 9, cost  0.391748869545
Pre-training layer 1, epoch 10, cost  0.375056111722
Pre-training layer 1, epoch 11, cost  0.360983760033
Pre-training layer 1, epoch 12, cost  0.34894121986
Pre-training layer 1, epoch 13, cost  0.337353860422
Pre-training layer 1, epoch 14, cost  0.327440857467
Pre-training layer 1, epoch 15, cost  0.318303047929
Pre-training layer 1, epoch 16, cost  0.310511045575
Pre-training layer 1, epoch 17, cost  0.303133225576
Pre-training layer 1, epoch 18, cost  0.296271229511
Pre-training layer 1, epoch 19, cost  0.290113321568
Pre-training layer 1, epoch 20, cost  0.28356163274
Pre-training layer 1, epoch 21, cost  0.27871580413
Pre-training layer 1, epoch 22, cost  0.273802821492
Pre-training layer 1, epoch 23, cost  0.268590463638
Pre-training layer 1, epoch 24, cost  0.263889253606
Pre-training layer 1, epoch 25, cost  0.26046772304
Pre-training layer 1, epoch 26, cost  0.256154182043
Pre-training layer 1, epoch 27, cost  0.252648603757
Pre-training layer 1, epoch 28, cost  0.249206168524
Pre-training layer 1, epoch 29, cost  0.245905386392
Pre-training layer 1, epoch 30, cost  0.242873345271
Pre-training layer 1, epoch 31, cost  0.240000402149
Pre-training layer 1, epoch 32, cost  0.237020767656
Pre-training layer 1, epoch 33, cost  0.234594484108
Pre-training layer 1, epoch 34, cost  0.232021515027
Pre-training layer 1, epoch 35, cost  0.229331996649
Pre-training layer 1, epoch 36, cost  0.22713910226
Pre-training layer 1, epoch 37, cost  0.224996688997
Pre-training layer 1, epoch 38, cost  0.222981843362
Pre-training layer 1, epoch 39, cost  0.220922165529
Pre-training layer 1, epoch 40, cost  0.219148048834
Pre-training layer 1, epoch 41, cost  0.217091442448
Pre-training layer 1, epoch 42, cost  0.215544155418
Pre-training layer 1, epoch 43, cost  0.213550695356
Pre-training layer 1, epoch 44, cost  0.21212147733
Pre-training layer 1, epoch 45, cost  0.210608637476
Pre-training layer 1, epoch 46, cost  0.209087228833
Pre-training layer 1, epoch 47, cost  0.207448269981
Pre-training layer 1, epoch 48, cost  0.206275103293
Pre-training layer 1, epoch 49, cost  0.204836959013
Pre-training layer 2, epoch 0, cost  4.81401924126
Pre-training layer 2, epoch 1, cost  1.41208935011
Pre-training layer 2, epoch 2, cost  1.07577671007
Pre-training layer 2, epoch 3, cost  0.913828980964
Pre-training layer 2, epoch 4, cost  0.809017126487
Pre-training layer 2, epoch 5, cost  0.743486021795
Pre-training layer 2, epoch 6, cost  0.702868693037
Pre-training layer 2, epoch 7, cost  0.658917463091
Pre-training layer 2, epoch 8, cost  0.628763096859
Pre-training layer 2, epoch 9, cost  0.607633697968
Pre-training layer 2, epoch 10, cost  0.57765506971
Pre-training layer 2, epoch 11, cost  0.574774592499
Pre-training layer 2, epoch 12, cost  0.549220098022
Pre-training layer 2, epoch 13, cost  0.543797994134
Pre-training layer 2, epoch 14, cost  0.531665250268
Pre-training layer 2, epoch 15, cost  0.518983741525
Pre-training layer 2, epoch 16, cost  0.511107677533
Pre-training layer 2, epoch 17, cost  0.507664661515
Pre-training layer 2, epoch 18, cost  0.493624460969
Pre-training layer 2, epoch 19, cost  0.493274724403
Pre-training layer 2, epoch 20, cost  0.481054950589
Pre-training layer 2, epoch 21, cost  0.480973500675
Pre-training layer 2, epoch 22, cost  0.476237559155
Pre-training layer 2, epoch 23, cost  0.4702867795
Pre-training layer 2, epoch 24, cost  0.465875703773
Pre-training layer 2, epoch 25, cost  0.46188601396
Pre-training layer 2, epoch 26, cost  0.457756841362
Pre-training layer 2, epoch 27, cost  0.454984400766
Pre-training layer 2, epoch 28, cost  0.454941384307
Pre-training layer 2, epoch 29, cost  0.449292824685
Pre-training layer 2, epoch 30, cost  0.446809404426
Pre-training layer 2, epoch 31, cost  0.447843648176
Pre-training layer 2, epoch 32, cost  0.443917234088
Pre-training layer 2, epoch 33, cost  0.441697118397
Pre-training layer 2, epoch 34, cost  0.439800628719
Pre-training layer 2, epoch 35, cost  0.437695618658
Pre-training layer 2, epoch 36, cost  0.43587844571
Pre-training layer 2, epoch 37, cost  0.43427279382
Pre-training layer 2, epoch 38, cost  0.432521621189
Pre-training layer 2, epoch 39, cost  0.43108837877
Pre-training layer 2, epoch 40, cost  0.429700441194
Pre-training layer 2, epoch 41, cost  0.428316729077
Pre-training layer 2, epoch 42, cost  0.427032507253
Pre-training layer 2, epoch 43, cost  0.425846450258
Pre-training layer 2, epoch 44, cost  0.424662687024
Pre-training layer 2, epoch 45, cost  0.423525320553
Pre-training layer 2, epoch 46, cost  0.422431059415
Pre-training layer 2, epoch 47, cost  0.421444504326
Pre-training layer 2, epoch 48, cost  0.420476382336
Pre-training layer 2, epoch 49, cost  0.419693770797
Pre-training layer 3, epoch 0, cost  3.57858405313
Pre-training layer 3, epoch 1, cost  0.695148768717
Pre-training layer 3, epoch 2, cost  0.441896709354
Pre-training layer 3, epoch 3, cost  0.313701033292
Pre-training layer 3, epoch 4, cost  0.239057615856
Pre-training layer 3, epoch 5, cost  0.19444066209
Pre-training layer 3, epoch 6, cost  0.167487655709
Pre-training layer 3, epoch 7, cost  0.143472870833
Pre-training layer 3, epoch 8, cost  0.126168444996
Pre-training layer 3, epoch 9, cost  0.11412863468
Pre-training layer 3, epoch 10, cost  0.105141493372
Pre-training layer 3, epoch 11, cost  0.0974990962581
Pre-training layer 3, epoch 12, cost  0.0904893963784
Pre-training layer 3, epoch 13, cost  0.0847017348142
Pre-training layer 3, epoch 14, cost  0.0801537893436
Pre-training layer 3, epoch 15, cost  0.0754347948266
Pre-training layer 3, epoch 16, cost  0.0716693709089
Pre-training layer 3, epoch 17, cost  0.068019632637
Pre-training layer 3, epoch 18, cost  0.0647931029764
Pre-training layer 3, epoch 19, cost  0.0618879851348
Pre-training layer 3, epoch 20, cost  0.0591572374807
Pre-training layer 3, epoch 21, cost  0.0564537870714
Pre-training layer 3, epoch 22, cost  0.0538193294861
Pre-training layer 3, epoch 23, cost  0.0514222975063
Pre-training layer 3, epoch 24, cost  0.0494934261369
Pre-training layer 3, epoch 25, cost  0.0479101932795
Pre-training layer 3, epoch 26, cost  0.0463449012875
Pre-training layer 3, epoch 27, cost  0.0445840213262
Pre-training layer 3, epoch 28, cost  0.043090493912
Pre-training layer 3, epoch 29, cost  0.0417625340663
Pre-training layer 3, epoch 30, cost  0.0403804436413
Pre-training layer 3, epoch 31, cost  0.0391611276431
Pre-training layer 3, epoch 32, cost  0.0379388797656
Pre-training layer 3, epoch 33, cost  0.0368369766892
Pre-training layer 3, epoch 34, cost  0.0357448011588
Pre-training layer 3, epoch 35, cost  0.0347279539316
Pre-training layer 3, epoch 36, cost  0.0337731739237
Pre-training layer 3, epoch 37, cost  0.0328446793027
Pre-training layer 3, epoch 38, cost  0.0319605906197
Pre-training layer 3, epoch 39, cost  0.0311252873082
Pre-training layer 3, epoch 40, cost  0.0303386867924
Pre-training layer 3, epoch 41, cost  0.0295952812852
Pre-training layer 3, epoch 42, cost  0.0289034349013
Pre-training layer 3, epoch 43, cost  0.0282520693585
Pre-training layer 3, epoch 44, cost  0.0275695197895
Pre-training layer 3, epoch 45, cost  0.0267696311565
Pre-training layer 3, epoch 46, cost  0.0258146019437
Pre-training layer 3, epoch 47, cost  0.0248773082445
Pre-training layer 3, epoch 48, cost  0.0242713486583
Pre-training layer 3, epoch 49, cost  0.0239973710009
Pre-training layer 4, epoch 0, cost  4.19993065671
Pre-training layer 4, epoch 1, cost  1.15589050846
Pre-training layer 4, epoch 2, cost  0.955656148207
Pre-training layer 4, epoch 3, cost  0.91962619524
Pre-training layer 4, epoch 4, cost  0.902836235367
Pre-training layer 4, epoch 5, cost  0.890486397209
Pre-training layer 4, epoch 6, cost  0.881618625241
Pre-training layer 4, epoch 7, cost  0.874616884411
Pre-training layer 4, epoch 8, cost  0.868931402967
Pre-training layer 4, epoch 9, cost  0.864055076637
Pre-training layer 4, epoch 10, cost  0.859967464266
Pre-training layer 4, epoch 11, cost  0.856326625087
Pre-training layer 4, epoch 12, cost  0.853205443834
Pre-training layer 4, epoch 13, cost  0.850308151386
Pre-training layer 4, epoch 14, cost  0.847774357174
Pre-training layer 4, epoch 15, cost  0.845471363774
Pre-training layer 4, epoch 16, cost  0.843385943181
Pre-training layer 4, epoch 17, cost  0.841501023262
Pre-training layer 4, epoch 18, cost  0.839776588992
Pre-training layer 4, epoch 19, cost  0.838179341799
Pre-training layer 4, epoch 20, cost  0.836702165926
Pre-training layer 4, epoch 21, cost  0.835420114554
Pre-training layer 4, epoch 22, cost  0.834132525971
Pre-training layer 4, epoch 23, cost  0.832869565769
Pre-training layer 4, epoch 24, cost  0.831771102907
Pre-training layer 4, epoch 25, cost  0.83071893434
Pre-training layer 4, epoch 26, cost  0.829718249358
Pre-training layer 4, epoch 27, cost  0.82882829054
Pre-training layer 4, epoch 28, cost  0.827926844184
Pre-training layer 4, epoch 29, cost  0.827121199763
Pre-training layer 4, epoch 30, cost  0.826337585363
Pre-training layer 4, epoch 31, cost  0.825601665205
Pre-training layer 4, epoch 32, cost  0.824897106182
Pre-training layer 4, epoch 33, cost  0.824271798599
Pre-training layer 4, epoch 34, cost  0.823622740935
Pre-training layer 4, epoch 35, cost  0.823013941757
Pre-training layer 4, epoch 36, cost  0.822446042762
Pre-training layer 4, epoch 37, cost  0.82189225521
Pre-training layer 4, epoch 38, cost  0.821387963443
Pre-training layer 4, epoch 39, cost  0.820915784305
Pre-training layer 4, epoch 40, cost  0.820457452692
Pre-training layer 4, epoch 41, cost  0.819960851798
Pre-training layer 4, epoch 42, cost  0.819521937957
Pre-training layer 4, epoch 43, cost  0.819094562399
Pre-training layer 4, epoch 44, cost  0.818658869083
Pre-training layer 4, epoch 45, cost  0.818613855137
Pre-training layer 4, epoch 46, cost  0.818112371213
Pre-training layer 4, epoch 47, cost  0.817744783434
Pre-training layer 4, epoch 48, cost  0.81740007167
Pre-training layer 4, epoch 49, cost  0.817069031924
Pre-training layer 5, epoch 0, cost  5.41521968807
Pre-training layer 5, epoch 1, cost  3.45078815099
Pre-training layer 5, epoch 2, cost  3.43595902224
Pre-training layer 5, epoch 3, cost  3.43145358516
Pre-training layer 5, epoch 4, cost  3.42941306541
Pre-training layer 5, epoch 5, cost  3.42807602738
Pre-training layer 5, epoch 6, cost  3.42695623561
Pre-training layer 5, epoch 7, cost  3.42587926866
Pre-training layer 5, epoch 8, cost  3.42475419471
Pre-training layer 5, epoch 9, cost  3.4235031915
Pre-training layer 5, epoch 10, cost  3.42203721309
Pre-training layer 5, epoch 11, cost  3.42023701564
Pre-training layer 5, epoch 12, cost  3.41793243619
Pre-training layer 5, epoch 13, cost  3.41485833421
Pre-training layer 5, epoch 14, cost  3.41059797673
Pre-training layer 5, epoch 15, cost  3.40453160012
Pre-training layer 5, epoch 16, cost  3.39602613294
Pre-training layer 5, epoch 17, cost  3.38569592283
Pre-training layer 5, epoch 18, cost  3.37696994014
Pre-training layer 5, epoch 19, cost  3.37204564914
Pre-training layer 5, epoch 20, cost  3.36939139543
Pre-training layer 5, epoch 21, cost  3.3676909911
Pre-training layer 5, epoch 22, cost  3.36646579933
Pre-training layer 5, epoch 23, cost  3.36551525902
Pre-training layer 5, epoch 24, cost  3.36474121515
Pre-training layer 5, epoch 25, cost  3.36408657567
Pre-training layer 5, epoch 26, cost  3.36351827391
Pre-training layer 5, epoch 27, cost  3.36301265673
Pre-training layer 5, epoch 28, cost  3.36255673079
Pre-training layer 5, epoch 29, cost  3.36214078497
Pre-training layer 5, epoch 30, cost  3.36175673849
Pre-training layer 5, epoch 31, cost  3.36139968139
Pre-training layer 5, epoch 32, cost  3.36106606762
Pre-training layer 5, epoch 33, cost  3.36075258217
Pre-training layer 5, epoch 34, cost  3.36045626399
Pre-training layer 5, epoch 35, cost  3.36017581712
Pre-training layer 5, epoch 36, cost  3.35990950351
Pre-training layer 5, epoch 37, cost  3.35965594942
Pre-training layer 5, epoch 38, cost  3.35941387863
Pre-training layer 5, epoch 39, cost  3.35918241158
Pre-training layer 5, epoch 40, cost  3.35896052397
Pre-training layer 5, epoch 41, cost  3.35874786416
Pre-training layer 5, epoch 42, cost  3.35854355351
Pre-training layer 5, epoch 43, cost  3.35834709552
Pre-training layer 5, epoch 44, cost  3.35815813821
Pre-training layer 5, epoch 45, cost  3.35797613954
Pre-training layer 5, epoch 46, cost  3.35779988079
Pre-training layer 5, epoch 47, cost  3.35763029821
Pre-training layer 5, epoch 48, cost  3.35746634493
Pre-training layer 5, epoch 49, cost  3.3573078039
The pretraining code for file multi_layer_km.pyc ran for 70.29m
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
ACC for deep clustering: 0.54
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 3.35486, Reconstruction: 3.10799, Clustering: 0.24687,
Fine-tuning epoch 2 ++++
Total cost: 1.71005, Reconstruction: 1.41843, Clustering: 0.29162,
Fine-tuning epoch 3 ++++
Total cost: 1.53032, Reconstruction: 1.24527, Clustering: 0.28505,
Fine-tuning epoch 4 ++++
Total cost: 1.41570, Reconstruction: 1.13929, Clustering: 0.27641,
Fine-tuning epoch 5 ++++
Total cost: 1.33648, Reconstruction: 1.06819, Clustering: 0.26828,
Fine-tuning epoch 6 ++++
Total cost: 1.28162, Reconstruction: 1.02075, Clustering: 0.26086,
Fine-tuning epoch 7 ++++
Total cost: 1.23722, Reconstruction: 0.98266, Clustering: 0.25457,
Fine-tuning epoch 8 ++++
Total cost: 1.20683, Reconstruction: 0.95601, Clustering: 0.25081,
Fine-tuning epoch 9 ++++
Total cost: 1.18123, Reconstruction: 0.93421, Clustering: 0.24702,
Fine-tuning epoch 10 ++++
Total cost: 1.15989, Reconstruction: 0.91619, Clustering: 0.24370,
Fine-tuning epoch 11 ++++
Total cost: 1.14083, Reconstruction: 0.89987, Clustering: 0.24096,
Fine-tuning epoch 12 ++++
Total cost: 1.12651, Reconstruction: 0.88749, Clustering: 0.23902,
Fine-tuning epoch 13 ++++
Total cost: 1.10828, Reconstruction: 0.87242, Clustering: 0.23586,
Fine-tuning epoch 14 ++++
Total cost: 1.09888, Reconstruction: 0.86460, Clustering: 0.23428,
Fine-tuning epoch 15 ++++
Total cost: 1.08797, Reconstruction: 0.85458, Clustering: 0.23339,
Fine-tuning epoch 16 ++++
Total cost: 1.07130, Reconstruction: 0.84146, Clustering: 0.22984,
Fine-tuning epoch 17 ++++
Total cost: 1.07263, Reconstruction: 0.84134, Clustering: 0.23129,
Fine-tuning epoch 18 ++++
Total cost: 1.05449, Reconstruction: 0.82716, Clustering: 0.22733,
Fine-tuning epoch 19 ++++
Total cost: 1.03796, Reconstruction: 0.81071, Clustering: 0.22726,
Fine-tuning epoch 20 ++++
Total cost: 1.03009, Reconstruction: 0.80290, Clustering: 0.22719,
Fine-tuning epoch 21 ++++
Total cost: 1.02277, Reconstruction: 0.79687, Clustering: 0.22590,
Fine-tuning epoch 22 ++++
Total cost: 1.01816, Reconstruction: 0.79222, Clustering: 0.22594,
Fine-tuning epoch 23 ++++
Total cost: 1.00566, Reconstruction: 0.78187, Clustering: 0.22378,
Fine-tuning epoch 24 ++++
Total cost: 0.99703, Reconstruction: 0.77501, Clustering: 0.22202,
Fine-tuning epoch 25 ++++
Total cost: 0.99267, Reconstruction: 0.77173, Clustering: 0.22094,
Fine-tuning epoch 26 ++++
Total cost: 0.98499, Reconstruction: 0.76441, Clustering: 0.22058,
Fine-tuning epoch 27 ++++
Total cost: 0.97132, Reconstruction: 0.75397, Clustering: 0.21735,
Fine-tuning epoch 28 ++++
Total cost: 0.96250, Reconstruction: 0.74614, Clustering: 0.21636,
Fine-tuning epoch 29 ++++
Total cost: 0.95478, Reconstruction: 0.73960, Clustering: 0.21518,
Fine-tuning epoch 30 ++++
Total cost: 0.94902, Reconstruction: 0.73460, Clustering: 0.21442,
Fine-tuning epoch 31 ++++
Total cost: 0.94104, Reconstruction: 0.72684, Clustering: 0.21420,
Fine-tuning epoch 32 ++++
Total cost: 0.92979, Reconstruction: 0.71792, Clustering: 0.21187,
Fine-tuning epoch 33 ++++
Total cost: 0.92463, Reconstruction: 0.71330, Clustering: 0.21133,
Fine-tuning epoch 34 ++++
Total cost: 0.91844, Reconstruction: 0.70829, Clustering: 0.21015,
Fine-tuning epoch 35 ++++
Total cost: 0.91780, Reconstruction: 0.70580, Clustering: 0.21201,
Fine-tuning epoch 36 ++++
Total cost: 0.90750, Reconstruction: 0.69748, Clustering: 0.21001,
Fine-tuning epoch 37 ++++
Total cost: 0.90751, Reconstruction: 0.69703, Clustering: 0.21048,
Fine-tuning epoch 38 ++++
Total cost: 0.89892, Reconstruction: 0.68994, Clustering: 0.20898,
Fine-tuning epoch 39 ++++
Total cost: 0.89516, Reconstruction: 0.68612, Clustering: 0.20903,
Fine-tuning epoch 40 ++++
Total cost: 0.88876, Reconstruction: 0.68063, Clustering: 0.20813,
Fine-tuning epoch 41 ++++
Total cost: 0.88690, Reconstruction: 0.67791, Clustering: 0.20899,
Fine-tuning epoch 42 ++++
Total cost: 0.87879, Reconstruction: 0.67098, Clustering: 0.20782,
Fine-tuning epoch 43 ++++
Total cost: 0.87348, Reconstruction: 0.66730, Clustering: 0.20618,
Fine-tuning epoch 44 ++++
Total cost: 0.87389, Reconstruction: 0.66647, Clustering: 0.20741,
Fine-tuning epoch 45 ++++
Total cost: 0.86245, Reconstruction: 0.65809, Clustering: 0.20437,
Fine-tuning epoch 46 ++++
Total cost: 0.86687, Reconstruction: 0.65985, Clustering: 0.20702,
Fine-tuning epoch 47 ++++
Total cost: 0.85629, Reconstruction: 0.65193, Clustering: 0.20435,
Fine-tuning epoch 48 ++++
Total cost: 0.85248, Reconstruction: 0.64865, Clustering: 0.20383,
Fine-tuning epoch 49 ++++
Total cost: 0.85419, Reconstruction: 0.64866, Clustering: 0.20553,
Fine-tuning epoch 50 ++++
Total cost: 0.83796, Reconstruction: 0.63689, Clustering: 0.20106,
Average squared 2-D reconstruction error: 0.6369
NMI for deep clustering: 0.58
ARI for deep clustering: 0.41
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 59.49m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.13680662714
Pre-training layer 0, epoch 1, cost  0.983664134831
Pre-training layer 0, epoch 2, cost  0.79248021413
Pre-training layer 0, epoch 3, cost  0.705300991566
Pre-training layer 0, epoch 4, cost  0.651594739998
Pre-training layer 0, epoch 5, cost  0.61380547058
Pre-training layer 0, epoch 6, cost  0.58507773927
Pre-training layer 0, epoch 7, cost  0.562028708662
Pre-training layer 0, epoch 8, cost  0.542695812608
Pre-training layer 0, epoch 9, cost  0.5259358063
Pre-training layer 0, epoch 10, cost  0.511882386979
Pre-training layer 0, epoch 11, cost  0.499523183183
Pre-training layer 0, epoch 12, cost  0.488623030349
Pre-training layer 0, epoch 13, cost  0.478806312048
Pre-training layer 0, epoch 14, cost  0.469909201892
Pre-training layer 0, epoch 15, cost  0.461742182652
Pre-training layer 0, epoch 16, cost  0.454240560722
Pre-training layer 0, epoch 17, cost  0.447273402003
Pre-training layer 0, epoch 18, cost  0.44084293282
Pre-training layer 0, epoch 19, cost  0.434842111715
Pre-training layer 0, epoch 20, cost  0.429209371901
Pre-training layer 0, epoch 21, cost  0.423976513452
Pre-training layer 0, epoch 22, cost  0.419072227024
Pre-training layer 0, epoch 23, cost  0.414469805744
Pre-training layer 0, epoch 24, cost  0.410135067767
Pre-training layer 0, epoch 25, cost  0.406020092393
Pre-training layer 0, epoch 26, cost  0.402155255724
Pre-training layer 0, epoch 27, cost  0.39847542321
Pre-training layer 0, epoch 28, cost  0.394994861197
Pre-training layer 0, epoch 29, cost  0.391670322212
Pre-training layer 0, epoch 30, cost  0.388525952577
Pre-training layer 0, epoch 31, cost  0.385517146306
Pre-training layer 0, epoch 32, cost  0.382643186863
Pre-training layer 0, epoch 33, cost  0.379889796491
Pre-training layer 0, epoch 34, cost  0.377251691879
Pre-training layer 0, epoch 35, cost  0.374740882676
Pre-training layer 0, epoch 36, cost  0.372322863226
Pre-training layer 0, epoch 37, cost  0.369991205318
Pre-training layer 0, epoch 38, cost  0.367756056502
Pre-training layer 0, epoch 39, cost  0.365597700211
Pre-training layer 0, epoch 40, cost  0.363511285733
Pre-training layer 0, epoch 41, cost  0.361501869457
Pre-training layer 0, epoch 42, cost  0.3595602858
Pre-training layer 0, epoch 43, cost  0.35767728282
Pre-training layer 0, epoch 44, cost  0.35585950482
Pre-training layer 0, epoch 45, cost  0.354082279322
Pre-training layer 0, epoch 46, cost  0.35236119824
Pre-training layer 0, epoch 47, cost  0.350692023865
Pre-training layer 0, epoch 48, cost  0.349061422206
Pre-training layer 0, epoch 49, cost  0.347490432509
Pre-training layer 1, epoch 0, cost  3.86565650903
Pre-training layer 1, epoch 1, cost  1.01940041368
Pre-training layer 1, epoch 2, cost  0.737537846009
Pre-training layer 1, epoch 3, cost  0.616727090212
Pre-training layer 1, epoch 4, cost  0.546799139916
Pre-training layer 1, epoch 5, cost  0.499245399873
Pre-training layer 1, epoch 6, cost  0.46351938965
Pre-training layer 1, epoch 7, cost  0.435475138445
Pre-training layer 1, epoch 8, cost  0.413217235027
Pre-training layer 1, epoch 9, cost  0.393386672152
Pre-training layer 1, epoch 10, cost  0.377319499755
Pre-training layer 1, epoch 11, cost  0.36305722875
Pre-training layer 1, epoch 12, cost  0.350098314304
Pre-training layer 1, epoch 13, cost  0.338734202222
Pre-training layer 1, epoch 14, cost  0.328615222003
Pre-training layer 1, epoch 15, cost  0.319688517639
Pre-training layer 1, epoch 16, cost  0.311134507389
Pre-training layer 1, epoch 17, cost  0.303734353458
Pre-training layer 1, epoch 18, cost  0.296836259815
Pre-training layer 1, epoch 19, cost  0.290343613466
Pre-training layer 1, epoch 20, cost  0.284263004054
Pre-training layer 1, epoch 21, cost  0.279240873264
Pre-training layer 1, epoch 22, cost  0.273945129674
Pre-training layer 1, epoch 23, cost  0.269285412298
Pre-training layer 1, epoch 24, cost  0.264918949592
Pre-training layer 1, epoch 25, cost  0.260305305157
Pre-training layer 1, epoch 26, cost  0.25690635732
Pre-training layer 1, epoch 27, cost  0.252619991247
Pre-training layer 1, epoch 28, cost  0.249268469106
Pre-training layer 1, epoch 29, cost  0.245790684413
Pre-training layer 1, epoch 30, cost  0.242914723022
Pre-training layer 1, epoch 31, cost  0.239745185652
Pre-training layer 1, epoch 32, cost  0.237096335697
Pre-training layer 1, epoch 33, cost  0.234335250089
Pre-training layer 1, epoch 34, cost  0.23177286023
Pre-training layer 1, epoch 35, cost  0.229396550694
Pre-training layer 1, epoch 36, cost  0.227010861692
Pre-training layer 1, epoch 37, cost  0.224785478115
Pre-training layer 1, epoch 38, cost  0.222750259348
Pre-training layer 1, epoch 39, cost  0.220614851925
Pre-training layer 1, epoch 40, cost  0.218540095583
Pre-training layer 1, epoch 41, cost  0.216816925286
Pre-training layer 1, epoch 42, cost  0.215085309245
Pre-training layer 1, epoch 43, cost  0.213404022439
Pre-training layer 1, epoch 44, cost  0.211573395071
Pre-training layer 1, epoch 45, cost  0.21004426389
Pre-training layer 1, epoch 46, cost  0.208576310607
Pre-training layer 1, epoch 47, cost  0.207048013222
Pre-training layer 1, epoch 48, cost  0.205651697997
Pre-training layer 1, epoch 49, cost  0.204377247162
Pre-training layer 2, epoch 0, cost  4.79895835854
Pre-training layer 2, epoch 1, cost  1.41297710234
Pre-training layer 2, epoch 2, cost  1.08195111613
Pre-training layer 2, epoch 3, cost  0.916065582261
Pre-training layer 2, epoch 4, cost  0.811841931762
Pre-training layer 2, epoch 5, cost  0.754366218586
Pre-training layer 2, epoch 6, cost  0.705933303
Pre-training layer 2, epoch 7, cost  0.664071293124
Pre-training layer 2, epoch 8, cost  0.632555202944
Pre-training layer 2, epoch 9, cost  0.615465122456
Pre-training layer 2, epoch 10, cost  0.594759303758
Pre-training layer 2, epoch 11, cost  0.571566156749
Pre-training layer 2, epoch 12, cost  0.563414977179
Pre-training layer 2, epoch 13, cost  0.551398996391
Pre-training layer 2, epoch 14, cost  0.537470631217
Pre-training layer 2, epoch 15, cost  0.525000232038
Pre-training layer 2, epoch 16, cost  0.520162576504
Pre-training layer 2, epoch 17, cost  0.515848512173
Pre-training layer 2, epoch 18, cost  0.499751911036
Pre-training layer 2, epoch 19, cost  0.502895799171
Pre-training layer 2, epoch 20, cost  0.488688802742
Pre-training layer 2, epoch 21, cost  0.486460797023
Pre-training layer 2, epoch 22, cost  0.483980563285
Pre-training layer 2, epoch 23, cost  0.479182346661
Pre-training layer 2, epoch 24, cost  0.474422533056
Pre-training layer 2, epoch 25, cost  0.469843590027
Pre-training layer 2, epoch 26, cost  0.465659283108
Pre-training layer 2, epoch 27, cost  0.463939015984
Pre-training layer 2, epoch 28, cost  0.462149231588
Pre-training layer 2, epoch 29, cost  0.459486577177
Pre-training layer 2, epoch 30, cost  0.456454866508
Pre-training layer 2, epoch 31, cost  0.454039388046
Pre-training layer 2, epoch 32, cost  0.451642052829
Pre-training layer 2, epoch 33, cost  0.44934949881
Pre-training layer 2, epoch 34, cost  0.4473312671
Pre-training layer 2, epoch 35, cost  0.445324390518
Pre-training layer 2, epoch 36, cost  0.443581802585
Pre-training layer 2, epoch 37, cost  0.44175870851
Pre-training layer 2, epoch 38, cost  0.44016989414
Pre-training layer 2, epoch 39, cost  0.438666807593
Pre-training layer 2, epoch 40, cost  0.437130107024
Pre-training layer 2, epoch 41, cost  0.435670946134
Pre-training layer 2, epoch 42, cost  0.434143813338
Pre-training layer 2, epoch 43, cost  0.432738381736
Pre-training layer 2, epoch 44, cost  0.432214848511
Pre-training layer 2, epoch 45, cost  0.431662335918
Pre-training layer 2, epoch 46, cost  0.430295218174
Pre-training layer 2, epoch 47, cost  0.428869822848
Pre-training layer 2, epoch 48, cost  0.428028848291
Pre-training layer 2, epoch 49, cost  0.427342252929
Pre-training layer 3, epoch 0, cost  3.58370985105
Pre-training layer 3, epoch 1, cost  0.693183296342
Pre-training layer 3, epoch 2, cost  0.439562714638
Pre-training layer 3, epoch 3, cost  0.314228054656
Pre-training layer 3, epoch 4, cost  0.239606401822
Pre-training layer 3, epoch 5, cost  0.193373373059
Pre-training layer 3, epoch 6, cost  0.166464354357
Pre-training layer 3, epoch 7, cost  0.145101330124
Pre-training layer 3, epoch 8, cost  0.126918236095
Pre-training layer 3, epoch 9, cost  0.113952549547
Pre-training layer 3, epoch 10, cost  0.103832690918
Pre-training layer 3, epoch 11, cost  0.0968659276744
Pre-training layer 3, epoch 12, cost  0.0908834601039
Pre-training layer 3, epoch 13, cost  0.0837489815895
Pre-training layer 3, epoch 14, cost  0.0787743238062
Pre-training layer 3, epoch 15, cost  0.0747787340464
Pre-training layer 3, epoch 16, cost  0.0705380081632
Pre-training layer 3, epoch 17, cost  0.0669025655284
Pre-training layer 3, epoch 18, cost  0.0638293558444
Pre-training layer 3, epoch 19, cost  0.0608541167343
Pre-training layer 3, epoch 20, cost  0.0582283782527
Pre-training layer 3, epoch 21, cost  0.0559650318108
Pre-training layer 3, epoch 22, cost  0.0539044507314
Pre-training layer 3, epoch 23, cost  0.0519998457895
Pre-training layer 3, epoch 24, cost  0.0500857095898
Pre-training layer 3, epoch 25, cost  0.0480734926355
Pre-training layer 3, epoch 26, cost  0.0461953890699
Pre-training layer 3, epoch 27, cost  0.0446831957311
Pre-training layer 3, epoch 28, cost  0.0432805057969
Pre-training layer 3, epoch 29, cost  0.0417965818819
Pre-training layer 3, epoch 30, cost  0.0404948000796
Pre-training layer 3, epoch 31, cost  0.0392104934106
Pre-training layer 3, epoch 32, cost  0.038033761141
Pre-training layer 3, epoch 33, cost  0.0368723537945
Pre-training layer 3, epoch 34, cost  0.0358178243743
Pre-training layer 3, epoch 35, cost  0.0347751385983
Pre-training layer 3, epoch 36, cost  0.0338016949156
Pre-training layer 3, epoch 37, cost  0.0328799365954
Pre-training layer 3, epoch 38, cost  0.0319942739528
Pre-training layer 3, epoch 39, cost  0.0311431473438
Pre-training layer 3, epoch 40, cost  0.0303370996934
Pre-training layer 3, epoch 41, cost  0.0295649792499
Pre-training layer 3, epoch 42, cost  0.0287911800569
Pre-training layer 3, epoch 43, cost  0.0280213547617
Pre-training layer 3, epoch 44, cost  0.0271898382246
Pre-training layer 3, epoch 45, cost  0.0263846392271
Pre-training layer 3, epoch 46, cost  0.0256031980061
Pre-training layer 3, epoch 47, cost  0.0250159087405
Pre-training layer 3, epoch 48, cost  0.0245910232792
Pre-training layer 3, epoch 49, cost  0.0241872725368
Pre-training layer 4, epoch 0, cost  4.20166969359
Pre-training layer 4, epoch 1, cost  1.15633669435
Pre-training layer 4, epoch 2, cost  0.951544067628
Pre-training layer 4, epoch 3, cost  0.918858194801
Pre-training layer 4, epoch 4, cost  0.901646017513
Pre-training layer 4, epoch 5, cost  0.889414695883
Pre-training layer 4, epoch 6, cost  0.880610060033
Pre-training layer 4, epoch 7, cost  0.873613496688
Pre-training layer 4, epoch 8, cost  0.867931709043
Pre-training layer 4, epoch 9, cost  0.863142218002
Pre-training layer 4, epoch 10, cost  0.859033985478
Pre-training layer 4, epoch 11, cost  0.855418416882
Pre-training layer 4, epoch 12, cost  0.852249480859
Pre-training layer 4, epoch 13, cost  0.84947060493
Pre-training layer 4, epoch 14, cost  0.84697647251
Pre-training layer 4, epoch 15, cost  0.844740801719
Pre-training layer 4, epoch 16, cost  0.8426622421
Pre-training layer 4, epoch 17, cost  0.840849341018
Pre-training layer 4, epoch 18, cost  0.839105183233
Pre-training layer 4, epoch 19, cost  0.837564984223
Pre-training layer 4, epoch 20, cost  0.836130957405
Pre-training layer 4, epoch 21, cost  0.834806450258
Pre-training layer 4, epoch 22, cost  0.833575192779
Pre-training layer 4, epoch 23, cost  0.8324284999
Pre-training layer 4, epoch 24, cost  0.831364866572
Pre-training layer 4, epoch 25, cost  0.830355549438
Pre-training layer 4, epoch 26, cost  0.829412945716
Pre-training layer 4, epoch 27, cost  0.82853668745
Pre-training layer 4, epoch 28, cost  0.827716200641
Pre-training layer 4, epoch 29, cost  0.82694950446
Pre-training layer 4, epoch 30, cost  0.826196716684
Pre-training layer 4, epoch 31, cost  0.825493206881
Pre-training layer 4, epoch 32, cost  0.824821393722
Pre-training layer 4, epoch 33, cost  0.824204936213
Pre-training layer 4, epoch 34, cost  0.823607906886
Pre-training layer 4, epoch 35, cost  0.823031385833
Pre-training layer 4, epoch 36, cost  0.822504855487
Pre-training layer 4, epoch 37, cost  0.821982701309
Pre-training layer 4, epoch 38, cost  0.82150072541
Pre-training layer 4, epoch 39, cost  0.821027633115
Pre-training layer 4, epoch 40, cost  0.820582896028
Pre-training layer 4, epoch 41, cost  0.820143483791
Pre-training layer 4, epoch 42, cost  0.819738010104
Pre-training layer 4, epoch 43, cost  0.819335692113
Pre-training layer 4, epoch 44, cost  0.818983741686
Pre-training layer 4, epoch 45, cost  0.818614318159
Pre-training layer 4, epoch 46, cost  0.818271547752
Pre-training layer 4, epoch 47, cost  0.817947875785
Pre-training layer 4, epoch 48, cost  0.817621346687
Pre-training layer 4, epoch 49, cost  0.817301421169
Pre-training layer 5, epoch 0, cost  5.45906230852
Pre-training layer 5, epoch 1, cost  3.46995595051
Pre-training layer 5, epoch 2, cost  3.45495586139
Pre-training layer 5, epoch 3, cost  3.45010091908
Pre-training layer 5, epoch 4, cost  3.44697624663
Pre-training layer 5, epoch 5, cost  3.44454516769
Pre-training layer 5, epoch 6, cost  3.44268635767
Pre-training layer 5, epoch 7, cost  3.44122020965
Pre-training layer 5, epoch 8, cost  3.4399328993
Pre-training layer 5, epoch 9, cost  3.43865067829
Pre-training layer 5, epoch 10, cost  3.43724312415
Pre-training layer 5, epoch 11, cost  3.43558613373
Pre-training layer 5, epoch 12, cost  3.43353293758
Pre-training layer 5, epoch 13, cost  3.43086887401
Pre-training layer 5, epoch 14, cost  3.42726907518
Pre-training layer 5, epoch 15, cost  3.42223954514
Pre-training layer 5, epoch 16, cost  3.41514002786
Pre-training layer 5, epoch 17, cost  3.40577202299
Pre-training layer 5, epoch 18, cost  3.39607730617
Pre-training layer 5, epoch 19, cost  3.38937991194
Pre-training layer 5, epoch 20, cost  3.38574379484
Pre-training layer 5, epoch 21, cost  3.38356135512
Pre-training layer 5, epoch 22, cost  3.38205054708
Pre-training layer 5, epoch 23, cost  3.38090886398
Pre-training layer 5, epoch 24, cost  3.37999529651
Pre-training layer 5, epoch 25, cost  3.37923313409
Pre-training layer 5, epoch 26, cost  3.37857802258
Pre-training layer 5, epoch 27, cost  3.37800189036
Pre-training layer 5, epoch 28, cost  3.37748553119
Pre-training layer 5, epoch 29, cost  3.37701707639
Pre-training layer 5, epoch 30, cost  3.3765872576
Pre-training layer 5, epoch 31, cost  3.37618956684
Pre-training layer 5, epoch 32, cost  3.37581919132
Pre-training layer 5, epoch 33, cost  3.37547231979
Pre-training layer 5, epoch 34, cost  3.37514537993
Pre-training layer 5, epoch 35, cost  3.37483688683
Pre-training layer 5, epoch 36, cost  3.37454397571
Pre-training layer 5, epoch 37, cost  3.37426577155
Pre-training layer 5, epoch 38, cost  3.3740003968
Pre-training layer 5, epoch 39, cost  3.37374707785
Pre-training layer 5, epoch 40, cost  3.37350479657
Pre-training layer 5, epoch 41, cost  3.37327281587
Pre-training layer 5, epoch 42, cost  3.37305023976
Pre-training layer 5, epoch 43, cost  3.37283608454
Pre-training layer 5, epoch 44, cost  3.37263065608
Pre-training layer 5, epoch 45, cost  3.37243240463
Pre-training layer 5, epoch 46, cost  3.3722412547
Pre-training layer 5, epoch 47, cost  3.37205712534
Pre-training layer 5, epoch 48, cost  3.37187914904
Pre-training layer 5, epoch 49, cost  3.3717073065
The pretraining code for file multi_layer_km.pyc ran for 49.99m
Initial NMI for deep clustering: 0.52
ARI for deep clustering: 0.39
ACC for deep clustering: 0.55
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 4.54960, Reconstruction: 4.35271, Clustering: 0.19689,
Fine-tuning epoch 2 ++++
Total cost: 2.63235, Reconstruction: 2.48230, Clustering: 0.15005,
Fine-tuning epoch 3 ++++
Total cost: 1.67529, Reconstruction: 1.41252, Clustering: 0.26277,
Fine-tuning epoch 4 ++++
Total cost: 1.50309, Reconstruction: 1.23437, Clustering: 0.26872,
Fine-tuning epoch 5 ++++
Total cost: 1.39475, Reconstruction: 1.12932, Clustering: 0.26544,
Fine-tuning epoch 6 ++++
Total cost: 1.32253, Reconstruction: 1.06126, Clustering: 0.26127,
Fine-tuning epoch 7 ++++
Total cost: 1.26486, Reconstruction: 1.00908, Clustering: 0.25578,
Fine-tuning epoch 8 ++++
Total cost: 1.22087, Reconstruction: 0.97080, Clustering: 0.25007,
Fine-tuning epoch 9 ++++
Total cost: 1.18940, Reconstruction: 0.94338, Clustering: 0.24603,
Fine-tuning epoch 10 ++++
Total cost: 1.16605, Reconstruction: 0.92227, Clustering: 0.24378,
Fine-tuning epoch 11 ++++
Total cost: 1.14129, Reconstruction: 0.90150, Clustering: 0.23980,
Fine-tuning epoch 12 ++++
Total cost: 1.12486, Reconstruction: 0.88739, Clustering: 0.23748,
Fine-tuning epoch 13 ++++
Total cost: 1.10712, Reconstruction: 0.87315, Clustering: 0.23397,
Fine-tuning epoch 14 ++++
Total cost: 1.09540, Reconstruction: 0.86263, Clustering: 0.23277,
Fine-tuning epoch 15 ++++
Total cost: 1.08649, Reconstruction: 0.85377, Clustering: 0.23272,
Fine-tuning epoch 16 ++++
Total cost: 1.06750, Reconstruction: 0.83921, Clustering: 0.22829,
Fine-tuning epoch 17 ++++
Total cost: 1.06191, Reconstruction: 0.83404, Clustering: 0.22787,
Fine-tuning epoch 18 ++++
Total cost: 1.05199, Reconstruction: 0.82559, Clustering: 0.22640,
Fine-tuning epoch 19 ++++
Total cost: 1.03810, Reconstruction: 0.81414, Clustering: 0.22395,
Fine-tuning epoch 20 ++++
Total cost: 1.03397, Reconstruction: 0.81015, Clustering: 0.22382,
Fine-tuning epoch 21 ++++
Total cost: 1.02990, Reconstruction: 0.80607, Clustering: 0.22383,
Fine-tuning epoch 22 ++++
Total cost: 1.01630, Reconstruction: 0.79492, Clustering: 0.22138,
Fine-tuning epoch 23 ++++
Total cost: 1.00821, Reconstruction: 0.78731, Clustering: 0.22090,
Fine-tuning epoch 24 ++++
Total cost: 1.00063, Reconstruction: 0.78218, Clustering: 0.21845,
Fine-tuning epoch 25 ++++
Total cost: 0.99892, Reconstruction: 0.77857, Clustering: 0.22034,
Fine-tuning epoch 26 ++++
Total cost: 0.98259, Reconstruction: 0.76561, Clustering: 0.21699,
Fine-tuning epoch 27 ++++
Total cost: 0.97898, Reconstruction: 0.76288, Clustering: 0.21610,
Fine-tuning epoch 28 ++++
Total cost: 0.96954, Reconstruction: 0.75322, Clustering: 0.21631,
Fine-tuning epoch 29 ++++
Total cost: 0.96315, Reconstruction: 0.74793, Clustering: 0.21522,
Fine-tuning epoch 30 ++++
Total cost: 0.95227, Reconstruction: 0.73951, Clustering: 0.21276,
Fine-tuning epoch 31 ++++
Total cost: 0.94515, Reconstruction: 0.73259, Clustering: 0.21256,
Fine-tuning epoch 32 ++++
Total cost: 0.93803, Reconstruction: 0.72649, Clustering: 0.21154,
Fine-tuning epoch 33 ++++
Total cost: 0.93249, Reconstruction: 0.72062, Clustering: 0.21187,
Fine-tuning epoch 34 ++++
Total cost: 0.92557, Reconstruction: 0.71524, Clustering: 0.21032,
Fine-tuning epoch 35 ++++
Total cost: 0.92247, Reconstruction: 0.71245, Clustering: 0.21002,
Fine-tuning epoch 36 ++++
Total cost: 0.91665, Reconstruction: 0.70564, Clustering: 0.21101,
Fine-tuning epoch 37 ++++
Total cost: 0.91652, Reconstruction: 0.70450, Clustering: 0.21202,
Fine-tuning epoch 38 ++++
Total cost: 0.90815, Reconstruction: 0.69840, Clustering: 0.20976,
Fine-tuning epoch 39 ++++
Total cost: 0.90015, Reconstruction: 0.69161, Clustering: 0.20853,
Fine-tuning epoch 40 ++++
Total cost: 0.89807, Reconstruction: 0.68916, Clustering: 0.20891,
Fine-tuning epoch 41 ++++
Total cost: 0.89101, Reconstruction: 0.68371, Clustering: 0.20731,
Fine-tuning epoch 42 ++++
Total cost: 0.88882, Reconstruction: 0.68130, Clustering: 0.20752,
Fine-tuning epoch 43 ++++
Total cost: 0.88378, Reconstruction: 0.67681, Clustering: 0.20697,
Fine-tuning epoch 44 ++++
Total cost: 0.88338, Reconstruction: 0.67570, Clustering: 0.20767,
Fine-tuning epoch 45 ++++
Total cost: 0.87341, Reconstruction: 0.66764, Clustering: 0.20577,
Fine-tuning epoch 46 ++++
Total cost: 0.87821, Reconstruction: 0.67049, Clustering: 0.20772,
Fine-tuning epoch 47 ++++
Total cost: 0.86924, Reconstruction: 0.66263, Clustering: 0.20661,
Fine-tuning epoch 48 ++++
Total cost: 0.86769, Reconstruction: 0.66136, Clustering: 0.20633,
Fine-tuning epoch 49 ++++
Total cost: 0.86229, Reconstruction: 0.65699, Clustering: 0.20530,
Fine-tuning epoch 50 ++++
Total cost: 0.86386, Reconstruction: 0.65648, Clustering: 0.20738,
Average squared 2-D reconstruction error: 0.6565
NMI for deep clustering: 0.59
ARI for deep clustering: 0.42
ACC for deep clustering: 0.57
The training code for file multi_layer_km.pyc ran for 48.33m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.12515302838
Pre-training layer 0, epoch 1, cost  0.980891883879
Pre-training layer 0, epoch 2, cost  0.790504861497
Pre-training layer 0, epoch 3, cost  0.703011184318
Pre-training layer 0, epoch 4, cost  0.649646050857
Pre-training layer 0, epoch 5, cost  0.61191386285
Pre-training layer 0, epoch 6, cost  0.583121498177
Pre-training layer 0, epoch 7, cost  0.559852574719
Pre-training layer 0, epoch 8, cost  0.540658340664
Pre-training layer 0, epoch 9, cost  0.524349280749
Pre-training layer 0, epoch 10, cost  0.510176811161
Pre-training layer 0, epoch 11, cost  0.497815499795
Pre-training layer 0, epoch 12, cost  0.486825269501
Pre-training layer 0, epoch 13, cost  0.476927347351
Pre-training layer 0, epoch 14, cost  0.467982107756
Pre-training layer 0, epoch 15, cost  0.459820669379
Pre-training layer 0, epoch 16, cost  0.452369311741
Pre-training layer 0, epoch 17, cost  0.445512563938
Pre-training layer 0, epoch 18, cost  0.439153552652
Pre-training layer 0, epoch 19, cost  0.43323354855
Pre-training layer 0, epoch 20, cost  0.427721343507
Pre-training layer 0, epoch 21, cost  0.422571698822
Pre-training layer 0, epoch 22, cost  0.417753303591
Pre-training layer 0, epoch 23, cost  0.41321776067
Pre-training layer 0, epoch 24, cost  0.408932596433
Pre-training layer 0, epoch 25, cost  0.404878075593
Pre-training layer 0, epoch 26, cost  0.401047225518
Pre-training layer 0, epoch 27, cost  0.3973858928
Pre-training layer 0, epoch 28, cost  0.393913669299
Pre-training layer 0, epoch 29, cost  0.39061039471
Pre-training layer 0, epoch 30, cost  0.387468958127
Pre-training layer 0, epoch 31, cost  0.384462817684
Pre-training layer 0, epoch 32, cost  0.381555925303
Pre-training layer 0, epoch 33, cost  0.378757144889
Pre-training layer 0, epoch 34, cost  0.376082552833
Pre-training layer 0, epoch 35, cost  0.3735246908
Pre-training layer 0, epoch 36, cost  0.371075905782
Pre-training layer 0, epoch 37, cost  0.368710462764
Pre-training layer 0, epoch 38, cost  0.366436464748
Pre-training layer 0, epoch 39, cost  0.364251775063
Pre-training layer 0, epoch 40, cost  0.362143220992
Pre-training layer 0, epoch 41, cost  0.36010416564
Pre-training layer 0, epoch 42, cost  0.358133226491
Pre-training layer 0, epoch 43, cost  0.356224704854
Pre-training layer 0, epoch 44, cost  0.35437896429
Pre-training layer 0, epoch 45, cost  0.352587406622
Pre-training layer 0, epoch 46, cost  0.350855307463
Pre-training layer 0, epoch 47, cost  0.349174098883
Pre-training layer 0, epoch 48, cost  0.347543735481
Pre-training layer 0, epoch 49, cost  0.345964193658
Pre-training layer 1, epoch 0, cost  3.8843794572
Pre-training layer 1, epoch 1, cost  1.02413985797
Pre-training layer 1, epoch 2, cost  0.740769841721
Pre-training layer 1, epoch 3, cost  0.618568696965
Pre-training layer 1, epoch 4, cost  0.548529562284
Pre-training layer 1, epoch 5, cost  0.499863414952
Pre-training layer 1, epoch 6, cost  0.464486888718
Pre-training layer 1, epoch 7, cost  0.436410060318
Pre-training layer 1, epoch 8, cost  0.412769437157
Pre-training layer 1, epoch 9, cost  0.393623284925
Pre-training layer 1, epoch 10, cost  0.376479071936
Pre-training layer 1, epoch 11, cost  0.361971193199
Pre-training layer 1, epoch 12, cost  0.349160924007
Pre-training layer 1, epoch 13, cost  0.337705053658
Pre-training layer 1, epoch 14, cost  0.32735521735
Pre-training layer 1, epoch 15, cost  0.31818293523
Pre-training layer 1, epoch 16, cost  0.310319518111
Pre-training layer 1, epoch 17, cost  0.302259506788
Pre-training layer 1, epoch 18, cost  0.295497819533
Pre-training layer 1, epoch 19, cost  0.288558399116
Pre-training layer 1, epoch 20, cost  0.282777313277
Pre-training layer 1, epoch 21, cost  0.277100954237
Pre-training layer 1, epoch 22, cost  0.272573308341
Pre-training layer 1, epoch 23, cost  0.267362268209
Pre-training layer 1, epoch 24, cost  0.262859562565
Pre-training layer 1, epoch 25, cost  0.258568288575
Pre-training layer 1, epoch 26, cost  0.254665881155
Pre-training layer 1, epoch 27, cost  0.250977752147
Pre-training layer 1, epoch 28, cost  0.246924015704
Pre-training layer 1, epoch 29, cost  0.243796207538
Pre-training layer 1, epoch 30, cost  0.241144894977
Pre-training layer 1, epoch 31, cost  0.238075498641
Pre-training layer 1, epoch 32, cost  0.234991403445
Pre-training layer 1, epoch 33, cost  0.232212440686
Pre-training layer 1, epoch 34, cost  0.229591906557
Pre-training layer 1, epoch 35, cost  0.22714804562
Pre-training layer 1, epoch 36, cost  0.224609904856
Pre-training layer 1, epoch 37, cost  0.222649684192
Pre-training layer 1, epoch 38, cost  0.220535385505
Pre-training layer 1, epoch 39, cost  0.218479838627
Pre-training layer 1, epoch 40, cost  0.216349016955
Pre-training layer 1, epoch 41, cost  0.214622499432
Pre-training layer 1, epoch 42, cost  0.212741960428
Pre-training layer 1, epoch 43, cost  0.211076173446
Pre-training layer 1, epoch 44, cost  0.209268631455
Pre-training layer 1, epoch 45, cost  0.207894224779
Pre-training layer 1, epoch 46, cost  0.206291504299
Pre-training layer 1, epoch 47, cost  0.204750069857
Pre-training layer 1, epoch 48, cost  0.203361321968
Pre-training layer 1, epoch 49, cost  0.202008682018
Pre-training layer 2, epoch 0, cost  4.81471251088
Pre-training layer 2, epoch 1, cost  1.40453038313
Pre-training layer 2, epoch 2, cost  1.07166852662
Pre-training layer 2, epoch 3, cost  0.909696936707
Pre-training layer 2, epoch 4, cost  0.802964112645
Pre-training layer 2, epoch 5, cost  0.736486427035
Pre-training layer 2, epoch 6, cost  0.697963775537
Pre-training layer 2, epoch 7, cost  0.64675988465
Pre-training layer 2, epoch 8, cost  0.623640412988
Pre-training layer 2, epoch 9, cost  0.606932900704
Pre-training layer 2, epoch 10, cost  0.576497182752
Pre-training layer 2, epoch 11, cost  0.566924513735
Pre-training layer 2, epoch 12, cost  0.546778217619
Pre-training layer 2, epoch 13, cost  0.537776696916
Pre-training layer 2, epoch 14, cost  0.528921397657
Pre-training layer 2, epoch 15, cost  0.517747415756
Pre-training layer 2, epoch 16, cost  0.502518647974
Pre-training layer 2, epoch 17, cost  0.501973670348
Pre-training layer 2, epoch 18, cost  0.491538118001
Pre-training layer 2, epoch 19, cost  0.486664617728
Pre-training layer 2, epoch 20, cost  0.482310154882
Pre-training layer 2, epoch 21, cost  0.477329155334
Pre-training layer 2, epoch 22, cost  0.469056640066
Pre-training layer 2, epoch 23, cost  0.465879596431
Pre-training layer 2, epoch 24, cost  0.462402738336
Pre-training layer 2, epoch 25, cost  0.459567935837
Pre-training layer 2, epoch 26, cost  0.456401459851
Pre-training layer 2, epoch 27, cost  0.452523375417
Pre-training layer 2, epoch 28, cost  0.448837779939
Pre-training layer 2, epoch 29, cost  0.445826692228
Pre-training layer 2, epoch 30, cost  0.444079533295
Pre-training layer 2, epoch 31, cost  0.441013882908
Pre-training layer 2, epoch 32, cost  0.438259471492
Pre-training layer 2, epoch 33, cost  0.436980365158
Pre-training layer 2, epoch 34, cost  0.434946700623
Pre-training layer 2, epoch 35, cost  0.433928519936
Pre-training layer 2, epoch 36, cost  0.431123647165
Pre-training layer 2, epoch 37, cost  0.430027930129
Pre-training layer 2, epoch 38, cost  0.428353377827
Pre-training layer 2, epoch 39, cost  0.426508918407
Pre-training layer 2, epoch 40, cost  0.425224481496
Pre-training layer 2, epoch 41, cost  0.424073900176
Pre-training layer 2, epoch 42, cost  0.422767114269
Pre-training layer 2, epoch 43, cost  0.421290086868
Pre-training layer 2, epoch 44, cost  0.419951089548
Pre-training layer 2, epoch 45, cost  0.419368320653
Pre-training layer 2, epoch 46, cost  0.418638365177
Pre-training layer 2, epoch 47, cost  0.417827579635
Pre-training layer 2, epoch 48, cost  0.416848160376
Pre-training layer 2, epoch 49, cost  0.415862212673
Pre-training layer 3, epoch 0, cost  3.58107259316
Pre-training layer 3, epoch 1, cost  0.69662534854
Pre-training layer 3, epoch 2, cost  0.443699463133
Pre-training layer 3, epoch 3, cost  0.31564426164
Pre-training layer 3, epoch 4, cost  0.24343495686
Pre-training layer 3, epoch 5, cost  0.197308647078
Pre-training layer 3, epoch 6, cost  0.169358886544
Pre-training layer 3, epoch 7, cost  0.146449038217
Pre-training layer 3, epoch 8, cost  0.129078269661
Pre-training layer 3, epoch 9, cost  0.116505458458
Pre-training layer 3, epoch 10, cost  0.106441096621
Pre-training layer 3, epoch 11, cost  0.0972003721292
Pre-training layer 3, epoch 12, cost  0.0890546943413
Pre-training layer 3, epoch 13, cost  0.0851340843723
Pre-training layer 3, epoch 14, cost  0.0793225943735
Pre-training layer 3, epoch 15, cost  0.0751757020056
Pre-training layer 3, epoch 16, cost  0.070872877359
Pre-training layer 3, epoch 17, cost  0.0678843436479
Pre-training layer 3, epoch 18, cost  0.0644359272679
Pre-training layer 3, epoch 19, cost  0.0613455003802
Pre-training layer 3, epoch 20, cost  0.0585558700004
Pre-training layer 3, epoch 21, cost  0.0559119627689
Pre-training layer 3, epoch 22, cost  0.0534362601744
Pre-training layer 3, epoch 23, cost  0.0511162605015
Pre-training layer 3, epoch 24, cost  0.0493436854238
Pre-training layer 3, epoch 25, cost  0.0479019116277
Pre-training layer 3, epoch 26, cost  0.0461765196676
Pre-training layer 3, epoch 27, cost  0.0443302672767
Pre-training layer 3, epoch 28, cost  0.0429549829779
Pre-training layer 3, epoch 29, cost  0.041540722219
Pre-training layer 3, epoch 30, cost  0.0401263228284
Pre-training layer 3, epoch 31, cost  0.0389114005538
Pre-training layer 3, epoch 32, cost  0.0376644939747
Pre-training layer 3, epoch 33, cost  0.0365351157718
Pre-training layer 3, epoch 34, cost  0.0354479645628
Pre-training layer 3, epoch 35, cost  0.0344151505846
Pre-training layer 3, epoch 36, cost  0.0334355897317
Pre-training layer 3, epoch 37, cost  0.0324957250381
Pre-training layer 3, epoch 38, cost  0.0316043251751
Pre-training layer 3, epoch 39, cost  0.0307447447102
Pre-training layer 3, epoch 40, cost  0.0299368823485
Pre-training layer 3, epoch 41, cost  0.0291715699384
Pre-training layer 3, epoch 42, cost  0.0284301469506
Pre-training layer 3, epoch 43, cost  0.0276781442458
Pre-training layer 3, epoch 44, cost  0.026836172105
Pre-training layer 3, epoch 45, cost  0.0258678791991
Pre-training layer 3, epoch 46, cost  0.0250078675637
Pre-training layer 3, epoch 47, cost  0.0245029756294
Pre-training layer 3, epoch 48, cost  0.0243101296637
Pre-training layer 3, epoch 49, cost  0.0240735329878
Pre-training layer 4, epoch 0, cost  4.21027153942
Pre-training layer 4, epoch 1, cost  1.15490152901
Pre-training layer 4, epoch 2, cost  0.950680524466
Pre-training layer 4, epoch 3, cost  0.916273522399
Pre-training layer 4, epoch 4, cost  0.898668356425
Pre-training layer 4, epoch 5, cost  0.88614717758
Pre-training layer 4, epoch 6, cost  0.877069242317
Pre-training layer 4, epoch 7, cost  0.869982555001
Pre-training layer 4, epoch 8, cost  0.864153060815
Pre-training layer 4, epoch 9, cost  0.859432300435
Pre-training layer 4, epoch 10, cost  0.855269405485
Pre-training layer 4, epoch 11, cost  0.851704414271
Pre-training layer 4, epoch 12, cost  0.848530150641
Pre-training layer 4, epoch 13, cost  0.845739251888
Pre-training layer 4, epoch 14, cost  0.843238153757
Pre-training layer 4, epoch 15, cost  0.841066366835
Pre-training layer 4, epoch 16, cost  0.839021695947
Pre-training layer 4, epoch 17, cost  0.837183436398
Pre-training layer 4, epoch 18, cost  0.835491418749
Pre-training layer 4, epoch 19, cost  0.833946862383
Pre-training layer 4, epoch 20, cost  0.832479782792
Pre-training layer 4, epoch 21, cost  0.831145511397
Pre-training layer 4, epoch 22, cost  0.829874733978
Pre-training layer 4, epoch 23, cost  0.828715095923
Pre-training layer 4, epoch 24, cost  0.827653647256
Pre-training layer 4, epoch 25, cost  0.826654025251
Pre-training layer 4, epoch 26, cost  0.825696868888
Pre-training layer 4, epoch 27, cost  0.824801201039
Pre-training layer 4, epoch 28, cost  0.823955219789
Pre-training layer 4, epoch 29, cost  0.823158260763
Pre-training layer 4, epoch 30, cost  0.82240547573
Pre-training layer 4, epoch 31, cost  0.821682570429
Pre-training layer 4, epoch 32, cost  0.821025272658
Pre-training layer 4, epoch 33, cost  0.820367675762
Pre-training layer 4, epoch 34, cost  0.819801750897
Pre-training layer 4, epoch 35, cost  0.819199229293
Pre-training layer 4, epoch 36, cost  0.818635838265
Pre-training layer 4, epoch 37, cost  0.818110473362
Pre-training layer 4, epoch 38, cost  0.817604188736
Pre-training layer 4, epoch 39, cost  0.817117506257
Pre-training layer 4, epoch 40, cost  0.816679160158
Pre-training layer 4, epoch 41, cost  0.816244378551
Pre-training layer 4, epoch 42, cost  0.815819079521
Pre-training layer 4, epoch 43, cost  0.815418138247
Pre-training layer 4, epoch 44, cost  0.815031696128
Pre-training layer 4, epoch 45, cost  0.814684058253
Pre-training layer 4, epoch 46, cost  0.814310758341
Pre-training layer 4, epoch 47, cost  0.813949088724
Pre-training layer 4, epoch 48, cost  0.813631867019
Pre-training layer 4, epoch 49, cost  0.813329552105
Pre-training layer 5, epoch 0, cost  5.44771053235
Pre-training layer 5, epoch 1, cost  3.45239309509
Pre-training layer 5, epoch 2, cost  3.43851402375
Pre-training layer 5, epoch 3, cost  3.43403645003
Pre-training layer 5, epoch 4, cost  3.4317346581
Pre-training layer 5, epoch 5, cost  3.43010984063
Pre-training layer 5, epoch 6, cost  3.4287305182
Pre-training layer 5, epoch 7, cost  3.42743639412
Pre-training layer 5, epoch 8, cost  3.42613652255
Pre-training layer 5, epoch 9, cost  3.42474944338
Pre-training layer 5, epoch 10, cost  3.42317954517
Pre-training layer 5, epoch 11, cost  3.42130676442
Pre-training layer 5, epoch 12, cost  3.41896236988
Pre-training layer 5, epoch 13, cost  3.41589147813
Pre-training layer 5, epoch 14, cost  3.41170769391
Pre-training layer 5, epoch 15, cost  3.4058609454
Pre-training layer 5, epoch 16, cost  3.39786872164
Pre-training layer 5, epoch 17, cost  3.38846092497
Pre-training layer 5, epoch 18, cost  3.38055340741
Pre-training layer 5, epoch 19, cost  3.37589113475
Pre-training layer 5, epoch 20, cost  3.37326308094
Pre-training layer 5, epoch 21, cost  3.37154096949
Pre-training layer 5, epoch 22, cost  3.37028105202
Pre-training layer 5, epoch 23, cost  3.36929270323
Pre-training layer 5, epoch 24, cost  3.36847740613
Pre-training layer 5, epoch 25, cost  3.36778073365
Pre-training layer 5, epoch 26, cost  3.36716855904
Pre-training layer 5, epoch 27, cost  3.36662036489
Pre-training layer 5, epoch 28, cost  3.36612190769
Pre-training layer 5, epoch 29, cost  3.36566295049
Pre-training layer 5, epoch 30, cost  3.36523672243
Pre-training layer 5, epoch 31, cost  3.36483764662
Pre-training layer 5, epoch 32, cost  3.36446114669
Pre-training layer 5, epoch 33, cost  3.36410567673
Pre-training layer 5, epoch 34, cost  3.36376808561
Pre-training layer 5, epoch 35, cost  3.36344666968
Pre-training layer 5, epoch 36, cost  3.36313962117
Pre-training layer 5, epoch 37, cost  3.36284509597
Pre-training layer 5, epoch 38, cost  3.36256319441
Pre-training layer 5, epoch 39, cost  3.3622924398
Pre-training layer 5, epoch 40, cost  3.36203173847
Pre-training layer 5, epoch 41, cost  3.36178061267
Pre-training layer 5, epoch 42, cost  3.36153793278
Pre-training layer 5, epoch 43, cost  3.3613038117
Pre-training layer 5, epoch 44, cost  3.36107715388
Pre-training layer 5, epoch 45, cost  3.36085766088
Pre-training layer 5, epoch 46, cost  3.3606448175
Pre-training layer 5, epoch 47, cost  3.36043860149
Pre-training layer 5, epoch 48, cost  3.36023828002
Pre-training layer 5, epoch 49, cost  3.36004399457
The pretraining code for file multi_layer_km.pyc ran for 49.54m
Initial NMI for deep clustering: 0.50
ARI for deep clustering: 0.37
... getting the finetuning functions
ACC for deep clustering: 0.53
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.03103, Reconstruction: 1.71174, Clustering: 0.31928,
Fine-tuning epoch 2 ++++
Total cost: 1.58661, Reconstruction: 1.27027, Clustering: 0.31634,
Fine-tuning epoch 3 ++++
Total cost: 1.43453, Reconstruction: 1.13745, Clustering: 0.29708,
Fine-tuning epoch 4 ++++
Total cost: 1.33669, Reconstruction: 1.05538, Clustering: 0.28131,
Fine-tuning epoch 5 ++++
Total cost: 1.27437, Reconstruction: 1.00325, Clustering: 0.27111,
Fine-tuning epoch 6 ++++
Total cost: 1.22968, Reconstruction: 0.96622, Clustering: 0.26346,
Fine-tuning epoch 7 ++++
Total cost: 1.19776, Reconstruction: 0.94019, Clustering: 0.25756,
Fine-tuning epoch 8 ++++
Total cost: 1.17682, Reconstruction: 0.92245, Clustering: 0.25437,
Fine-tuning epoch 9 ++++
Total cost: 1.15449, Reconstruction: 0.90385, Clustering: 0.25065,
Fine-tuning epoch 10 ++++
Total cost: 1.13115, Reconstruction: 0.88468, Clustering: 0.24647,
Fine-tuning epoch 11 ++++
Total cost: 1.11669, Reconstruction: 0.87203, Clustering: 0.24467,
Fine-tuning epoch 12 ++++
Total cost: 1.09808, Reconstruction: 0.85741, Clustering: 0.24067,
Fine-tuning epoch 13 ++++
Total cost: 1.09187, Reconstruction: 0.85128, Clustering: 0.24059,
Fine-tuning epoch 14 ++++
Total cost: 1.07473, Reconstruction: 0.83790, Clustering: 0.23683,
Fine-tuning epoch 15 ++++
Total cost: 1.06257, Reconstruction: 0.82756, Clustering: 0.23501,
Fine-tuning epoch 16 ++++
Total cost: 1.05883, Reconstruction: 0.82323, Clustering: 0.23560,
Fine-tuning epoch 17 ++++
Total cost: 1.04677, Reconstruction: 0.81353, Clustering: 0.23324,
Fine-tuning epoch 18 ++++
Total cost: 1.03257, Reconstruction: 0.80188, Clustering: 0.23069,
Fine-tuning epoch 19 ++++
Total cost: 1.02170, Reconstruction: 0.79224, Clustering: 0.22946,
Fine-tuning epoch 20 ++++
Total cost: 1.01052, Reconstruction: 0.78330, Clustering: 0.22722,
Fine-tuning epoch 21 ++++
Total cost: 1.00869, Reconstruction: 0.78087, Clustering: 0.22782,
Fine-tuning epoch 22 ++++
Total cost: 0.99584, Reconstruction: 0.76998, Clustering: 0.22586,
Fine-tuning epoch 23 ++++
Total cost: 0.99170, Reconstruction: 0.76606, Clustering: 0.22564,
Fine-tuning epoch 24 ++++
Total cost: 0.98792, Reconstruction: 0.76171, Clustering: 0.22620,
Fine-tuning epoch 25 ++++
Total cost: 0.98157, Reconstruction: 0.75565, Clustering: 0.22592,
Fine-tuning epoch 26 ++++
Total cost: 0.96778, Reconstruction: 0.74582, Clustering: 0.22196,
Fine-tuning epoch 27 ++++
Total cost: 0.96629, Reconstruction: 0.74256, Clustering: 0.22373,
Fine-tuning epoch 28 ++++
Total cost: 0.96058, Reconstruction: 0.73839, Clustering: 0.22220,
Fine-tuning epoch 29 ++++
Total cost: 0.95612, Reconstruction: 0.73441, Clustering: 0.22171,
Fine-tuning epoch 30 ++++
Total cost: 0.95154, Reconstruction: 0.72961, Clustering: 0.22193,
Fine-tuning epoch 31 ++++
Total cost: 0.94378, Reconstruction: 0.72288, Clustering: 0.22090,
Fine-tuning epoch 32 ++++
Total cost: 0.94066, Reconstruction: 0.72015, Clustering: 0.22051,
Fine-tuning epoch 33 ++++
Total cost: 0.93864, Reconstruction: 0.71856, Clustering: 0.22009,
Fine-tuning epoch 34 ++++
Total cost: 0.92739, Reconstruction: 0.70912, Clustering: 0.21827,
Fine-tuning epoch 35 ++++
Total cost: 0.92292, Reconstruction: 0.70540, Clustering: 0.21752,
Fine-tuning epoch 36 ++++
Total cost: 0.91108, Reconstruction: 0.69624, Clustering: 0.21484,
Fine-tuning epoch 37 ++++
Total cost: 0.91418, Reconstruction: 0.69783, Clustering: 0.21635,
Fine-tuning epoch 38 ++++
Total cost: 0.90545, Reconstruction: 0.69075, Clustering: 0.21469,
Fine-tuning epoch 39 ++++
Total cost: 0.90073, Reconstruction: 0.68651, Clustering: 0.21422,
Fine-tuning epoch 40 ++++
Total cost: 0.89619, Reconstruction: 0.68266, Clustering: 0.21352,
Fine-tuning epoch 41 ++++
Total cost: 0.88917, Reconstruction: 0.67695, Clustering: 0.21222,
Fine-tuning epoch 42 ++++
Total cost: 0.88447, Reconstruction: 0.67274, Clustering: 0.21173,
Fine-tuning epoch 43 ++++
Total cost: 0.87948, Reconstruction: 0.66905, Clustering: 0.21043,
Fine-tuning epoch 44 ++++
Total cost: 0.87813, Reconstruction: 0.66811, Clustering: 0.21002,
Fine-tuning epoch 45 ++++
Total cost: 0.86914, Reconstruction: 0.66051, Clustering: 0.20862,
Fine-tuning epoch 46 ++++
Total cost: 0.86685, Reconstruction: 0.65853, Clustering: 0.20832,
Fine-tuning epoch 47 ++++
Total cost: 0.85795, Reconstruction: 0.65167, Clustering: 0.20628,
Fine-tuning epoch 48 ++++
Total cost: 0.85744, Reconstruction: 0.65011, Clustering: 0.20732,
Fine-tuning epoch 49 ++++
Total cost: 0.85138, Reconstruction: 0.64613, Clustering: 0.20526,
Fine-tuning epoch 50 ++++
Total cost: 0.84353, Reconstruction: 0.63941, Clustering: 0.20412,
Average squared 2-D reconstruction error: 0.6394
NMI for deep clustering: 0.58
ARI for deep clustering: 0.40
ACC for deep clustering: 0.55
The training code for file multi_layer_km.pyc ran for 48.55m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.13391655994
Pre-training layer 0, epoch 1, cost  0.976220943726
Pre-training layer 0, epoch 2, cost  0.785721945678
Pre-training layer 0, epoch 3, cost  0.698580633117
Pre-training layer 0, epoch 4, cost  0.645137811781
Pre-training layer 0, epoch 5, cost  0.607446478277
Pre-training layer 0, epoch 6, cost  0.578638947651
Pre-training layer 0, epoch 7, cost  0.555494587142
Pre-training layer 0, epoch 8, cost  0.535662136348
Pre-training layer 0, epoch 9, cost  0.51902472579
Pre-training layer 0, epoch 10, cost  0.504671208729
Pre-training layer 0, epoch 11, cost  0.492146361077
Pre-training layer 0, epoch 12, cost  0.481050357299
Pre-training layer 0, epoch 13, cost  0.471102117996
Pre-training layer 0, epoch 14, cost  0.462128158336
Pre-training layer 0, epoch 15, cost  0.453993473838
Pre-training layer 0, epoch 16, cost  0.446514371325
Pre-training layer 0, epoch 17, cost  0.439641802854
Pre-training layer 0, epoch 18, cost  0.433311085771
Pre-training layer 0, epoch 19, cost  0.427407875436
Pre-training layer 0, epoch 20, cost  0.421898047644
Pre-training layer 0, epoch 21, cost  0.416745408071
Pre-training layer 0, epoch 22, cost  0.411926981105
Pre-training layer 0, epoch 23, cost  0.407400312782
Pre-training layer 0, epoch 24, cost  0.403135356775
Pre-training layer 0, epoch 25, cost  0.399081813378
Pre-training layer 0, epoch 26, cost  0.395243810785
Pre-training layer 0, epoch 27, cost  0.391581223925
Pre-training layer 0, epoch 28, cost  0.388096626178
Pre-training layer 0, epoch 29, cost  0.384760001139
Pre-training layer 0, epoch 30, cost  0.381566414572
Pre-training layer 0, epoch 31, cost  0.37849874991
Pre-training layer 0, epoch 32, cost  0.375593938582
Pre-training layer 0, epoch 33, cost  0.372809256219
Pre-training layer 0, epoch 34, cost  0.370157643493
Pre-training layer 0, epoch 35, cost  0.367605034476
Pre-training layer 0, epoch 36, cost  0.365161286196
Pre-training layer 0, epoch 37, cost  0.36280658638
Pre-training layer 0, epoch 38, cost  0.360538020932
Pre-training layer 0, epoch 39, cost  0.358365075522
Pre-training layer 0, epoch 40, cost  0.356278453265
Pre-training layer 0, epoch 41, cost  0.354255694861
Pre-training layer 0, epoch 42, cost  0.352312995939
Pre-training layer 0, epoch 43, cost  0.350436495493
Pre-training layer 0, epoch 44, cost  0.348609141525
Pre-training layer 0, epoch 45, cost  0.346842294784
Pre-training layer 0, epoch 46, cost  0.345143426632
Pre-training layer 0, epoch 47, cost  0.343478101992
Pre-training layer 0, epoch 48, cost  0.341871051662
Pre-training layer 0, epoch 49, cost  0.340326563073
Pre-training layer 1, epoch 0, cost  3.87060841816
Pre-training layer 1, epoch 1, cost  1.01760910525
Pre-training layer 1, epoch 2, cost  0.735215164928
Pre-training layer 1, epoch 3, cost  0.613937252856
Pre-training layer 1, epoch 4, cost  0.543497204289
Pre-training layer 1, epoch 5, cost  0.495776648373
Pre-training layer 1, epoch 6, cost  0.460739727227
Pre-training layer 1, epoch 7, cost  0.432161827504
Pre-training layer 1, epoch 8, cost  0.409030180785
Pre-training layer 1, epoch 9, cost  0.390353310756
Pre-training layer 1, epoch 10, cost  0.373534418532
Pre-training layer 1, epoch 11, cost  0.358706536254
Pre-training layer 1, epoch 12, cost  0.34610715799
Pre-training layer 1, epoch 13, cost  0.334898847015
Pre-training layer 1, epoch 14, cost  0.324858235136
Pre-training layer 1, epoch 15, cost  0.315904351413
Pre-training layer 1, epoch 16, cost  0.307506867763
Pre-training layer 1, epoch 17, cost  0.299604638501
Pre-training layer 1, epoch 18, cost  0.292675728832
Pre-training layer 1, epoch 19, cost  0.286541168967
Pre-training layer 1, epoch 20, cost  0.280981779803
Pre-training layer 1, epoch 21, cost  0.275284307666
Pre-training layer 1, epoch 22, cost  0.269909649243
Pre-training layer 1, epoch 23, cost  0.265448755792
Pre-training layer 1, epoch 24, cost  0.26067044003
Pre-training layer 1, epoch 25, cost  0.256793029308
Pre-training layer 1, epoch 26, cost  0.252878666479
Pre-training layer 1, epoch 27, cost  0.249272066714
Pre-training layer 1, epoch 28, cost  0.245403181213
Pre-training layer 1, epoch 29, cost  0.242019186782
Pre-training layer 1, epoch 30, cost  0.239265695649
Pre-training layer 1, epoch 31, cost  0.236195504186
Pre-training layer 1, epoch 32, cost  0.233317465948
Pre-training layer 1, epoch 33, cost  0.23057132618
Pre-training layer 1, epoch 34, cost  0.228055598675
Pre-training layer 1, epoch 35, cost  0.225971504882
Pre-training layer 1, epoch 36, cost  0.223400997232
Pre-training layer 1, epoch 37, cost  0.221140599893
Pre-training layer 1, epoch 38, cost  0.219070295576
Pre-training layer 1, epoch 39, cost  0.21692067485
Pre-training layer 1, epoch 40, cost  0.215110299738
Pre-training layer 1, epoch 41, cost  0.213154264754
Pre-training layer 1, epoch 42, cost  0.211526555008
Pre-training layer 1, epoch 43, cost  0.209752977545
Pre-training layer 1, epoch 44, cost  0.208328042211
Pre-training layer 1, epoch 45, cost  0.206627542543
Pre-training layer 1, epoch 46, cost  0.205122100209
Pre-training layer 1, epoch 47, cost  0.203752051661
Pre-training layer 1, epoch 48, cost  0.20212370293
Pre-training layer 1, epoch 49, cost  0.200948279382
Pre-training layer 2, epoch 0, cost  4.8582779985
Pre-training layer 2, epoch 1, cost  1.41812696272
Pre-training layer 2, epoch 2, cost  1.066501003
Pre-training layer 2, epoch 3, cost  0.90414782545
Pre-training layer 2, epoch 4, cost  0.808222171359
Pre-training layer 2, epoch 5, cost  0.74618195356
Pre-training layer 2, epoch 6, cost  0.680183007651
Pre-training layer 2, epoch 7, cost  0.652836414741
Pre-training layer 2, epoch 8, cost  0.628967839654
Pre-training layer 2, epoch 9, cost  0.598449426621
Pre-training layer 2, epoch 10, cost  0.588366129024
Pre-training layer 2, epoch 11, cost  0.563463246664
Pre-training layer 2, epoch 12, cost  0.55746963237
Pre-training layer 2, epoch 13, cost  0.539042966257
Pre-training layer 2, epoch 14, cost  0.528672983616
Pre-training layer 2, epoch 15, cost  0.518627230905
Pre-training layer 2, epoch 16, cost  0.505387020618
Pre-training layer 2, epoch 17, cost  0.506034425448
Pre-training layer 2, epoch 18, cost  0.494762761727
Pre-training layer 2, epoch 19, cost  0.491179827395
Pre-training layer 2, epoch 20, cost  0.481046825827
Pre-training layer 2, epoch 21, cost  0.482519932449
Pre-training layer 2, epoch 22, cost  0.476124406572
Pre-training layer 2, epoch 23, cost  0.470536489131
Pre-training layer 2, epoch 24, cost  0.466330437986
Pre-training layer 2, epoch 25, cost  0.461341925499
Pre-training layer 2, epoch 26, cost  0.45952010282
Pre-training layer 2, epoch 27, cost  0.457552418733
Pre-training layer 2, epoch 28, cost  0.454488497435
Pre-training layer 2, epoch 29, cost  0.450994369157
Pre-training layer 2, epoch 30, cost  0.447580480369
Pre-training layer 2, epoch 31, cost  0.445788632578
Pre-training layer 2, epoch 32, cost  0.444133583895
Pre-training layer 2, epoch 33, cost  0.441841020933
Pre-training layer 2, epoch 34, cost  0.439859759194
Pre-training layer 2, epoch 35, cost  0.437713965651
Pre-training layer 2, epoch 36, cost  0.436476609105
Pre-training layer 2, epoch 37, cost  0.434913906941
Pre-training layer 2, epoch 38, cost  0.432851119451
Pre-training layer 2, epoch 39, cost  0.431544658283
Pre-training layer 2, epoch 40, cost  0.430330931443
Pre-training layer 2, epoch 41, cost  0.429021176077
Pre-training layer 2, epoch 42, cost  0.427540272867
Pre-training layer 2, epoch 43, cost  0.42660885894
Pre-training layer 2, epoch 44, cost  0.425624506033
Pre-training layer 2, epoch 45, cost  0.424344562781
Pre-training layer 2, epoch 46, cost  0.423237338134
Pre-training layer 2, epoch 47, cost  0.422399712737
Pre-training layer 2, epoch 48, cost  0.421830244663
Pre-training layer 2, epoch 49, cost  0.420807405901
Pre-training layer 3, epoch 0, cost  3.58199326365
Pre-training layer 3, epoch 1, cost  0.696571823756
Pre-training layer 3, epoch 2, cost  0.44209626089
Pre-training layer 3, epoch 3, cost  0.311717190838
Pre-training layer 3, epoch 4, cost  0.237045443233
Pre-training layer 3, epoch 5, cost  0.197458911389
Pre-training layer 3, epoch 6, cost  0.167069601267
Pre-training layer 3, epoch 7, cost  0.143015306843
Pre-training layer 3, epoch 8, cost  0.127621844997
Pre-training layer 3, epoch 9, cost  0.116260582073
Pre-training layer 3, epoch 10, cost  0.10659250998
Pre-training layer 3, epoch 11, cost  0.0971080068262
Pre-training layer 3, epoch 12, cost  0.0897730581666
Pre-training layer 3, epoch 13, cost  0.086010353212
Pre-training layer 3, epoch 14, cost  0.0797650458492
Pre-training layer 3, epoch 15, cost  0.0758855156668
Pre-training layer 3, epoch 16, cost  0.0714618705709
Pre-training layer 3, epoch 17, cost  0.0684630230797
Pre-training layer 3, epoch 18, cost  0.0650485661078
Pre-training layer 3, epoch 19, cost  0.062025224788
Pre-training layer 3, epoch 20, cost  0.0592367928031
Pre-training layer 3, epoch 21, cost  0.0564498116908
Pre-training layer 3, epoch 22, cost  0.0537112895645
Pre-training layer 3, epoch 23, cost  0.0512353996765
Pre-training layer 3, epoch 24, cost  0.0494968788306
Pre-training layer 3, epoch 25, cost  0.0481715177086
Pre-training layer 3, epoch 26, cost  0.0466013032421
Pre-training layer 3, epoch 27, cost  0.0446294176719
Pre-training layer 3, epoch 28, cost  0.0431975698393
Pre-training layer 3, epoch 29, cost  0.0419045979593
Pre-training layer 3, epoch 30, cost  0.0403853849968
Pre-training layer 3, epoch 31, cost  0.0392952180605
Pre-training layer 3, epoch 32, cost  0.0379300203973
Pre-training layer 3, epoch 33, cost  0.0369175673098
Pre-training layer 3, epoch 34, cost  0.0357887086379
Pre-training layer 3, epoch 35, cost  0.0347310045609
Pre-training layer 3, epoch 36, cost  0.0338110631567
Pre-training layer 3, epoch 37, cost  0.0328676172471
Pre-training layer 3, epoch 38, cost  0.0319500824517
Pre-training layer 3, epoch 39, cost  0.0311160423052
Pre-training layer 3, epoch 40, cost  0.0303203123734
Pre-training layer 3, epoch 41, cost  0.0295593275679
Pre-training layer 3, epoch 42, cost  0.028825507195
Pre-training layer 3, epoch 43, cost  0.0281411493197
Pre-training layer 3, epoch 44, cost  0.027498728645
Pre-training layer 3, epoch 45, cost  0.0268595119053
Pre-training layer 3, epoch 46, cost  0.0260186821052
Pre-training layer 3, epoch 47, cost  0.0245309430526
Pre-training layer 3, epoch 48, cost  0.0238927765978
Pre-training layer 3, epoch 49, cost  0.0242424222989
Pre-training layer 4, epoch 0, cost  4.240861564
Pre-training layer 4, epoch 1, cost  1.17250857385
Pre-training layer 4, epoch 2, cost  0.978149112084
Pre-training layer 4, epoch 3, cost  0.944412208466
Pre-training layer 4, epoch 4, cost  0.925866246838
Pre-training layer 4, epoch 5, cost  0.913751034729
Pre-training layer 4, epoch 6, cost  0.904741773064
Pre-training layer 4, epoch 7, cost  0.897628992172
Pre-training layer 4, epoch 8, cost  0.89188280914
Pre-training layer 4, epoch 9, cost  0.886986413938
Pre-training layer 4, epoch 10, cost  0.882790959813
Pre-training layer 4, epoch 11, cost  0.879118615829
Pre-training layer 4, epoch 12, cost  0.87586020631
Pre-training layer 4, epoch 13, cost  0.873046982271
Pre-training layer 4, epoch 14, cost  0.870477898214
Pre-training layer 4, epoch 15, cost  0.868194024597
Pre-training layer 4, epoch 16, cost  0.866093456829
Pre-training layer 4, epoch 17, cost  0.864173672777
Pre-training layer 4, epoch 18, cost  0.862413117783
Pre-training layer 4, epoch 19, cost  0.860814411946
Pre-training layer 4, epoch 20, cost  0.85930864781
Pre-training layer 4, epoch 21, cost  0.85795101765
Pre-training layer 4, epoch 22, cost  0.856665268834
Pre-training layer 4, epoch 23, cost  0.855457967382
Pre-training layer 4, epoch 24, cost  0.854359487842
Pre-training layer 4, epoch 25, cost  0.853291482927
Pre-training layer 4, epoch 26, cost  0.85231071169
Pre-training layer 4, epoch 27, cost  0.851388370946
Pre-training layer 4, epoch 28, cost  0.850512941959
Pre-training layer 4, epoch 29, cost  0.849684188157
Pre-training layer 4, epoch 30, cost  0.848904943231
Pre-training layer 4, epoch 31, cost  0.848191966529
Pre-training layer 4, epoch 32, cost  0.847502368079
Pre-training layer 4, epoch 33, cost  0.846796250262
Pre-training layer 4, epoch 34, cost  0.846170552765
Pre-training layer 4, epoch 35, cost  0.845589061981
Pre-training layer 4, epoch 36, cost  0.845043069373
Pre-training layer 4, epoch 37, cost  0.844497441555
Pre-training layer 4, epoch 38, cost  0.843979949896
Pre-training layer 4, epoch 39, cost  0.843518262291
Pre-training layer 4, epoch 40, cost  0.843035835926
Pre-training layer 4, epoch 41, cost  0.842574321412
Pre-training layer 4, epoch 42, cost  0.842170502912
Pre-training layer 4, epoch 43, cost  0.841744215403
Pre-training layer 4, epoch 44, cost  0.841350891446
Pre-training layer 4, epoch 45, cost  0.840966787579
Pre-training layer 4, epoch 46, cost  0.840623919029
Pre-training layer 4, epoch 47, cost  0.840265321154
Pre-training layer 4, epoch 48, cost  0.839942927945
Pre-training layer 4, epoch 49, cost  0.839623643717
Pre-training layer 5, epoch 0, cost  5.43596810106
Pre-training layer 5, epoch 1, cost  3.45818139106
Pre-training layer 5, epoch 2, cost  3.44510558958
Pre-training layer 5, epoch 3, cost  3.44195114443
Pre-training layer 5, epoch 4, cost  3.44033243264
Pre-training layer 5, epoch 5, cost  3.43916611226
Pre-training layer 5, epoch 6, cost  3.43818884879
Pre-training layer 5, epoch 7, cost  3.43730552072
Pre-training layer 5, epoch 8, cost  3.4364620318
Pre-training layer 5, epoch 9, cost  3.43562406356
Pre-training layer 5, epoch 10, cost  3.43476276334
Pre-training layer 5, epoch 11, cost  3.43384692269
Pre-training layer 5, epoch 12, cost  3.4328437888
Pre-training layer 5, epoch 13, cost  3.43170899975
Pre-training layer 5, epoch 14, cost  3.43038489762
Pre-training layer 5, epoch 15, cost  3.42878990554
Pre-training layer 5, epoch 16, cost  3.42680356538
Pre-training layer 5, epoch 17, cost  3.42424659299
Pre-training layer 5, epoch 18, cost  3.42084388853
Pre-training layer 5, epoch 19, cost  3.41619106743
Pre-training layer 5, epoch 20, cost  3.40982603383
Pre-training layer 5, epoch 21, cost  3.40179117646
Pre-training layer 5, epoch 22, cost  3.39381680407
Pre-training layer 5, epoch 23, cost  3.38830566867
Pre-training layer 5, epoch 24, cost  3.38516227433
Pre-training layer 5, epoch 25, cost  3.38319354321
Pre-training layer 5, epoch 26, cost  3.38179523307
Pre-training layer 5, epoch 27, cost  3.38072106568
Pre-training layer 5, epoch 28, cost  3.37985191461
Pre-training layer 5, epoch 29, cost  3.37912133086
Pre-training layer 5, epoch 30, cost  3.37848931554
Pre-training layer 5, epoch 31, cost  3.37793006564
Pre-training layer 5, epoch 32, cost  3.3774269872
Pre-training layer 5, epoch 33, cost  3.37696946304
Pre-training layer 5, epoch 34, cost  3.37654804285
Pre-training layer 5, epoch 35, cost  3.37615675939
Pre-training layer 5, epoch 36, cost  3.37579102132
Pre-training layer 5, epoch 37, cost  3.37544725165
Pre-training layer 5, epoch 38, cost  3.37512282854
Pre-training layer 5, epoch 39, cost  3.37481522628
Pre-training layer 5, epoch 40, cost  3.37452301152
Pre-training layer 5, epoch 41, cost  3.37424415125
Pre-training layer 5, epoch 42, cost  3.37397737071
Pre-training layer 5, epoch 43, cost  3.37372197231
Pre-training layer 5, epoch 44, cost  3.37347681764
Pre-training layer 5, epoch 45, cost  3.37324085533
Pre-training layer 5, epoch 46, cost  3.37301394113
Pre-training layer 5, epoch 47, cost  3.37279492039
Pre-training layer 5, epoch 48, cost  3.37258390582
Pre-training layer 5, epoch 49, cost  3.37238014489
The pretraining code for file multi_layer_km.pyc ran for 49.50m
Initial NMI for deep clustering: 0.50
ARI for deep clustering: 0.35
ACC for deep clustering: 0.51
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 4.01316, Reconstruction: 3.78426, Clustering: 0.22890,
Fine-tuning epoch 2 ++++
Total cost: 1.78436, Reconstruction: 1.52808, Clustering: 0.25628,
Fine-tuning epoch 3 ++++
Total cost: 1.56390, Reconstruction: 1.28707, Clustering: 0.27683,
Fine-tuning epoch 4 ++++
Total cost: 1.43854, Reconstruction: 1.16694, Clustering: 0.27160,
Fine-tuning epoch 5 ++++
Total cost: 1.35576, Reconstruction: 1.09362, Clustering: 0.26215,
Fine-tuning epoch 6 ++++
Total cost: 1.30298, Reconstruction: 1.04721, Clustering: 0.25577,
Fine-tuning epoch 7 ++++
Total cost: 1.25548, Reconstruction: 1.00499, Clustering: 0.25049,
Fine-tuning epoch 8 ++++
Total cost: 1.21678, Reconstruction: 0.97054, Clustering: 0.24624,
Fine-tuning epoch 9 ++++
Total cost: 1.19108, Reconstruction: 0.94711, Clustering: 0.24397,
Fine-tuning epoch 10 ++++
Total cost: 1.16510, Reconstruction: 0.92450, Clustering: 0.24060,
Fine-tuning epoch 11 ++++
Total cost: 1.14343, Reconstruction: 0.90522, Clustering: 0.23821,
Fine-tuning epoch 12 ++++
Total cost: 1.12979, Reconstruction: 0.89254, Clustering: 0.23725,
Fine-tuning epoch 13 ++++
Total cost: 1.10984, Reconstruction: 0.87575, Clustering: 0.23409,
Fine-tuning epoch 14 ++++
Total cost: 1.09407, Reconstruction: 0.86263, Clustering: 0.23144,
Fine-tuning epoch 15 ++++
Total cost: 1.08321, Reconstruction: 0.85274, Clustering: 0.23047,
Fine-tuning epoch 16 ++++
Total cost: 1.07244, Reconstruction: 0.84328, Clustering: 0.22916,
Fine-tuning epoch 17 ++++
Total cost: 1.06195, Reconstruction: 0.83408, Clustering: 0.22788,
Fine-tuning epoch 18 ++++
Total cost: 1.05077, Reconstruction: 0.82431, Clustering: 0.22646,
Fine-tuning epoch 19 ++++
Total cost: 1.04273, Reconstruction: 0.81687, Clustering: 0.22586,
Fine-tuning epoch 20 ++++
Total cost: 1.03264, Reconstruction: 0.80840, Clustering: 0.22424,
Fine-tuning epoch 21 ++++
Total cost: 1.02555, Reconstruction: 0.80223, Clustering: 0.22333,
Fine-tuning epoch 22 ++++
Total cost: 1.01417, Reconstruction: 0.79275, Clustering: 0.22142,
Fine-tuning epoch 23 ++++
Total cost: 1.00773, Reconstruction: 0.78688, Clustering: 0.22085,
Fine-tuning epoch 24 ++++
Total cost: 0.99249, Reconstruction: 0.77457, Clustering: 0.21792,
Fine-tuning epoch 25 ++++
Total cost: 0.98672, Reconstruction: 0.76929, Clustering: 0.21742,
Fine-tuning epoch 26 ++++
Total cost: 0.97654, Reconstruction: 0.76132, Clustering: 0.21521,
Fine-tuning epoch 27 ++++
Total cost: 0.96886, Reconstruction: 0.75449, Clustering: 0.21437,
Fine-tuning epoch 28 ++++
Total cost: 0.96387, Reconstruction: 0.75060, Clustering: 0.21327,
Fine-tuning epoch 29 ++++
Total cost: 0.95132, Reconstruction: 0.74010, Clustering: 0.21122,
Fine-tuning epoch 30 ++++
Total cost: 0.94567, Reconstruction: 0.73509, Clustering: 0.21058,
Fine-tuning epoch 31 ++++
Total cost: 0.93895, Reconstruction: 0.72997, Clustering: 0.20899,
Fine-tuning epoch 32 ++++
Total cost: 0.93950, Reconstruction: 0.72845, Clustering: 0.21104,
Fine-tuning epoch 33 ++++
Total cost: 0.92542, Reconstruction: 0.71787, Clustering: 0.20754,
Fine-tuning epoch 34 ++++
Total cost: 0.91739, Reconstruction: 0.71099, Clustering: 0.20641,
Fine-tuning epoch 35 ++++
Total cost: 0.91473, Reconstruction: 0.70773, Clustering: 0.20700,
Fine-tuning epoch 36 ++++
Total cost: 0.90714, Reconstruction: 0.70136, Clustering: 0.20577,
Fine-tuning epoch 37 ++++
Total cost: 0.90371, Reconstruction: 0.69810, Clustering: 0.20561,
Fine-tuning epoch 38 ++++
Total cost: 0.89797, Reconstruction: 0.69307, Clustering: 0.20490,
Fine-tuning epoch 39 ++++
Total cost: 0.89513, Reconstruction: 0.68997, Clustering: 0.20516,
Fine-tuning epoch 40 ++++
Total cost: 0.89048, Reconstruction: 0.68526, Clustering: 0.20522,
Fine-tuning epoch 41 ++++
Total cost: 0.88690, Reconstruction: 0.68122, Clustering: 0.20568,
Fine-tuning epoch 42 ++++
Total cost: 0.88349, Reconstruction: 0.67827, Clustering: 0.20523,
Fine-tuning epoch 43 ++++
Total cost: 0.87671, Reconstruction: 0.67324, Clustering: 0.20347,
Fine-tuning epoch 44 ++++
Total cost: 0.87145, Reconstruction: 0.66811, Clustering: 0.20334,
Fine-tuning epoch 45 ++++
Total cost: 0.86587, Reconstruction: 0.66282, Clustering: 0.20306,
Fine-tuning epoch 46 ++++
Total cost: 0.86871, Reconstruction: 0.66453, Clustering: 0.20418,
Fine-tuning epoch 47 ++++
Total cost: 0.85790, Reconstruction: 0.65715, Clustering: 0.20075,
Fine-tuning epoch 48 ++++
Total cost: 0.85505, Reconstruction: 0.65359, Clustering: 0.20146,
Fine-tuning epoch 49 ++++
Total cost: 0.84968, Reconstruction: 0.64886, Clustering: 0.20082,
Fine-tuning epoch 50 ++++
Total cost: 0.84625, Reconstruction: 0.64528, Clustering: 0.20097,
Average squared 2-D reconstruction error: 0.6453
NMI for deep clustering: 0.58
ARI for deep clustering: 0.40
ACC for deep clustering: 0.54
The training code for file multi_layer_km.pyc ran for 47.89m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.13544251491
Pre-training layer 0, epoch 1, cost  0.973085211067
Pre-training layer 0, epoch 2, cost  0.783121921102
Pre-training layer 0, epoch 3, cost  0.696297615301
Pre-training layer 0, epoch 4, cost  0.642722324582
Pre-training layer 0, epoch 5, cost  0.604860305132
Pre-training layer 0, epoch 6, cost  0.576085211337
Pre-training layer 0, epoch 7, cost  0.552979347378
Pre-training layer 0, epoch 8, cost  0.533944360735
Pre-training layer 0, epoch 9, cost  0.517760944047
Pre-training layer 0, epoch 10, cost  0.503802936732
Pre-training layer 0, epoch 11, cost  0.491437699045
Pre-training layer 0, epoch 12, cost  0.480501149301
Pre-training layer 0, epoch 13, cost  0.470729373667
Pre-training layer 0, epoch 14, cost  0.461882454019
Pre-training layer 0, epoch 15, cost  0.453803674829
Pre-training layer 0, epoch 16, cost  0.446420662317
Pre-training layer 0, epoch 17, cost  0.439651170744
Pre-training layer 0, epoch 18, cost  0.433269909186
Pre-training layer 0, epoch 19, cost  0.42723364599
Pre-training layer 0, epoch 20, cost  0.421755266798
Pre-training layer 0, epoch 21, cost  0.416638553542
Pre-training layer 0, epoch 22, cost  0.411849331573
Pre-training layer 0, epoch 23, cost  0.407183413484
Pre-training layer 0, epoch 24, cost  0.402853856256
Pre-training layer 0, epoch 25, cost  0.398803388137
Pre-training layer 0, epoch 26, cost  0.394980765473
Pre-training layer 0, epoch 27, cost  0.391361591889
Pre-training layer 0, epoch 28, cost  0.387915532251
Pre-training layer 0, epoch 29, cost  0.384660992896
Pre-training layer 0, epoch 30, cost  0.381525430702
Pre-training layer 0, epoch 31, cost  0.378536710097
Pre-training layer 0, epoch 32, cost  0.375701669235
Pre-training layer 0, epoch 33, cost  0.372972322824
Pre-training layer 0, epoch 34, cost  0.370357802067
Pre-training layer 0, epoch 35, cost  0.367863903868
Pre-training layer 0, epoch 36, cost  0.365464491923
Pre-training layer 0, epoch 37, cost  0.363160096389
Pre-training layer 0, epoch 38, cost  0.360947962327
Pre-training layer 0, epoch 39, cost  0.358814474561
Pre-training layer 0, epoch 40, cost  0.356743708459
Pre-training layer 0, epoch 41, cost  0.354749002055
Pre-training layer 0, epoch 42, cost  0.352810501526
Pre-training layer 0, epoch 43, cost  0.350942737244
Pre-training layer 0, epoch 44, cost  0.349134911933
Pre-training layer 0, epoch 45, cost  0.347385287622
Pre-training layer 0, epoch 46, cost  0.345687840465
Pre-training layer 0, epoch 47, cost  0.344044278898
Pre-training layer 0, epoch 48, cost  0.342450507356
Pre-training layer 0, epoch 49, cost  0.340896103042
Pre-training layer 1, epoch 0, cost  3.90909885236
Pre-training layer 1, epoch 1, cost  1.03653648488
Pre-training layer 1, epoch 2, cost  0.751552274883
Pre-training layer 1, epoch 3, cost  0.628501361707
Pre-training layer 1, epoch 4, cost  0.557206890161
Pre-training layer 1, epoch 5, cost  0.508025510517
Pre-training layer 1, epoch 6, cost  0.472564881277
Pre-training layer 1, epoch 7, cost  0.443293823068
Pre-training layer 1, epoch 8, cost  0.420140024192
Pre-training layer 1, epoch 9, cost  0.40007118834
Pre-training layer 1, epoch 10, cost  0.382825845039
Pre-training layer 1, epoch 11, cost  0.36818367344
Pre-training layer 1, epoch 12, cost  0.355207239171
Pre-training layer 1, epoch 13, cost  0.343178363734
Pre-training layer 1, epoch 14, cost  0.332826804468
Pre-training layer 1, epoch 15, cost  0.323624131455
Pre-training layer 1, epoch 16, cost  0.31551634225
Pre-training layer 1, epoch 17, cost  0.30742969349
Pre-training layer 1, epoch 18, cost  0.30031763148
Pre-training layer 1, epoch 19, cost  0.294246248051
Pre-training layer 1, epoch 20, cost  0.287725983079
Pre-training layer 1, epoch 21, cost  0.281842855448
Pre-training layer 1, epoch 22, cost  0.276948194128
Pre-training layer 1, epoch 23, cost  0.271788933738
Pre-training layer 1, epoch 24, cost  0.267349912879
Pre-training layer 1, epoch 25, cost  0.262870185073
Pre-training layer 1, epoch 26, cost  0.258617427979
Pre-training layer 1, epoch 27, cost  0.255551884546
Pre-training layer 1, epoch 28, cost  0.251553243594
Pre-training layer 1, epoch 29, cost  0.247827768164
Pre-training layer 1, epoch 30, cost  0.244803080876
Pre-training layer 1, epoch 31, cost  0.242012636431
Pre-training layer 1, epoch 32, cost  0.238838035045
Pre-training layer 1, epoch 33, cost  0.236110169873
Pre-training layer 1, epoch 34, cost  0.233622940425
Pre-training layer 1, epoch 35, cost  0.230783412791
Pre-training layer 1, epoch 36, cost  0.228734542439
Pre-training layer 1, epoch 37, cost  0.226398624074
Pre-training layer 1, epoch 38, cost  0.224051750277
Pre-training layer 1, epoch 39, cost  0.222210204274
Pre-training layer 1, epoch 40, cost  0.220034806139
Pre-training layer 1, epoch 41, cost  0.218160479336
Pre-training layer 1, epoch 42, cost  0.21622176049
Pre-training layer 1, epoch 43, cost  0.214599023875
Pre-training layer 1, epoch 44, cost  0.212858557782
Pre-training layer 1, epoch 45, cost  0.211307652066
Pre-training layer 1, epoch 46, cost  0.209755048204
Pre-training layer 1, epoch 47, cost  0.208135172404
Pre-training layer 1, epoch 48, cost  0.206744933205
Pre-training layer 1, epoch 49, cost  0.205303817793
Pre-training layer 2, epoch 0, cost  4.88650537281
Pre-training layer 2, epoch 1, cost  1.44714591639
Pre-training layer 2, epoch 2, cost  1.07214131704
Pre-training layer 2, epoch 3, cost  0.910987972621
Pre-training layer 2, epoch 4, cost  0.81416436999
Pre-training layer 2, epoch 5, cost  0.75468254476
Pre-training layer 2, epoch 6, cost  0.693339347751
Pre-training layer 2, epoch 7, cost  0.674877028685
Pre-training layer 2, epoch 8, cost  0.638159241498
Pre-training layer 2, epoch 9, cost  0.615252839782
Pre-training layer 2, epoch 10, cost  0.596165625921
Pre-training layer 2, epoch 11, cost  0.575509733794
Pre-training layer 2, epoch 12, cost  0.563340163237
Pre-training layer 2, epoch 13, cost  0.554990602395
Pre-training layer 2, epoch 14, cost  0.545495448527
Pre-training layer 2, epoch 15, cost  0.530292262628
Pre-training layer 2, epoch 16, cost  0.520520549801
Pre-training layer 2, epoch 17, cost  0.518359500951
Pre-training layer 2, epoch 18, cost  0.510604037646
Pre-training layer 2, epoch 19, cost  0.500985301906
Pre-training layer 2, epoch 20, cost  0.494529411844
Pre-training layer 2, epoch 21, cost  0.495056860379
Pre-training layer 2, epoch 22, cost  0.48808563047
Pre-training layer 2, epoch 23, cost  0.480732098148
Pre-training layer 2, epoch 24, cost  0.477636297985
Pre-training layer 2, epoch 25, cost  0.476122814166
Pre-training layer 2, epoch 26, cost  0.472795135076
Pre-training layer 2, epoch 27, cost  0.465577299412
Pre-training layer 2, epoch 28, cost  0.464493326378
Pre-training layer 2, epoch 29, cost  0.465416601942
Pre-training layer 2, epoch 30, cost  0.459636879705
Pre-training layer 2, epoch 31, cost  0.45707374133
Pre-training layer 2, epoch 32, cost  0.45718285486
Pre-training layer 2, epoch 33, cost  0.452272365807
Pre-training layer 2, epoch 34, cost  0.452874875911
Pre-training layer 2, epoch 35, cost  0.448516043351
Pre-training layer 2, epoch 36, cost  0.448600942297
Pre-training layer 2, epoch 37, cost  0.446237668958
Pre-training layer 2, epoch 38, cost  0.444072383804
Pre-training layer 2, epoch 39, cost  0.443223549667
Pre-training layer 2, epoch 40, cost  0.442209357612
Pre-training layer 2, epoch 41, cost  0.440684990901
Pre-training layer 2, epoch 42, cost  0.439207870406
Pre-training layer 2, epoch 43, cost  0.43762792739
Pre-training layer 2, epoch 44, cost  0.435696962093
Pre-training layer 2, epoch 45, cost  0.434693386432
Pre-training layer 2, epoch 46, cost  0.434893533334
Pre-training layer 2, epoch 47, cost  0.434192869226
Pre-training layer 2, epoch 48, cost  0.433718360463
Pre-training layer 2, epoch 49, cost  0.432184340177
Pre-training layer 3, epoch 0, cost  3.58913591922
Pre-training layer 3, epoch 1, cost  0.704470200708
Pre-training layer 3, epoch 2, cost  0.449182904911
Pre-training layer 3, epoch 3, cost  0.320143540482
Pre-training layer 3, epoch 4, cost  0.242266923038
Pre-training layer 3, epoch 5, cost  0.199455178133
Pre-training layer 3, epoch 6, cost  0.170247495396
Pre-training layer 3, epoch 7, cost  0.144049244809
Pre-training layer 3, epoch 8, cost  0.128212380873
Pre-training layer 3, epoch 9, cost  0.116365968167
Pre-training layer 3, epoch 10, cost  0.10617590365
Pre-training layer 3, epoch 11, cost  0.0983808245986
Pre-training layer 3, epoch 12, cost  0.091952885806
Pre-training layer 3, epoch 13, cost  0.0849832140591
Pre-training layer 3, epoch 14, cost  0.0796981973021
Pre-training layer 3, epoch 15, cost  0.0755907039353
Pre-training layer 3, epoch 16, cost  0.0711908723652
Pre-training layer 3, epoch 17, cost  0.0675876860436
Pre-training layer 3, epoch 18, cost  0.0644870449996
Pre-training layer 3, epoch 19, cost  0.0614750185793
Pre-training layer 3, epoch 20, cost  0.0587906984284
Pre-training layer 3, epoch 21, cost  0.056325781136
Pre-training layer 3, epoch 22, cost  0.0540928237209
Pre-training layer 3, epoch 23, cost  0.0521254014446
Pre-training layer 3, epoch 24, cost  0.0504041406143
Pre-training layer 3, epoch 25, cost  0.0486604509168
Pre-training layer 3, epoch 26, cost  0.0467163541977
Pre-training layer 3, epoch 27, cost  0.0449497317464
Pre-training layer 3, epoch 28, cost  0.0436792760358
Pre-training layer 3, epoch 29, cost  0.0421237895749
Pre-training layer 3, epoch 30, cost  0.0407713648793
Pre-training layer 3, epoch 31, cost  0.0395363996058
Pre-training layer 3, epoch 32, cost  0.0382844919667
Pre-training layer 3, epoch 33, cost  0.0371606726533
Pre-training layer 3, epoch 34, cost  0.0360746771417
Pre-training layer 3, epoch 35, cost  0.0349806257408
Pre-training layer 3, epoch 36, cost  0.0340489299239
Pre-training layer 3, epoch 37, cost  0.0331031472258
Pre-training layer 3, epoch 38, cost  0.03216941912
Pre-training layer 3, epoch 39, cost  0.0313163293191
Pre-training layer 3, epoch 40, cost  0.0305123875292
Pre-training layer 3, epoch 41, cost  0.0297424741479
Pre-training layer 3, epoch 42, cost  0.0289910257396
Pre-training layer 3, epoch 43, cost  0.0282472768543
Pre-training layer 3, epoch 44, cost  0.0274995502728
Pre-training layer 3, epoch 45, cost  0.0266459934534
Pre-training layer 3, epoch 46, cost  0.0255770850961
Pre-training layer 3, epoch 47, cost  0.0249692373861
Pre-training layer 3, epoch 48, cost  0.0248720727027
Pre-training layer 3, epoch 49, cost  0.0245359519759
Pre-training layer 4, epoch 0, cost  4.24444249519
Pre-training layer 4, epoch 1, cost  1.16737299291
Pre-training layer 4, epoch 2, cost  0.961242506374
Pre-training layer 4, epoch 3, cost  0.924218519112
Pre-training layer 4, epoch 4, cost  0.906897245207
Pre-training layer 4, epoch 5, cost  0.894292708975
Pre-training layer 4, epoch 6, cost  0.885154786588
Pre-training layer 4, epoch 7, cost  0.878113713372
Pre-training layer 4, epoch 8, cost  0.872394018871
Pre-training layer 4, epoch 9, cost  0.867619389493
Pre-training layer 4, epoch 10, cost  0.863463437902
Pre-training layer 4, epoch 11, cost  0.859837063673
Pre-training layer 4, epoch 12, cost  0.856607485674
Pre-training layer 4, epoch 13, cost  0.853791842228
Pre-training layer 4, epoch 14, cost  0.85121480657
Pre-training layer 4, epoch 15, cost  0.848918354884
Pre-training layer 4, epoch 16, cost  0.846861679469
Pre-training layer 4, epoch 17, cost  0.844949513939
Pre-training layer 4, epoch 18, cost  0.843205018833
Pre-training layer 4, epoch 19, cost  0.841632720105
Pre-training layer 4, epoch 20, cost  0.840107424902
Pre-training layer 4, epoch 21, cost  0.838711767941
Pre-training layer 4, epoch 22, cost  0.837449670498
Pre-training layer 4, epoch 23, cost  0.836225478792
Pre-training layer 4, epoch 24, cost  0.835086559361
Pre-training layer 4, epoch 25, cost  0.834074914229
Pre-training layer 4, epoch 26, cost  0.833080697803
Pre-training layer 4, epoch 27, cost  0.83215202837
Pre-training layer 4, epoch 28, cost  0.831271701152
Pre-training layer 4, epoch 29, cost  0.830478678937
Pre-training layer 4, epoch 30, cost  0.829654480983
Pre-training layer 4, epoch 31, cost  0.828921630549
Pre-training layer 4, epoch 32, cost  0.828236327452
Pre-training layer 4, epoch 33, cost  0.827562253327
Pre-training layer 4, epoch 34, cost  0.826942055639
Pre-training layer 4, epoch 35, cost  0.826342818297
Pre-training layer 4, epoch 36, cost  0.82575861497
Pre-training layer 4, epoch 37, cost  0.825237770884
Pre-training layer 4, epoch 38, cost  0.824692887526
Pre-training layer 4, epoch 39, cost  0.824195728148
Pre-training layer 4, epoch 40, cost  0.823715072681
Pre-training layer 4, epoch 41, cost  0.823273764314
Pre-training layer 4, epoch 42, cost  0.822835367463
Pre-training layer 4, epoch 43, cost  0.822402067935
Pre-training layer 4, epoch 44, cost  0.822036491165
Pre-training layer 4, epoch 45, cost  0.821656019054
Pre-training layer 4, epoch 46, cost  0.821278638381
Pre-training layer 4, epoch 47, cost  0.820925337363
Pre-training layer 4, epoch 48, cost  0.820582140426
Pre-training layer 4, epoch 49, cost  0.820251772467
Pre-training layer 5, epoch 0, cost  5.42577830808
Pre-training layer 5, epoch 1, cost  3.43798077807
Pre-training layer 5, epoch 2, cost  3.42371194516
Pre-training layer 5, epoch 3, cost  3.41940760578
Pre-training layer 5, epoch 4, cost  3.41749989001
Pre-training layer 5, epoch 5, cost  3.41626821288
Pre-training layer 5, epoch 6, cost  3.41528145173
Pre-training layer 5, epoch 7, cost  3.41439855088
Pre-training layer 5, epoch 8, cost  3.41355878923
Pre-training layer 5, epoch 9, cost  3.41272562029
Pre-training layer 5, epoch 10, cost  3.41187280404
Pre-training layer 5, epoch 11, cost  3.41096866249
Pre-training layer 5, epoch 12, cost  3.40998246698
Pre-training layer 5, epoch 13, cost  3.4088702413
Pre-training layer 5, epoch 14, cost  3.40757991542
Pre-training layer 5, epoch 15, cost  3.40603646248
Pre-training layer 5, epoch 16, cost  3.40413134424
Pre-training layer 5, epoch 17, cost  3.40170175529
Pre-training layer 5, epoch 18, cost  3.39849625194
Pre-training layer 5, epoch 19, cost  3.39413036526
Pre-training layer 5, epoch 20, cost  3.38808855312
Pre-training layer 5, epoch 21, cost  3.38006994909
Pre-training layer 5, epoch 22, cost  3.37122489359
Pre-training layer 5, epoch 23, cost  3.36441835061
Pre-training layer 5, epoch 24, cost  3.36051276113
Pre-training layer 5, epoch 25, cost  3.3581928881
Pre-training layer 5, epoch 26, cost  3.35660076733
Pre-training layer 5, epoch 27, cost  3.35540207451
Pre-training layer 5, epoch 28, cost  3.35444750833
Pre-training layer 5, epoch 29, cost  3.35365440433
Pre-training layer 5, epoch 30, cost  3.35297556822
Pre-training layer 5, epoch 31, cost  3.3523818911
Pre-training layer 5, epoch 32, cost  3.35185258374
Pre-training layer 5, epoch 33, cost  3.35137509015
Pre-training layer 5, epoch 34, cost  3.35093842393
Pre-training layer 5, epoch 35, cost  3.35053566301
Pre-training layer 5, epoch 36, cost  3.35016199719
Pre-training layer 5, epoch 37, cost  3.34981340821
Pre-training layer 5, epoch 38, cost  3.34948596214
Pre-training layer 5, epoch 39, cost  3.34917767234
Pre-training layer 5, epoch 40, cost  3.34888620477
Pre-training layer 5, epoch 41, cost  3.3486092242
Pre-training layer 5, epoch 42, cost  3.34834557628
Pre-training layer 5, epoch 43, cost  3.3480942546
Pre-training layer 5, epoch 44, cost  3.34785378535
Pre-training layer 5, epoch 45, cost  3.34762396989
Pre-training layer 5, epoch 46, cost  3.34740300555
Pre-training layer 5, epoch 47, cost  3.34719063295
Pre-training layer 5, epoch 48, cost  3.34698591411
Pre-training layer 5, epoch 49, cost  3.34678895141
The pretraining code for file multi_layer_km.pyc ran for 49.61m
Initial NMI for deep clustering: 0.52
ARI for deep clustering: 0.39
... getting the finetuning functions
ACC for deep clustering: 0.55
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 4.18126, Reconstruction: 3.96497, Clustering: 0.21629,
Fine-tuning epoch 2 ++++
Total cost: 1.81364, Reconstruction: 1.56101, Clustering: 0.25263,
Fine-tuning epoch 3 ++++
Total cost: 1.56120, Reconstruction: 1.26823, Clustering: 0.29297,
Fine-tuning epoch 4 ++++
Total cost: 1.42449, Reconstruction: 1.13591, Clustering: 0.28859,
Fine-tuning epoch 5 ++++
Total cost: 1.33961, Reconstruction: 1.06174, Clustering: 0.27787,
Fine-tuning epoch 6 ++++
Total cost: 1.28227, Reconstruction: 1.01449, Clustering: 0.26777,
Fine-tuning epoch 7 ++++
Total cost: 1.24115, Reconstruction: 0.98063, Clustering: 0.26052,
Fine-tuning epoch 8 ++++
Total cost: 1.20764, Reconstruction: 0.95283, Clustering: 0.25482,
Fine-tuning epoch 9 ++++
Total cost: 1.17819, Reconstruction: 0.92787, Clustering: 0.25033,
Fine-tuning epoch 10 ++++
Total cost: 1.15131, Reconstruction: 0.90654, Clustering: 0.24477,
Fine-tuning epoch 11 ++++
Total cost: 1.13699, Reconstruction: 0.89412, Clustering: 0.24287,
Fine-tuning epoch 12 ++++
Total cost: 1.10420, Reconstruction: 0.86502, Clustering: 0.23918,
Fine-tuning epoch 13 ++++
Total cost: 1.08881, Reconstruction: 0.85098, Clustering: 0.23784,
Fine-tuning epoch 14 ++++
Total cost: 1.07696, Reconstruction: 0.84082, Clustering: 0.23614,
Fine-tuning epoch 15 ++++
Total cost: 1.06411, Reconstruction: 0.83016, Clustering: 0.23395,
Fine-tuning epoch 16 ++++
Total cost: 1.05281, Reconstruction: 0.82173, Clustering: 0.23108,
Fine-tuning epoch 17 ++++
Total cost: 1.04568, Reconstruction: 0.81453, Clustering: 0.23115,
Fine-tuning epoch 18 ++++
Total cost: 1.02994, Reconstruction: 0.80219, Clustering: 0.22775,
Fine-tuning epoch 19 ++++
Total cost: 1.02117, Reconstruction: 0.79367, Clustering: 0.22750,
Fine-tuning epoch 20 ++++
Total cost: 1.01056, Reconstruction: 0.78474, Clustering: 0.22582,
Fine-tuning epoch 21 ++++
Total cost: 1.00057, Reconstruction: 0.77653, Clustering: 0.22404,
Fine-tuning epoch 22 ++++
Total cost: 0.98809, Reconstruction: 0.76574, Clustering: 0.22235,
Fine-tuning epoch 23 ++++
Total cost: 0.97977, Reconstruction: 0.75866, Clustering: 0.22111,
Fine-tuning epoch 24 ++++
Total cost: 0.97015, Reconstruction: 0.74969, Clustering: 0.22046,
Fine-tuning epoch 25 ++++
Total cost: 0.96343, Reconstruction: 0.74309, Clustering: 0.22034,
Fine-tuning epoch 26 ++++
Total cost: 0.95278, Reconstruction: 0.73397, Clustering: 0.21880,
Fine-tuning epoch 27 ++++
Total cost: 0.94198, Reconstruction: 0.72467, Clustering: 0.21731,
Fine-tuning epoch 28 ++++
Total cost: 0.93763, Reconstruction: 0.72041, Clustering: 0.21722,
Fine-tuning epoch 29 ++++
Total cost: 0.92845, Reconstruction: 0.71254, Clustering: 0.21591,
Fine-tuning epoch 30 ++++
Total cost: 0.92257, Reconstruction: 0.70695, Clustering: 0.21562,
Fine-tuning epoch 31 ++++
Total cost: 0.91698, Reconstruction: 0.70248, Clustering: 0.21449,
Fine-tuning epoch 32 ++++
Total cost: 0.91003, Reconstruction: 0.69614, Clustering: 0.21389,
Fine-tuning epoch 33 ++++
Total cost: 0.90862, Reconstruction: 0.69329, Clustering: 0.21534,
Fine-tuning epoch 34 ++++
Total cost: 0.90661, Reconstruction: 0.69138, Clustering: 0.21523,
Fine-tuning epoch 35 ++++
Total cost: 0.89738, Reconstruction: 0.68290, Clustering: 0.21449,
Fine-tuning epoch 36 ++++
Total cost: 0.89341, Reconstruction: 0.67940, Clustering: 0.21401,
Fine-tuning epoch 37 ++++
Total cost: 0.88494, Reconstruction: 0.67309, Clustering: 0.21186,
Fine-tuning epoch 38 ++++
Total cost: 0.88218, Reconstruction: 0.66958, Clustering: 0.21260,
Fine-tuning epoch 39 ++++
Total cost: 0.87873, Reconstruction: 0.66718, Clustering: 0.21155,
Fine-tuning epoch 40 ++++
Total cost: 0.87509, Reconstruction: 0.66409, Clustering: 0.21100,
Fine-tuning epoch 41 ++++
Total cost: 0.86977, Reconstruction: 0.65895, Clustering: 0.21082,
Fine-tuning epoch 42 ++++
Total cost: 0.86574, Reconstruction: 0.65574, Clustering: 0.21000,
Fine-tuning epoch 43 ++++
Total cost: 0.86597, Reconstruction: 0.65556, Clustering: 0.21041,
Fine-tuning epoch 44 ++++
Total cost: 0.85184, Reconstruction: 0.64463, Clustering: 0.20721,
Fine-tuning epoch 45 ++++
Total cost: 0.85207, Reconstruction: 0.64411, Clustering: 0.20796,
Fine-tuning epoch 46 ++++
Total cost: 0.84386, Reconstruction: 0.63722, Clustering: 0.20663,
Fine-tuning epoch 47 ++++
Total cost: 0.84135, Reconstruction: 0.63489, Clustering: 0.20646,
Fine-tuning epoch 48 ++++
Total cost: 0.83752, Reconstruction: 0.63235, Clustering: 0.20516,
Fine-tuning epoch 49 ++++
Total cost: 0.83360, Reconstruction: 0.62869, Clustering: 0.20492,
Fine-tuning epoch 50 ++++
Total cost: 0.82833, Reconstruction: 0.62420, Clustering: 0.20413,
Average squared 2-D reconstruction error: 0.6242
NMI for deep clustering: 0.59
ARI for deep clustering: 0.43
ACC for deep clustering: 0.58
The training code for file multi_layer_km.pyc ran for 47.91m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.13870602897
Pre-training layer 0, epoch 1, cost  0.976579066435
Pre-training layer 0, epoch 2, cost  0.786576007871
Pre-training layer 0, epoch 3, cost  0.699533678234
Pre-training layer 0, epoch 4, cost  0.64642608609
Pre-training layer 0, epoch 5, cost  0.608880348835
Pre-training layer 0, epoch 6, cost  0.580341471823
Pre-training layer 0, epoch 7, cost  0.557490144767
Pre-training layer 0, epoch 8, cost  0.538538538777
Pre-training layer 0, epoch 9, cost  0.522311328284
Pre-training layer 0, epoch 10, cost  0.508254050773
Pre-training layer 0, epoch 11, cost  0.495972456144
Pre-training layer 0, epoch 12, cost  0.484980073254
Pre-training layer 0, epoch 13, cost  0.475126466293
Pre-training layer 0, epoch 14, cost  0.466264627803
Pre-training layer 0, epoch 15, cost  0.458088787091
Pre-training layer 0, epoch 16, cost  0.450636464132
Pre-training layer 0, epoch 17, cost  0.44383891348
Pre-training layer 0, epoch 18, cost  0.437504060857
Pre-training layer 0, epoch 19, cost  0.431622850423
Pre-training layer 0, epoch 20, cost  0.426165590396
Pre-training layer 0, epoch 21, cost  0.421040982108
Pre-training layer 0, epoch 22, cost  0.416249133853
Pre-training layer 0, epoch 23, cost  0.411734728941
Pre-training layer 0, epoch 24, cost  0.407492764469
Pre-training layer 0, epoch 25, cost  0.403479702095
Pre-training layer 0, epoch 26, cost  0.39965473581
Pre-training layer 0, epoch 27, cost  0.396011437249
Pre-training layer 0, epoch 28, cost  0.392577170794
Pre-training layer 0, epoch 29, cost  0.389305471376
Pre-training layer 0, epoch 30, cost  0.386177901854
Pre-training layer 0, epoch 31, cost  0.383199050224
Pre-training layer 0, epoch 32, cost  0.380340594666
Pre-training layer 0, epoch 33, cost  0.377594006084
Pre-training layer 0, epoch 34, cost  0.374983345051
Pre-training layer 0, epoch 35, cost  0.372472059788
Pre-training layer 0, epoch 36, cost  0.370058555464
Pre-training layer 0, epoch 37, cost  0.367723349811
Pre-training layer 0, epoch 38, cost  0.365479085164
Pre-training layer 0, epoch 39, cost  0.363323239261
Pre-training layer 0, epoch 40, cost  0.36121976937
Pre-training layer 0, epoch 41, cost  0.359175076707
Pre-training layer 0, epoch 42, cost  0.357146569445
Pre-training layer 0, epoch 43, cost  0.355196508256
Pre-training layer 0, epoch 44, cost  0.353337243054
Pre-training layer 0, epoch 45, cost  0.351550027999
Pre-training layer 0, epoch 46, cost  0.349816243488
Pre-training layer 0, epoch 47, cost  0.348140897589
Pre-training layer 0, epoch 48, cost  0.34651227199
Pre-training layer 0, epoch 49, cost  0.344947638945
Pre-training layer 1, epoch 0, cost  3.87928197566
Pre-training layer 1, epoch 1, cost  1.01792400984
Pre-training layer 1, epoch 2, cost  0.733730421556
Pre-training layer 1, epoch 3, cost  0.612705241738
Pre-training layer 1, epoch 4, cost  0.542675241284
Pre-training layer 1, epoch 5, cost  0.495125132293
Pre-training layer 1, epoch 6, cost  0.459027357013
Pre-training layer 1, epoch 7, cost  0.431256923295
Pre-training layer 1, epoch 8, cost  0.408310838731
Pre-training layer 1, epoch 9, cost  0.389066212738
Pre-training layer 1, epoch 10, cost  0.372601794553
Pre-training layer 1, epoch 11, cost  0.35805604519
Pre-training layer 1, epoch 12, cost  0.345403549104
Pre-training layer 1, epoch 13, cost  0.333987046199
Pre-training layer 1, epoch 14, cost  0.323826624919
Pre-training layer 1, epoch 15, cost  0.314844559527
Pre-training layer 1, epoch 16, cost  0.306589297483
Pre-training layer 1, epoch 17, cost  0.298993641745
Pre-training layer 1, epoch 18, cost  0.292362699743
Pre-training layer 1, epoch 19, cost  0.285994293752
Pre-training layer 1, epoch 20, cost  0.279958229062
Pre-training layer 1, epoch 21, cost  0.274450429176
Pre-training layer 1, epoch 22, cost  0.269362361839
Pre-training layer 1, epoch 23, cost  0.265116548499
Pre-training layer 1, epoch 24, cost  0.260264465653
Pre-training layer 1, epoch 25, cost  0.256374438953
Pre-training layer 1, epoch 26, cost  0.252068852781
Pre-training layer 1, epoch 27, cost  0.248674401104
Pre-training layer 1, epoch 28, cost  0.245329097427
Pre-training layer 1, epoch 29, cost  0.241894854601
Pre-training layer 1, epoch 30, cost  0.238822140718
Pre-training layer 1, epoch 31, cost  0.235717555396
Pre-training layer 1, epoch 32, cost  0.232766277726
Pre-training layer 1, epoch 33, cost  0.230531893659
Pre-training layer 1, epoch 34, cost  0.228031896289
Pre-training layer 1, epoch 35, cost  0.225624267659
Pre-training layer 1, epoch 36, cost  0.223209926474
Pre-training layer 1, epoch 37, cost  0.221036418383
Pre-training layer 1, epoch 38, cost  0.218913929046
Pre-training layer 1, epoch 39, cost  0.216880234882
Pre-training layer 1, epoch 40, cost  0.21513480099
Pre-training layer 1, epoch 41, cost  0.213401329391
Pre-training layer 1, epoch 42, cost  0.21143635094
Pre-training layer 1, epoch 43, cost  0.209947822516
Pre-training layer 1, epoch 44, cost  0.208069427936
Pre-training layer 1, epoch 45, cost  0.206639408609
Pre-training layer 1, epoch 46, cost  0.205184345051
Pre-training layer 1, epoch 47, cost  0.203704203095
Pre-training layer 1, epoch 48, cost  0.202270487183
Pre-training layer 1, epoch 49, cost  0.201069372603
Pre-training layer 2, epoch 0, cost  4.79163200642
Pre-training layer 2, epoch 1, cost  1.40777467901
Pre-training layer 2, epoch 2, cost  1.07136981083
Pre-training layer 2, epoch 3, cost  0.908232241752
Pre-training layer 2, epoch 4, cost  0.815083160956
Pre-training layer 2, epoch 5, cost  0.740453113581
Pre-training layer 2, epoch 6, cost  0.68702677594
Pre-training layer 2, epoch 7, cost  0.648723488449
Pre-training layer 2, epoch 8, cost  0.625444053197
Pre-training layer 2, epoch 9, cost  0.600381852814
Pre-training layer 2, epoch 10, cost  0.585758069709
Pre-training layer 2, epoch 11, cost  0.562325895617
Pre-training layer 2, epoch 12, cost  0.55492433415
Pre-training layer 2, epoch 13, cost  0.533200679564
Pre-training layer 2, epoch 14, cost  0.524330245797
Pre-training layer 2, epoch 15, cost  0.516221636471
Pre-training layer 2, epoch 16, cost  0.508319564203
Pre-training layer 2, epoch 17, cost  0.492534057044
Pre-training layer 2, epoch 18, cost  0.495640185289
Pre-training layer 2, epoch 19, cost  0.480519957029
Pre-training layer 2, epoch 20, cost  0.483322537759
Pre-training layer 2, epoch 21, cost  0.473461143923
Pre-training layer 2, epoch 22, cost  0.466570225448
Pre-training layer 2, epoch 23, cost  0.464487470993
Pre-training layer 2, epoch 24, cost  0.463407949516
Pre-training layer 2, epoch 25, cost  0.458411460444
Pre-training layer 2, epoch 26, cost  0.454332106952
Pre-training layer 2, epoch 27, cost  0.45094748771
Pre-training layer 2, epoch 28, cost  0.448032734718
Pre-training layer 2, epoch 29, cost  0.445322585333
Pre-training layer 2, epoch 30, cost  0.442125198275
Pre-training layer 2, epoch 31, cost  0.439676471645
Pre-training layer 2, epoch 32, cost  0.437908560845
Pre-training layer 2, epoch 33, cost  0.435070328108
Pre-training layer 2, epoch 34, cost  0.4337089961
Pre-training layer 2, epoch 35, cost  0.431269658346
Pre-training layer 2, epoch 36, cost  0.429854862675
Pre-training layer 2, epoch 37, cost  0.428144478742
Pre-training layer 2, epoch 38, cost  0.426450486464
Pre-training layer 2, epoch 39, cost  0.42508564823
Pre-training layer 2, epoch 40, cost  0.423735183114
Pre-training layer 2, epoch 41, cost  0.422386472654
Pre-training layer 2, epoch 42, cost  0.421114146547
Pre-training layer 2, epoch 43, cost  0.41985018616
Pre-training layer 2, epoch 44, cost  0.418632620442
Pre-training layer 2, epoch 45, cost  0.417478785699
Pre-training layer 2, epoch 46, cost  0.41628249136
Pre-training layer 2, epoch 47, cost  0.415365757685
Pre-training layer 2, epoch 48, cost  0.414695655269
Pre-training layer 2, epoch 49, cost  0.414133085508
Pre-training layer 3, epoch 0, cost  3.58899990166
Pre-training layer 3, epoch 1, cost  0.699908080298
Pre-training layer 3, epoch 2, cost  0.447896844732
Pre-training layer 3, epoch 3, cost  0.317174280075
Pre-training layer 3, epoch 4, cost  0.240629083963
Pre-training layer 3, epoch 5, cost  0.201369352326
Pre-training layer 3, epoch 6, cost  0.16959790477
Pre-training layer 3, epoch 7, cost  0.14424889336
Pre-training layer 3, epoch 8, cost  0.129734825339
Pre-training layer 3, epoch 9, cost  0.117165618816
Pre-training layer 3, epoch 10, cost  0.106044491839
Pre-training layer 3, epoch 11, cost  0.0982934516579
Pre-training layer 3, epoch 12, cost  0.0921826336976
Pre-training layer 3, epoch 13, cost  0.0858170840595
Pre-training layer 3, epoch 14, cost  0.0795185042587
Pre-training layer 3, epoch 15, cost  0.0759467938878
Pre-training layer 3, epoch 16, cost  0.0712578240601
Pre-training layer 3, epoch 17, cost  0.0679879268709
Pre-training layer 3, epoch 18, cost  0.064887796359
Pre-training layer 3, epoch 19, cost  0.0618608254142
Pre-training layer 3, epoch 20, cost  0.0591416656598
Pre-training layer 3, epoch 21, cost  0.0566259718227
Pre-training layer 3, epoch 22, cost  0.0544230298922
Pre-training layer 3, epoch 23, cost  0.0525829069061
Pre-training layer 3, epoch 24, cost  0.0509740992361
Pre-training layer 3, epoch 25, cost  0.049154603889
Pre-training layer 3, epoch 26, cost  0.0468833246578
Pre-training layer 3, epoch 27, cost  0.0451111380222
Pre-training layer 3, epoch 28, cost  0.0441532057425
Pre-training layer 3, epoch 29, cost  0.0422037368325
Pre-training layer 3, epoch 30, cost  0.041098827875
Pre-training layer 3, epoch 31, cost  0.039678856179
Pre-training layer 3, epoch 32, cost  0.0385845447236
Pre-training layer 3, epoch 33, cost  0.0371841147943
Pre-training layer 3, epoch 34, cost  0.0364571415573
Pre-training layer 3, epoch 35, cost  0.0350007667386
Pre-training layer 3, epoch 36, cost  0.0341743137558
Pre-training layer 3, epoch 37, cost  0.0333912585431
Pre-training layer 3, epoch 38, cost  0.0322930652475
Pre-training layer 3, epoch 39, cost  0.0313259621795
Pre-training layer 3, epoch 40, cost  0.0305676419904
Pre-training layer 3, epoch 41, cost  0.0298007844081
Pre-training layer 3, epoch 42, cost  0.0288248313092
Pre-training layer 3, epoch 43, cost  0.0273113925359
Pre-training layer 3, epoch 44, cost  0.0264405266951
Pre-training layer 3, epoch 45, cost  0.0270812285335
Pre-training layer 3, epoch 46, cost  0.0264657705887
Pre-training layer 3, epoch 47, cost  0.0260295531753
Pre-training layer 3, epoch 48, cost  0.0254400642976
Pre-training layer 3, epoch 49, cost  0.024828124651
Pre-training layer 4, epoch 0, cost  4.20077816809
Pre-training layer 4, epoch 1, cost  1.15437771859
Pre-training layer 4, epoch 2, cost  0.955021833373
Pre-training layer 4, epoch 3, cost  0.917017924663
Pre-training layer 4, epoch 4, cost  0.899210239412
Pre-training layer 4, epoch 5, cost  0.886481144869
Pre-training layer 4, epoch 6, cost  0.877209146694
Pre-training layer 4, epoch 7, cost  0.869892911199
Pre-training layer 4, epoch 8, cost  0.864052470775
Pre-training layer 4, epoch 9, cost  0.859184797146
Pre-training layer 4, epoch 10, cost  0.855013486733
Pre-training layer 4, epoch 11, cost  0.851316030218
Pre-training layer 4, epoch 12, cost  0.848133606606
Pre-training layer 4, epoch 13, cost  0.84526824194
Pre-training layer 4, epoch 14, cost  0.842690558494
Pre-training layer 4, epoch 15, cost  0.840398723513
Pre-training layer 4, epoch 16, cost  0.838283298697
Pre-training layer 4, epoch 17, cost  0.836355577837
Pre-training layer 4, epoch 18, cost  0.834652108102
Pre-training layer 4, epoch 19, cost  0.833000858997
Pre-training layer 4, epoch 20, cost  0.831531962629
Pre-training layer 4, epoch 21, cost  0.83017491484
Pre-training layer 4, epoch 22, cost  0.828875862127
Pre-training layer 4, epoch 23, cost  0.827649044956
Pre-training layer 4, epoch 24, cost  0.82651874377
Pre-training layer 4, epoch 25, cost  0.825481936747
Pre-training layer 4, epoch 26, cost  0.824511432051
Pre-training layer 4, epoch 27, cost  0.82357576402
Pre-training layer 4, epoch 28, cost  0.822693045773
Pre-training layer 4, epoch 29, cost  0.821887821677
Pre-training layer 4, epoch 30, cost  0.821100224977
Pre-training layer 4, epoch 31, cost  0.820398123496
Pre-training layer 4, epoch 32, cost  0.81971209923
Pre-training layer 4, epoch 33, cost  0.819045843596
Pre-training layer 4, epoch 34, cost  0.818394475008
Pre-training layer 4, epoch 35, cost  0.817791914188
Pre-training layer 4, epoch 36, cost  0.817211393173
Pre-training layer 4, epoch 37, cost  0.816693433492
Pre-training layer 4, epoch 38, cost  0.816151200438
Pre-training layer 4, epoch 39, cost  0.81568107514
Pre-training layer 4, epoch 40, cost  0.815217204326
Pre-training layer 4, epoch 41, cost  0.814852798596
Pre-training layer 4, epoch 42, cost  0.81440916824
Pre-training layer 4, epoch 43, cost  0.81393870902
Pre-training layer 4, epoch 44, cost  0.813519525768
Pre-training layer 4, epoch 45, cost  0.813159941915
Pre-training layer 4, epoch 46, cost  0.812784806412
Pre-training layer 4, epoch 47, cost  0.812463328545
Pre-training layer 4, epoch 48, cost  0.812115709432
Pre-training layer 4, epoch 49, cost  0.811783079965
Pre-training layer 5, epoch 0, cost  5.44056201565
Pre-training layer 5, epoch 1, cost  3.43160365794
Pre-training layer 5, epoch 2, cost  3.41885252317
Pre-training layer 5, epoch 3, cost  3.41537586732
Pre-training layer 5, epoch 4, cost  3.41347032559
Pre-training layer 5, epoch 5, cost  3.41201251545
Pre-training layer 5, epoch 6, cost  3.41071556015
Pre-training layer 5, epoch 7, cost  3.40946642952
Pre-training layer 5, epoch 8, cost  3.40819548744
Pre-training layer 5, epoch 9, cost  3.40684084549
Pre-training layer 5, epoch 10, cost  3.40532972219
Pre-training layer 5, epoch 11, cost  3.40356256176
Pre-training layer 5, epoch 12, cost  3.40139837458
Pre-training layer 5, epoch 13, cost  3.39861727104
Pre-training layer 5, epoch 14, cost  3.39488610025
Pre-training layer 5, epoch 15, cost  3.38970727782
Pre-training layer 5, epoch 16, cost  3.38251063742
Pre-training layer 5, epoch 17, cost  3.37339404045
Pre-training layer 5, epoch 18, cost  3.36456981651
Pre-training layer 5, epoch 19, cost  3.35872774097
Pre-training layer 5, epoch 20, cost  3.35547100021
Pre-training layer 5, epoch 21, cost  3.35344364136
Pre-training layer 5, epoch 22, cost  3.35200644941
Pre-training layer 5, epoch 23, cost  3.35090250455
Pre-training layer 5, epoch 24, cost  3.35000546309
Pre-training layer 5, epoch 25, cost  3.3492465691
Pre-training layer 5, epoch 26, cost  3.34858602514
Pre-training layer 5, epoch 27, cost  3.34799786719
Pre-training layer 5, epoch 28, cost  3.34746514239
Pre-training layer 5, epoch 29, cost  3.3469763376
Pre-training layer 5, epoch 30, cost  3.34652370064
Pre-training layer 5, epoch 31, cost  3.34610050959
Pre-training layer 5, epoch 32, cost  3.34570282422
Pre-training layer 5, epoch 33, cost  3.34532729728
Pre-training layer 5, epoch 34, cost  3.34497040431
Pre-training layer 5, epoch 35, cost  3.34463029293
Pre-training layer 5, epoch 36, cost  3.34430529983
Pre-training layer 5, epoch 37, cost  3.34399405205
Pre-training layer 5, epoch 38, cost  3.34369457135
Pre-training layer 5, epoch 39, cost  3.34340676745
Pre-training layer 5, epoch 40, cost  3.34312917043
Pre-training layer 5, epoch 41, cost  3.34286155122
Pre-training layer 5, epoch 42, cost  3.3426028453
Pre-training layer 5, epoch 43, cost  3.34235288427
Pre-training layer 5, epoch 44, cost  3.34211076938
Pre-training layer 5, epoch 45, cost  3.34187610681
Pre-training layer 5, epoch 46, cost  3.34164810156
Pre-training layer 5, epoch 47, cost  3.34142718152
Pre-training layer 5, epoch 48, cost  3.34121252349
The pretraining code for file multi_layer_km.pyc ran for 49.49m
Pre-training layer 5, epoch 49, cost  3.3410035623
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
... getting the finetuning functions
ACC for deep clustering: 0.53
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.33315, Reconstruction: 2.06079, Clustering: 0.27236,
Fine-tuning epoch 2 ++++
Total cost: 1.66595, Reconstruction: 1.38662, Clustering: 0.27933,
Fine-tuning epoch 3 ++++
Total cost: 1.50500, Reconstruction: 1.22613, Clustering: 0.27887,
Fine-tuning epoch 4 ++++
Total cost: 1.39893, Reconstruction: 1.12539, Clustering: 0.27354,
Fine-tuning epoch 5 ++++
Total cost: 1.31661, Reconstruction: 1.05113, Clustering: 0.26547,
Fine-tuning epoch 6 ++++
Total cost: 1.26762, Reconstruction: 1.00617, Clustering: 0.26145,
Fine-tuning epoch 7 ++++
Total cost: 1.22254, Reconstruction: 0.96749, Clustering: 0.25505,
Fine-tuning epoch 8 ++++
Total cost: 1.19150, Reconstruction: 0.94053, Clustering: 0.25097,
Fine-tuning epoch 9 ++++
Total cost: 1.16727, Reconstruction: 0.91977, Clustering: 0.24750,
Fine-tuning epoch 10 ++++
Total cost: 1.14350, Reconstruction: 0.90015, Clustering: 0.24335,
Fine-tuning epoch 11 ++++
Total cost: 1.12879, Reconstruction: 0.88701, Clustering: 0.24179,
Fine-tuning epoch 12 ++++
Total cost: 1.11540, Reconstruction: 0.87519, Clustering: 0.24021,
Fine-tuning epoch 13 ++++
Total cost: 1.09674, Reconstruction: 0.86086, Clustering: 0.23588,
Fine-tuning epoch 14 ++++
Total cost: 1.08927, Reconstruction: 0.85404, Clustering: 0.23523,
Fine-tuning epoch 15 ++++
Total cost: 1.07295, Reconstruction: 0.84084, Clustering: 0.23211,
Fine-tuning epoch 16 ++++
Total cost: 1.06832, Reconstruction: 0.83657, Clustering: 0.23175,
Fine-tuning epoch 17 ++++
Total cost: 1.05584, Reconstruction: 0.82699, Clustering: 0.22884,
Fine-tuning epoch 18 ++++
Total cost: 1.04944, Reconstruction: 0.82098, Clustering: 0.22846,
Fine-tuning epoch 19 ++++
Total cost: 1.04550, Reconstruction: 0.81701, Clustering: 0.22849,
Fine-tuning epoch 20 ++++
Total cost: 1.03165, Reconstruction: 0.80575, Clustering: 0.22590,
Fine-tuning epoch 21 ++++
Total cost: 1.02513, Reconstruction: 0.79937, Clustering: 0.22576,
Fine-tuning epoch 22 ++++
Total cost: 1.01750, Reconstruction: 0.79340, Clustering: 0.22410,
Fine-tuning epoch 23 ++++
Total cost: 1.00851, Reconstruction: 0.78551, Clustering: 0.22300,
Fine-tuning epoch 24 ++++
Total cost: 1.00033, Reconstruction: 0.77840, Clustering: 0.22192,
Fine-tuning epoch 25 ++++
Total cost: 0.98977, Reconstruction: 0.76980, Clustering: 0.21997,
Fine-tuning epoch 26 ++++
Total cost: 0.98467, Reconstruction: 0.76475, Clustering: 0.21992,
Fine-tuning epoch 27 ++++
Total cost: 0.97922, Reconstruction: 0.76028, Clustering: 0.21894,
Fine-tuning epoch 28 ++++
Total cost: 0.97255, Reconstruction: 0.75400, Clustering: 0.21855,
Fine-tuning epoch 29 ++++
Total cost: 0.96626, Reconstruction: 0.74865, Clustering: 0.21761,
Fine-tuning epoch 30 ++++
Total cost: 0.95851, Reconstruction: 0.74177, Clustering: 0.21674,
Fine-tuning epoch 31 ++++
Total cost: 0.95279, Reconstruction: 0.73674, Clustering: 0.21605,
Fine-tuning epoch 32 ++++
Total cost: 0.94559, Reconstruction: 0.73045, Clustering: 0.21514,
Fine-tuning epoch 33 ++++
Total cost: 0.94277, Reconstruction: 0.72687, Clustering: 0.21590,
Fine-tuning epoch 34 ++++
Total cost: 0.93384, Reconstruction: 0.72080, Clustering: 0.21304,
Fine-tuning epoch 35 ++++
Total cost: 0.92654, Reconstruction: 0.71408, Clustering: 0.21246,
Fine-tuning epoch 36 ++++
Total cost: 0.91743, Reconstruction: 0.70725, Clustering: 0.21018,
Fine-tuning epoch 37 ++++
Total cost: 0.91331, Reconstruction: 0.70403, Clustering: 0.20928,
Fine-tuning epoch 38 ++++
Total cost: 0.91515, Reconstruction: 0.70398, Clustering: 0.21118,
Fine-tuning epoch 39 ++++
Total cost: 0.90533, Reconstruction: 0.69576, Clustering: 0.20957,
Fine-tuning epoch 40 ++++
Total cost: 0.90123, Reconstruction: 0.69210, Clustering: 0.20913,
Fine-tuning epoch 41 ++++
Total cost: 0.89857, Reconstruction: 0.68837, Clustering: 0.21020,
Fine-tuning epoch 42 ++++
Total cost: 0.89209, Reconstruction: 0.68365, Clustering: 0.20844,
Fine-tuning epoch 43 ++++
Total cost: 0.88801, Reconstruction: 0.67979, Clustering: 0.20823,
Fine-tuning epoch 44 ++++
Total cost: 0.88505, Reconstruction: 0.67715, Clustering: 0.20790,
Fine-tuning epoch 45 ++++
Total cost: 0.88628, Reconstruction: 0.67729, Clustering: 0.20899,
Fine-tuning epoch 46 ++++
Total cost: 0.87827, Reconstruction: 0.66934, Clustering: 0.20894,
Fine-tuning epoch 47 ++++
Total cost: 0.87588, Reconstruction: 0.66849, Clustering: 0.20739,
Fine-tuning epoch 48 ++++
Total cost: 0.87584, Reconstruction: 0.66695, Clustering: 0.20889,
Fine-tuning epoch 49 ++++
Total cost: 0.87361, Reconstruction: 0.66569, Clustering: 0.20791,
Fine-tuning epoch 50 ++++
Total cost: 0.86789, Reconstruction: 0.66008, Clustering: 0.20781,
Average squared 2-D reconstruction error: 0.6601
NMI for deep clustering: 0.58
ARI for deep clustering: 0.41
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 48.34m
KM avg. NMI = 0.49, ARI = 0.37, ACC = 0.55
SAE+KM avg. NMI = 0.51, ARI = 0.37, ACC = 0.53
DCN    avg. NMI = 0.58, ARI = 0.41, ACC = 0.56

Process finished with exit code 0