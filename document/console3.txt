/home/wenjun/anaconda2/bin/python2.7 /home/wenjun/AnacondaProjects/on_my_git/DCN/run_raw_mnist.py
/home/wenjun/anaconda2/lib/python2.7/site-packages/theano/gpuarray/dnn.py:135: UserWarning: Your cuDNN version is more recent than Theano. If you encounter problems, try updating Theano or downgrading cuDNN to version 5.1.
  warnings.warn("Your cuDNN version is more recent than "
Using cuDNN version 7001 on context None
Mapped name None to device cuda: TITAN Xp (0000:03:00.0)
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.15046291348
Pre-training layer 0, epoch 1, cost  0.994174812968
Pre-training layer 0, epoch 2, cost  0.801133030598
Pre-training layer 0, epoch 3, cost  0.712675991286
Pre-training layer 0, epoch 4, cost  0.658273337788
Pre-training layer 0, epoch 5, cost  0.620295910233
Pre-training layer 0, epoch 6, cost  0.591206603683
Pre-training layer 0, epoch 7, cost  0.568041332687
Pre-training layer 0, epoch 8, cost  0.548981143696
Pre-training layer 0, epoch 9, cost  0.532743099705
Pre-training layer 0, epoch 10, cost  0.518683363998
Pre-training layer 0, epoch 11, cost  0.506388181788
Pre-training layer 0, epoch 12, cost  0.495481669068
Pre-training layer 0, epoch 13, cost  0.485699685786
Pre-training layer 0, epoch 14, cost  0.476832485362
Pre-training layer 0, epoch 15, cost  0.46875472528
Pre-training layer 0, epoch 16, cost  0.46135799968
Pre-training layer 0, epoch 17, cost  0.454520025235
Pre-training layer 0, epoch 18, cost  0.448208452394
Pre-training layer 0, epoch 19, cost  0.44224858866
Pre-training layer 0, epoch 20, cost  0.436258764767
Pre-training layer 0, epoch 21, cost  0.430946851253
Pre-training layer 0, epoch 22, cost  0.426004166138
Pre-training layer 0, epoch 23, cost  0.421370822223
Pre-training layer 0, epoch 24, cost  0.417013132807
Pre-training layer 0, epoch 25, cost  0.412890265234
Pre-training layer 0, epoch 26, cost  0.408979839135
Pre-training layer 0, epoch 27, cost  0.405278588987
Pre-training layer 0, epoch 28, cost  0.40172757075
Pre-training layer 0, epoch 29, cost  0.398214014714
Pre-training layer 0, epoch 30, cost  0.394964064146
Pre-training layer 0, epoch 31, cost  0.391874545349
Pre-training layer 0, epoch 32, cost  0.388907050873
Pre-training layer 0, epoch 33, cost  0.386085871466
Pre-training layer 0, epoch 34, cost  0.383384185975
Pre-training layer 0, epoch 35, cost  0.380757421847
Pre-training layer 0, epoch 36, cost  0.378221205152
Pre-training layer 0, epoch 37, cost  0.375813229398
Pre-training layer 0, epoch 38, cost  0.373498536464
Pre-training layer 0, epoch 39, cost  0.371264822555
Pre-training layer 0, epoch 40, cost  0.369113377221
Pre-training layer 0, epoch 41, cost  0.366986321102
Pre-training layer 0, epoch 42, cost  0.364937116885
Pre-training layer 0, epoch 43, cost  0.362970790478
Pre-training layer 0, epoch 44, cost  0.361076943884
Pre-training layer 0, epoch 45, cost  0.3592346715
Pre-training layer 0, epoch 46, cost  0.3574082127
Pre-training layer 0, epoch 47, cost  0.355520380903
Pre-training layer 0, epoch 48, cost  0.353804336634
Pre-training layer 0, epoch 49, cost  0.352150913717
Pre-training layer 1, epoch 0, cost  3.87348721088
Pre-training layer 1, epoch 1, cost  1.01509175782
Pre-training layer 1, epoch 2, cost  0.733102108413
Pre-training layer 1, epoch 3, cost  0.612789208647
Pre-training layer 1, epoch 4, cost  0.542770286261
Pre-training layer 1, epoch 5, cost  0.496032699528
Pre-training layer 1, epoch 6, cost  0.460212481034
Pre-training layer 1, epoch 7, cost  0.432406127724
Pre-training layer 1, epoch 8, cost  0.40906878054
Pre-training layer 1, epoch 9, cost  0.39016297081
Pre-training layer 1, epoch 10, cost  0.373785357988
Pre-training layer 1, epoch 11, cost  0.359538284819
Pre-training layer 1, epoch 12, cost  0.346902033177
Pre-training layer 1, epoch 13, cost  0.3357046757
Pre-training layer 1, epoch 14, cost  0.325729833507
Pre-training layer 1, epoch 15, cost  0.31681224219
Pre-training layer 1, epoch 16, cost  0.30846135571
Pre-training layer 1, epoch 17, cost  0.300973553911
Pre-training layer 1, epoch 18, cost  0.29481868264
Pre-training layer 1, epoch 19, cost  0.288202944284
Pre-training layer 1, epoch 20, cost  0.282064942655
Pre-training layer 1, epoch 21, cost  0.276649640084
Pre-training layer 1, epoch 22, cost  0.27134265254
Pre-training layer 1, epoch 23, cost  0.266542155445
Pre-training layer 1, epoch 24, cost  0.262495919139
Pre-training layer 1, epoch 25, cost  0.258180050204
Pre-training layer 1, epoch 26, cost  0.254634777179
Pre-training layer 1, epoch 27, cost  0.251006305711
Pre-training layer 1, epoch 28, cost  0.247353649566
Pre-training layer 1, epoch 29, cost  0.244041134955
Pre-training layer 1, epoch 30, cost  0.241003611489
Pre-training layer 1, epoch 31, cost  0.238053940633
Pre-training layer 1, epoch 32, cost  0.235187338014
Pre-training layer 1, epoch 33, cost  0.23266464689
Pre-training layer 1, epoch 34, cost  0.230629928309
Pre-training layer 1, epoch 35, cost  0.227659602843
Pre-training layer 1, epoch 36, cost  0.225495873771
Pre-training layer 1, epoch 37, cost  0.223200628044
Pre-training layer 1, epoch 38, cost  0.221192632632
Pre-training layer 1, epoch 39, cost  0.219120771702
Pre-training layer 1, epoch 40, cost  0.217156587032
Pre-training layer 1, epoch 41, cost  0.215321294456
Pre-training layer 1, epoch 42, cost  0.213855605476
Pre-training layer 1, epoch 43, cost  0.2122206695
Pre-training layer 1, epoch 44, cost  0.210402896888
Pre-training layer 1, epoch 45, cost  0.208796766128
Pre-training layer 1, epoch 46, cost  0.207544875787
Pre-training layer 1, epoch 47, cost  0.205975687791
Pre-training layer 1, epoch 48, cost  0.204606857497
Pre-training layer 1, epoch 49, cost  0.203243782895
Pre-training layer 2, epoch 0, cost  4.81564773474
Pre-training layer 2, epoch 1, cost  1.40885719132
Pre-training layer 2, epoch 2, cost  1.07055988311
Pre-training layer 2, epoch 3, cost  0.907951388669
Pre-training layer 2, epoch 4, cost  0.813493432136
Pre-training layer 2, epoch 5, cost  0.73679112413
Pre-training layer 2, epoch 6, cost  0.693792866425
Pre-training layer 2, epoch 7, cost  0.651290947974
Pre-training layer 2, epoch 8, cost  0.63010044233
Pre-training layer 2, epoch 9, cost  0.605741130982
Pre-training layer 2, epoch 10, cost  0.591547511285
Pre-training layer 2, epoch 11, cost  0.564562862553
Pre-training layer 2, epoch 12, cost  0.560549962839
Pre-training layer 2, epoch 13, cost  0.541284153843
Pre-training layer 2, epoch 14, cost  0.529293053093
Pre-training layer 2, epoch 15, cost  0.520632770899
Pre-training layer 2, epoch 16, cost  0.513906322422
Pre-training layer 2, epoch 17, cost  0.505125351444
Pre-training layer 2, epoch 18, cost  0.495989804783
Pre-training layer 2, epoch 19, cost  0.498693236886
Pre-training layer 2, epoch 20, cost  0.484612134862
Pre-training layer 2, epoch 21, cost  0.481365162858
Pre-training layer 2, epoch 22, cost  0.478208159774
Pre-training layer 2, epoch 23, cost  0.472219894643
Pre-training layer 2, epoch 24, cost  0.46790233445
Pre-training layer 2, epoch 25, cost  0.463449750801
Pre-training layer 2, epoch 26, cost  0.459235015066
Pre-training layer 2, epoch 27, cost  0.456127028256
Pre-training layer 2, epoch 28, cost  0.455140849735
Pre-training layer 2, epoch 29, cost  0.451932334932
Pre-training layer 2, epoch 30, cost  0.449153688428
Pre-training layer 2, epoch 31, cost  0.446694479229
Pre-training layer 2, epoch 32, cost  0.444681719826
Pre-training layer 2, epoch 33, cost  0.442352120013
Pre-training layer 2, epoch 34, cost  0.440548330146
Pre-training layer 2, epoch 35, cost  0.438361324071
Pre-training layer 2, epoch 36, cost  0.436738065214
Pre-training layer 2, epoch 37, cost  0.43506730556
Pre-training layer 2, epoch 38, cost  0.433853716938
Pre-training layer 2, epoch 39, cost  0.432297612719
Pre-training layer 2, epoch 40, cost  0.431013683294
Pre-training layer 2, epoch 41, cost  0.429663451302
Pre-training layer 2, epoch 42, cost  0.428432961089
Pre-training layer 2, epoch 43, cost  0.427270500909
Pre-training layer 2, epoch 44, cost  0.42624648739
Pre-training layer 2, epoch 45, cost  0.425172393933
Pre-training layer 2, epoch 46, cost  0.423974701755
Pre-training layer 2, epoch 47, cost  0.422814270661
Pre-training layer 2, epoch 48, cost  0.422001915111
Pre-training layer 2, epoch 49, cost  0.421178610576
Pre-training layer 3, epoch 0, cost  3.61103960719
Pre-training layer 3, epoch 1, cost  0.701998103323
Pre-training layer 3, epoch 2, cost  0.444075159445
Pre-training layer 3, epoch 3, cost  0.312460507268
Pre-training layer 3, epoch 4, cost  0.242106241868
Pre-training layer 3, epoch 5, cost  0.192856904447
Pre-training layer 3, epoch 6, cost  0.165402000667
Pre-training layer 3, epoch 7, cost  0.144705833281
Pre-training layer 3, epoch 8, cost  0.12558228162
Pre-training layer 3, epoch 9, cost  0.11302934213
Pre-training layer 3, epoch 10, cost  0.103986611269
Pre-training layer 3, epoch 11, cost  0.0963968888242
Pre-training layer 3, epoch 12, cost  0.0890217715064
Pre-training layer 3, epoch 13, cost  0.0831230828583
Pre-training layer 3, epoch 14, cost  0.0784353627056
Pre-training layer 3, epoch 15, cost  0.0737748556825
Pre-training layer 3, epoch 16, cost  0.0700358248598
Pre-training layer 3, epoch 17, cost  0.0664931348027
Pre-training layer 3, epoch 18, cost  0.0634395961492
Pre-training layer 3, epoch 19, cost  0.0607151439492
Pre-training layer 3, epoch 20, cost  0.0582728294662
Pre-training layer 3, epoch 21, cost  0.0560149696571
Pre-training layer 3, epoch 22, cost  0.0538874599971
Pre-training layer 3, epoch 23, cost  0.0517315662973
Pre-training layer 3, epoch 24, cost  0.0495288229073
Pre-training layer 3, epoch 25, cost  0.0476225575839
Pre-training layer 3, epoch 26, cost  0.0460381195396
Pre-training layer 3, epoch 27, cost  0.0445910999825
Pre-training layer 3, epoch 28, cost  0.0430027146527
Pre-training layer 3, epoch 29, cost  0.0416151039235
Pre-training layer 3, epoch 30, cost  0.0403226824728
Pre-training layer 3, epoch 31, cost  0.0390340193191
Pre-training layer 3, epoch 32, cost  0.0378479543984
Pre-training layer 3, epoch 33, cost  0.0367080777799
Pre-training layer 3, epoch 34, cost  0.0356233156196
Pre-training layer 3, epoch 35, cost  0.0345975701533
Pre-training layer 3, epoch 36, cost  0.0336078026966
Pre-training layer 3, epoch 37, cost  0.0326351429686
Pre-training layer 3, epoch 38, cost  0.031683257764
Pre-training layer 3, epoch 39, cost  0.0307414674987
Pre-training layer 3, epoch 40, cost  0.0297716861892
Pre-training layer 3, epoch 41, cost  0.0289265848083
Pre-training layer 3, epoch 42, cost  0.0283719276587
Pre-training layer 3, epoch 43, cost  0.0278317452872
Pre-training layer 3, epoch 44, cost  0.0271910219831
Pre-training layer 3, epoch 45, cost  0.0265815721111
Pre-training layer 3, epoch 46, cost  0.0259930787093
Pre-training layer 3, epoch 47, cost  0.0254375017474
Pre-training layer 3, epoch 48, cost  0.0248600545796
Pre-training layer 3, epoch 49, cost  0.024256169368
Pre-training layer 4, epoch 0, cost  4.23630465092
Pre-training layer 4, epoch 1, cost  1.15978847091
Pre-training layer 4, epoch 2, cost  0.957109401839
Pre-training layer 4, epoch 3, cost  0.92134627216
Pre-training layer 4, epoch 4, cost  0.903805182125
Pre-training layer 4, epoch 5, cost  0.89139910549
Pre-training layer 4, epoch 6, cost  0.882396088955
Pre-training layer 4, epoch 7, cost  0.875232343055
Pre-training layer 4, epoch 8, cost  0.869360450306
Pre-training layer 4, epoch 9, cost  0.864465485362
Pre-training layer 4, epoch 10, cost  0.860234601813
Pre-training layer 4, epoch 11, cost  0.856578743053
Pre-training layer 4, epoch 12, cost  0.853377766182
Pre-training layer 4, epoch 13, cost  0.850536514666
Pre-training layer 4, epoch 14, cost  0.847979506412
Pre-training layer 4, epoch 15, cost  0.845693314746
Pre-training layer 4, epoch 16, cost  0.843612172072
Pre-training layer 4, epoch 17, cost  0.841684821871
Pre-training layer 4, epoch 18, cost  0.839882779521
Pre-training layer 4, epoch 19, cost  0.838287616804
Pre-training layer 4, epoch 20, cost  0.836792417
Pre-training layer 4, epoch 21, cost  0.835401552077
Pre-training layer 4, epoch 22, cost  0.834103820063
Pre-training layer 4, epoch 23, cost  0.832932304815
Pre-training layer 4, epoch 24, cost  0.831784880765
Pre-training layer 4, epoch 25, cost  0.830742259253
Pre-training layer 4, epoch 26, cost  0.829758574038
Pre-training layer 4, epoch 27, cost  0.828818081504
Pre-training layer 4, epoch 28, cost  0.827964282747
Pre-training layer 4, epoch 29, cost  0.827136671196
Pre-training layer 4, epoch 30, cost  0.826351262475
Pre-training layer 4, epoch 31, cost  0.825614973672
Pre-training layer 4, epoch 32, cost  0.824959902515
Pre-training layer 4, epoch 33, cost  0.824336044773
Pre-training layer 4, epoch 34, cost  0.823670461756
Pre-training layer 4, epoch 35, cost  0.823045012925
Pre-training layer 4, epoch 36, cost  0.822486490462
Pre-training layer 4, epoch 37, cost  0.821917741652
Pre-training layer 4, epoch 38, cost  0.821408811294
Pre-training layer 4, epoch 39, cost  0.820893696385
Pre-training layer 4, epoch 40, cost  0.820417259829
Pre-training layer 4, epoch 41, cost  0.819939363786
Pre-training layer 4, epoch 42, cost  0.819536546855
Pre-training layer 4, epoch 43, cost  0.819094649802
Pre-training layer 4, epoch 44, cost  0.81870392892
Pre-training layer 4, epoch 45, cost  0.818311300248
Pre-training layer 4, epoch 46, cost  0.817949650152
Pre-training layer 4, epoch 47, cost  0.817606138356
Pre-training layer 4, epoch 48, cost  0.817277041268
Pre-training layer 4, epoch 49, cost  0.816933440633
Pre-training layer 5, epoch 0, cost  5.47164519062
Pre-training layer 5, epoch 1, cost  3.46313283331
Pre-training layer 5, epoch 2, cost  3.44666836641
Pre-training layer 5, epoch 3, cost  3.44208365504
Pre-training layer 5, epoch 4, cost  3.43974876011
Pre-training layer 5, epoch 5, cost  3.4380838169
Pre-training layer 5, epoch 6, cost  3.43669105466
Pre-training layer 5, epoch 7, cost  3.43540891672
Pre-training layer 5, epoch 8, cost  3.43413986832
Pre-training layer 5, epoch 9, cost  3.43279613833
Pre-training layer 5, epoch 10, cost  3.43128249256
Pre-training layer 5, epoch 11, cost  3.42948013422
Pre-training layer 5, epoch 12, cost  3.42722330727
Pre-training layer 5, epoch 13, cost  3.42426774821
Pre-training layer 5, epoch 14, cost  3.42024138772
Pre-training layer 5, epoch 15, cost  3.41460157373
Pre-training layer 5, epoch 16, cost  3.40678789183
Pre-training layer 5, epoch 17, cost  3.39717964025
Pre-training layer 5, epoch 18, cost  3.38850243967
Pre-training layer 5, epoch 19, cost  3.38315405235
Pre-training layer 5, epoch 20, cost  3.38018351921
Pre-training layer 5, epoch 21, cost  3.37828146222
Pre-training layer 5, epoch 22, cost  3.37690700543
Pre-training layer 5, epoch 23, cost  3.3758394894
Pre-training layer 5, epoch 24, cost  3.37496839287
Pre-training layer 5, epoch 25, cost  3.37423093477
Pre-training layer 5, epoch 26, cost  3.37358940929
Pre-training layer 5, epoch 27, cost  3.37302160039
Pre-training layer 5, epoch 28, cost  3.37250992224
Pre-training layer 5, epoch 29, cost  3.37204357357
Pre-training layer 5, epoch 30, cost  3.3716133666
Pre-training layer 5, epoch 31, cost  3.37121515001
Pre-training layer 5, epoch 32, cost  3.37084293336
Pre-training layer 5, epoch 33, cost  3.37049401875
Pre-training layer 5, epoch 34, cost  3.37016459888
Pre-training layer 5, epoch 35, cost  3.36985358577
Pre-training layer 5, epoch 36, cost  3.36955848284
Pre-training layer 5, epoch 37, cost  3.36927802908
Pre-training layer 5, epoch 38, cost  3.36901081951
Pre-training layer 5, epoch 39, cost  3.36875537084
Pre-training layer 5, epoch 40, cost  3.36851133512
Pre-training layer 5, epoch 41, cost  3.36827719581
Pre-training layer 5, epoch 42, cost  3.36805292392
Pre-training layer 5, epoch 43, cost  3.36783755244
Pre-training layer 5, epoch 44, cost  3.36763016109
Pre-training layer 5, epoch 45, cost  3.36743061343
Pre-training layer 5, epoch 46, cost  3.36723825616
Pre-training layer 5, epoch 47, cost  3.36705274626
Pre-training layer 5, epoch 48, cost  3.36687342202
Pre-training layer 5, epoch 49, cost  3.36670020778
The pretraining code for file multi_layer_km.pyc ran for 25.80m
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
ACC for deep clustering: 0.53
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.08875, Reconstruction: 1.77815, Clustering: 0.31060,
Fine-tuning epoch 2 ++++
Total cost: 1.60305, Reconstruction: 1.29386, Clustering: 0.30919,
Fine-tuning epoch 3 ++++
Total cost: 1.44694, Reconstruction: 1.15196, Clustering: 0.29498,
Fine-tuning epoch 4 ++++
Total cost: 1.35146, Reconstruction: 1.07053, Clustering: 0.28093,
Fine-tuning epoch 5 ++++
Total cost: 1.28968, Reconstruction: 1.01973, Clustering: 0.26995,
Fine-tuning epoch 6 ++++
Total cost: 1.24170, Reconstruction: 0.97999, Clustering: 0.26170,
Fine-tuning epoch 7 ++++
Total cost: 1.20786, Reconstruction: 0.95144, Clustering: 0.25642,
Fine-tuning epoch 8 ++++
Total cost: 1.18246, Reconstruction: 0.93046, Clustering: 0.25200,
Fine-tuning epoch 9 ++++
Total cost: 1.15752, Reconstruction: 0.91026, Clustering: 0.24726,
Fine-tuning epoch 10 ++++
Total cost: 1.13914, Reconstruction: 0.89513, Clustering: 0.24401,
Fine-tuning epoch 11 ++++
Total cost: 1.12075, Reconstruction: 0.87812, Clustering: 0.24263,
Fine-tuning epoch 12 ++++
Total cost: 1.10638, Reconstruction: 0.86677, Clustering: 0.23961,
Fine-tuning epoch 13 ++++
Total cost: 1.09014, Reconstruction: 0.85317, Clustering: 0.23697,
Fine-tuning epoch 14 ++++
Total cost: 1.08168, Reconstruction: 0.84631, Clustering: 0.23537,
Fine-tuning epoch 15 ++++
Total cost: 1.06900, Reconstruction: 0.83528, Clustering: 0.23372,
Fine-tuning epoch 16 ++++
Total cost: 1.05738, Reconstruction: 0.82679, Clustering: 0.23059,
Fine-tuning epoch 17 ++++
Total cost: 1.04876, Reconstruction: 0.81879, Clustering: 0.22997,
Fine-tuning epoch 18 ++++
Total cost: 1.04268, Reconstruction: 0.81361, Clustering: 0.22907,
Fine-tuning epoch 19 ++++
Total cost: 1.03077, Reconstruction: 0.80340, Clustering: 0.22737,
Fine-tuning epoch 20 ++++
Total cost: 1.02374, Reconstruction: 0.79796, Clustering: 0.22578,
Fine-tuning epoch 21 ++++
Total cost: 1.01832, Reconstruction: 0.79225, Clustering: 0.22607,
Fine-tuning epoch 22 ++++
Total cost: 1.00956, Reconstruction: 0.78475, Clustering: 0.22480,
Fine-tuning epoch 23 ++++
Total cost: 0.99370, Reconstruction: 0.77304, Clustering: 0.22066,
Fine-tuning epoch 24 ++++
Total cost: 0.98214, Reconstruction: 0.76341, Clustering: 0.21873,
Fine-tuning epoch 25 ++++
Total cost: 0.97446, Reconstruction: 0.75760, Clustering: 0.21686,
Fine-tuning epoch 26 ++++
Total cost: 0.96489, Reconstruction: 0.74947, Clustering: 0.21542,
Fine-tuning epoch 27 ++++
Total cost: 0.95916, Reconstruction: 0.74377, Clustering: 0.21538,
Fine-tuning epoch 28 ++++
Total cost: 0.95022, Reconstruction: 0.73687, Clustering: 0.21334,
Fine-tuning epoch 29 ++++
Total cost: 0.94208, Reconstruction: 0.72944, Clustering: 0.21263,
Fine-tuning epoch 30 ++++
Total cost: 0.93811, Reconstruction: 0.72572, Clustering: 0.21240,
Fine-tuning epoch 31 ++++
Total cost: 0.92772, Reconstruction: 0.71671, Clustering: 0.21101,
Fine-tuning epoch 32 ++++
Total cost: 0.91916, Reconstruction: 0.70942, Clustering: 0.20973,
Fine-tuning epoch 33 ++++
Total cost: 0.91746, Reconstruction: 0.70698, Clustering: 0.21048,
Fine-tuning epoch 34 ++++
Total cost: 0.90754, Reconstruction: 0.69901, Clustering: 0.20854,
Fine-tuning epoch 35 ++++
Total cost: 0.90391, Reconstruction: 0.69505, Clustering: 0.20886,
Fine-tuning epoch 36 ++++
Total cost: 0.89626, Reconstruction: 0.68938, Clustering: 0.20688,
Fine-tuning epoch 37 ++++
Total cost: 0.89775, Reconstruction: 0.68856, Clustering: 0.20919,
Fine-tuning epoch 38 ++++
Total cost: 0.88438, Reconstruction: 0.67825, Clustering: 0.20613,
Fine-tuning epoch 39 ++++
Total cost: 0.88380, Reconstruction: 0.67796, Clustering: 0.20584,
Fine-tuning epoch 40 ++++
Total cost: 0.87666, Reconstruction: 0.67160, Clustering: 0.20506,
Fine-tuning epoch 41 ++++
Total cost: 0.86999, Reconstruction: 0.66489, Clustering: 0.20510,
Fine-tuning epoch 42 ++++
Total cost: 0.86557, Reconstruction: 0.66188, Clustering: 0.20369,
Fine-tuning epoch 43 ++++
Total cost: 0.85812, Reconstruction: 0.65581, Clustering: 0.20231,
Fine-tuning epoch 44 ++++
Total cost: 0.85488, Reconstruction: 0.65309, Clustering: 0.20179,
Fine-tuning epoch 45 ++++
Total cost: 0.84996, Reconstruction: 0.64803, Clustering: 0.20193,
Fine-tuning epoch 46 ++++
Total cost: 0.84253, Reconstruction: 0.64253, Clustering: 0.20000,
Fine-tuning epoch 47 ++++
Total cost: 0.83889, Reconstruction: 0.63915, Clustering: 0.19974,
Fine-tuning epoch 48 ++++
Total cost: 0.83809, Reconstruction: 0.63797, Clustering: 0.20013,
Fine-tuning epoch 49 ++++
Total cost: 0.82451, Reconstruction: 0.62764, Clustering: 0.19687,
Fine-tuning epoch 50 ++++
Total cost: 0.82556, Reconstruction: 0.62782, Clustering: 0.19774,
Average squared 2-D reconstruction error: 0.6278
NMI for deep clustering: 0.58
ARI for deep clustering: 0.42
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 24.98m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.14039052801
Pre-training layer 0, epoch 1, cost  0.979085897808
Pre-training layer 0, epoch 2, cost  0.78839132211
Pre-training layer 0, epoch 3, cost  0.700957574972
Pre-training layer 0, epoch 4, cost  0.647308867654
Pre-training layer 0, epoch 5, cost  0.609071643139
Pre-training layer 0, epoch 6, cost  0.580015162334
Pre-training layer 0, epoch 7, cost  0.556773661218
Pre-training layer 0, epoch 8, cost  0.537617526891
Pre-training layer 0, epoch 9, cost  0.521482417187
Pre-training layer 0, epoch 10, cost  0.507476536857
Pre-training layer 0, epoch 11, cost  0.495190781543
Pre-training layer 0, epoch 12, cost  0.484192089994
Pre-training layer 0, epoch 13, cost  0.474284161099
Pre-training layer 0, epoch 14, cost  0.464754723454
Pre-training layer 0, epoch 15, cost  0.456062677944
Pre-training layer 0, epoch 16, cost  0.448486766059
Pre-training layer 0, epoch 17, cost  0.441576489757
Pre-training layer 0, epoch 18, cost  0.435178337413
Pre-training layer 0, epoch 19, cost  0.429247286533
Pre-training layer 0, epoch 20, cost  0.423737892061
Pre-training layer 0, epoch 21, cost  0.418571296722
Pre-training layer 0, epoch 22, cost  0.413706777829
Pre-training layer 0, epoch 23, cost  0.409138964734
Pre-training layer 0, epoch 24, cost  0.404861288678
Pre-training layer 0, epoch 25, cost  0.400774660861
Pre-training layer 0, epoch 26, cost  0.396910040197
Pre-training layer 0, epoch 27, cost  0.393246895768
Pre-training layer 0, epoch 28, cost  0.389760148212
Pre-training layer 0, epoch 29, cost  0.386451634036
Pre-training layer 0, epoch 30, cost  0.383280852214
Pre-training layer 0, epoch 31, cost  0.380266688518
Pre-training layer 0, epoch 32, cost  0.377373887625
Pre-training layer 0, epoch 33, cost  0.374619107548
Pre-training layer 0, epoch 34, cost  0.37197258819
Pre-training layer 0, epoch 35, cost  0.369431456921
Pre-training layer 0, epoch 36, cost  0.366980413213
Pre-training layer 0, epoch 37, cost  0.364627084263
Pre-training layer 0, epoch 38, cost  0.362375534593
Pre-training layer 0, epoch 39, cost  0.360186652121
Pre-training layer 0, epoch 40, cost  0.358075957308
Pre-training layer 0, epoch 41, cost  0.356040482256
Pre-training layer 0, epoch 42, cost  0.35407816387
Pre-training layer 0, epoch 43, cost  0.352187020303
Pre-training layer 0, epoch 44, cost  0.350369194001
Pre-training layer 0, epoch 45, cost  0.348602391601
Pre-training layer 0, epoch 46, cost  0.346897124715
Pre-training layer 0, epoch 47, cost  0.345233197687
Pre-training layer 0, epoch 48, cost  0.343623431842
Pre-training layer 0, epoch 49, cost  0.342058818808
Pre-training layer 1, epoch 0, cost  3.90660958074
Pre-training layer 1, epoch 1, cost  1.02795402786
Pre-training layer 1, epoch 2, cost  0.742626962591
Pre-training layer 1, epoch 3, cost  0.620728387558
Pre-training layer 1, epoch 4, cost  0.550040496617
Pre-training layer 1, epoch 5, cost  0.501936567626
Pre-training layer 1, epoch 6, cost  0.465718916382
Pre-training layer 1, epoch 7, cost  0.438456908246
Pre-training layer 1, epoch 8, cost  0.41555303506
Pre-training layer 1, epoch 9, cost  0.39591261915
Pre-training layer 1, epoch 10, cost  0.379485885554
Pre-training layer 1, epoch 11, cost  0.364754063125
Pre-training layer 1, epoch 12, cost  0.35216259176
Pre-training layer 1, epoch 13, cost  0.340494199366
Pre-training layer 1, epoch 14, cost  0.330083752915
Pre-training layer 1, epoch 15, cost  0.321316256661
Pre-training layer 1, epoch 16, cost  0.312694482082
Pre-training layer 1, epoch 17, cost  0.305370416925
Pre-training layer 1, epoch 18, cost  0.298012680378
Pre-training layer 1, epoch 19, cost  0.292008249932
Pre-training layer 1, epoch 20, cost  0.285869228176
Pre-training layer 1, epoch 21, cost  0.280198123325
Pre-training layer 1, epoch 22, cost  0.275075039105
Pre-training layer 1, epoch 23, cost  0.270205321672
Pre-training layer 1, epoch 24, cost  0.266272583877
Pre-training layer 1, epoch 25, cost  0.261470168927
Pre-training layer 1, epoch 26, cost  0.257977084831
Pre-training layer 1, epoch 27, cost  0.254040267349
Pre-training layer 1, epoch 28, cost  0.250535515784
Pre-training layer 1, epoch 29, cost  0.247104242802
Pre-training layer 1, epoch 30, cost  0.244109389114
Pre-training layer 1, epoch 31, cost  0.241174123445
Pre-training layer 1, epoch 32, cost  0.238421138437
Pre-training layer 1, epoch 33, cost  0.235778301757
Pre-training layer 1, epoch 34, cost  0.233071833925
Pre-training layer 1, epoch 35, cost  0.230493989642
Pre-training layer 1, epoch 36, cost  0.228041213785
Pre-training layer 1, epoch 37, cost  0.225996723681
Pre-training layer 1, epoch 38, cost  0.22388161663
Pre-training layer 1, epoch 39, cost  0.221832300596
Pre-training layer 1, epoch 40, cost  0.219763050863
Pre-training layer 1, epoch 41, cost  0.21791786856
Pre-training layer 1, epoch 42, cost  0.216097946603
Pre-training layer 1, epoch 43, cost  0.214538177875
Pre-training layer 1, epoch 44, cost  0.212825967789
Pre-training layer 1, epoch 45, cost  0.211193952147
Pre-training layer 1, epoch 46, cost  0.209624131071
Pre-training layer 1, epoch 47, cost  0.208275393693
Pre-training layer 1, epoch 48, cost  0.206790227127
Pre-training layer 1, epoch 49, cost  0.205396380927
Pre-training layer 2, epoch 0, cost  4.80225353291
Pre-training layer 2, epoch 1, cost  1.41296041748
Pre-training layer 2, epoch 2, cost  1.07920563333
Pre-training layer 2, epoch 3, cost  0.911502835993
Pre-training layer 2, epoch 4, cost  0.810104543391
Pre-training layer 2, epoch 5, cost  0.753943711797
Pre-training layer 2, epoch 6, cost  0.692278367517
Pre-training layer 2, epoch 7, cost  0.66943184277
Pre-training layer 2, epoch 8, cost  0.634186142276
Pre-training layer 2, epoch 9, cost  0.605919102988
Pre-training layer 2, epoch 10, cost  0.588444716622
Pre-training layer 2, epoch 11, cost  0.579075052635
Pre-training layer 2, epoch 12, cost  0.557972804903
Pre-training layer 2, epoch 13, cost  0.544516706809
Pre-training layer 2, epoch 14, cost  0.535995211023
Pre-training layer 2, epoch 15, cost  0.525189983108
Pre-training layer 2, epoch 16, cost  0.51181438467
Pre-training layer 2, epoch 17, cost  0.510294694525
Pre-training layer 2, epoch 18, cost  0.4977891659
Pre-training layer 2, epoch 19, cost  0.499764111275
Pre-training layer 2, epoch 20, cost  0.485981128615
Pre-training layer 2, epoch 21, cost  0.480327512423
Pre-training layer 2, epoch 22, cost  0.478417258677
Pre-training layer 2, epoch 23, cost  0.477494929609
Pre-training layer 2, epoch 24, cost  0.473253510872
Pre-training layer 2, epoch 25, cost  0.467453405927
Pre-training layer 2, epoch 26, cost  0.464508558628
Pre-training layer 2, epoch 27, cost  0.461503317007
Pre-training layer 2, epoch 28, cost  0.456810658186
Pre-training layer 2, epoch 29, cost  0.453187685639
Pre-training layer 2, epoch 30, cost  0.452213306759
Pre-training layer 2, epoch 31, cost  0.450214713094
Pre-training layer 2, epoch 32, cost  0.445507263028
Pre-training layer 2, epoch 33, cost  0.446476690622
Pre-training layer 2, epoch 34, cost  0.44123615724
Pre-training layer 2, epoch 35, cost  0.442441726832
Pre-training layer 2, epoch 36, cost  0.438682055498
Pre-training layer 2, epoch 37, cost  0.436633789186
Pre-training layer 2, epoch 38, cost  0.437083899306
Pre-training layer 2, epoch 39, cost  0.435149804886
Pre-training layer 2, epoch 40, cost  0.432658042525
Pre-training layer 2, epoch 41, cost  0.431000704275
Pre-training layer 2, epoch 42, cost  0.429895520849
Pre-training layer 2, epoch 43, cost  0.428915886597
Pre-training layer 2, epoch 44, cost  0.428050438399
Pre-training layer 2, epoch 45, cost  0.427378650448
Pre-training layer 2, epoch 46, cost  0.426892424347
Pre-training layer 2, epoch 47, cost  0.42556835091
Pre-training layer 2, epoch 48, cost  0.424176159333
Pre-training layer 2, epoch 49, cost  0.423344573808
Pre-training layer 3, epoch 0, cost  3.6038791736
Pre-training layer 3, epoch 1, cost  0.698847312807
Pre-training layer 3, epoch 2, cost  0.442005741607
Pre-training layer 3, epoch 3, cost  0.31217232972
Pre-training layer 3, epoch 4, cost  0.241814799969
Pre-training layer 3, epoch 5, cost  0.19557434558
Pre-training layer 3, epoch 6, cost  0.165375980134
Pre-training layer 3, epoch 7, cost  0.144209448229
Pre-training layer 3, epoch 8, cost  0.12782994386
Pre-training layer 3, epoch 9, cost  0.115273588176
Pre-training layer 3, epoch 10, cost  0.104626245029
Pre-training layer 3, epoch 11, cost  0.0953926021585
Pre-training layer 3, epoch 12, cost  0.0889985091115
Pre-training layer 3, epoch 13, cost  0.0842473496522
Pre-training layer 3, epoch 14, cost  0.0781931558757
Pre-training layer 3, epoch 15, cost  0.0744166752363
Pre-training layer 3, epoch 16, cost  0.0700648523201
Pre-training layer 3, epoch 17, cost  0.0664585677134
Pre-training layer 3, epoch 18, cost  0.0630059375902
Pre-training layer 3, epoch 19, cost  0.0599779053959
Pre-training layer 3, epoch 20, cost  0.0575191317202
Pre-training layer 3, epoch 21, cost  0.0554060477096
Pre-training layer 3, epoch 22, cost  0.0535047281334
Pre-training layer 3, epoch 23, cost  0.0515274420441
Pre-training layer 3, epoch 24, cost  0.0494888887031
Pre-training layer 3, epoch 25, cost  0.0475154766153
Pre-training layer 3, epoch 26, cost  0.0458514814477
Pre-training layer 3, epoch 27, cost  0.044314598375
Pre-training layer 3, epoch 28, cost  0.0427433610477
Pre-training layer 3, epoch 29, cost  0.041395120562
Pre-training layer 3, epoch 30, cost  0.0400040496621
Pre-training layer 3, epoch 31, cost  0.0388001654755
Pre-training layer 3, epoch 32, cost  0.0375561322772
Pre-training layer 3, epoch 33, cost  0.036463315268
Pre-training layer 3, epoch 34, cost  0.0353989388269
Pre-training layer 3, epoch 35, cost  0.0343259081501
Pre-training layer 3, epoch 36, cost  0.0333735309045
Pre-training layer 3, epoch 37, cost  0.0324852035647
Pre-training layer 3, epoch 38, cost  0.0315788549821
Pre-training layer 3, epoch 39, cost  0.0307021732086
Pre-training layer 3, epoch 40, cost  0.0298529937172
Pre-training layer 3, epoch 41, cost  0.0290365550127
Pre-training layer 3, epoch 42, cost  0.0281732238016
Pre-training layer 3, epoch 43, cost  0.0272157756541
Pre-training layer 3, epoch 44, cost  0.026474877419
Pre-training layer 3, epoch 45, cost  0.0262187697948
Pre-training layer 3, epoch 46, cost  0.0260144017434
Pre-training layer 3, epoch 47, cost  0.025615857924
Pre-training layer 3, epoch 48, cost  0.0250183948386
Pre-training layer 3, epoch 49, cost  0.0241940882264
Pre-training layer 4, epoch 0, cost  4.22275769929
Pre-training layer 4, epoch 1, cost  1.16381789416
Pre-training layer 4, epoch 2, cost  0.960607121963
Pre-training layer 4, epoch 3, cost  0.924690839674
Pre-training layer 4, epoch 4, cost  0.907170015668
Pre-training layer 4, epoch 5, cost  0.89451217658
Pre-training layer 4, epoch 6, cost  0.885378698311
Pre-training layer 4, epoch 7, cost  0.878113856971
Pre-training layer 4, epoch 8, cost  0.872180348465
Pre-training layer 4, epoch 9, cost  0.867224589575
Pre-training layer 4, epoch 10, cost  0.863135803184
Pre-training layer 4, epoch 11, cost  0.859526152458
Pre-training layer 4, epoch 12, cost  0.856379407874
Pre-training layer 4, epoch 13, cost  0.853571722433
Pre-training layer 4, epoch 14, cost  0.851078589337
Pre-training layer 4, epoch 15, cost  0.848790831764
Pre-training layer 4, epoch 16, cost  0.846699325906
Pre-training layer 4, epoch 17, cost  0.844842223922
Pre-training layer 4, epoch 18, cost  0.843099986769
Pre-training layer 4, epoch 19, cost  0.841508623273
Pre-training layer 4, epoch 20, cost  0.840036787637
Pre-training layer 4, epoch 21, cost  0.83868656693
Pre-training layer 4, epoch 22, cost  0.837449105541
Pre-training layer 4, epoch 23, cost  0.836241833172
Pre-training layer 4, epoch 24, cost  0.835148143547
Pre-training layer 4, epoch 25, cost  0.834121797133
Pre-training layer 4, epoch 26, cost  0.833151318102
Pre-training layer 4, epoch 27, cost  0.832255491414
Pre-training layer 4, epoch 28, cost  0.831388100764
Pre-training layer 4, epoch 29, cost  0.830587297425
Pre-training layer 4, epoch 30, cost  0.829819663658
Pre-training layer 4, epoch 31, cost  0.829095020915
Pre-training layer 4, epoch 32, cost  0.828405377784
Pre-training layer 4, epoch 33, cost  0.827756058079
Pre-training layer 4, epoch 34, cost  0.827151919154
Pre-training layer 4, epoch 35, cost  0.826568332932
Pre-training layer 4, epoch 36, cost  0.826000181205
Pre-training layer 4, epoch 37, cost  0.825462854266
Pre-training layer 4, epoch 38, cost  0.824968357146
Pre-training layer 4, epoch 39, cost  0.824484351434
Pre-training layer 4, epoch 40, cost  0.824023631469
Pre-training layer 4, epoch 41, cost  0.823579794047
Pre-training layer 4, epoch 42, cost  0.823147447567
Pre-training layer 4, epoch 43, cost  0.822738130211
Pre-training layer 4, epoch 44, cost  0.822352576815
Pre-training layer 4, epoch 45, cost  0.821972075539
Pre-training layer 4, epoch 46, cost  0.821614797571
Pre-training layer 4, epoch 47, cost  0.821273451615
Pre-training layer 4, epoch 48, cost  0.820940882354
Pre-training layer 4, epoch 49, cost  0.820616357524
Pre-training layer 5, epoch 0, cost  5.44386571797
Pre-training layer 5, epoch 1, cost  3.4517453246
Pre-training layer 5, epoch 2, cost  3.43688689535
Pre-training layer 5, epoch 3, cost  3.43214919841
Pre-training layer 5, epoch 4, cost  3.42964949362
Pre-training layer 5, epoch 5, cost  3.42788947937
Pre-training layer 5, epoch 6, cost  3.4264502428
Pre-training layer 5, epoch 7, cost  3.42516948716
Pre-training layer 5, epoch 8, cost  3.423949986
Pre-training layer 5, epoch 9, cost  3.42271831118
Pre-training layer 5, epoch 10, cost  3.4213944998
Pre-training layer 5, epoch 11, cost  3.41989133261
Pre-training layer 5, epoch 12, cost  3.41809605877
Pre-training layer 5, epoch 13, cost  3.41586472823
Pre-training layer 5, epoch 14, cost  3.41298968957
Pre-training layer 5, epoch 15, cost  3.40916193362
Pre-training layer 5, epoch 16, cost  3.40392246728
Pre-training layer 5, epoch 17, cost  3.39667135114
Pre-training layer 5, epoch 18, cost  3.38723116646
Pre-training layer 5, epoch 19, cost  3.37747730317
Pre-training layer 5, epoch 20, cost  3.37064570909
Pre-training layer 5, epoch 21, cost  3.36686779875
Pre-training layer 5, epoch 22, cost  3.3645893593
Pre-training layer 5, epoch 23, cost  3.36301239472
Pre-training layer 5, epoch 24, cost  3.36182641032
Pre-training layer 5, epoch 25, cost  3.36088370042
Pre-training layer 5, epoch 26, cost  3.36010059475
Pre-training layer 5, epoch 27, cost  3.35943145522
Pre-training layer 5, epoch 28, cost  3.35884461277
Pre-training layer 5, epoch 29, cost  3.35832107134
Pre-training layer 5, epoch 30, cost  3.357846143
Pre-training layer 5, epoch 31, cost  3.35741257988
Pre-training layer 5, epoch 32, cost  3.35701145491
Pre-training layer 5, epoch 33, cost  3.35663806334
Pre-training layer 5, epoch 34, cost  3.35628887424
Pre-training layer 5, epoch 35, cost  3.355960828
Pre-training layer 5, epoch 36, cost  3.35565098719
Pre-training layer 5, epoch 37, cost  3.35535743585
Pre-training layer 5, epoch 38, cost  3.35507851272
Pre-training layer 5, epoch 39, cost  3.3548128813
Pre-training layer 5, epoch 40, cost  3.35455955107
Pre-training layer 5, epoch 41, cost  3.35431741148
Pre-training layer 5, epoch 42, cost  3.35408518362
Pre-training layer 5, epoch 43, cost  3.35386264472
Pre-training layer 5, epoch 44, cost  3.35364869346
Pre-training layer 5, epoch 45, cost  3.35344304098
Pre-training layer 5, epoch 46, cost  3.35324499651
Pre-training layer 5, epoch 47, cost  3.35305431219
Pre-training layer 5, epoch 48, cost  3.35287000622
The pretraining code for file multi_layer_km.pyc ran for 25.89m
Pre-training layer 5, epoch 49, cost  3.35269240795
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
ACC for deep clustering: 0.54
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.08068, Reconstruction: 1.76493, Clustering: 0.31575,
Fine-tuning epoch 2 ++++
Total cost: 1.61077, Reconstruction: 1.30181, Clustering: 0.30896,
Fine-tuning epoch 3 ++++
Total cost: 1.46456, Reconstruction: 1.17087, Clustering: 0.29368,
Fine-tuning epoch 4 ++++
Total cost: 1.37057, Reconstruction: 1.08950, Clustering: 0.28106,
Fine-tuning epoch 5 ++++
Total cost: 1.29571, Reconstruction: 1.02694, Clustering: 0.26877,
Fine-tuning epoch 6 ++++
Total cost: 1.25175, Reconstruction: 0.98949, Clustering: 0.26226,
Fine-tuning epoch 7 ++++
Total cost: 1.21547, Reconstruction: 0.95894, Clustering: 0.25653,
Fine-tuning epoch 8 ++++
Total cost: 1.18793, Reconstruction: 0.93553, Clustering: 0.25240,
Fine-tuning epoch 9 ++++
Total cost: 1.16285, Reconstruction: 0.91442, Clustering: 0.24843,
Fine-tuning epoch 10 ++++
Total cost: 1.14439, Reconstruction: 0.89871, Clustering: 0.24568,
Fine-tuning epoch 11 ++++
Total cost: 1.13019, Reconstruction: 0.88664, Clustering: 0.24355,
Fine-tuning epoch 12 ++++
Total cost: 1.10996, Reconstruction: 0.87022, Clustering: 0.23974,
Fine-tuning epoch 13 ++++
Total cost: 1.10132, Reconstruction: 0.86264, Clustering: 0.23868,
Fine-tuning epoch 14 ++++
Total cost: 1.08874, Reconstruction: 0.85193, Clustering: 0.23681,
Fine-tuning epoch 15 ++++
Total cost: 1.07974, Reconstruction: 0.84413, Clustering: 0.23561,
Fine-tuning epoch 16 ++++
Total cost: 1.06982, Reconstruction: 0.83615, Clustering: 0.23367,
Fine-tuning epoch 17 ++++
Total cost: 1.06513, Reconstruction: 0.83044, Clustering: 0.23469,
Fine-tuning epoch 18 ++++
Total cost: 1.05020, Reconstruction: 0.81964, Clustering: 0.23056,
Fine-tuning epoch 19 ++++
Total cost: 1.04179, Reconstruction: 0.81178, Clustering: 0.23002,
Fine-tuning epoch 20 ++++
Total cost: 1.03549, Reconstruction: 0.80621, Clustering: 0.22928,
Fine-tuning epoch 21 ++++
Total cost: 1.02743, Reconstruction: 0.79980, Clustering: 0.22764,
Fine-tuning epoch 22 ++++
Total cost: 1.01562, Reconstruction: 0.78903, Clustering: 0.22659,
Fine-tuning epoch 23 ++++
Total cost: 1.00802, Reconstruction: 0.78322, Clustering: 0.22480,
Fine-tuning epoch 24 ++++
Total cost: 1.00310, Reconstruction: 0.77815, Clustering: 0.22495,
Fine-tuning epoch 25 ++++
Total cost: 0.99471, Reconstruction: 0.77110, Clustering: 0.22361,
Fine-tuning epoch 26 ++++
Total cost: 0.98730, Reconstruction: 0.76451, Clustering: 0.22279,
Fine-tuning epoch 27 ++++
Total cost: 0.98424, Reconstruction: 0.76094, Clustering: 0.22331,
Fine-tuning epoch 28 ++++
Total cost: 0.97583, Reconstruction: 0.75401, Clustering: 0.22182,
Fine-tuning epoch 29 ++++
Total cost: 0.96758, Reconstruction: 0.74750, Clustering: 0.22008,
Fine-tuning epoch 30 ++++
Total cost: 0.96083, Reconstruction: 0.74151, Clustering: 0.21932,
Fine-tuning epoch 31 ++++
Total cost: 0.96014, Reconstruction: 0.73975, Clustering: 0.22039,
Fine-tuning epoch 32 ++++
Total cost: 0.95228, Reconstruction: 0.73355, Clustering: 0.21872,
Fine-tuning epoch 33 ++++
Total cost: 0.94537, Reconstruction: 0.72830, Clustering: 0.21707,
Fine-tuning epoch 34 ++++
Total cost: 0.94121, Reconstruction: 0.72466, Clustering: 0.21654,
Fine-tuning epoch 35 ++++
Total cost: 0.93743, Reconstruction: 0.72157, Clustering: 0.21586,
Fine-tuning epoch 36 ++++
Total cost: 0.92447, Reconstruction: 0.71129, Clustering: 0.21317,
Fine-tuning epoch 37 ++++
Total cost: 0.91800, Reconstruction: 0.70564, Clustering: 0.21236,
Fine-tuning epoch 38 ++++
Total cost: 0.91666, Reconstruction: 0.70348, Clustering: 0.21318,
Fine-tuning epoch 39 ++++
Total cost: 0.91051, Reconstruction: 0.69870, Clustering: 0.21182,
Fine-tuning epoch 40 ++++
Total cost: 0.90716, Reconstruction: 0.69485, Clustering: 0.21230,
Fine-tuning epoch 41 ++++
Total cost: 0.90395, Reconstruction: 0.69228, Clustering: 0.21167,
Fine-tuning epoch 42 ++++
Total cost: 0.89989, Reconstruction: 0.68941, Clustering: 0.21048,
Fine-tuning epoch 43 ++++
Total cost: 0.88867, Reconstruction: 0.68000, Clustering: 0.20867,
Fine-tuning epoch 44 ++++
Total cost: 0.88870, Reconstruction: 0.67960, Clustering: 0.20911,
Fine-tuning epoch 45 ++++
Total cost: 0.88349, Reconstruction: 0.67450, Clustering: 0.20899,
Fine-tuning epoch 46 ++++
Total cost: 0.88208, Reconstruction: 0.67322, Clustering: 0.20885,
Fine-tuning epoch 47 ++++
Total cost: 0.87693, Reconstruction: 0.66926, Clustering: 0.20767,
Fine-tuning epoch 48 ++++
Total cost: 0.87474, Reconstruction: 0.66731, Clustering: 0.20743,
Fine-tuning epoch 49 ++++
Total cost: 0.87175, Reconstruction: 0.66323, Clustering: 0.20851,
Fine-tuning epoch 50 ++++
Total cost: 0.86376, Reconstruction: 0.65724, Clustering: 0.20652,
Average squared 2-D reconstruction error: 0.6572
NMI for deep clustering: 0.60
ARI for deep clustering: 0.43
ACC for deep clustering: 0.57
The training code for file multi_layer_km.pyc ran for 24.11m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.12805751871
Pre-training layer 0, epoch 1, cost  0.97913921109
Pre-training layer 0, epoch 2, cost  0.788028599394
Pre-training layer 0, epoch 3, cost  0.700159430765
Pre-training layer 0, epoch 4, cost  0.646711777484
Pre-training layer 0, epoch 5, cost  0.609075019341
Pre-training layer 0, epoch 6, cost  0.580449675357
Pre-training layer 0, epoch 7, cost  0.557512483581
Pre-training layer 0, epoch 8, cost  0.538552232686
Pre-training layer 0, epoch 9, cost  0.522337924166
Pre-training layer 0, epoch 10, cost  0.508402983484
Pre-training layer 0, epoch 11, cost  0.496265566011
Pre-training layer 0, epoch 12, cost  0.4854756965
Pre-training layer 0, epoch 13, cost  0.475782223943
Pre-training layer 0, epoch 14, cost  0.467033115115
Pre-training layer 0, epoch 15, cost  0.459046573769
Pre-training layer 0, epoch 16, cost  0.451706335579
Pre-training layer 0, epoch 17, cost  0.444939672735
Pre-training layer 0, epoch 18, cost  0.438682922684
Pre-training layer 0, epoch 19, cost  0.432889678867
Pre-training layer 0, epoch 20, cost  0.427440899725
Pre-training layer 0, epoch 21, cost  0.42234821413
Pre-training layer 0, epoch 22, cost  0.417547148428
Pre-training layer 0, epoch 23, cost  0.413032645292
Pre-training layer 0, epoch 24, cost  0.408769946212
Pre-training layer 0, epoch 25, cost  0.404741541818
Pre-training layer 0, epoch 26, cost  0.400910051404
Pre-training layer 0, epoch 27, cost  0.397253573128
Pre-training layer 0, epoch 28, cost  0.393771132704
Pre-training layer 0, epoch 29, cost  0.390465191715
Pre-training layer 0, epoch 30, cost  0.387295374138
Pre-training layer 0, epoch 31, cost  0.384259595103
Pre-training layer 0, epoch 32, cost  0.381379617924
Pre-training layer 0, epoch 33, cost  0.378618773211
Pre-training layer 0, epoch 34, cost  0.375982532166
Pre-training layer 0, epoch 35, cost  0.373451223061
Pre-training layer 0, epoch 36, cost  0.371024660486
Pre-training layer 0, epoch 37, cost  0.368690235479
Pre-training layer 0, epoch 38, cost  0.366440635296
Pre-training layer 0, epoch 39, cost  0.364285664304
Pre-training layer 0, epoch 40, cost  0.362194829669
Pre-training layer 0, epoch 41, cost  0.360178567342
Pre-training layer 0, epoch 42, cost  0.358235572144
Pre-training layer 0, epoch 43, cost  0.356352799153
Pre-training layer 0, epoch 44, cost  0.354544691607
Pre-training layer 0, epoch 45, cost  0.352777884395
Pre-training layer 0, epoch 46, cost  0.351061668778
Pre-training layer 0, epoch 47, cost  0.349410255558
Pre-training layer 0, epoch 48, cost  0.347812026237
Pre-training layer 0, epoch 49, cost  0.346249414795
Pre-training layer 1, epoch 0, cost  3.87697623631
Pre-training layer 1, epoch 1, cost  1.02439802007
Pre-training layer 1, epoch 2, cost  0.741213808429
Pre-training layer 1, epoch 3, cost  0.619814098242
Pre-training layer 1, epoch 4, cost  0.549176157734
Pre-training layer 1, epoch 5, cost  0.502026916173
Pre-training layer 1, epoch 6, cost  0.465533071184
Pre-training layer 1, epoch 7, cost  0.437277242512
Pre-training layer 1, epoch 8, cost  0.413969934709
Pre-training layer 1, epoch 9, cost  0.394338677046
Pre-training layer 1, epoch 10, cost  0.378183259202
Pre-training layer 1, epoch 11, cost  0.363687674447
Pre-training layer 1, epoch 12, cost  0.350800015849
Pre-training layer 1, epoch 13, cost  0.339578283882
Pre-training layer 1, epoch 14, cost  0.329117406798
Pre-training layer 1, epoch 15, cost  0.319839300073
Pre-training layer 1, epoch 16, cost  0.311824092669
Pre-training layer 1, epoch 17, cost  0.30439387307
Pre-training layer 1, epoch 18, cost  0.297028845887
Pre-training layer 1, epoch 19, cost  0.29078888031
Pre-training layer 1, epoch 20, cost  0.285048036551
Pre-training layer 1, epoch 21, cost  0.279697471872
Pre-training layer 1, epoch 22, cost  0.274449376315
Pre-training layer 1, epoch 23, cost  0.269671117949
Pre-training layer 1, epoch 24, cost  0.265011323125
Pre-training layer 1, epoch 25, cost  0.260709662808
Pre-training layer 1, epoch 26, cost  0.257145604236
Pre-training layer 1, epoch 27, cost  0.253133711762
Pre-training layer 1, epoch 28, cost  0.249857113004
Pre-training layer 1, epoch 29, cost  0.246539735407
Pre-training layer 1, epoch 30, cost  0.243172612353
Pre-training layer 1, epoch 31, cost  0.240457207547
Pre-training layer 1, epoch 32, cost  0.237429129188
Pre-training layer 1, epoch 33, cost  0.234861605221
Pre-training layer 1, epoch 34, cost  0.232115144693
Pre-training layer 1, epoch 35, cost  0.229884101791
Pre-training layer 1, epoch 36, cost  0.227393106783
Pre-training layer 1, epoch 37, cost  0.224953464348
Pre-training layer 1, epoch 38, cost  0.223035433
Pre-training layer 1, epoch 39, cost  0.221145795373
Pre-training layer 1, epoch 40, cost  0.218847017919
Pre-training layer 1, epoch 41, cost  0.217225456538
Pre-training layer 1, epoch 42, cost  0.215175504607
Pre-training layer 1, epoch 43, cost  0.213530813489
Pre-training layer 1, epoch 44, cost  0.212367576183
Pre-training layer 1, epoch 45, cost  0.210153967116
Pre-training layer 1, epoch 46, cost  0.208651054805
Pre-training layer 1, epoch 47, cost  0.207149162028
Pre-training layer 1, epoch 48, cost  0.205782262742
Pre-training layer 1, epoch 49, cost  0.204413081943
Pre-training layer 2, epoch 0, cost  4.82335488214
Pre-training layer 2, epoch 1, cost  1.41778357044
Pre-training layer 2, epoch 2, cost  1.0781170282
Pre-training layer 2, epoch 3, cost  0.914656735662
Pre-training layer 2, epoch 4, cost  0.820594135782
Pre-training layer 2, epoch 5, cost  0.749621177652
Pre-training layer 2, epoch 6, cost  0.699674799456
Pre-training layer 2, epoch 7, cost  0.661451745714
Pre-training layer 2, epoch 8, cost  0.638041329628
Pre-training layer 2, epoch 9, cost  0.615045606957
Pre-training layer 2, epoch 10, cost  0.599831018829
Pre-training layer 2, epoch 11, cost  0.574443616159
Pre-training layer 2, epoch 12, cost  0.569948829341
Pre-training layer 2, epoch 13, cost  0.5493584299
Pre-training layer 2, epoch 14, cost  0.539388705864
Pre-training layer 2, epoch 15, cost  0.530195954397
Pre-training layer 2, epoch 16, cost  0.517941178762
Pre-training layer 2, epoch 17, cost  0.514328185646
Pre-training layer 2, epoch 18, cost  0.5100040804
Pre-training layer 2, epoch 19, cost  0.496372827834
Pre-training layer 2, epoch 20, cost  0.497173730855
Pre-training layer 2, epoch 21, cost  0.489540225431
Pre-training layer 2, epoch 22, cost  0.483208164643
Pre-training layer 2, epoch 23, cost  0.47893056845
Pre-training layer 2, epoch 24, cost  0.474712352507
Pre-training layer 2, epoch 25, cost  0.472261665228
Pre-training layer 2, epoch 26, cost  0.469544902206
Pre-training layer 2, epoch 27, cost  0.466465259524
Pre-training layer 2, epoch 28, cost  0.462809003992
Pre-training layer 2, epoch 29, cost  0.459022462295
Pre-training layer 2, epoch 30, cost  0.457719754361
Pre-training layer 2, epoch 31, cost  0.454962251471
Pre-training layer 2, epoch 32, cost  0.452094851748
Pre-training layer 2, epoch 33, cost  0.450478319267
Pre-training layer 2, epoch 34, cost  0.448875912487
Pre-training layer 2, epoch 35, cost  0.445333607765
Pre-training layer 2, epoch 36, cost  0.445521906592
Pre-training layer 2, epoch 37, cost  0.443283018999
Pre-training layer 2, epoch 38, cost  0.440985905464
Pre-training layer 2, epoch 39, cost  0.439714200084
Pre-training layer 2, epoch 40, cost  0.438722772426
Pre-training layer 2, epoch 41, cost  0.438234436161
Pre-training layer 2, epoch 42, cost  0.437692166487
Pre-training layer 2, epoch 43, cost  0.435578555712
Pre-training layer 2, epoch 44, cost  0.4345012315
Pre-training layer 2, epoch 45, cost  0.433413987257
Pre-training layer 2, epoch 46, cost  0.43231315536
Pre-training layer 2, epoch 47, cost  0.431275203973
Pre-training layer 2, epoch 48, cost  0.430281681849
Pre-training layer 2, epoch 49, cost  0.429284265723
Pre-training layer 3, epoch 0, cost  3.59898563767
Pre-training layer 3, epoch 1, cost  0.70217801339
Pre-training layer 3, epoch 2, cost  0.44207622193
Pre-training layer 3, epoch 3, cost  0.31466044626
Pre-training layer 3, epoch 4, cost  0.240018347982
Pre-training layer 3, epoch 5, cost  0.19076350728
Pre-training layer 3, epoch 6, cost  0.162486393945
Pre-training layer 3, epoch 7, cost  0.142023831339
Pre-training layer 3, epoch 8, cost  0.124622670432
Pre-training layer 3, epoch 9, cost  0.111717063296
Pre-training layer 3, epoch 10, cost  0.1027741989
Pre-training layer 3, epoch 11, cost  0.0959191598994
Pre-training layer 3, epoch 12, cost  0.0891766450243
Pre-training layer 3, epoch 13, cost  0.0824080041325
Pre-training layer 3, epoch 14, cost  0.07825894416
Pre-training layer 3, epoch 15, cost  0.0735090284222
Pre-training layer 3, epoch 16, cost  0.0698947154843
Pre-training layer 3, epoch 17, cost  0.0662901891553
Pre-training layer 3, epoch 18, cost  0.0632050196896
Pre-training layer 3, epoch 19, cost  0.0604534414672
Pre-training layer 3, epoch 20, cost  0.0579124895169
Pre-training layer 3, epoch 21, cost  0.0554881358245
Pre-training layer 3, epoch 22, cost  0.0530924501879
Pre-training layer 3, epoch 23, cost  0.0508213044928
Pre-training layer 3, epoch 24, cost  0.0490622059603
Pre-training layer 3, epoch 25, cost  0.0476506261543
Pre-training layer 3, epoch 26, cost  0.0460855247897
Pre-training layer 3, epoch 27, cost  0.0443117957674
Pre-training layer 3, epoch 28, cost  0.0428312642417
Pre-training layer 3, epoch 29, cost  0.041504198788
Pre-training layer 3, epoch 30, cost  0.0401193884041
Pre-training layer 3, epoch 31, cost  0.0389085809761
Pre-training layer 3, epoch 32, cost  0.0376823179188
Pre-training layer 3, epoch 33, cost  0.0365878722328
Pre-training layer 3, epoch 34, cost  0.0354958492178
Pre-training layer 3, epoch 35, cost  0.0344854332362
Pre-training layer 3, epoch 36, cost  0.0335166561012
Pre-training layer 3, epoch 37, cost  0.0325881826805
Pre-training layer 3, epoch 38, cost  0.0317132454948
Pre-training layer 3, epoch 39, cost  0.030879024815
Pre-training layer 3, epoch 40, cost  0.0300843410649
Pre-training layer 3, epoch 41, cost  0.0292768053407
Pre-training layer 3, epoch 42, cost  0.0284668019575
Pre-training layer 3, epoch 43, cost  0.027584715958
Pre-training layer 3, epoch 44, cost  0.0266270851731
Pre-training layer 3, epoch 45, cost  0.0258123242913
Pre-training layer 3, epoch 46, cost  0.0253507456656
Pre-training layer 3, epoch 47, cost  0.0250284149844
Pre-training layer 3, epoch 48, cost  0.0246292998107
Pre-training layer 3, epoch 49, cost  0.0241318443134
Pre-training layer 4, epoch 0, cost  4.214518449
Pre-training layer 4, epoch 1, cost  1.16600113626
Pre-training layer 4, epoch 2, cost  0.96656395147
Pre-training layer 4, epoch 3, cost  0.930032201465
Pre-training layer 4, epoch 4, cost  0.91240712131
Pre-training layer 4, epoch 5, cost  0.899860023704
Pre-training layer 4, epoch 6, cost  0.890639879868
Pre-training layer 4, epoch 7, cost  0.883356371183
Pre-training layer 4, epoch 8, cost  0.877358865259
Pre-training layer 4, epoch 9, cost  0.872317459019
Pre-training layer 4, epoch 10, cost  0.868057090942
Pre-training layer 4, epoch 11, cost  0.864428780795
Pre-training layer 4, epoch 12, cost  0.861139308114
Pre-training layer 4, epoch 13, cost  0.858270937205
Pre-training layer 4, epoch 14, cost  0.855755621651
Pre-training layer 4, epoch 15, cost  0.853438910786
Pre-training layer 4, epoch 16, cost  0.851374613504
Pre-training layer 4, epoch 17, cost  0.84949085427
Pre-training layer 4, epoch 18, cost  0.847734548735
Pre-training layer 4, epoch 19, cost  0.846166591422
Pre-training layer 4, epoch 20, cost  0.844672824735
Pre-training layer 4, epoch 21, cost  0.843272585954
Pre-training layer 4, epoch 22, cost  0.842008809662
Pre-training layer 4, epoch 23, cost  0.840865545089
Pre-training layer 4, epoch 24, cost  0.839729297287
Pre-training layer 4, epoch 25, cost  0.838737682876
Pre-training layer 4, epoch 26, cost  0.837755578073
Pre-training layer 4, epoch 27, cost  0.836847189967
Pre-training layer 4, epoch 28, cost  0.835982413298
Pre-training layer 4, epoch 29, cost  0.835189429769
Pre-training layer 4, epoch 30, cost  0.834426401271
Pre-training layer 4, epoch 31, cost  0.833708845556
Pre-training layer 4, epoch 32, cost  0.833017429955
Pre-training layer 4, epoch 33, cost  0.832349580094
Pre-training layer 4, epoch 34, cost  0.831757352804
Pre-training layer 4, epoch 35, cost  0.831178068541
Pre-training layer 4, epoch 36, cost  0.830620696012
Pre-training layer 4, epoch 37, cost  0.830074879532
Pre-training layer 4, epoch 38, cost  0.829587493617
Pre-training layer 4, epoch 39, cost  0.829090507871
Pre-training layer 4, epoch 40, cost  0.828631931924
Pre-training layer 4, epoch 41, cost  0.82819358335
Pre-training layer 4, epoch 42, cost  0.827777859984
Pre-training layer 4, epoch 43, cost  0.827362678126
Pre-training layer 4, epoch 44, cost  0.826993259038
Pre-training layer 4, epoch 45, cost  0.826616417833
Pre-training layer 4, epoch 46, cost  0.826269324558
Pre-training layer 4, epoch 47, cost  0.825912203443
Pre-training layer 4, epoch 48, cost  0.82558243911
Pre-training layer 4, epoch 49, cost  0.825271759879
Pre-training layer 5, epoch 0, cost  5.44038359028
Pre-training layer 5, epoch 1, cost  3.45113839105
Pre-training layer 5, epoch 2, cost  3.43552460586
Pre-training layer 5, epoch 3, cost  3.4291862071
Pre-training layer 5, epoch 4, cost  3.42581645442
Pre-training layer 5, epoch 5, cost  3.42367817463
Pre-training layer 5, epoch 6, cost  3.42209565182
Pre-training layer 5, epoch 7, cost  3.42080773743
Pre-training layer 5, epoch 8, cost  3.41967826253
Pre-training layer 5, epoch 9, cost  3.41863010237
Pre-training layer 5, epoch 10, cost  3.41759974105
Pre-training layer 5, epoch 11, cost  3.41653675619
Pre-training layer 5, epoch 12, cost  3.41538672469
Pre-training layer 5, epoch 13, cost  3.41409045493
Pre-training layer 5, epoch 14, cost  3.41256884809
Pre-training layer 5, epoch 15, cost  3.41071281131
Pre-training layer 5, epoch 16, cost  3.40836389157
Pre-training layer 5, epoch 17, cost  3.40528567819
Pre-training layer 5, epoch 18, cost  3.40111200964
Pre-training layer 5, epoch 19, cost  3.39535617543
Pre-training layer 5, epoch 20, cost  3.38769129116
Pre-training layer 5, epoch 21, cost  3.3790300949
Pre-training layer 5, epoch 22, cost  3.37201724488
Pre-training layer 5, epoch 23, cost  3.36783282853
Pre-training layer 5, epoch 24, cost  3.36534348388
Pre-training layer 5, epoch 25, cost  3.36364372297
Pre-training layer 5, epoch 26, cost  3.36236590685
Pre-training layer 5, epoch 27, cost  3.36134466654
Pre-training layer 5, epoch 28, cost  3.36049091234
Pre-training layer 5, epoch 29, cost  3.3597548393
Pre-training layer 5, epoch 30, cost  3.35910334885
Pre-training layer 5, epoch 31, cost  3.35851739967
Pre-training layer 5, epoch 32, cost  3.357980831
Pre-training layer 5, epoch 33, cost  3.35748502437
Pre-training layer 5, epoch 34, cost  3.3570234864
Pre-training layer 5, epoch 35, cost  3.3565907157
Pre-training layer 5, epoch 36, cost  3.35618200087
Pre-training layer 5, epoch 37, cost  3.35579523179
Pre-training layer 5, epoch 38, cost  3.3554275987
Pre-training layer 5, epoch 39, cost  3.35507713128
Pre-training layer 5, epoch 40, cost  3.354741969
Pre-training layer 5, epoch 41, cost  3.35442139711
Pre-training layer 5, epoch 42, cost  3.35411342364
Pre-training layer 5, epoch 43, cost  3.35381794715
Pre-training layer 5, epoch 44, cost  3.35353383116
Pre-training layer 5, epoch 45, cost  3.35326046051
Pre-training layer 5, epoch 46, cost  3.35299724568
Pre-training layer 5, epoch 47, cost  3.35274382315
Pre-training layer 5, epoch 48, cost  3.35249935191
The pretraining code for file multi_layer_km.pyc ran for 25.77m
Pre-training layer 5, epoch 49, cost  3.35226397175
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
... getting the finetuning functions
ACC for deep clustering: 0.53
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 3.82627, Reconstruction: 3.61724, Clustering: 0.20903,
Fine-tuning epoch 2 ++++
Total cost: 1.84010, Reconstruction: 1.61291, Clustering: 0.22719,
Fine-tuning epoch 3 ++++
Total cost: 1.61625, Reconstruction: 1.35926, Clustering: 0.25699,
Fine-tuning epoch 4 ++++
Total cost: 1.49346, Reconstruction: 1.23588, Clustering: 0.25758,
Fine-tuning epoch 5 ++++
Total cost: 1.40358, Reconstruction: 1.15321, Clustering: 0.25037,
Fine-tuning epoch 6 ++++
Total cost: 1.34506, Reconstruction: 1.09572, Clustering: 0.24934,
Fine-tuning epoch 7 ++++
Total cost: 1.29448, Reconstruction: 1.04853, Clustering: 0.24594,
Fine-tuning epoch 8 ++++
Total cost: 1.25828, Reconstruction: 1.01554, Clustering: 0.24273,
Fine-tuning epoch 9 ++++
Total cost: 1.22864, Reconstruction: 0.98933, Clustering: 0.23931,
Fine-tuning epoch 10 ++++
Total cost: 1.20288, Reconstruction: 0.96647, Clustering: 0.23640,
Fine-tuning epoch 11 ++++
Total cost: 1.18340, Reconstruction: 0.94929, Clustering: 0.23411,
Fine-tuning epoch 12 ++++
Total cost: 1.16272, Reconstruction: 0.93071, Clustering: 0.23200,
Fine-tuning epoch 13 ++++
Total cost: 1.14468, Reconstruction: 0.91383, Clustering: 0.23086,
Fine-tuning epoch 14 ++++
Total cost: 1.12898, Reconstruction: 0.89901, Clustering: 0.22996,
Fine-tuning epoch 15 ++++
Total cost: 1.11095, Reconstruction: 0.88309, Clustering: 0.22786,
Fine-tuning epoch 16 ++++
Total cost: 1.09530, Reconstruction: 0.86905, Clustering: 0.22624,
Fine-tuning epoch 17 ++++
Total cost: 1.08213, Reconstruction: 0.85688, Clustering: 0.22525,
Fine-tuning epoch 18 ++++
Total cost: 1.06958, Reconstruction: 0.84595, Clustering: 0.22363,
Fine-tuning epoch 19 ++++
Total cost: 1.06173, Reconstruction: 0.83882, Clustering: 0.22291,
Fine-tuning epoch 20 ++++
Total cost: 1.05098, Reconstruction: 0.82867, Clustering: 0.22231,
Fine-tuning epoch 21 ++++
Total cost: 1.04246, Reconstruction: 0.82129, Clustering: 0.22117,
Fine-tuning epoch 22 ++++
Total cost: 1.03270, Reconstruction: 0.81255, Clustering: 0.22016,
Fine-tuning epoch 23 ++++
Total cost: 1.02748, Reconstruction: 0.80723, Clustering: 0.22025,
Fine-tuning epoch 24 ++++
Total cost: 1.02064, Reconstruction: 0.80112, Clustering: 0.21952,
Fine-tuning epoch 25 ++++
Total cost: 1.00926, Reconstruction: 0.79144, Clustering: 0.21781,
Fine-tuning epoch 26 ++++
Total cost: 1.00396, Reconstruction: 0.78601, Clustering: 0.21795,
Fine-tuning epoch 27 ++++
Total cost: 0.99568, Reconstruction: 0.77888, Clustering: 0.21680,
Fine-tuning epoch 28 ++++
Total cost: 0.98721, Reconstruction: 0.77172, Clustering: 0.21549,
Fine-tuning epoch 29 ++++
Total cost: 0.97959, Reconstruction: 0.76568, Clustering: 0.21391,
Fine-tuning epoch 30 ++++
Total cost: 0.96896, Reconstruction: 0.75676, Clustering: 0.21220,
Fine-tuning epoch 31 ++++
Total cost: 0.96647, Reconstruction: 0.75417, Clustering: 0.21230,
Fine-tuning epoch 32 ++++
Total cost: 0.96121, Reconstruction: 0.74869, Clustering: 0.21252,
Fine-tuning epoch 33 ++++
Total cost: 0.95668, Reconstruction: 0.74487, Clustering: 0.21181,
Fine-tuning epoch 34 ++++
Total cost: 0.94834, Reconstruction: 0.73780, Clustering: 0.21054,
Fine-tuning epoch 35 ++++
Total cost: 0.94880, Reconstruction: 0.73669, Clustering: 0.21211,
Fine-tuning epoch 36 ++++
Total cost: 0.94420, Reconstruction: 0.73168, Clustering: 0.21252,
Fine-tuning epoch 37 ++++
Total cost: 0.93665, Reconstruction: 0.72644, Clustering: 0.21021,
Fine-tuning epoch 38 ++++
Total cost: 0.93374, Reconstruction: 0.72404, Clustering: 0.20970,
Fine-tuning epoch 39 ++++
Total cost: 0.92742, Reconstruction: 0.71820, Clustering: 0.20923,
Fine-tuning epoch 40 ++++
Total cost: 0.92351, Reconstruction: 0.71443, Clustering: 0.20908,
Fine-tuning epoch 41 ++++
Total cost: 0.91370, Reconstruction: 0.70635, Clustering: 0.20736,
Fine-tuning epoch 42 ++++
Total cost: 0.91488, Reconstruction: 0.70712, Clustering: 0.20777,
Fine-tuning epoch 43 ++++
Total cost: 0.90818, Reconstruction: 0.70155, Clustering: 0.20663,
Fine-tuning epoch 44 ++++
Total cost: 0.90529, Reconstruction: 0.69858, Clustering: 0.20671,
Fine-tuning epoch 45 ++++
Total cost: 0.89615, Reconstruction: 0.69178, Clustering: 0.20436,
Fine-tuning epoch 46 ++++
Total cost: 0.89297, Reconstruction: 0.68814, Clustering: 0.20483,
Fine-tuning epoch 47 ++++
Total cost: 0.89315, Reconstruction: 0.68786, Clustering: 0.20529,
Fine-tuning epoch 48 ++++
Total cost: 0.88029, Reconstruction: 0.67843, Clustering: 0.20186,
Fine-tuning epoch 49 ++++
Total cost: 0.88196, Reconstruction: 0.67734, Clustering: 0.20462,
Fine-tuning epoch 50 ++++
Total cost: 0.87545, Reconstruction: 0.67242, Clustering: 0.20303,
Average squared 2-D reconstruction error: 0.6724
NMI for deep clustering: 0.57
ARI for deep clustering: 0.41
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 24.26m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.12264215519
Pre-training layer 0, epoch 1, cost  0.975544508037
Pre-training layer 0, epoch 2, cost  0.784571215954
Pre-training layer 0, epoch 3, cost  0.697744364389
Pre-training layer 0, epoch 4, cost  0.644379454926
Pre-training layer 0, epoch 5, cost  0.60667004832
Pre-training layer 0, epoch 6, cost  0.577820425949
Pre-training layer 0, epoch 7, cost  0.554939088228
Pre-training layer 0, epoch 8, cost  0.535966552699
Pre-training layer 0, epoch 9, cost  0.519643698304
Pre-training layer 0, epoch 10, cost  0.505561207996
Pre-training layer 0, epoch 11, cost  0.493201333242
Pre-training layer 0, epoch 12, cost  0.482287365143
Pre-training layer 0, epoch 13, cost  0.472474966122
Pre-training layer 0, epoch 14, cost  0.463612599491
Pre-training layer 0, epoch 15, cost  0.455563979862
Pre-training layer 0, epoch 16, cost  0.448141198467
Pre-training layer 0, epoch 17, cost  0.441316743745
Pre-training layer 0, epoch 18, cost  0.435026895666
Pre-training layer 0, epoch 19, cost  0.429199879492
Pre-training layer 0, epoch 20, cost  0.423770720212
Pre-training layer 0, epoch 21, cost  0.41868873626
Pre-training layer 0, epoch 22, cost  0.41392460498
Pre-training layer 0, epoch 23, cost  0.409470724081
Pre-training layer 0, epoch 24, cost  0.405272008604
Pre-training layer 0, epoch 25, cost  0.401303567407
Pre-training layer 0, epoch 26, cost  0.39753250595
Pre-training layer 0, epoch 27, cost  0.393966377947
Pre-training layer 0, epoch 28, cost  0.390558824622
Pre-training layer 0, epoch 29, cost  0.387329560451
Pre-training layer 0, epoch 30, cost  0.38423452649
Pre-training layer 0, epoch 31, cost  0.381280316595
Pre-training layer 0, epoch 32, cost  0.37845285245
Pre-training layer 0, epoch 33, cost  0.375753600325
Pre-training layer 0, epoch 34, cost  0.373159385339
Pre-training layer 0, epoch 35, cost  0.370672621631
Pre-training layer 0, epoch 36, cost  0.368282856779
Pre-training layer 0, epoch 37, cost  0.365973620495
Pre-training layer 0, epoch 38, cost  0.36376105759
Pre-training layer 0, epoch 39, cost  0.361610141886
Pre-training layer 0, epoch 40, cost  0.359547142386
Pre-training layer 0, epoch 41, cost  0.357537589341
Pre-training layer 0, epoch 42, cost  0.355608979559
Pre-training layer 0, epoch 43, cost  0.353742399931
Pre-training layer 0, epoch 44, cost  0.351929178253
Pre-training layer 0, epoch 45, cost  0.350171043828
Pre-training layer 0, epoch 46, cost  0.348454898466
Pre-training layer 0, epoch 47, cost  0.346791689109
Pre-training layer 0, epoch 48, cost  0.345174807302
Pre-training layer 0, epoch 49, cost  0.34360332079
Pre-training layer 1, epoch 0, cost  3.86945180603
Pre-training layer 1, epoch 1, cost  1.01578863864
Pre-training layer 1, epoch 2, cost  0.734309260297
Pre-training layer 1, epoch 3, cost  0.613980349837
Pre-training layer 1, epoch 4, cost  0.54473017028
Pre-training layer 1, epoch 5, cost  0.497687092494
Pre-training layer 1, epoch 6, cost  0.462519233141
Pre-training layer 1, epoch 7, cost  0.434750991202
Pre-training layer 1, epoch 8, cost  0.411637681179
Pre-training layer 1, epoch 9, cost  0.39278609939
Pre-training layer 1, epoch 10, cost  0.37647273806
Pre-training layer 1, epoch 11, cost  0.362270134232
Pre-training layer 1, epoch 12, cost  0.348929228018
Pre-training layer 1, epoch 13, cost  0.338418049581
Pre-training layer 1, epoch 14, cost  0.327990656552
Pre-training layer 1, epoch 15, cost  0.318941416099
Pre-training layer 1, epoch 16, cost  0.310801511499
Pre-training layer 1, epoch 17, cost  0.30349881345
Pre-training layer 1, epoch 18, cost  0.296610240482
Pre-training layer 1, epoch 19, cost  0.290126578797
Pre-training layer 1, epoch 20, cost  0.284481386194
Pre-training layer 1, epoch 21, cost  0.278675062501
Pre-training layer 1, epoch 22, cost  0.27410108645
Pre-training layer 1, epoch 23, cost  0.269029859535
Pre-training layer 1, epoch 24, cost  0.264416450483
Pre-training layer 1, epoch 25, cost  0.260725140152
Pre-training layer 1, epoch 26, cost  0.25679822919
Pre-training layer 1, epoch 27, cost  0.252634904275
Pre-training layer 1, epoch 28, cost  0.249406952841
Pre-training layer 1, epoch 29, cost  0.246246398452
Pre-training layer 1, epoch 30, cost  0.243189169189
Pre-training layer 1, epoch 31, cost  0.239929940892
Pre-training layer 1, epoch 32, cost  0.237527920451
Pre-training layer 1, epoch 33, cost  0.234142292921
Pre-training layer 1, epoch 34, cost  0.232093616706
Pre-training layer 1, epoch 35, cost  0.229529596914
Pre-training layer 1, epoch 36, cost  0.227194210713
Pre-training layer 1, epoch 37, cost  0.224797784963
Pre-training layer 1, epoch 38, cost  0.22333106015
Pre-training layer 1, epoch 39, cost  0.220786835169
Pre-training layer 1, epoch 40, cost  0.21884028744
Pre-training layer 1, epoch 41, cost  0.216760508626
Pre-training layer 1, epoch 42, cost  0.215233189332
Pre-training layer 1, epoch 43, cost  0.213547603839
Pre-training layer 1, epoch 44, cost  0.211890463365
Pre-training layer 1, epoch 45, cost  0.210501571091
Pre-training layer 1, epoch 46, cost  0.208896395287
Pre-training layer 1, epoch 47, cost  0.207463036089
Pre-training layer 1, epoch 48, cost  0.205968565832
Pre-training layer 1, epoch 49, cost  0.204613010763
Pre-training layer 2, epoch 0, cost  4.82893930971
Pre-training layer 2, epoch 1, cost  1.40815103869
Pre-training layer 2, epoch 2, cost  1.07175344508
Pre-training layer 2, epoch 3, cost  0.910916366685
Pre-training layer 2, epoch 4, cost  0.817716181067
Pre-training layer 2, epoch 5, cost  0.733029544498
Pre-training layer 2, epoch 6, cost  0.702972325437
Pre-training layer 2, epoch 7, cost  0.652221245853
Pre-training layer 2, epoch 8, cost  0.630943273983
Pre-training layer 2, epoch 9, cost  0.610699076806
Pre-training layer 2, epoch 10, cost  0.595147923559
Pre-training layer 2, epoch 11, cost  0.563662130068
Pre-training layer 2, epoch 12, cost  0.561618040074
Pre-training layer 2, epoch 13, cost  0.546732371473
Pre-training layer 2, epoch 14, cost  0.532608167459
Pre-training layer 2, epoch 15, cost  0.519212646755
Pre-training layer 2, epoch 16, cost  0.513805157618
Pre-training layer 2, epoch 17, cost  0.510552454121
Pre-training layer 2, epoch 18, cost  0.496972802019
Pre-training layer 2, epoch 19, cost  0.495482193446
Pre-training layer 2, epoch 20, cost  0.483280627058
Pre-training layer 2, epoch 21, cost  0.484639188971
Pre-training layer 2, epoch 22, cost  0.478721770625
Pre-training layer 2, epoch 23, cost  0.472219392599
Pre-training layer 2, epoch 24, cost  0.467147743068
Pre-training layer 2, epoch 25, cost  0.464332553289
Pre-training layer 2, epoch 26, cost  0.461345520276
Pre-training layer 2, epoch 27, cost  0.460550312134
Pre-training layer 2, epoch 28, cost  0.456220600576
Pre-training layer 2, epoch 29, cost  0.453037605257
Pre-training layer 2, epoch 30, cost  0.451048166549
Pre-training layer 2, epoch 31, cost  0.448317587564
Pre-training layer 2, epoch 32, cost  0.445521003482
Pre-training layer 2, epoch 33, cost  0.443714088783
Pre-training layer 2, epoch 34, cost  0.441321832107
Pre-training layer 2, epoch 35, cost  0.43958116048
Pre-training layer 2, epoch 36, cost  0.437621681111
Pre-training layer 2, epoch 37, cost  0.435951521538
Pre-training layer 2, epoch 38, cost  0.434369724815
Pre-training layer 2, epoch 39, cost  0.432807322332
Pre-training layer 2, epoch 40, cost  0.431386048152
Pre-training layer 2, epoch 41, cost  0.430020496034
Pre-training layer 2, epoch 42, cost  0.428693098615
Pre-training layer 2, epoch 43, cost  0.427413362843
Pre-training layer 2, epoch 44, cost  0.426133780824
Pre-training layer 2, epoch 45, cost  0.425121181557
Pre-training layer 2, epoch 46, cost  0.424200090444
Pre-training layer 2, epoch 47, cost  0.423161549455
Pre-training layer 2, epoch 48, cost  0.422150890168
Pre-training layer 2, epoch 49, cost  0.421250911394
Pre-training layer 3, epoch 0, cost  3.59618390909
Pre-training layer 3, epoch 1, cost  0.699157734077
Pre-training layer 3, epoch 2, cost  0.439717136106
Pre-training layer 3, epoch 3, cost  0.311194380227
Pre-training layer 3, epoch 4, cost  0.239836724731
Pre-training layer 3, epoch 5, cost  0.192801128379
Pre-training layer 3, epoch 6, cost  0.164826061371
Pre-training layer 3, epoch 7, cost  0.143411382759
Pre-training layer 3, epoch 8, cost  0.125570348371
Pre-training layer 3, epoch 9, cost  0.112448102057
Pre-training layer 3, epoch 10, cost  0.102987363839
Pre-training layer 3, epoch 11, cost  0.096624942221
Pre-training layer 3, epoch 12, cost  0.0904433027093
Pre-training layer 3, epoch 13, cost  0.0834409904859
Pre-training layer 3, epoch 14, cost  0.0790584785792
Pre-training layer 3, epoch 15, cost  0.0743701311845
Pre-training layer 3, epoch 16, cost  0.0707053276145
Pre-training layer 3, epoch 17, cost  0.0669076113698
Pre-training layer 3, epoch 18, cost  0.063656324955
Pre-training layer 3, epoch 19, cost  0.0606832396164
Pre-training layer 3, epoch 20, cost  0.057921098801
Pre-training layer 3, epoch 21, cost  0.0554845020734
Pre-training layer 3, epoch 22, cost  0.0533725479774
Pre-training layer 3, epoch 23, cost  0.0515344799583
Pre-training layer 3, epoch 24, cost  0.0497685290105
Pre-training layer 3, epoch 25, cost  0.0478740941267
Pre-training layer 3, epoch 26, cost  0.0459983366459
Pre-training layer 3, epoch 27, cost  0.0444690834979
Pre-training layer 3, epoch 28, cost  0.0431189824911
Pre-training layer 3, epoch 29, cost  0.0415633564114
Pre-training layer 3, epoch 30, cost  0.0403657722321
Pre-training layer 3, epoch 31, cost  0.0390084316794
Pre-training layer 3, epoch 32, cost  0.0379113264113
Pre-training layer 3, epoch 33, cost  0.0367085761326
Pre-training layer 3, epoch 34, cost  0.0356842106094
Pre-training layer 3, epoch 35, cost  0.0346588016171
Pre-training layer 3, epoch 36, cost  0.0336825736133
Pre-training layer 3, epoch 37, cost  0.0327638102906
Pre-training layer 3, epoch 38, cost  0.03187536069
Pre-training layer 3, epoch 39, cost  0.0310390792452
Pre-training layer 3, epoch 40, cost  0.0302297434674
Pre-training layer 3, epoch 41, cost  0.0294037498049
Pre-training layer 3, epoch 42, cost  0.0284741853005
Pre-training layer 3, epoch 43, cost  0.0274068944731
Pre-training layer 3, epoch 44, cost  0.0266214845742
Pre-training layer 3, epoch 45, cost  0.0262012899861
Pre-training layer 3, epoch 46, cost  0.0257411123604
Pre-training layer 3, epoch 47, cost  0.0251794851915
Pre-training layer 3, epoch 48, cost  0.0246164085853
Pre-training layer 3, epoch 49, cost  0.0241816648249
Pre-training layer 4, epoch 0, cost  4.22798392421
Pre-training layer 4, epoch 1, cost  1.15319920064
Pre-training layer 4, epoch 2, cost  0.94869096179
Pre-training layer 4, epoch 3, cost  0.914356538066
Pre-training layer 4, epoch 4, cost  0.896758768346
Pre-training layer 4, epoch 5, cost  0.884723975588
Pre-training layer 4, epoch 6, cost  0.875766699073
Pre-training layer 4, epoch 7, cost  0.868836299175
Pre-training layer 4, epoch 8, cost  0.863140514215
Pre-training layer 4, epoch 9, cost  0.858478427458
Pre-training layer 4, epoch 10, cost  0.854362694183
Pre-training layer 4, epoch 11, cost  0.850866570446
Pre-training layer 4, epoch 12, cost  0.847773905585
Pre-training layer 4, epoch 13, cost  0.845030908495
Pre-training layer 4, epoch 14, cost  0.842556448628
Pre-training layer 4, epoch 15, cost  0.840313950428
Pre-training layer 4, epoch 16, cost  0.838268001059
Pre-training layer 4, epoch 17, cost  0.836405858557
Pre-training layer 4, epoch 18, cost  0.834711427342
Pre-training layer 4, epoch 19, cost  0.833133304921
Pre-training layer 4, epoch 20, cost  0.831683808612
Pre-training layer 4, epoch 21, cost  0.83033863384
Pre-training layer 4, epoch 22, cost  0.829077429421
Pre-training layer 4, epoch 23, cost  0.827898976083
Pre-training layer 4, epoch 24, cost  0.826818832374
Pre-training layer 4, epoch 25, cost  0.825799265777
Pre-training layer 4, epoch 26, cost  0.824813819596
Pre-training layer 4, epoch 27, cost  0.823908596101
Pre-training layer 4, epoch 28, cost  0.823057218541
Pre-training layer 4, epoch 29, cost  0.822250187701
Pre-training layer 4, epoch 30, cost  0.82152312199
Pre-training layer 4, epoch 31, cost  0.820799012498
Pre-training layer 4, epoch 32, cost  0.820113354584
Pre-training layer 4, epoch 33, cost  0.819478873116
Pre-training layer 4, epoch 34, cost  0.818863056973
Pre-training layer 4, epoch 35, cost  0.818303885806
Pre-training layer 4, epoch 36, cost  0.817727538213
Pre-training layer 4, epoch 37, cost  0.817238735626
Pre-training layer 4, epoch 38, cost  0.816735990317
Pre-training layer 4, epoch 39, cost  0.816234971021
Pre-training layer 4, epoch 40, cost  0.815772605208
Pre-training layer 4, epoch 41, cost  0.815327091053
Pre-training layer 4, epoch 42, cost  0.814926585423
Pre-training layer 4, epoch 43, cost  0.814517201545
Pre-training layer 4, epoch 44, cost  0.814128565477
Pre-training layer 4, epoch 45, cost  0.813752507247
Pre-training layer 4, epoch 46, cost  0.813400172613
Pre-training layer 4, epoch 47, cost  0.813058356055
Pre-training layer 4, epoch 48, cost  0.812738112033
Pre-training layer 4, epoch 49, cost  0.812418393329
Pre-training layer 5, epoch 0, cost  5.44063523342
Pre-training layer 5, epoch 1, cost  3.47301551499
Pre-training layer 5, epoch 2, cost  3.4611144311
Pre-training layer 5, epoch 3, cost  3.45720894396
Pre-training layer 5, epoch 4, cost  3.45475193632
Pre-training layer 5, epoch 5, cost  3.45273696614
Pre-training layer 5, epoch 6, cost  3.45094783404
Pre-training layer 5, epoch 7, cost  3.44938978181
Pre-training layer 5, epoch 8, cost  3.44807212946
Pre-training layer 5, epoch 9, cost  3.44695364707
Pre-training layer 5, epoch 10, cost  3.44595890156
Pre-training layer 5, epoch 11, cost  3.4450123762
Pre-training layer 5, epoch 12, cost  3.44405230631
Pre-training layer 5, epoch 13, cost  3.44302596628
Pre-training layer 5, epoch 14, cost  3.44187943958
Pre-training layer 5, epoch 15, cost  3.44054500982
Pre-training layer 5, epoch 16, cost  3.43893611313
Pre-training layer 5, epoch 17, cost  3.43692631163
Pre-training layer 5, epoch 18, cost  3.4343261453
Pre-training layer 5, epoch 19, cost  3.43084290805
Pre-training layer 5, epoch 20, cost  3.42603962802
Pre-training layer 5, epoch 21, cost  3.41940431667
Pre-training layer 5, epoch 22, cost  3.41097176084
Pre-training layer 5, epoch 23, cost  3.40273822673
Pre-training layer 5, epoch 24, cost  3.39727756739
Pre-training layer 5, epoch 25, cost  3.39424494261
Pre-training layer 5, epoch 26, cost  3.39235181837
Pre-training layer 5, epoch 27, cost  3.39101258763
Pre-training layer 5, epoch 28, cost  3.3899911153
Pre-training layer 5, epoch 29, cost  3.38916815833
Pre-training layer 5, epoch 30, cost  3.38847860859
Pre-training layer 5, epoch 31, cost  3.38788379544
Pre-training layer 5, epoch 32, cost  3.38735925551
Pre-training layer 5, epoch 33, cost  3.38688790082
Pre-training layer 5, epoch 34, cost  3.38645825587
Pre-training layer 5, epoch 35, cost  3.38606282964
Pre-training layer 5, epoch 36, cost  3.38569574482
Pre-training layer 5, epoch 37, cost  3.38535177843
Pre-training layer 5, epoch 38, cost  3.38502849044
Pre-training layer 5, epoch 39, cost  3.38472270643
Pre-training layer 5, epoch 40, cost  3.38443271201
Pre-training layer 5, epoch 41, cost  3.38415656874
Pre-training layer 5, epoch 42, cost  3.38389310454
Pre-training layer 5, epoch 43, cost  3.3836408904
Pre-training layer 5, epoch 44, cost  3.38339886039
Pre-training layer 5, epoch 45, cost  3.3831658826
Pre-training layer 5, epoch 46, cost  3.38294166307
Pre-training layer 5, epoch 47, cost  3.38272516639
Pre-training layer 5, epoch 48, cost  3.38251637089
Pre-training layer 5, epoch 49, cost  3.38231418258
The pretraining code for file multi_layer_km.pyc ran for 25.79m
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
ACC for deep clustering: 0.55
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.10773, Reconstruction: 1.79458, Clustering: 0.31315,
Fine-tuning epoch 2 ++++
Total cost: 1.61587, Reconstruction: 1.30928, Clustering: 0.30658,
Fine-tuning epoch 3 ++++
Total cost: 1.47116, Reconstruction: 1.18036, Clustering: 0.29080,
Fine-tuning epoch 4 ++++
Total cost: 1.37518, Reconstruction: 1.09672, Clustering: 0.27846,
Fine-tuning epoch 5 ++++
Total cost: 1.30796, Reconstruction: 1.03725, Clustering: 0.27070,
Fine-tuning epoch 6 ++++
Total cost: 1.25647, Reconstruction: 0.99345, Clustering: 0.26302,
Fine-tuning epoch 7 ++++
Total cost: 1.21840, Reconstruction: 0.96007, Clustering: 0.25832,
Fine-tuning epoch 8 ++++
Total cost: 1.18944, Reconstruction: 0.93511, Clustering: 0.25433,
Fine-tuning epoch 9 ++++
Total cost: 1.16582, Reconstruction: 0.91528, Clustering: 0.25054,
Fine-tuning epoch 10 ++++
Total cost: 1.14779, Reconstruction: 0.90016, Clustering: 0.24763,
Fine-tuning epoch 11 ++++
Total cost: 1.13208, Reconstruction: 0.88670, Clustering: 0.24538,
Fine-tuning epoch 12 ++++
Total cost: 1.11773, Reconstruction: 0.87480, Clustering: 0.24293,
Fine-tuning epoch 13 ++++
Total cost: 1.10140, Reconstruction: 0.86081, Clustering: 0.24059,
Fine-tuning epoch 14 ++++
Total cost: 1.09366, Reconstruction: 0.85456, Clustering: 0.23911,
Fine-tuning epoch 15 ++++
Total cost: 1.08180, Reconstruction: 0.84439, Clustering: 0.23742,
Fine-tuning epoch 16 ++++
Total cost: 1.06873, Reconstruction: 0.83388, Clustering: 0.23485,
Fine-tuning epoch 17 ++++
Total cost: 1.06286, Reconstruction: 0.82797, Clustering: 0.23489,
Fine-tuning epoch 18 ++++
Total cost: 1.04659, Reconstruction: 0.81500, Clustering: 0.23159,
Fine-tuning epoch 19 ++++
Total cost: 1.04355, Reconstruction: 0.81118, Clustering: 0.23237,
Fine-tuning epoch 20 ++++
Total cost: 1.03800, Reconstruction: 0.80666, Clustering: 0.23134,
Fine-tuning epoch 21 ++++
Total cost: 1.03220, Reconstruction: 0.80133, Clustering: 0.23088,
Fine-tuning epoch 22 ++++
Total cost: 1.02556, Reconstruction: 0.79584, Clustering: 0.22972,
Fine-tuning epoch 23 ++++
Total cost: 1.02243, Reconstruction: 0.79299, Clustering: 0.22945,
Fine-tuning epoch 24 ++++
Total cost: 1.01180, Reconstruction: 0.78387, Clustering: 0.22793,
Fine-tuning epoch 25 ++++
Total cost: 1.00674, Reconstruction: 0.77954, Clustering: 0.22720,
Fine-tuning epoch 26 ++++
Total cost: 1.00763, Reconstruction: 0.77986, Clustering: 0.22777,
Fine-tuning epoch 27 ++++
Total cost: 1.00040, Reconstruction: 0.77364, Clustering: 0.22676,
Fine-tuning epoch 28 ++++
Total cost: 0.99282, Reconstruction: 0.76738, Clustering: 0.22544,
Fine-tuning epoch 29 ++++
Total cost: 0.99095, Reconstruction: 0.76526, Clustering: 0.22569,
Fine-tuning epoch 30 ++++
Total cost: 0.98266, Reconstruction: 0.75864, Clustering: 0.22402,
Fine-tuning epoch 31 ++++
Total cost: 0.97922, Reconstruction: 0.75557, Clustering: 0.22365,
Fine-tuning epoch 32 ++++
Total cost: 0.97233, Reconstruction: 0.74955, Clustering: 0.22278,
Fine-tuning epoch 33 ++++
Total cost: 0.97050, Reconstruction: 0.74769, Clustering: 0.22281,
Fine-tuning epoch 34 ++++
Total cost: 0.96166, Reconstruction: 0.74101, Clustering: 0.22065,
Fine-tuning epoch 35 ++++
Total cost: 0.95395, Reconstruction: 0.73403, Clustering: 0.21992,
Fine-tuning epoch 36 ++++
Total cost: 0.94797, Reconstruction: 0.73042, Clustering: 0.21755,
Fine-tuning epoch 37 ++++
Total cost: 0.94030, Reconstruction: 0.72283, Clustering: 0.21746,
Fine-tuning epoch 38 ++++
Total cost: 0.93980, Reconstruction: 0.72133, Clustering: 0.21847,
Fine-tuning epoch 39 ++++
Total cost: 0.92920, Reconstruction: 0.71412, Clustering: 0.21508,
Fine-tuning epoch 40 ++++
Total cost: 0.92308, Reconstruction: 0.70919, Clustering: 0.21389,
Fine-tuning epoch 41 ++++
Total cost: 0.92085, Reconstruction: 0.70624, Clustering: 0.21461,
Fine-tuning epoch 42 ++++
Total cost: 0.91815, Reconstruction: 0.70404, Clustering: 0.21412,
Fine-tuning epoch 43 ++++
Total cost: 0.90784, Reconstruction: 0.69578, Clustering: 0.21206,
Fine-tuning epoch 44 ++++
Total cost: 0.90396, Reconstruction: 0.69317, Clustering: 0.21079,
Fine-tuning epoch 45 ++++
Total cost: 0.89789, Reconstruction: 0.68772, Clustering: 0.21017,
Fine-tuning epoch 46 ++++
Total cost: 0.89841, Reconstruction: 0.68743, Clustering: 0.21097,
Fine-tuning epoch 47 ++++
Total cost: 0.88701, Reconstruction: 0.67948, Clustering: 0.20753,
Fine-tuning epoch 48 ++++
Total cost: 0.88549, Reconstruction: 0.67761, Clustering: 0.20788,
Fine-tuning epoch 49 ++++
Total cost: 0.88349, Reconstruction: 0.67467, Clustering: 0.20881,
Fine-tuning epoch 50 ++++
Total cost: 0.88196, Reconstruction: 0.67299, Clustering: 0.20897,
Average squared 2-D reconstruction error: 0.6730
NMI for deep clustering: 0.58
ARI for deep clustering: 0.43
ACC for deep clustering: 0.58
The training code for file multi_layer_km.pyc ran for 24.27m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.15096293177
Pre-training layer 0, epoch 1, cost  0.985934592431
Pre-training layer 0, epoch 2, cost  0.793955759591
Pre-training layer 0, epoch 3, cost  0.706533529746
Pre-training layer 0, epoch 4, cost  0.653124369302
Pre-training layer 0, epoch 5, cost  0.615432342154
Pre-training layer 0, epoch 6, cost  0.586332151139
Pre-training layer 0, epoch 7, cost  0.563028365329
Pre-training layer 0, epoch 8, cost  0.54360282626
Pre-training layer 0, epoch 9, cost  0.527072291522
Pre-training layer 0, epoch 10, cost  0.512667604914
Pre-training layer 0, epoch 11, cost  0.50012011556
Pre-training layer 0, epoch 12, cost  0.488985943185
Pre-training layer 0, epoch 13, cost  0.478849404785
Pre-training layer 0, epoch 14, cost  0.46981109426
Pre-training layer 0, epoch 15, cost  0.461603931156
Pre-training layer 0, epoch 16, cost  0.45412560373
Pre-training layer 0, epoch 17, cost  0.4472595426
Pre-training layer 0, epoch 18, cost  0.440931739661
Pre-training layer 0, epoch 19, cost  0.435082873244
Pre-training layer 0, epoch 20, cost  0.429670285908
Pre-training layer 0, epoch 21, cost  0.424601827546
Pre-training layer 0, epoch 22, cost  0.419848253205
Pre-training layer 0, epoch 23, cost  0.415386732379
Pre-training layer 0, epoch 24, cost  0.411046183728
Pre-training layer 0, epoch 25, cost  0.406955094837
Pre-training layer 0, epoch 26, cost  0.403130090662
Pre-training layer 0, epoch 27, cost  0.39953167751
Pre-training layer 0, epoch 28, cost  0.396112896938
Pre-training layer 0, epoch 29, cost  0.392853468625
Pre-training layer 0, epoch 30, cost  0.38973924421
Pre-training layer 0, epoch 31, cost  0.386743571852
Pre-training layer 0, epoch 32, cost  0.38390365379
Pre-training layer 0, epoch 33, cost  0.381180244102
Pre-training layer 0, epoch 34, cost  0.378569466986
Pre-training layer 0, epoch 35, cost  0.376054559486
Pre-training layer 0, epoch 36, cost  0.373639298884
Pre-training layer 0, epoch 37, cost  0.371317176759
Pre-training layer 0, epoch 38, cost  0.369067203257
Pre-training layer 0, epoch 39, cost  0.366898358613
Pre-training layer 0, epoch 40, cost  0.364805031173
Pre-training layer 0, epoch 41, cost  0.362793913181
Pre-training layer 0, epoch 42, cost  0.360851023744
Pre-training layer 0, epoch 43, cost  0.358965476446
Pre-training layer 0, epoch 44, cost  0.357131356255
Pre-training layer 0, epoch 45, cost  0.355315513781
Pre-training layer 0, epoch 46, cost  0.353571107507
Pre-training layer 0, epoch 47, cost  0.351885198738
Pre-training layer 0, epoch 48, cost  0.350259913217
Pre-training layer 0, epoch 49, cost  0.348663279443
Pre-training layer 1, epoch 0, cost  3.89502873517
Pre-training layer 1, epoch 1, cost  1.03089288634
Pre-training layer 1, epoch 2, cost  0.74591254661
Pre-training layer 1, epoch 3, cost  0.624045636755
Pre-training layer 1, epoch 4, cost  0.553311260588
Pre-training layer 1, epoch 5, cost  0.505410813969
Pre-training layer 1, epoch 6, cost  0.469044179877
Pre-training layer 1, epoch 7, cost  0.440538594561
Pre-training layer 1, epoch 8, cost  0.417061701945
Pre-training layer 1, epoch 9, cost  0.397028461986
Pre-training layer 1, epoch 10, cost  0.380103082488
Pre-training layer 1, epoch 11, cost  0.365127560153
Pre-training layer 1, epoch 12, cost  0.352418193578
Pre-training layer 1, epoch 13, cost  0.340734595497
Pre-training layer 1, epoch 14, cost  0.330596107235
Pre-training layer 1, epoch 15, cost  0.321664380253
Pre-training layer 1, epoch 16, cost  0.312943164529
Pre-training layer 1, epoch 17, cost  0.304908644481
Pre-training layer 1, epoch 18, cost  0.297702063792
Pre-training layer 1, epoch 19, cost  0.291279949051
Pre-training layer 1, epoch 20, cost  0.285111377631
Pre-training layer 1, epoch 21, cost  0.279530547615
Pre-training layer 1, epoch 22, cost  0.274809988175
Pre-training layer 1, epoch 23, cost  0.26951125605
Pre-training layer 1, epoch 24, cost  0.264848668442
Pre-training layer 1, epoch 25, cost  0.26081642385
Pre-training layer 1, epoch 26, cost  0.256592722005
Pre-training layer 1, epoch 27, cost  0.252714356865
Pre-training layer 1, epoch 28, cost  0.249039754918
Pre-training layer 1, epoch 29, cost  0.24585396421
Pre-training layer 1, epoch 30, cost  0.242849867348
Pre-training layer 1, epoch 31, cost  0.239467072358
Pre-training layer 1, epoch 32, cost  0.237177472178
Pre-training layer 1, epoch 33, cost  0.234014979851
Pre-training layer 1, epoch 34, cost  0.231406737158
Pre-training layer 1, epoch 35, cost  0.229067082569
Pre-training layer 1, epoch 36, cost  0.226776983848
Pre-training layer 1, epoch 37, cost  0.224902194814
Pre-training layer 1, epoch 38, cost  0.222369237647
Pre-training layer 1, epoch 39, cost  0.220184369596
Pre-training layer 1, epoch 40, cost  0.218475966168
Pre-training layer 1, epoch 41, cost  0.21667865083
Pre-training layer 1, epoch 42, cost  0.214880608198
Pre-training layer 1, epoch 43, cost  0.212924976215
Pre-training layer 1, epoch 44, cost  0.211232073122
Pre-training layer 1, epoch 45, cost  0.209739391452
Pre-training layer 1, epoch 46, cost  0.208119773617
Pre-training layer 1, epoch 47, cost  0.206590085657
Pre-training layer 1, epoch 48, cost  0.205215334743
Pre-training layer 1, epoch 49, cost  0.203950690226
Pre-training layer 2, epoch 0, cost  4.82012789601
Pre-training layer 2, epoch 1, cost  1.43065634017
Pre-training layer 2, epoch 2, cost  1.09211561077
Pre-training layer 2, epoch 3, cost  0.92562369408
Pre-training layer 2, epoch 4, cost  0.818563905863
Pre-training layer 2, epoch 5, cost  0.758376072341
Pre-training layer 2, epoch 6, cost  0.711239831921
Pre-training layer 2, epoch 7, cost  0.668833042925
Pre-training layer 2, epoch 8, cost  0.637520504106
Pre-training layer 2, epoch 9, cost  0.616893194902
Pre-training layer 2, epoch 10, cost  0.602023622976
Pre-training layer 2, epoch 11, cost  0.57927291476
Pre-training layer 2, epoch 12, cost  0.570290652338
Pre-training layer 2, epoch 13, cost  0.551707614427
Pre-training layer 2, epoch 14, cost  0.540571271417
Pre-training layer 2, epoch 15, cost  0.530409982412
Pre-training layer 2, epoch 16, cost  0.519502182968
Pre-training layer 2, epoch 17, cost  0.518530717916
Pre-training layer 2, epoch 18, cost  0.506098884014
Pre-training layer 2, epoch 19, cost  0.502958932702
Pre-training layer 2, epoch 20, cost  0.491415451146
Pre-training layer 2, epoch 21, cost  0.490590221482
Pre-training layer 2, epoch 22, cost  0.487151646648
Pre-training layer 2, epoch 23, cost  0.48230493787
Pre-training layer 2, epoch 24, cost  0.477066237617
Pre-training layer 2, epoch 25, cost  0.473901396592
Pre-training layer 2, epoch 26, cost  0.470773878258
Pre-training layer 2, epoch 27, cost  0.467251909706
Pre-training layer 2, epoch 28, cost  0.462656496389
Pre-training layer 2, epoch 29, cost  0.459718006533
Pre-training layer 2, epoch 30, cost  0.458814141039
Pre-training layer 2, epoch 31, cost  0.456454236426
Pre-training layer 2, epoch 32, cost  0.451937403416
Pre-training layer 2, epoch 33, cost  0.452690208891
Pre-training layer 2, epoch 34, cost  0.447486613085
Pre-training layer 2, epoch 35, cost  0.449395357019
Pre-training layer 2, epoch 36, cost  0.443788560636
Pre-training layer 2, epoch 37, cost  0.443746446571
Pre-training layer 2, epoch 38, cost  0.443915912003
Pre-training layer 2, epoch 39, cost  0.440296816579
Pre-training layer 2, epoch 40, cost  0.438480829032
Pre-training layer 2, epoch 41, cost  0.437654516812
Pre-training layer 2, epoch 42, cost  0.437243273068
Pre-training layer 2, epoch 43, cost  0.436561358377
Pre-training layer 2, epoch 44, cost  0.435023849612
Pre-training layer 2, epoch 45, cost  0.43351159517
Pre-training layer 2, epoch 46, cost  0.432288144499
Pre-training layer 2, epoch 47, cost  0.431257883914
Pre-training layer 2, epoch 48, cost  0.430368693323
Pre-training layer 2, epoch 49, cost  0.42958986718
Pre-training layer 3, epoch 0, cost  3.57042276207
Pre-training layer 3, epoch 1, cost  0.69942762401
Pre-training layer 3, epoch 2, cost  0.440540847554
Pre-training layer 3, epoch 3, cost  0.310041721564
Pre-training layer 3, epoch 4, cost  0.238093164925
Pre-training layer 3, epoch 5, cost  0.191852398385
Pre-training layer 3, epoch 6, cost  0.16252316434
Pre-training layer 3, epoch 7, cost  0.141202580704
Pre-training layer 3, epoch 8, cost  0.12436565025
Pre-training layer 3, epoch 9, cost  0.112152508284
Pre-training layer 3, epoch 10, cost  0.102392176672
Pre-training layer 3, epoch 11, cost  0.094707410316
Pre-training layer 3, epoch 12, cost  0.089830572077
Pre-training layer 3, epoch 13, cost  0.0831601558388
Pre-training layer 3, epoch 14, cost  0.0782869182701
Pre-training layer 3, epoch 15, cost  0.0739297579938
Pre-training layer 3, epoch 16, cost  0.0702610826751
Pre-training layer 3, epoch 17, cost  0.0668099859171
Pre-training layer 3, epoch 18, cost  0.0638254547796
Pre-training layer 3, epoch 19, cost  0.060997969388
Pre-training layer 3, epoch 20, cost  0.0582571899846
Pre-training layer 3, epoch 21, cost  0.0555844220047
Pre-training layer 3, epoch 22, cost  0.0531345589336
Pre-training layer 3, epoch 23, cost  0.0510114647525
Pre-training layer 3, epoch 24, cost  0.0492043608289
Pre-training layer 3, epoch 25, cost  0.0475516760542
Pre-training layer 3, epoch 26, cost  0.0458197746829
Pre-training layer 3, epoch 27, cost  0.0441651473894
Pre-training layer 3, epoch 28, cost  0.0427508676326
Pre-training layer 3, epoch 29, cost  0.0413311195862
Pre-training layer 3, epoch 30, cost  0.0400279739705
Pre-training layer 3, epoch 31, cost  0.0388025502466
Pre-training layer 3, epoch 32, cost  0.0376082224686
Pre-training layer 3, epoch 33, cost  0.0364921951655
Pre-training layer 3, epoch 34, cost  0.035437172361
Pre-training layer 3, epoch 35, cost  0.0344053010299
Pre-training layer 3, epoch 36, cost  0.033441841554
Pre-training layer 3, epoch 37, cost  0.0325380875879
Pre-training layer 3, epoch 38, cost  0.0316388183325
Pre-training layer 3, epoch 39, cost  0.0307938120355
Pre-training layer 3, epoch 40, cost  0.0299861558648
Pre-training layer 3, epoch 41, cost  0.0291951096509
Pre-training layer 3, epoch 42, cost  0.0284167049188
Pre-training layer 3, epoch 43, cost  0.0276428714084
Pre-training layer 3, epoch 44, cost  0.0268918934001
Pre-training layer 3, epoch 45, cost  0.0262110100235
Pre-training layer 3, epoch 46, cost  0.0256430662464
Pre-training layer 3, epoch 47, cost  0.0251736049395
Pre-training layer 3, epoch 48, cost  0.0247214516251
Pre-training layer 3, epoch 49, cost  0.0242318504893
Pre-training layer 4, epoch 0, cost  4.22258870559
Pre-training layer 4, epoch 1, cost  1.16445431779
Pre-training layer 4, epoch 2, cost  0.959128382651
Pre-training layer 4, epoch 3, cost  0.924530813545
Pre-training layer 4, epoch 4, cost  0.906795077594
Pre-training layer 4, epoch 5, cost  0.894547755453
Pre-training layer 4, epoch 6, cost  0.885656848519
Pre-training layer 4, epoch 7, cost  0.878708135399
Pre-training layer 4, epoch 8, cost  0.872908463976
Pre-training layer 4, epoch 9, cost  0.868066345167
Pre-training layer 4, epoch 10, cost  0.863897027757
Pre-training layer 4, epoch 11, cost  0.860243572924
Pre-training layer 4, epoch 12, cost  0.857059460088
Pre-training layer 4, epoch 13, cost  0.854209123339
Pre-training layer 4, epoch 14, cost  0.851699031745
Pre-training layer 4, epoch 15, cost  0.849402946468
Pre-training layer 4, epoch 16, cost  0.847271185468
Pre-training layer 4, epoch 17, cost  0.845384234682
Pre-training layer 4, epoch 18, cost  0.843619811912
Pre-training layer 4, epoch 19, cost  0.84195406103
Pre-training layer 4, epoch 20, cost  0.840490656814
Pre-training layer 4, epoch 21, cost  0.83904984421
Pre-training layer 4, epoch 22, cost  0.83777484542
Pre-training layer 4, epoch 23, cost  0.836565739862
Pre-training layer 4, epoch 24, cost  0.835461638572
Pre-training layer 4, epoch 25, cost  0.834369465961
Pre-training layer 4, epoch 26, cost  0.83335544976
Pre-training layer 4, epoch 27, cost  0.83245873619
Pre-training layer 4, epoch 28, cost  0.831554715162
Pre-training layer 4, epoch 29, cost  0.830731734326
Pre-training layer 4, epoch 30, cost  0.829982960459
Pre-training layer 4, epoch 31, cost  0.829250230801
Pre-training layer 4, epoch 32, cost  0.828551471762
Pre-training layer 4, epoch 33, cost  0.827872332218
Pre-training layer 4, epoch 34, cost  0.827225412998
Pre-training layer 4, epoch 35, cost  0.826663601064
Pre-training layer 4, epoch 36, cost  0.826077512241
Pre-training layer 4, epoch 37, cost  0.825533810319
Pre-training layer 4, epoch 38, cost  0.825008891653
Pre-training layer 4, epoch 39, cost  0.82454373366
Pre-training layer 4, epoch 40, cost  0.824066034823
Pre-training layer 4, epoch 41, cost  0.823618735156
Pre-training layer 4, epoch 42, cost  0.823199443701
Pre-training layer 4, epoch 43, cost  0.822804470151
Pre-training layer 4, epoch 44, cost  0.822392502186
Pre-training layer 4, epoch 45, cost  0.822033074892
Pre-training layer 4, epoch 46, cost  0.821661746762
Pre-training layer 4, epoch 47, cost  0.821322459098
Pre-training layer 4, epoch 48, cost  0.820990901799
Pre-training layer 4, epoch 49, cost  0.820668600815
Pre-training layer 5, epoch 0, cost  5.45365547969
Pre-training layer 5, epoch 1, cost  3.44415653594
Pre-training layer 5, epoch 2, cost  3.42924961661
Pre-training layer 5, epoch 3, cost  3.424725129
Pre-training layer 5, epoch 4, cost  3.42161976869
Pre-training layer 5, epoch 5, cost  3.4188746162
Pre-training layer 5, epoch 6, cost  3.4166610916
Pre-training layer 5, epoch 7, cost  3.41503247044
Pre-training layer 5, epoch 8, cost  3.413803357
Pre-training layer 5, epoch 9, cost  3.41278290495
Pre-training layer 5, epoch 10, cost  3.4118521968
Pre-training layer 5, epoch 11, cost  3.41093627984
Pre-training layer 5, epoch 12, cost  3.40998257466
Pre-training layer 5, epoch 13, cost  3.4089457823
Pre-training layer 5, epoch 14, cost  3.40777569148
Pre-training layer 5, epoch 15, cost  3.40640747683
Pre-training layer 5, epoch 16, cost  3.40475231551
Pre-training layer 5, epoch 17, cost  3.40268316604
Pre-training layer 5, epoch 18, cost  3.40000686992
Pre-training layer 5, epoch 19, cost  3.39642913673
Pre-training layer 5, epoch 20, cost  3.39153209853
Pre-training layer 5, epoch 21, cost  3.38487538881
Pre-training layer 5, epoch 22, cost  3.37669957348
Pre-training layer 5, epoch 23, cost  3.36900120085
Pre-training layer 5, epoch 24, cost  3.36390107375
Pre-training layer 5, epoch 25, cost  3.36097490824
Pre-training layer 5, epoch 26, cost  3.35910227877
Pre-training layer 5, epoch 27, cost  3.35775642124
Pre-training layer 5, epoch 28, cost  3.35671536284
Pre-training layer 5, epoch 29, cost  3.35587022419
Pre-training layer 5, epoch 30, cost  3.35515735876
Pre-training layer 5, epoch 31, cost  3.35453940524
Pre-training layer 5, epoch 32, cost  3.35399231491
Pre-training layer 5, epoch 33, cost  3.35349963884
Pre-training layer 5, epoch 34, cost  3.35305053452
Pre-training layer 5, epoch 35, cost  3.35263665794
Pre-training layer 5, epoch 36, cost  3.35225190242
Pre-training layer 5, epoch 37, cost  3.3518924221
Pre-training layer 5, epoch 38, cost  3.35155432567
Pre-training layer 5, epoch 39, cost  3.3512352288
Pre-training layer 5, epoch 40, cost  3.35093272734
Pre-training layer 5, epoch 41, cost  3.3506450934
Pre-training layer 5, epoch 42, cost  3.35037104041
Pre-training layer 5, epoch 43, cost  3.35010922433
Pre-training layer 5, epoch 44, cost  3.34985886069
Pre-training layer 5, epoch 45, cost  3.34961869847
Pre-training layer 5, epoch 46, cost  3.34938778571
Pre-training layer 5, epoch 47, cost  3.34916598288
Pre-training layer 5, epoch 48, cost  3.34895247708
The pretraining code for file multi_layer_km.pyc ran for 25.75m
Pre-training layer 5, epoch 49, cost  3.34874664977
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
... getting the finetuning functions
ACC for deep clustering: 0.53
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 3.12675, Reconstruction: 2.86299, Clustering: 0.26376,
Fine-tuning epoch 2 ++++
Total cost: 1.66106, Reconstruction: 1.35625, Clustering: 0.30481,
Fine-tuning epoch 3 ++++
Total cost: 1.48397, Reconstruction: 1.18490, Clustering: 0.29908,
Fine-tuning epoch 4 ++++
Total cost: 1.37749, Reconstruction: 1.09168, Clustering: 0.28581,
Fine-tuning epoch 5 ++++
Total cost: 1.30056, Reconstruction: 1.02798, Clustering: 0.27258,
Fine-tuning epoch 6 ++++
Total cost: 1.25066, Reconstruction: 0.98689, Clustering: 0.26378,
Fine-tuning epoch 7 ++++
Total cost: 1.21008, Reconstruction: 0.95455, Clustering: 0.25553,
Fine-tuning epoch 8 ++++
Total cost: 1.18832, Reconstruction: 0.93587, Clustering: 0.25244,
Fine-tuning epoch 9 ++++
Total cost: 1.16344, Reconstruction: 0.91576, Clustering: 0.24768,
Fine-tuning epoch 10 ++++
Total cost: 1.14135, Reconstruction: 0.89740, Clustering: 0.24395,
Fine-tuning epoch 11 ++++
Total cost: 1.12117, Reconstruction: 0.88078, Clustering: 0.24039,
Fine-tuning epoch 12 ++++
Total cost: 1.10598, Reconstruction: 0.86787, Clustering: 0.23810,
Fine-tuning epoch 13 ++++
Total cost: 1.09635, Reconstruction: 0.85991, Clustering: 0.23644,
Fine-tuning epoch 14 ++++
Total cost: 1.07952, Reconstruction: 0.84643, Clustering: 0.23309,
Fine-tuning epoch 15 ++++
Total cost: 1.07176, Reconstruction: 0.83966, Clustering: 0.23210,
Fine-tuning epoch 16 ++++
Total cost: 1.05950, Reconstruction: 0.82938, Clustering: 0.23012,
Fine-tuning epoch 17 ++++
Total cost: 1.04929, Reconstruction: 0.82084, Clustering: 0.22845,
Fine-tuning epoch 18 ++++
Total cost: 1.04053, Reconstruction: 0.81357, Clustering: 0.22696,
Fine-tuning epoch 19 ++++
Total cost: 1.03170, Reconstruction: 0.80632, Clustering: 0.22538,
Fine-tuning epoch 20 ++++
Total cost: 1.02244, Reconstruction: 0.79769, Clustering: 0.22475,
Fine-tuning epoch 21 ++++
Total cost: 1.01402, Reconstruction: 0.79113, Clustering: 0.22289,
Fine-tuning epoch 22 ++++
Total cost: 1.00280, Reconstruction: 0.78153, Clustering: 0.22126,
Fine-tuning epoch 23 ++++
Total cost: 0.99688, Reconstruction: 0.77509, Clustering: 0.22179,
Fine-tuning epoch 24 ++++
Total cost: 0.98628, Reconstruction: 0.76610, Clustering: 0.22018,
Fine-tuning epoch 25 ++++
Total cost: 0.97821, Reconstruction: 0.75937, Clustering: 0.21885,
Fine-tuning epoch 26 ++++
Total cost: 0.96800, Reconstruction: 0.75031, Clustering: 0.21769,
Fine-tuning epoch 27 ++++
Total cost: 0.96182, Reconstruction: 0.74423, Clustering: 0.21759,
Fine-tuning epoch 28 ++++
Total cost: 0.95748, Reconstruction: 0.73976, Clustering: 0.21771,
Fine-tuning epoch 29 ++++
Total cost: 0.94594, Reconstruction: 0.73068, Clustering: 0.21526,
Fine-tuning epoch 30 ++++
Total cost: 0.93935, Reconstruction: 0.72419, Clustering: 0.21516,
Fine-tuning epoch 31 ++++
Total cost: 0.92958, Reconstruction: 0.71705, Clustering: 0.21253,
Fine-tuning epoch 32 ++++
Total cost: 0.92372, Reconstruction: 0.71167, Clustering: 0.21205,
Fine-tuning epoch 33 ++++
Total cost: 0.91766, Reconstruction: 0.70536, Clustering: 0.21230,
Fine-tuning epoch 34 ++++
Total cost: 0.91788, Reconstruction: 0.70474, Clustering: 0.21314,
Fine-tuning epoch 35 ++++
Total cost: 0.90816, Reconstruction: 0.69692, Clustering: 0.21124,
Fine-tuning epoch 36 ++++
Total cost: 0.90570, Reconstruction: 0.69429, Clustering: 0.21141,
Fine-tuning epoch 37 ++++
Total cost: 0.90055, Reconstruction: 0.68980, Clustering: 0.21075,
Fine-tuning epoch 38 ++++
Total cost: 0.89815, Reconstruction: 0.68620, Clustering: 0.21195,
Fine-tuning epoch 39 ++++
Total cost: 0.88931, Reconstruction: 0.68065, Clustering: 0.20866,
Fine-tuning epoch 40 ++++
Total cost: 0.88613, Reconstruction: 0.67660, Clustering: 0.20953,
Fine-tuning epoch 41 ++++
Total cost: 0.88026, Reconstruction: 0.67211, Clustering: 0.20815,
Fine-tuning epoch 42 ++++
Total cost: 0.87707, Reconstruction: 0.66848, Clustering: 0.20859,
Fine-tuning epoch 43 ++++
Total cost: 0.87255, Reconstruction: 0.66541, Clustering: 0.20714,
Fine-tuning epoch 44 ++++
Total cost: 0.86492, Reconstruction: 0.65875, Clustering: 0.20617,
Fine-tuning epoch 45 ++++
Total cost: 0.86702, Reconstruction: 0.66006, Clustering: 0.20696,
Fine-tuning epoch 46 ++++
Total cost: 0.85805, Reconstruction: 0.65211, Clustering: 0.20594,
Fine-tuning epoch 47 ++++
Total cost: 0.85450, Reconstruction: 0.65016, Clustering: 0.20434,
Fine-tuning epoch 48 ++++
Total cost: 0.84967, Reconstruction: 0.64562, Clustering: 0.20405,
Fine-tuning epoch 49 ++++
Total cost: 0.84334, Reconstruction: 0.63984, Clustering: 0.20350,
Fine-tuning epoch 50 ++++
Total cost: 0.84197, Reconstruction: 0.63903, Clustering: 0.20295,
Average squared 2-D reconstruction error: 0.6390
NMI for deep clustering: 0.58
ARI for deep clustering: 0.42
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 24.14m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.15737169395
Pre-training layer 0, epoch 1, cost  0.982581018625
Pre-training layer 0, epoch 2, cost  0.791424025445
Pre-training layer 0, epoch 3, cost  0.703706000009
Pre-training layer 0, epoch 4, cost  0.649783142956
Pre-training layer 0, epoch 5, cost  0.611269225097
Pre-training layer 0, epoch 6, cost  0.581956135165
Pre-training layer 0, epoch 7, cost  0.558709785696
Pre-training layer 0, epoch 8, cost  0.539441413819
Pre-training layer 0, epoch 9, cost  0.523005504428
Pre-training layer 0, epoch 10, cost  0.50880655022
Pre-training layer 0, epoch 11, cost  0.496408633708
Pre-training layer 0, epoch 12, cost  0.485275223063
Pre-training layer 0, epoch 13, cost  0.475401819458
Pre-training layer 0, epoch 14, cost  0.466505885407
Pre-training layer 0, epoch 15, cost  0.458418334302
Pre-training layer 0, epoch 16, cost  0.451034711314
Pre-training layer 0, epoch 17, cost  0.444228098284
Pre-training layer 0, epoch 18, cost  0.437903667552
Pre-training layer 0, epoch 19, cost  0.432053614876
Pre-training layer 0, epoch 20, cost  0.426632675239
Pre-training layer 0, epoch 21, cost  0.421591390549
Pre-training layer 0, epoch 22, cost  0.416848396201
Pre-training layer 0, epoch 23, cost  0.41238913774
Pre-training layer 0, epoch 24, cost  0.408189114259
Pre-training layer 0, epoch 25, cost  0.404209079108
Pre-training layer 0, epoch 26, cost  0.400442436387
Pre-training layer 0, epoch 27, cost  0.396863648973
Pre-training layer 0, epoch 28, cost  0.393459398717
Pre-training layer 0, epoch 29, cost  0.390215750969
Pre-training layer 0, epoch 30, cost  0.387081535382
Pre-training layer 0, epoch 31, cost  0.384095705933
Pre-training layer 0, epoch 32, cost  0.381255301952
Pre-training layer 0, epoch 33, cost  0.378553736802
Pre-training layer 0, epoch 34, cost  0.37595527654
Pre-training layer 0, epoch 35, cost  0.37343999014
Pre-training layer 0, epoch 36, cost  0.370429679853
Pre-training layer 0, epoch 37, cost  0.367841803583
Pre-training layer 0, epoch 38, cost  0.365551681562
Pre-training layer 0, epoch 39, cost  0.363377022958
Pre-training layer 0, epoch 40, cost  0.361288890673
Pre-training layer 0, epoch 41, cost  0.359277921699
Pre-training layer 0, epoch 42, cost  0.35734650764
Pre-training layer 0, epoch 43, cost  0.355492461804
Pre-training layer 0, epoch 44, cost  0.353693118351
Pre-training layer 0, epoch 45, cost  0.351954194183
Pre-training layer 0, epoch 46, cost  0.350272434123
Pre-training layer 0, epoch 47, cost  0.348638411542
Pre-training layer 0, epoch 48, cost  0.347062895301
Pre-training layer 0, epoch 49, cost  0.345523481749
Pre-training layer 1, epoch 0, cost  3.85443688225
Pre-training layer 1, epoch 1, cost  1.01213549384
Pre-training layer 1, epoch 2, cost  0.731438779766
Pre-training layer 1, epoch 3, cost  0.611814459238
Pre-training layer 1, epoch 4, cost  0.54246533815
Pre-training layer 1, epoch 5, cost  0.495709480815
Pre-training layer 1, epoch 6, cost  0.460376159272
Pre-training layer 1, epoch 7, cost  0.432240727118
Pre-training layer 1, epoch 8, cost  0.409512388662
Pre-training layer 1, epoch 9, cost  0.39005155049
Pre-training layer 1, epoch 10, cost  0.37400160869
Pre-training layer 1, epoch 11, cost  0.359801082518
Pre-training layer 1, epoch 12, cost  0.347355097403
Pre-training layer 1, epoch 13, cost  0.33604508377
Pre-training layer 1, epoch 14, cost  0.326313207389
Pre-training layer 1, epoch 15, cost  0.3171399934
Pre-training layer 1, epoch 16, cost  0.308782704439
Pre-training layer 1, epoch 17, cost  0.301808221538
Pre-training layer 1, epoch 18, cost  0.29458817789
Pre-training layer 1, epoch 19, cost  0.288382665428
Pre-training layer 1, epoch 20, cost  0.282352137341
Pre-training layer 1, epoch 21, cost  0.276851241211
Pre-training layer 1, epoch 22, cost  0.271617615169
Pre-training layer 1, epoch 23, cost  0.267121462904
Pre-training layer 1, epoch 24, cost  0.262640456753
Pre-training layer 1, epoch 25, cost  0.258934769688
Pre-training layer 1, epoch 26, cost  0.255062432989
Pre-training layer 1, epoch 27, cost  0.251025135225
Pre-training layer 1, epoch 28, cost  0.247964633837
Pre-training layer 1, epoch 29, cost  0.244335947544
Pre-training layer 1, epoch 30, cost  0.241088470029
Pre-training layer 1, epoch 31, cost  0.238196386641
Pre-training layer 1, epoch 32, cost  0.235696963368
Pre-training layer 1, epoch 33, cost  0.233110226262
Pre-training layer 1, epoch 34, cost  0.2304283935
Pre-training layer 1, epoch 35, cost  0.227823224242
Pre-training layer 1, epoch 36, cost  0.225443357479
Pre-training layer 1, epoch 37, cost  0.223644352647
Pre-training layer 1, epoch 38, cost  0.221531532765
Pre-training layer 1, epoch 39, cost  0.219347205629
Pre-training layer 1, epoch 40, cost  0.217400898007
Pre-training layer 1, epoch 41, cost  0.215579236595
Pre-training layer 1, epoch 42, cost  0.213888412454
Pre-training layer 1, epoch 43, cost  0.21217925323
Pre-training layer 1, epoch 44, cost  0.210447112453
Pre-training layer 1, epoch 45, cost  0.208936828419
Pre-training layer 1, epoch 46, cost  0.207515980129
Pre-training layer 1, epoch 47, cost  0.20604776524
Pre-training layer 1, epoch 48, cost  0.204522922034
Pre-training layer 1, epoch 49, cost  0.203119481025
Pre-training layer 2, epoch 0, cost  4.81179571013
Pre-training layer 2, epoch 1, cost  1.40391612367
Pre-training layer 2, epoch 2, cost  1.07303947781
Pre-training layer 2, epoch 3, cost  0.912365241111
Pre-training layer 2, epoch 4, cost  0.814284142463
Pre-training layer 2, epoch 5, cost  0.732715801505
Pre-training layer 2, epoch 6, cost  0.708047643242
Pre-training layer 2, epoch 7, cost  0.65581837767
Pre-training layer 2, epoch 8, cost  0.633309701237
Pre-training layer 2, epoch 9, cost  0.614338979707
Pre-training layer 2, epoch 10, cost  0.594539535713
Pre-training layer 2, epoch 11, cost  0.569991337222
Pre-training layer 2, epoch 12, cost  0.560803992684
Pre-training layer 2, epoch 13, cost  0.554195820044
Pre-training layer 2, epoch 14, cost  0.537162754026
Pre-training layer 2, epoch 15, cost  0.525876376867
Pre-training layer 2, epoch 16, cost  0.51489420844
Pre-training layer 2, epoch 17, cost  0.514468967875
Pre-training layer 2, epoch 18, cost  0.502777041372
Pre-training layer 2, epoch 19, cost  0.499626379207
Pre-training layer 2, epoch 20, cost  0.492768993731
Pre-training layer 2, epoch 21, cost  0.489957821695
Pre-training layer 2, epoch 22, cost  0.480792140737
Pre-training layer 2, epoch 23, cost  0.477804619837
Pre-training layer 2, epoch 24, cost  0.474455917792
Pre-training layer 2, epoch 25, cost  0.470602096472
Pre-training layer 2, epoch 26, cost  0.46721686082
Pre-training layer 2, epoch 27, cost  0.464495367758
Pre-training layer 2, epoch 28, cost  0.461509674135
Pre-training layer 2, epoch 29, cost  0.456591167186
Pre-training layer 2, epoch 30, cost  0.454556149032
Pre-training layer 2, epoch 31, cost  0.453786117723
Pre-training layer 2, epoch 32, cost  0.450132521321
Pre-training layer 2, epoch 33, cost  0.44884045933
Pre-training layer 2, epoch 34, cost  0.447269229456
Pre-training layer 2, epoch 35, cost  0.444652526747
Pre-training layer 2, epoch 36, cost  0.442864669449
Pre-training layer 2, epoch 37, cost  0.44144861696
Pre-training layer 2, epoch 38, cost  0.439332101393
Pre-training layer 2, epoch 39, cost  0.437962489943
Pre-training layer 2, epoch 40, cost  0.437119346883
Pre-training layer 2, epoch 41, cost  0.435308131105
Pre-training layer 2, epoch 42, cost  0.43401668397
Pre-training layer 2, epoch 43, cost  0.432816528814
Pre-training layer 2, epoch 44, cost  0.431668009833
Pre-training layer 2, epoch 45, cost  0.430530998017
Pre-training layer 2, epoch 46, cost  0.429535224563
Pre-training layer 2, epoch 47, cost  0.428781948911
Pre-training layer 2, epoch 48, cost  0.427766455892
Pre-training layer 2, epoch 49, cost  0.427033677156
Pre-training layer 3, epoch 0, cost  3.57852385428
Pre-training layer 3, epoch 1, cost  0.696825996038
Pre-training layer 3, epoch 2, cost  0.445595628079
Pre-training layer 3, epoch 3, cost  0.314998345714
Pre-training layer 3, epoch 4, cost  0.241759626254
Pre-training layer 3, epoch 5, cost  0.201458678362
Pre-training layer 3, epoch 6, cost  0.168511988553
Pre-training layer 3, epoch 7, cost  0.144580999922
Pre-training layer 3, epoch 8, cost  0.128847427371
Pre-training layer 3, epoch 9, cost  0.116820473094
Pre-training layer 3, epoch 10, cost  0.106955903149
Pre-training layer 3, epoch 11, cost  0.097179301397
Pre-training layer 3, epoch 12, cost  0.0891164932717
Pre-training layer 3, epoch 13, cost  0.0850753084306
Pre-training layer 3, epoch 14, cost  0.0800777841461
Pre-training layer 3, epoch 15, cost  0.0756592257432
Pre-training layer 3, epoch 16, cost  0.0719087849659
Pre-training layer 3, epoch 17, cost  0.0689093530471
Pre-training layer 3, epoch 18, cost  0.0656211287203
Pre-training layer 3, epoch 19, cost  0.0628312073151
Pre-training layer 3, epoch 20, cost  0.0601511242119
Pre-training layer 3, epoch 21, cost  0.0572916856786
Pre-training layer 3, epoch 22, cost  0.0543259557961
Pre-training layer 3, epoch 23, cost  0.0517397531482
Pre-training layer 3, epoch 24, cost  0.0499107516832
Pre-training layer 3, epoch 25, cost  0.0484528579964
Pre-training layer 3, epoch 26, cost  0.046869498588
Pre-training layer 3, epoch 27, cost  0.0450420785945
Pre-training layer 3, epoch 28, cost  0.0434835033061
Pre-training layer 3, epoch 29, cost  0.0421534214112
Pre-training layer 3, epoch 30, cost  0.0406804721414
Pre-training layer 3, epoch 31, cost  0.0394592445861
Pre-training layer 3, epoch 32, cost  0.0381986970852
Pre-training layer 3, epoch 33, cost  0.0370675549244
Pre-training layer 3, epoch 34, cost  0.0359426381831
Pre-training layer 3, epoch 35, cost  0.034932937554
Pre-training layer 3, epoch 36, cost  0.0339304731354
Pre-training layer 3, epoch 37, cost  0.0329505545225
Pre-training layer 3, epoch 38, cost  0.032088500591
Pre-training layer 3, epoch 39, cost  0.031239782499
Pre-training layer 3, epoch 40, cost  0.0304140294177
Pre-training layer 3, epoch 41, cost  0.0296528212579
Pre-training layer 3, epoch 42, cost  0.028948660808
Pre-training layer 3, epoch 43, cost  0.0282338884165
Pre-training layer 3, epoch 44, cost  0.0273895682112
Pre-training layer 3, epoch 45, cost  0.0263908775234
Pre-training layer 3, epoch 46, cost  0.0255761482396
Pre-training layer 3, epoch 47, cost  0.0250007879658
Pre-training layer 3, epoch 48, cost  0.0245409276419
Pre-training layer 3, epoch 49, cost  0.0241252080941
Pre-training layer 4, epoch 0, cost  4.21594866425
Pre-training layer 4, epoch 1, cost  1.15758302324
Pre-training layer 4, epoch 2, cost  0.95846875459
Pre-training layer 4, epoch 3, cost  0.923071650102
Pre-training layer 4, epoch 4, cost  0.906062339359
Pre-training layer 4, epoch 5, cost  0.893585450008
Pre-training layer 4, epoch 6, cost  0.884682458948
Pre-training layer 4, epoch 7, cost  0.877562741039
Pre-training layer 4, epoch 8, cost  0.871932128706
Pre-training layer 4, epoch 9, cost  0.867116087226
Pre-training layer 4, epoch 10, cost  0.862996662136
Pre-training layer 4, epoch 11, cost  0.859380738738
Pre-training layer 4, epoch 12, cost  0.856233777155
Pre-training layer 4, epoch 13, cost  0.853416169424
Pre-training layer 4, epoch 14, cost  0.850854020598
Pre-training layer 4, epoch 15, cost  0.848586628688
Pre-training layer 4, epoch 16, cost  0.84647268396
Pre-training layer 4, epoch 17, cost  0.844578155246
Pre-training layer 4, epoch 18, cost  0.842837981526
Pre-training layer 4, epoch 19, cost  0.841243992147
Pre-training layer 4, epoch 20, cost  0.839746461245
Pre-training layer 4, epoch 21, cost  0.838356002784
Pre-training layer 4, epoch 22, cost  0.837109113755
Pre-training layer 4, epoch 23, cost  0.835859945238
Pre-training layer 4, epoch 24, cost  0.834769787296
Pre-training layer 4, epoch 25, cost  0.833718954451
Pre-training layer 4, epoch 26, cost  0.832730836389
Pre-training layer 4, epoch 27, cost  0.831818547175
Pre-training layer 4, epoch 28, cost  0.830984172515
Pre-training layer 4, epoch 29, cost  0.830152156626
Pre-training layer 4, epoch 30, cost  0.829356769921
Pre-training layer 4, epoch 31, cost  0.828627155053
Pre-training layer 4, epoch 32, cost  0.827941561643
Pre-training layer 4, epoch 33, cost  0.827273910415
Pre-training layer 4, epoch 34, cost  0.826665469215
Pre-training layer 4, epoch 35, cost  0.826045631865
Pre-training layer 4, epoch 36, cost  0.825492730553
Pre-training layer 4, epoch 37, cost  0.824944347771
Pre-training layer 4, epoch 38, cost  0.824440171762
Pre-training layer 4, epoch 39, cost  0.82394371641
Pre-training layer 4, epoch 40, cost  0.823473926454
Pre-training layer 4, epoch 41, cost  0.823033644522
Pre-training layer 4, epoch 42, cost  0.822601951222
Pre-training layer 4, epoch 43, cost  0.8221685085
Pre-training layer 4, epoch 44, cost  0.821789163296
Pre-training layer 4, epoch 45, cost  0.821391992498
Pre-training layer 4, epoch 46, cost  0.821043537627
Pre-training layer 4, epoch 47, cost  0.820695350687
Pre-training layer 4, epoch 48, cost  0.82035438511
Pre-training layer 4, epoch 49, cost  0.82002888496
Pre-training layer 5, epoch 0, cost  5.46561198948
Pre-training layer 5, epoch 1, cost  3.45716021112
Pre-training layer 5, epoch 2, cost  3.44536806694
Pre-training layer 5, epoch 3, cost  3.44203334462
Pre-training layer 5, epoch 4, cost  3.44011873254
Pre-training layer 5, epoch 5, cost  3.43862119364
Pre-training layer 5, epoch 6, cost  3.43723023043
Pre-training layer 5, epoch 7, cost  3.43581222995
Pre-training layer 5, epoch 8, cost  3.43431470556
Pre-training layer 5, epoch 9, cost  3.43274054171
Pre-training layer 5, epoch 10, cost  3.43108967421
Pre-training layer 5, epoch 11, cost  3.42931624036
Pre-training layer 5, epoch 12, cost  3.4272890423
Pre-training layer 5, epoch 13, cost  3.42478157237
Pre-training layer 5, epoch 14, cost  3.42145605093
Pre-training layer 5, epoch 15, cost  3.41678676225
Pre-training layer 5, epoch 16, cost  3.4100237517
Pre-training layer 5, epoch 17, cost  3.40056677817
Pre-training layer 5, epoch 18, cost  3.3898208092
Pre-training layer 5, epoch 19, cost  3.38186092313
Pre-training layer 5, epoch 20, cost  3.37763400983
Pre-training layer 5, epoch 21, cost  3.37521810931
Pre-training layer 5, epoch 22, cost  3.37358981455
Pre-training layer 5, epoch 23, cost  3.37238166332
Pre-training layer 5, epoch 24, cost  3.37142678299
Pre-training layer 5, epoch 25, cost  3.37063677105
Pre-training layer 5, epoch 26, cost  3.36996173243
Pre-training layer 5, epoch 27, cost  3.36936942103
Pre-training layer 5, epoch 28, cost  3.36884004924
Pre-training layer 5, epoch 29, cost  3.36835983005
Pre-training layer 5, epoch 30, cost  3.36792015812
Pre-training layer 5, epoch 31, cost  3.36751311278
Pre-training layer 5, epoch 32, cost  3.36713353023
Pre-training layer 5, epoch 33, cost  3.36677804576
Pre-training layer 5, epoch 34, cost  3.36644381865
Pre-training layer 5, epoch 35, cost  3.36612763725
Pre-training layer 5, epoch 36, cost  3.36582812694
Pre-training layer 5, epoch 37, cost  3.36554323227
Pre-training layer 5, epoch 38, cost  3.3652720227
Pre-training layer 5, epoch 39, cost  3.36501281162
Pre-training layer 5, epoch 40, cost  3.36476489433
Pre-training layer 5, epoch 41, cost  3.36452753059
Pre-training layer 5, epoch 42, cost  3.36429969882
Pre-training layer 5, epoch 43, cost  3.36408081528
Pre-training layer 5, epoch 44, cost  3.36387055562
Pre-training layer 5, epoch 45, cost  3.36366815506
Pre-training layer 5, epoch 46, cost  3.36347297025
Pre-training layer 5, epoch 47, cost  3.36328467424
Pre-training layer 5, epoch 48, cost  3.36310307003
The pretraining code for file multi_layer_km.pyc ran for 25.73m
Pre-training layer 5, epoch 49, cost  3.3629276024
Initial NMI for deep clustering: 0.52
ARI for deep clustering: 0.39
ACC for deep clustering: 0.54
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.13584, Reconstruction: 1.83500, Clustering: 0.30083,
Fine-tuning epoch 2 ++++
Total cost: 1.60883, Reconstruction: 1.30913, Clustering: 0.29971,
Fine-tuning epoch 3 ++++
Total cost: 1.45353, Reconstruction: 1.16368, Clustering: 0.28986,
Fine-tuning epoch 4 ++++
Total cost: 1.35026, Reconstruction: 1.07328, Clustering: 0.27698,
Fine-tuning epoch 5 ++++
Total cost: 1.28531, Reconstruction: 1.01709, Clustering: 0.26822,
Fine-tuning epoch 6 ++++
Total cost: 1.23939, Reconstruction: 0.97906, Clustering: 0.26033,
Fine-tuning epoch 7 ++++
Total cost: 1.20603, Reconstruction: 0.95085, Clustering: 0.25518,
Fine-tuning epoch 8 ++++
Total cost: 1.17652, Reconstruction: 0.92613, Clustering: 0.25038,
Fine-tuning epoch 9 ++++
Total cost: 1.15458, Reconstruction: 0.90778, Clustering: 0.24681,
Fine-tuning epoch 10 ++++
Total cost: 1.13696, Reconstruction: 0.89310, Clustering: 0.24385,
Fine-tuning epoch 11 ++++
Total cost: 1.11468, Reconstruction: 0.87518, Clustering: 0.23950,
Fine-tuning epoch 12 ++++
Total cost: 1.10633, Reconstruction: 0.86677, Clustering: 0.23956,
Fine-tuning epoch 13 ++++
Total cost: 1.09445, Reconstruction: 0.85659, Clustering: 0.23786,
Fine-tuning epoch 14 ++++
Total cost: 1.08240, Reconstruction: 0.84588, Clustering: 0.23652,
Fine-tuning epoch 15 ++++
Total cost: 1.06617, Reconstruction: 0.83307, Clustering: 0.23310,
Fine-tuning epoch 16 ++++
Total cost: 1.06317, Reconstruction: 0.82937, Clustering: 0.23380,
Fine-tuning epoch 17 ++++
Total cost: 1.04743, Reconstruction: 0.81597, Clustering: 0.23146,
Fine-tuning epoch 18 ++++
Total cost: 1.03944, Reconstruction: 0.80882, Clustering: 0.23061,
Fine-tuning epoch 19 ++++
Total cost: 1.02932, Reconstruction: 0.80074, Clustering: 0.22858,
Fine-tuning epoch 20 ++++
Total cost: 1.02775, Reconstruction: 0.79794, Clustering: 0.22980,
Fine-tuning epoch 21 ++++
Total cost: 1.01431, Reconstruction: 0.78714, Clustering: 0.22717,
Fine-tuning epoch 22 ++++
Total cost: 1.00484, Reconstruction: 0.77918, Clustering: 0.22566,
Fine-tuning epoch 23 ++++
Total cost: 0.99839, Reconstruction: 0.77353, Clustering: 0.22486,
Fine-tuning epoch 24 ++++
Total cost: 0.98622, Reconstruction: 0.76392, Clustering: 0.22230,
Fine-tuning epoch 25 ++++
Total cost: 0.97843, Reconstruction: 0.75722, Clustering: 0.22121,
Fine-tuning epoch 26 ++++
Total cost: 0.97309, Reconstruction: 0.75237, Clustering: 0.22072,
Fine-tuning epoch 27 ++++
Total cost: 0.95942, Reconstruction: 0.74149, Clustering: 0.21793,
Fine-tuning epoch 28 ++++
Total cost: 0.95513, Reconstruction: 0.73775, Clustering: 0.21738,
Fine-tuning epoch 29 ++++
Total cost: 0.94856, Reconstruction: 0.73114, Clustering: 0.21742,
Fine-tuning epoch 30 ++++
Total cost: 0.94393, Reconstruction: 0.72699, Clustering: 0.21694,
Fine-tuning epoch 31 ++++
Total cost: 0.93478, Reconstruction: 0.72000, Clustering: 0.21479,
Fine-tuning epoch 32 ++++
Total cost: 0.92648, Reconstruction: 0.71258, Clustering: 0.21390,
Fine-tuning epoch 33 ++++
Total cost: 0.92688, Reconstruction: 0.71205, Clustering: 0.21483,
Fine-tuning epoch 34 ++++
Total cost: 0.92373, Reconstruction: 0.70823, Clustering: 0.21550,
Fine-tuning epoch 35 ++++
Total cost: 0.91527, Reconstruction: 0.70111, Clustering: 0.21416,
Fine-tuning epoch 36 ++++
Total cost: 0.91187, Reconstruction: 0.69768, Clustering: 0.21419,
Fine-tuning epoch 37 ++++
Total cost: 0.90286, Reconstruction: 0.69062, Clustering: 0.21224,
Fine-tuning epoch 38 ++++
Total cost: 0.89907, Reconstruction: 0.68681, Clustering: 0.21226,
Fine-tuning epoch 39 ++++
Total cost: 0.90053, Reconstruction: 0.68687, Clustering: 0.21366,
Fine-tuning epoch 40 ++++
Total cost: 0.88754, Reconstruction: 0.67750, Clustering: 0.21004,
Fine-tuning epoch 41 ++++
Total cost: 0.88886, Reconstruction: 0.67716, Clustering: 0.21169,
Fine-tuning epoch 42 ++++
Total cost: 0.88126, Reconstruction: 0.67127, Clustering: 0.20999,
Fine-tuning epoch 43 ++++
Total cost: 0.88090, Reconstruction: 0.66954, Clustering: 0.21136,
Fine-tuning epoch 44 ++++
Total cost: 0.87793, Reconstruction: 0.66684, Clustering: 0.21110,
Fine-tuning epoch 45 ++++
Total cost: 0.87037, Reconstruction: 0.66083, Clustering: 0.20954,
Fine-tuning epoch 46 ++++
Total cost: 0.86844, Reconstruction: 0.65925, Clustering: 0.20919,
Fine-tuning epoch 47 ++++
Total cost: 0.86697, Reconstruction: 0.65667, Clustering: 0.21030,
Fine-tuning epoch 48 ++++
Total cost: 0.86083, Reconstruction: 0.65131, Clustering: 0.20953,
Fine-tuning epoch 49 ++++
Total cost: 0.85962, Reconstruction: 0.65023, Clustering: 0.20939,
Fine-tuning epoch 50 ++++
Total cost: 0.85147, Reconstruction: 0.64431, Clustering: 0.20715,
Average squared 2-D reconstruction error: 0.6443
NMI for deep clustering: 0.60
ARI for deep clustering: 0.43
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 24.16m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.15894425675
Pre-training layer 0, epoch 1, cost  0.991874547875
Pre-training layer 0, epoch 2, cost  0.798755723358
Pre-training layer 0, epoch 3, cost  0.709906300067
Pre-training layer 0, epoch 4, cost  0.655440284527
Pre-training layer 0, epoch 5, cost  0.617031901337
Pre-training layer 0, epoch 6, cost  0.58781552858
Pre-training layer 0, epoch 7, cost  0.564287399868
Pre-training layer 0, epoch 8, cost  0.545052486194
Pre-training layer 0, epoch 9, cost  0.528784242513
Pre-training layer 0, epoch 10, cost  0.514749776845
Pre-training layer 0, epoch 11, cost  0.502453312873
Pre-training layer 0, epoch 12, cost  0.491543922932
Pre-training layer 0, epoch 13, cost  0.481685391583
Pre-training layer 0, epoch 14, cost  0.472719131869
Pre-training layer 0, epoch 15, cost  0.464605205376
Pre-training layer 0, epoch 16, cost  0.457168354753
Pre-training layer 0, epoch 17, cost  0.450271910084
Pre-training layer 0, epoch 18, cost  0.443894889711
Pre-training layer 0, epoch 19, cost  0.437972231826
Pre-training layer 0, epoch 20, cost  0.432432292641
Pre-training layer 0, epoch 21, cost  0.427239868864
Pre-training layer 0, epoch 22, cost  0.422351772934
Pre-training layer 0, epoch 23, cost  0.417715369242
Pre-training layer 0, epoch 24, cost  0.413314514471
Pre-training layer 0, epoch 25, cost  0.409163447337
Pre-training layer 0, epoch 26, cost  0.405222231467
Pre-training layer 0, epoch 27, cost  0.401472537067
Pre-training layer 0, epoch 28, cost  0.397900991737
Pre-training layer 0, epoch 29, cost  0.394495152213
Pre-training layer 0, epoch 30, cost  0.39098468913
Pre-training layer 0, epoch 31, cost  0.387546364482
Pre-training layer 0, epoch 32, cost  0.384477517205
Pre-training layer 0, epoch 33, cost  0.381573392684
Pre-training layer 0, epoch 34, cost  0.378792153832
Pre-training layer 0, epoch 35, cost  0.376092270842
Pre-training layer 0, epoch 36, cost  0.373501897328
Pre-training layer 0, epoch 37, cost  0.371015754512
Pre-training layer 0, epoch 38, cost  0.368618100063
Pre-training layer 0, epoch 39, cost  0.366306596765
Pre-training layer 0, epoch 40, cost  0.364069372289
Pre-training layer 0, epoch 41, cost  0.361901495244
Pre-training layer 0, epoch 42, cost  0.359818366935
Pre-training layer 0, epoch 43, cost  0.357812002549
Pre-training layer 0, epoch 44, cost  0.355856716244
Pre-training layer 0, epoch 45, cost  0.35395950258
Pre-training layer 0, epoch 46, cost  0.352117606315
Pre-training layer 0, epoch 47, cost  0.350322618658
Pre-training layer 0, epoch 48, cost  0.348578044601
Pre-training layer 0, epoch 49, cost  0.346889203121
Pre-training layer 1, epoch 0, cost  3.91270053364
Pre-training layer 1, epoch 1, cost  1.0320523368
Pre-training layer 1, epoch 2, cost  0.745839921033
Pre-training layer 1, epoch 3, cost  0.622259479024
Pre-training layer 1, epoch 4, cost  0.551300962533
Pre-training layer 1, epoch 5, cost  0.502910228196
Pre-training layer 1, epoch 6, cost  0.466112603375
Pre-training layer 1, epoch 7, cost  0.436851764498
Pre-training layer 1, epoch 8, cost  0.41411411766
Pre-training layer 1, epoch 9, cost  0.394580177559
Pre-training layer 1, epoch 10, cost  0.37738542688
Pre-training layer 1, epoch 11, cost  0.362274719929
Pre-training layer 1, epoch 12, cost  0.350051030955
Pre-training layer 1, epoch 13, cost  0.33834288595
Pre-training layer 1, epoch 14, cost  0.327814580927
Pre-training layer 1, epoch 15, cost  0.319129082439
Pre-training layer 1, epoch 16, cost  0.310067675908
Pre-training layer 1, epoch 17, cost  0.302821048355
Pre-training layer 1, epoch 18, cost  0.295597719391
Pre-training layer 1, epoch 19, cost  0.289706211372
Pre-training layer 1, epoch 20, cost  0.28341274487
Pre-training layer 1, epoch 21, cost  0.278102087068
Pre-training layer 1, epoch 22, cost  0.272985479365
Pre-training layer 1, epoch 23, cost  0.268257271023
Pre-training layer 1, epoch 24, cost  0.263750980049
Pre-training layer 1, epoch 25, cost  0.259474762455
Pre-training layer 1, epoch 26, cost  0.25548826463
Pre-training layer 1, epoch 27, cost  0.251869179986
Pre-training layer 1, epoch 28, cost  0.248276951925
Pre-training layer 1, epoch 29, cost  0.245057248291
Pre-training layer 1, epoch 30, cost  0.241994621701
Pre-training layer 1, epoch 31, cost  0.238965013466
Pre-training layer 1, epoch 32, cost  0.236350128432
Pre-training layer 1, epoch 33, cost  0.233460222209
Pre-training layer 1, epoch 34, cost  0.230833494807
Pre-training layer 1, epoch 35, cost  0.22858363653
Pre-training layer 1, epoch 36, cost  0.226774284685
Pre-training layer 1, epoch 37, cost  0.223785889844
Pre-training layer 1, epoch 38, cost  0.221970527367
Pre-training layer 1, epoch 39, cost  0.21984328078
Pre-training layer 1, epoch 40, cost  0.217910351138
Pre-training layer 1, epoch 41, cost  0.216037046012
Pre-training layer 1, epoch 42, cost  0.214275814608
Pre-training layer 1, epoch 43, cost  0.212546279134
Pre-training layer 1, epoch 44, cost  0.21089805312
Pre-training layer 1, epoch 45, cost  0.209400111632
Pre-training layer 1, epoch 46, cost  0.208000731205
Pre-training layer 1, epoch 47, cost  0.20644587504
Pre-training layer 1, epoch 48, cost  0.205024330106
Pre-training layer 1, epoch 49, cost  0.203667723415
Pre-training layer 2, epoch 0, cost  4.80414599723
Pre-training layer 2, epoch 1, cost  1.40344984802
Pre-training layer 2, epoch 2, cost  1.06823988047
Pre-training layer 2, epoch 3, cost  0.90660446352
Pre-training layer 2, epoch 4, cost  0.813691316464
Pre-training layer 2, epoch 5, cost  0.739767186741
Pre-training layer 2, epoch 6, cost  0.694424463247
Pre-training layer 2, epoch 7, cost  0.649230671954
Pre-training layer 2, epoch 8, cost  0.628307838018
Pre-training layer 2, epoch 9, cost  0.610610620994
Pre-training layer 2, epoch 10, cost  0.582677888254
Pre-training layer 2, epoch 11, cost  0.564007408078
Pre-training layer 2, epoch 12, cost  0.550869689204
Pre-training layer 2, epoch 13, cost  0.540987403686
Pre-training layer 2, epoch 14, cost  0.530922330524
Pre-training layer 2, epoch 15, cost  0.52344545385
Pre-training layer 2, epoch 16, cost  0.512054351221
Pre-training layer 2, epoch 17, cost  0.497627958148
Pre-training layer 2, epoch 18, cost  0.501587841708
Pre-training layer 2, epoch 19, cost  0.486491028837
Pre-training layer 2, epoch 20, cost  0.482084496326
Pre-training layer 2, epoch 21, cost  0.481392610921
Pre-training layer 2, epoch 22, cost  0.475039014723
Pre-training layer 2, epoch 23, cost  0.466784296412
Pre-training layer 2, epoch 24, cost  0.465688130902
Pre-training layer 2, epoch 25, cost  0.46319695442
Pre-training layer 2, epoch 26, cost  0.460619501125
Pre-training layer 2, epoch 27, cost  0.457232185298
Pre-training layer 2, epoch 28, cost  0.453134229443
Pre-training layer 2, epoch 29, cost  0.449375839384
Pre-training layer 2, epoch 30, cost  0.447616742131
Pre-training layer 2, epoch 31, cost  0.445856990098
Pre-training layer 2, epoch 32, cost  0.441318039102
Pre-training layer 2, epoch 33, cost  0.441431984286
Pre-training layer 2, epoch 34, cost  0.436991676814
Pre-training layer 2, epoch 35, cost  0.437553839982
Pre-training layer 2, epoch 36, cost  0.434452590105
Pre-training layer 2, epoch 37, cost  0.433259148622
Pre-training layer 2, epoch 38, cost  0.431912688815
Pre-training layer 2, epoch 39, cost  0.430447085543
Pre-training layer 2, epoch 40, cost  0.428980524078
Pre-training layer 2, epoch 41, cost  0.42735353871
Pre-training layer 2, epoch 42, cost  0.425931388844
Pre-training layer 2, epoch 43, cost  0.42456089632
Pre-training layer 2, epoch 44, cost  0.423024130197
Pre-training layer 2, epoch 45, cost  0.42170354385
Pre-training layer 2, epoch 46, cost  0.421110125009
Pre-training layer 2, epoch 47, cost  0.420778963764
Pre-training layer 2, epoch 48, cost  0.419936594732
Pre-training layer 2, epoch 49, cost  0.418847992583
Pre-training layer 3, epoch 0, cost  3.59955659083
Pre-training layer 3, epoch 1, cost  0.698016514264
Pre-training layer 3, epoch 2, cost  0.441975571711
Pre-training layer 3, epoch 3, cost  0.313321474954
Pre-training layer 3, epoch 4, cost  0.24180682451
Pre-training layer 3, epoch 5, cost  0.194098710059
Pre-training layer 3, epoch 6, cost  0.166529121573
Pre-training layer 3, epoch 7, cost  0.145471362233
Pre-training layer 3, epoch 8, cost  0.127513997674
Pre-training layer 3, epoch 9, cost  0.114285840969
Pre-training layer 3, epoch 10, cost  0.103836851039
Pre-training layer 3, epoch 11, cost  0.0972557109694
Pre-training layer 3, epoch 12, cost  0.0918910941594
Pre-training layer 3, epoch 13, cost  0.0846539556428
Pre-training layer 3, epoch 14, cost  0.0798458380619
Pre-training layer 3, epoch 15, cost  0.0755457341803
Pre-training layer 3, epoch 16, cost  0.071741186434
Pre-training layer 3, epoch 17, cost  0.0678032653541
Pre-training layer 3, epoch 18, cost  0.0648755429413
Pre-training layer 3, epoch 19, cost  0.0617976038481
Pre-training layer 3, epoch 20, cost  0.0588015242474
Pre-training layer 3, epoch 21, cost  0.0562649855116
Pre-training layer 3, epoch 22, cost  0.0543013739051
Pre-training layer 3, epoch 23, cost  0.0524772396153
Pre-training layer 3, epoch 24, cost  0.0505523561529
Pre-training layer 3, epoch 25, cost  0.0483804701281
Pre-training layer 3, epoch 26, cost  0.0463388647019
Pre-training layer 3, epoch 27, cost  0.0449929276048
Pre-training layer 3, epoch 28, cost  0.0436012556182
Pre-training layer 3, epoch 29, cost  0.0418671813277
Pre-training layer 3, epoch 30, cost  0.0408646055348
Pre-training layer 3, epoch 31, cost  0.0392898465016
Pre-training layer 3, epoch 32, cost  0.03837698574
Pre-training layer 3, epoch 33, cost  0.0369595715963
Pre-training layer 3, epoch 34, cost  0.0360453700483
Pre-training layer 3, epoch 35, cost  0.0350230894737
Pre-training layer 3, epoch 36, cost  0.0338869992974
Pre-training layer 3, epoch 37, cost  0.0330574882859
Pre-training layer 3, epoch 38, cost  0.0322227069603
Pre-training layer 3, epoch 39, cost  0.0312992852697
Pre-training layer 3, epoch 40, cost  0.0304317813736
Pre-training layer 3, epoch 41, cost  0.0296678212869
Pre-training layer 3, epoch 42, cost  0.0289672919369
Pre-training layer 3, epoch 43, cost  0.028293267669
Pre-training layer 3, epoch 44, cost  0.0276579461262
Pre-training layer 3, epoch 45, cost  0.0269996575921
Pre-training layer 3, epoch 46, cost  0.0261917559939
Pre-training layer 3, epoch 47, cost  0.0248089963398
Pre-training layer 3, epoch 48, cost  0.0237125252514
Pre-training layer 3, epoch 49, cost  0.0243636134323
Pre-training layer 4, epoch 0, cost  4.23169315509
Pre-training layer 4, epoch 1, cost  1.15819628226
Pre-training layer 4, epoch 2, cost  0.956351689655
Pre-training layer 4, epoch 3, cost  0.918674084784
Pre-training layer 4, epoch 4, cost  0.901632639763
Pre-training layer 4, epoch 5, cost  0.888812220782
Pre-training layer 4, epoch 6, cost  0.879384904038
Pre-training layer 4, epoch 7, cost  0.87199710377
Pre-training layer 4, epoch 8, cost  0.865924340176
Pre-training layer 4, epoch 9, cost  0.860845367494
Pre-training layer 4, epoch 10, cost  0.856600539084
Pre-training layer 4, epoch 11, cost  0.852805894573
Pre-training layer 4, epoch 12, cost  0.849627218937
Pre-training layer 4, epoch 13, cost  0.846767953136
Pre-training layer 4, epoch 14, cost  0.844178098539
Pre-training layer 4, epoch 15, cost  0.841787985188
Pre-training layer 4, epoch 16, cost  0.839660411044
Pre-training layer 4, epoch 17, cost  0.837789349257
Pre-training layer 4, epoch 18, cost  0.836059372462
Pre-training layer 4, epoch 19, cost  0.834395237305
Pre-training layer 4, epoch 20, cost  0.832899096216
Pre-training layer 4, epoch 21, cost  0.831588732988
Pre-training layer 4, epoch 22, cost  0.830273794638
Pre-training layer 4, epoch 23, cost  0.829079320002
Pre-training layer 4, epoch 24, cost  0.827959699735
Pre-training layer 4, epoch 25, cost  0.826939990544
Pre-training layer 4, epoch 26, cost  0.82593707763
Pre-training layer 4, epoch 27, cost  0.825004622523
Pre-training layer 4, epoch 28, cost  0.824161137938
Pre-training layer 4, epoch 29, cost  0.823342585666
Pre-training layer 4, epoch 30, cost  0.822582088808
Pre-training layer 4, epoch 31, cost  0.821872968882
Pre-training layer 4, epoch 32, cost  0.821183282754
Pre-training layer 4, epoch 33, cost  0.820503273335
Pre-training layer 4, epoch 34, cost  0.819912395848
Pre-training layer 4, epoch 35, cost  0.819288842695
Pre-training layer 4, epoch 36, cost  0.818753994058
Pre-training layer 4, epoch 37, cost  0.818223559976
Pre-training layer 4, epoch 38, cost  0.817698263244
Pre-training layer 4, epoch 39, cost  0.817248883356
Pre-training layer 4, epoch 40, cost  0.816775525693
Pre-training layer 4, epoch 41, cost  0.816335832273
Pre-training layer 4, epoch 42, cost  0.815910570489
Pre-training layer 4, epoch 43, cost  0.815504438731
Pre-training layer 4, epoch 44, cost  0.815118446839
Pre-training layer 4, epoch 45, cost  0.81474884996
Pre-training layer 4, epoch 46, cost  0.814397330627
Pre-training layer 4, epoch 47, cost  0.814048164341
Pre-training layer 4, epoch 48, cost  0.813711273011
Pre-training layer 4, epoch 49, cost  0.813399022951
Pre-training layer 5, epoch 0, cost  5.43430505692
Pre-training layer 5, epoch 1, cost  3.43775339044
Pre-training layer 5, epoch 2, cost  3.42121708423
Pre-training layer 5, epoch 3, cost  3.41503242265
Pre-training layer 5, epoch 4, cost  3.41191992646
Pre-training layer 5, epoch 5, cost  3.41013724849
Pre-training layer 5, epoch 6, cost  3.40888613439
Pre-training layer 5, epoch 7, cost  3.40785100744
Pre-training layer 5, epoch 8, cost  3.40689398304
Pre-training layer 5, epoch 9, cost  3.4059484571
Pre-training layer 5, epoch 10, cost  3.40496092156
Pre-training layer 5, epoch 11, cost  3.40388339042
Pre-training layer 5, epoch 12, cost  3.40266173874
Pre-training layer 5, epoch 13, cost  3.40122414397
Pre-training layer 5, epoch 14, cost  3.39946939844
Pre-training layer 5, epoch 15, cost  3.39725039796
Pre-training layer 5, epoch 16, cost  3.39434180112
Pre-training layer 5, epoch 17, cost  3.39039524191
Pre-training layer 5, epoch 18, cost  3.3849120583
Pre-training layer 5, epoch 19, cost  3.3774172577
Pre-training layer 5, epoch 20, cost  3.36842918422
Pre-training layer 5, epoch 21, cost  3.3606048613
Pre-training layer 5, epoch 22, cost  3.35587294712
Pre-training layer 5, epoch 23, cost  3.35319145892
Pre-training layer 5, epoch 24, cost  3.35142845965
Pre-training layer 5, epoch 25, cost  3.35013609615
Pre-training layer 5, epoch 26, cost  3.34912279606
Pre-training layer 5, epoch 27, cost  3.34828962659
Pre-training layer 5, epoch 28, cost  3.347581717
Pre-training layer 5, epoch 29, cost  3.34696223529
Pre-training layer 5, epoch 30, cost  3.34640943822
Pre-training layer 5, epoch 31, cost  3.34590909324
Pre-training layer 5, epoch 32, cost  3.34545066623
Pre-training layer 5, epoch 33, cost  3.34502666099
Pre-training layer 5, epoch 34, cost  3.34463163567
Pre-training layer 5, epoch 35, cost  3.34426096862
Pre-training layer 5, epoch 36, cost  3.34391171627
Pre-training layer 5, epoch 37, cost  3.34358103924
Pre-training layer 5, epoch 38, cost  3.34326687695
Pre-training layer 5, epoch 39, cost  3.34296781188
Pre-training layer 5, epoch 40, cost  3.34268191941
Pre-training layer 5, epoch 41, cost  3.34240816533
Pre-training layer 5, epoch 42, cost  3.34214548898
Pre-training layer 5, epoch 43, cost  3.34189337911
Pre-training layer 5, epoch 44, cost  3.34165045344
Pre-training layer 5, epoch 45, cost  3.34141664441
Pre-training layer 5, epoch 46, cost  3.3411908992
Pre-training layer 5, epoch 47, cost  3.34097294093
Pre-training layer 5, epoch 48, cost  3.3407624472
The pretraining code for file multi_layer_km.pyc ran for 25.75m
Pre-training layer 5, epoch 49, cost  3.34055852763
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
... getting the finetuning functions
ACC for deep clustering: 0.53
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.22211, Reconstruction: 1.89907, Clustering: 0.32303,
Fine-tuning epoch 2 ++++
Total cost: 1.60522, Reconstruction: 1.28765, Clustering: 0.31757,
Fine-tuning epoch 3 ++++
Total cost: 1.45592, Reconstruction: 1.15452, Clustering: 0.30140,
Fine-tuning epoch 4 ++++
Total cost: 1.36072, Reconstruction: 1.07401, Clustering: 0.28671,
Fine-tuning epoch 5 ++++
Total cost: 1.29402, Reconstruction: 1.01939, Clustering: 0.27463,
Fine-tuning epoch 6 ++++
Total cost: 1.25078, Reconstruction: 0.98442, Clustering: 0.26635,
Fine-tuning epoch 7 ++++
Total cost: 1.21599, Reconstruction: 0.95617, Clustering: 0.25981,
Fine-tuning epoch 8 ++++
Total cost: 1.19168, Reconstruction: 0.93611, Clustering: 0.25557,
Fine-tuning epoch 9 ++++
Total cost: 1.16315, Reconstruction: 0.91337, Clustering: 0.24979,
Fine-tuning epoch 10 ++++
Total cost: 1.14555, Reconstruction: 0.89841, Clustering: 0.24714,
Fine-tuning epoch 11 ++++
Total cost: 1.12657, Reconstruction: 0.88268, Clustering: 0.24389,
Fine-tuning epoch 12 ++++
Total cost: 1.11465, Reconstruction: 0.87254, Clustering: 0.24210,
Fine-tuning epoch 13 ++++
Total cost: 1.09598, Reconstruction: 0.85803, Clustering: 0.23795,
Fine-tuning epoch 14 ++++
Total cost: 1.08562, Reconstruction: 0.84900, Clustering: 0.23661,
Fine-tuning epoch 15 ++++
Total cost: 1.07533, Reconstruction: 0.84069, Clustering: 0.23464,
Fine-tuning epoch 16 ++++
Total cost: 1.06654, Reconstruction: 0.83304, Clustering: 0.23350,
Fine-tuning epoch 17 ++++
Total cost: 1.05505, Reconstruction: 0.82405, Clustering: 0.23100,
Fine-tuning epoch 18 ++++
Total cost: 1.04681, Reconstruction: 0.81653, Clustering: 0.23028,
Fine-tuning epoch 19 ++++
Total cost: 1.03429, Reconstruction: 0.80610, Clustering: 0.22818,
Fine-tuning epoch 20 ++++
Total cost: 1.02591, Reconstruction: 0.79889, Clustering: 0.22701,
Fine-tuning epoch 21 ++++
Total cost: 1.00855, Reconstruction: 0.78561, Clustering: 0.22293,
Fine-tuning epoch 22 ++++
Total cost: 0.99819, Reconstruction: 0.77633, Clustering: 0.22186,
Fine-tuning epoch 23 ++++
Total cost: 0.98567, Reconstruction: 0.76591, Clustering: 0.21976,
Fine-tuning epoch 24 ++++
Total cost: 0.97830, Reconstruction: 0.75824, Clustering: 0.22006,
Fine-tuning epoch 25 ++++
Total cost: 0.97314, Reconstruction: 0.75354, Clustering: 0.21960,
Fine-tuning epoch 26 ++++
Total cost: 0.96023, Reconstruction: 0.74326, Clustering: 0.21697,
Fine-tuning epoch 27 ++++
Total cost: 0.95561, Reconstruction: 0.73850, Clustering: 0.21710,
Fine-tuning epoch 28 ++++
Total cost: 0.94968, Reconstruction: 0.73209, Clustering: 0.21759,
Fine-tuning epoch 29 ++++
Total cost: 0.94407, Reconstruction: 0.72679, Clustering: 0.21729,
Fine-tuning epoch 30 ++++
Total cost: 0.93500, Reconstruction: 0.71939, Clustering: 0.21561,
Fine-tuning epoch 31 ++++
Total cost: 0.92812, Reconstruction: 0.71319, Clustering: 0.21493,
Fine-tuning epoch 32 ++++
Total cost: 0.92159, Reconstruction: 0.70819, Clustering: 0.21340,
Fine-tuning epoch 33 ++++
Total cost: 0.92095, Reconstruction: 0.70593, Clustering: 0.21501,
Fine-tuning epoch 34 ++++
Total cost: 0.91407, Reconstruction: 0.69962, Clustering: 0.21444,
Fine-tuning epoch 35 ++++
Total cost: 0.90660, Reconstruction: 0.69337, Clustering: 0.21323,
Fine-tuning epoch 36 ++++
Total cost: 0.89780, Reconstruction: 0.68591, Clustering: 0.21190,
Fine-tuning epoch 37 ++++
Total cost: 0.89288, Reconstruction: 0.68148, Clustering: 0.21140,
Fine-tuning epoch 38 ++++
Total cost: 0.88543, Reconstruction: 0.67630, Clustering: 0.20912,
Fine-tuning epoch 39 ++++
Total cost: 0.88200, Reconstruction: 0.67286, Clustering: 0.20913,
Fine-tuning epoch 40 ++++
Total cost: 0.87880, Reconstruction: 0.66852, Clustering: 0.21027,
Fine-tuning epoch 41 ++++
Total cost: 0.87170, Reconstruction: 0.66319, Clustering: 0.20851,
Fine-tuning epoch 42 ++++
Total cost: 0.86654, Reconstruction: 0.65839, Clustering: 0.20815,
Fine-tuning epoch 43 ++++
Total cost: 0.86006, Reconstruction: 0.65375, Clustering: 0.20631,
Fine-tuning epoch 44 ++++
Total cost: 0.85038, Reconstruction: 0.64489, Clustering: 0.20549,
Fine-tuning epoch 45 ++++
Total cost: 0.84926, Reconstruction: 0.64398, Clustering: 0.20527,
Fine-tuning epoch 46 ++++
Total cost: 0.84863, Reconstruction: 0.64311, Clustering: 0.20552,
Fine-tuning epoch 47 ++++
Total cost: 0.83820, Reconstruction: 0.63402, Clustering: 0.20417,
Fine-tuning epoch 48 ++++
Total cost: 0.82893, Reconstruction: 0.62697, Clustering: 0.20196,
Fine-tuning epoch 49 ++++
Total cost: 0.82483, Reconstruction: 0.62196, Clustering: 0.20287,
Fine-tuning epoch 50 ++++
Total cost: 0.81769, Reconstruction: 0.61615, Clustering: 0.20154,
Average squared 2-D reconstruction error: 0.6162
NMI for deep clustering: 0.59
ARI for deep clustering: 0.42
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 24.16m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.14842355795
Pre-training layer 0, epoch 1, cost  0.978955573243
Pre-training layer 0, epoch 2, cost  0.787672363749
Pre-training layer 0, epoch 3, cost  0.700938758395
Pre-training layer 0, epoch 4, cost  0.64778731361
Pre-training layer 0, epoch 5, cost  0.610305721987
Pre-training layer 0, epoch 6, cost  0.581949241574
Pre-training layer 0, epoch 7, cost  0.559304969338
Pre-training layer 0, epoch 8, cost  0.540612840963
Pre-training layer 0, epoch 9, cost  0.524810908467
Pre-training layer 0, epoch 10, cost  0.511134188164
Pre-training layer 0, epoch 11, cost  0.499131308372
Pre-training layer 0, epoch 12, cost  0.488438960569
Pre-training layer 0, epoch 13, cost  0.478772806434
Pre-training layer 0, epoch 14, cost  0.469965721264
Pre-training layer 0, epoch 15, cost  0.462045396081
Pre-training layer 0, epoch 16, cost  0.454820558554
Pre-training layer 0, epoch 17, cost  0.448157331788
Pre-training layer 0, epoch 18, cost  0.441977637917
Pre-training layer 0, epoch 19, cost  0.436250896054
Pre-training layer 0, epoch 20, cost  0.430908105313
Pre-training layer 0, epoch 21, cost  0.425915188305
Pre-training layer 0, epoch 22, cost  0.421232872524
Pre-training layer 0, epoch 23, cost  0.416800413924
Pre-training layer 0, epoch 24, cost  0.412616949156
Pre-training layer 0, epoch 25, cost  0.408669328243
Pre-training layer 0, epoch 26, cost  0.404908320097
Pre-training layer 0, epoch 27, cost  0.401353825482
Pre-training layer 0, epoch 28, cost  0.397960158095
Pre-training layer 0, epoch 29, cost  0.394708773828
Pre-training layer 0, epoch 30, cost  0.391591471277
Pre-training layer 0, epoch 31, cost  0.388614822165
Pre-training layer 0, epoch 32, cost  0.385759862003
Pre-training layer 0, epoch 33, cost  0.383008692347
Pre-training layer 0, epoch 34, cost  0.380367202428
Pre-training layer 0, epoch 35, cost  0.377829049152
Pre-training layer 0, epoch 36, cost  0.375388111241
Pre-training layer 0, epoch 37, cost  0.373031777958
Pre-training layer 0, epoch 38, cost  0.370773056482
Pre-training layer 0, epoch 39, cost  0.368575291957
Pre-training layer 0, epoch 40, cost  0.36646889279
Pre-training layer 0, epoch 41, cost  0.364417985069
Pre-training layer 0, epoch 42, cost  0.362430875091
Pre-training layer 0, epoch 43, cost  0.3605120556
Pre-training layer 0, epoch 44, cost  0.35865772268
Pre-training layer 0, epoch 45, cost  0.356859849836
Pre-training layer 0, epoch 46, cost  0.355103443708
Pre-training layer 0, epoch 47, cost  0.353413279195
Pre-training layer 0, epoch 48, cost  0.351769677565
Pre-training layer 0, epoch 49, cost  0.350175455836
Pre-training layer 1, epoch 0, cost  3.87892918408
Pre-training layer 1, epoch 1, cost  1.01960764262
Pre-training layer 1, epoch 2, cost  0.737069457396
Pre-training layer 1, epoch 3, cost  0.616053938973
Pre-training layer 1, epoch 4, cost  0.546035831974
Pre-training layer 1, epoch 5, cost  0.497900675245
Pre-training layer 1, epoch 6, cost  0.462487481211
Pre-training layer 1, epoch 7, cost  0.43471053188
Pre-training layer 1, epoch 8, cost  0.411908248413
Pre-training layer 1, epoch 9, cost  0.392498978098
Pre-training layer 1, epoch 10, cost  0.375482641185
Pre-training layer 1, epoch 11, cost  0.362061113846
Pre-training layer 1, epoch 12, cost  0.349361439522
Pre-training layer 1, epoch 13, cost  0.337532642793
Pre-training layer 1, epoch 14, cost  0.328189193602
Pre-training layer 1, epoch 15, cost  0.318777057253
Pre-training layer 1, epoch 16, cost  0.311109490874
Pre-training layer 1, epoch 17, cost  0.303043515544
Pre-training layer 1, epoch 18, cost  0.296132949201
Pre-training layer 1, epoch 19, cost  0.290156930417
Pre-training layer 1, epoch 20, cost  0.284445408097
Pre-training layer 1, epoch 21, cost  0.278988456327
Pre-training layer 1, epoch 22, cost  0.274022922185
Pre-training layer 1, epoch 23, cost  0.269357291035
Pre-training layer 1, epoch 24, cost  0.264355502439
Pre-training layer 1, epoch 25, cost  0.260496370332
Pre-training layer 1, epoch 26, cost  0.25652841445
Pre-training layer 1, epoch 27, cost  0.253037605033
Pre-training layer 1, epoch 28, cost  0.249617314869
Pre-training layer 1, epoch 29, cost  0.246106650738
Pre-training layer 1, epoch 30, cost  0.243421823696
Pre-training layer 1, epoch 31, cost  0.240365663372
Pre-training layer 1, epoch 32, cost  0.237330411282
Pre-training layer 1, epoch 33, cost  0.234916891803
Pre-training layer 1, epoch 34, cost  0.232203533134
Pre-training layer 1, epoch 35, cost  0.229809724043
Pre-training layer 1, epoch 36, cost  0.227646024069
Pre-training layer 1, epoch 37, cost  0.225339238758
Pre-training layer 1, epoch 38, cost  0.223165959314
Pre-training layer 1, epoch 39, cost  0.221290472134
Pre-training layer 1, epoch 40, cost  0.219281535287
Pre-training layer 1, epoch 41, cost  0.21733012927
Pre-training layer 1, epoch 42, cost  0.215643455871
Pre-training layer 1, epoch 43, cost  0.214111602995
Pre-training layer 1, epoch 44, cost  0.212239857049
Pre-training layer 1, epoch 45, cost  0.210650191507
Pre-training layer 1, epoch 46, cost  0.209442287809
Pre-training layer 1, epoch 47, cost  0.207976792153
Pre-training layer 1, epoch 48, cost  0.206396050837
Pre-training layer 1, epoch 49, cost  0.20506207181
Pre-training layer 2, epoch 0, cost  4.83343550051
Pre-training layer 2, epoch 1, cost  1.42078364025
Pre-training layer 2, epoch 2, cost  1.08267141528
Pre-training layer 2, epoch 3, cost  0.919800307003
Pre-training layer 2, epoch 4, cost  0.82063289671
Pre-training layer 2, epoch 5, cost  0.760124331072
Pre-training layer 2, epoch 6, cost  0.701390730222
Pre-training layer 2, epoch 7, cost  0.679270878527
Pre-training layer 2, epoch 8, cost  0.642169302204
Pre-training layer 2, epoch 9, cost  0.611597609313
Pre-training layer 2, epoch 10, cost  0.598899265691
Pre-training layer 2, epoch 11, cost  0.582635885249
Pre-training layer 2, epoch 12, cost  0.57209217466
Pre-training layer 2, epoch 13, cost  0.551911476372
Pre-training layer 2, epoch 14, cost  0.542741454772
Pre-training layer 2, epoch 15, cost  0.535040902355
Pre-training layer 2, epoch 16, cost  0.525284906871
Pre-training layer 2, epoch 17, cost  0.512750394277
Pre-training layer 2, epoch 18, cost  0.514550241918
Pre-training layer 2, epoch 19, cost  0.500389930194
Pre-training layer 2, epoch 20, cost  0.497018030598
Pre-training layer 2, epoch 21, cost  0.497255187957
Pre-training layer 2, epoch 22, cost  0.487257040739
Pre-training layer 2, epoch 23, cost  0.483325150332
Pre-training layer 2, epoch 24, cost  0.480282870712
Pre-training layer 2, epoch 25, cost  0.477090795624
Pre-training layer 2, epoch 26, cost  0.474233318948
Pre-training layer 2, epoch 27, cost  0.470860448079
Pre-training layer 2, epoch 28, cost  0.467080683423
Pre-training layer 2, epoch 29, cost  0.463317394153
Pre-training layer 2, epoch 30, cost  0.461820743492
Pre-training layer 2, epoch 31, cost  0.459702732225
Pre-training layer 2, epoch 32, cost  0.456014233587
Pre-training layer 2, epoch 33, cost  0.455595446588
Pre-training layer 2, epoch 34, cost  0.452051551503
Pre-training layer 2, epoch 35, cost  0.451341821314
Pre-training layer 2, epoch 36, cost  0.449486516083
Pre-training layer 2, epoch 37, cost  0.448126610275
Pre-training layer 2, epoch 38, cost  0.446442320124
Pre-training layer 2, epoch 39, cost  0.4446693979
Pre-training layer 2, epoch 40, cost  0.443138760102
Pre-training layer 2, epoch 41, cost  0.441708969938
Pre-training layer 2, epoch 42, cost  0.440724329763
Pre-training layer 2, epoch 43, cost  0.440248110155
Pre-training layer 2, epoch 44, cost  0.438984547926
Pre-training layer 2, epoch 45, cost  0.437831961317
Pre-training layer 2, epoch 46, cost  0.436681003083
Pre-training layer 2, epoch 47, cost  0.435433789216
Pre-training layer 2, epoch 48, cost  0.434551130599
Pre-training layer 2, epoch 49, cost  0.433526038902
Pre-training layer 3, epoch 0, cost  3.62353640609
Pre-training layer 3, epoch 1, cost  0.700851787535
Pre-training layer 3, epoch 2, cost  0.441589678176
Pre-training layer 3, epoch 3, cost  0.313823363328
Pre-training layer 3, epoch 4, cost  0.240082380313
Pre-training layer 3, epoch 5, cost  0.192173248602
Pre-training layer 3, epoch 6, cost  0.166335256784
Pre-training layer 3, epoch 7, cost  0.143750899724
Pre-training layer 3, epoch 8, cost  0.125414179078
Pre-training layer 3, epoch 9, cost  0.112925412766
Pre-training layer 3, epoch 10, cost  0.103734853347
Pre-training layer 3, epoch 11, cost  0.0957583225417
Pre-training layer 3, epoch 12, cost  0.0887456375252
Pre-training layer 3, epoch 13, cost  0.0828111982523
Pre-training layer 3, epoch 14, cost  0.0782496946322
Pre-training layer 3, epoch 15, cost  0.0737350878035
Pre-training layer 3, epoch 16, cost  0.0700313960768
Pre-training layer 3, epoch 17, cost  0.0664744841205
Pre-training layer 3, epoch 18, cost  0.0632363156502
Pre-training layer 3, epoch 19, cost  0.0603810460058
Pre-training layer 3, epoch 20, cost  0.0578635789942
Pre-training layer 3, epoch 21, cost  0.0555749484757
Pre-training layer 3, epoch 22, cost  0.053377886449
Pre-training layer 3, epoch 23, cost  0.0511366951393
Pre-training layer 3, epoch 24, cost  0.0490037995209
Pre-training layer 3, epoch 25, cost  0.0472336762303
Pre-training layer 3, epoch 26, cost  0.0457733499743
Pre-training layer 3, epoch 27, cost  0.0442112637327
Pre-training layer 3, epoch 28, cost  0.0426463376791
Pre-training layer 3, epoch 29, cost  0.0413655194673
Pre-training layer 3, epoch 30, cost  0.0399523441781
Pre-training layer 3, epoch 31, cost  0.0387505732444
Pre-training layer 3, epoch 32, cost  0.0375328592341
Pre-training layer 3, epoch 33, cost  0.0364425273437
Pre-training layer 3, epoch 34, cost  0.0353406320507
Pre-training layer 3, epoch 35, cost  0.0343285647226
Pre-training layer 3, epoch 36, cost  0.0333472432183
Pre-training layer 3, epoch 37, cost  0.0324058594085
Pre-training layer 3, epoch 38, cost  0.0315064078399
Pre-training layer 3, epoch 39, cost  0.030635371477
Pre-training layer 3, epoch 40, cost  0.0298419963512
Pre-training layer 3, epoch 41, cost  0.0291567486152
Pre-training layer 3, epoch 42, cost  0.0285599492549
Pre-training layer 3, epoch 43, cost  0.0280289207713
Pre-training layer 3, epoch 44, cost  0.027371999944
Pre-training layer 3, epoch 45, cost  0.0266968273488
Pre-training layer 3, epoch 46, cost  0.0260197025385
Pre-training layer 3, epoch 47, cost  0.0253414225608
Pre-training layer 3, epoch 48, cost  0.0246321720615
Pre-training layer 3, epoch 49, cost  0.0239432326703
Pre-training layer 4, epoch 0, cost  4.23185275827
Pre-training layer 4, epoch 1, cost  1.17022210343
Pre-training layer 4, epoch 2, cost  0.969875500937
Pre-training layer 4, epoch 3, cost  0.933840197198
Pre-training layer 4, epoch 4, cost  0.915222440386
Pre-training layer 4, epoch 5, cost  0.902549523488
Pre-training layer 4, epoch 6, cost  0.893403883734
Pre-training layer 4, epoch 7, cost  0.886185596028
Pre-training layer 4, epoch 8, cost  0.880348056076
Pre-training layer 4, epoch 9, cost  0.87537025695
Pre-training layer 4, epoch 10, cost  0.871053693049
Pre-training layer 4, epoch 11, cost  0.867365818698
Pre-training layer 4, epoch 12, cost  0.864224870526
Pre-training layer 4, epoch 13, cost  0.86132718424
Pre-training layer 4, epoch 14, cost  0.85877293168
Pre-training layer 4, epoch 15, cost  0.856445036045
Pre-training layer 4, epoch 16, cost  0.854378377131
Pre-training layer 4, epoch 17, cost  0.852504569986
Pre-training layer 4, epoch 18, cost  0.850754010623
Pre-training layer 4, epoch 19, cost  0.849131128017
Pre-training layer 4, epoch 20, cost  0.847676727041
Pre-training layer 4, epoch 21, cost  0.846289564834
Pre-training layer 4, epoch 22, cost  0.84500978162
Pre-training layer 4, epoch 23, cost  0.843822182913
Pre-training layer 4, epoch 24, cost  0.842691145481
Pre-training layer 4, epoch 25, cost  0.841665076972
Pre-training layer 4, epoch 26, cost  0.840665759639
Pre-training layer 4, epoch 27, cost  0.839769644861
Pre-training layer 4, epoch 28, cost  0.838895570849
Pre-training layer 4, epoch 29, cost  0.838072626447
Pre-training layer 4, epoch 30, cost  0.837303439527
Pre-training layer 4, epoch 31, cost  0.836539261101
Pre-training layer 4, epoch 32, cost  0.835846589545
Pre-training layer 4, epoch 33, cost  0.83518629304
Pre-training layer 4, epoch 34, cost  0.834562158711
Pre-training layer 4, epoch 35, cost  0.833971842684
Pre-training layer 4, epoch 36, cost  0.833385300861
Pre-training layer 4, epoch 37, cost  0.832875567708
Pre-training layer 4, epoch 38, cost  0.832340141691
Pre-training layer 4, epoch 39, cost  0.831848616972
Pre-training layer 4, epoch 40, cost  0.831392604086
Pre-training layer 4, epoch 41, cost  0.830927605209
Pre-training layer 4, epoch 42, cost  0.830501687491
Pre-training layer 4, epoch 43, cost  0.830089348675
Pre-training layer 4, epoch 44, cost  0.829687113056
Pre-training layer 4, epoch 45, cost  0.829312596388
Pre-training layer 4, epoch 46, cost  0.828939591798
Pre-training layer 4, epoch 47, cost  0.828593418814
Pre-training layer 4, epoch 48, cost  0.8282480275
Pre-training layer 4, epoch 49, cost  0.827931197271
Pre-training layer 5, epoch 0, cost  5.44574741913
Pre-training layer 5, epoch 1, cost  3.43671350028
Pre-training layer 5, epoch 2, cost  3.42404877143
Pre-training layer 5, epoch 3, cost  3.41984997976
Pre-training layer 5, epoch 4, cost  3.41765209941
Pre-training layer 5, epoch 5, cost  3.41616608949
Pre-training layer 5, epoch 6, cost  3.4149541194
Pre-training layer 5, epoch 7, cost  3.41382609384
Pre-training layer 5, epoch 8, cost  3.41267323517
Pre-training layer 5, epoch 9, cost  3.41141175795
Pre-training layer 5, epoch 10, cost  3.40995292014
Pre-training layer 5, epoch 11, cost  3.40817696978
Pre-training layer 5, epoch 12, cost  3.40592055867
Pre-training layer 5, epoch 13, cost  3.40293041554
Pre-training layer 5, epoch 14, cost  3.39881159384
Pre-training layer 5, epoch 15, cost  3.392976761
Pre-training layer 5, epoch 16, cost  3.3847878889
Pre-training layer 5, epoch 17, cost  3.37464927355
Pre-training layer 5, epoch 18, cost  3.3656908131
Pre-training layer 5, epoch 19, cost  3.36044745829
Pre-training layer 5, epoch 20, cost  3.35763800041
Pre-training layer 5, epoch 21, cost  3.35585913733
Pre-training layer 5, epoch 22, cost  3.35458355909
Pre-training layer 5, epoch 23, cost  3.35359680294
Pre-training layer 5, epoch 24, cost  3.35279280139
Pre-training layer 5, epoch 25, cost  3.35211244082
Pre-training layer 5, epoch 26, cost  3.35152018021
Pre-training layer 5, epoch 27, cost  3.35099435287
Pre-training layer 5, epoch 28, cost  3.35051874253
Pre-training layer 5, epoch 29, cost  3.3500839653
Pre-training layer 5, epoch 30, cost  3.3496824562
Pre-training layer 5, epoch 31, cost  3.34930869586
Pre-training layer 5, epoch 32, cost  3.34895868425
Pre-training layer 5, epoch 33, cost  3.34862964257
Pre-training layer 5, epoch 34, cost  3.3483183242
Pre-training layer 5, epoch 35, cost  3.34802320359
Pre-training layer 5, epoch 36, cost  3.34774247079
Pre-training layer 5, epoch 37, cost  3.34747480165
Pre-training layer 5, epoch 38, cost  3.34721889878
Pre-training layer 5, epoch 39, cost  3.34697411937
Pre-training layer 5, epoch 40, cost  3.34673908005
Pre-training layer 5, epoch 41, cost  3.34651292669
Pre-training layer 5, epoch 42, cost  3.34629585363
Pre-training layer 5, epoch 43, cost  3.34608682313
Pre-training layer 5, epoch 44, cost  3.34588511077
Pre-training layer 5, epoch 45, cost  3.34569006693
Pre-training layer 5, epoch 46, cost  3.34550190715
Pre-training layer 5, epoch 47, cost  3.34532011017
Pre-training layer 5, epoch 48, cost  3.34514396826
Pre-training layer 5, epoch 49, cost  3.34497366171
The pretraining code for file multi_layer_km.pyc ran for 25.74m
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
... getting the finetuning functions
ACC for deep clustering: 0.53
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 2.29448, Reconstruction: 1.99180, Clustering: 0.30268,
Fine-tuning epoch 2 ++++
Total cost: 1.59146, Reconstruction: 1.28116, Clustering: 0.31030,
Fine-tuning epoch 3 ++++
Total cost: 1.44448, Reconstruction: 1.14901, Clustering: 0.29546,
Fine-tuning epoch 4 ++++
Total cost: 1.34729, Reconstruction: 1.06561, Clustering: 0.28168,
Fine-tuning epoch 5 ++++
Total cost: 1.28173, Reconstruction: 1.00999, Clustering: 0.27174,
Fine-tuning epoch 6 ++++
Total cost: 1.23748, Reconstruction: 0.97296, Clustering: 0.26452,
Fine-tuning epoch 7 ++++
Total cost: 1.20586, Reconstruction: 0.94609, Clustering: 0.25978,
Fine-tuning epoch 8 ++++
Total cost: 1.17439, Reconstruction: 0.92085, Clustering: 0.25354,
Fine-tuning epoch 9 ++++
Total cost: 1.15739, Reconstruction: 0.90595, Clustering: 0.25144,
Fine-tuning epoch 10 ++++
Total cost: 1.13165, Reconstruction: 0.88494, Clustering: 0.24671,
Fine-tuning epoch 11 ++++
Total cost: 1.11710, Reconstruction: 0.87149, Clustering: 0.24560,
Fine-tuning epoch 12 ++++
Total cost: 1.10004, Reconstruction: 0.85743, Clustering: 0.24261,
Fine-tuning epoch 13 ++++
Total cost: 1.08598, Reconstruction: 0.84583, Clustering: 0.24015,
Fine-tuning epoch 14 ++++
Total cost: 1.07177, Reconstruction: 0.83378, Clustering: 0.23800,
Fine-tuning epoch 15 ++++
Total cost: 1.06081, Reconstruction: 0.82340, Clustering: 0.23742,
Fine-tuning epoch 16 ++++
Total cost: 1.04865, Reconstruction: 0.81340, Clustering: 0.23526,
Fine-tuning epoch 17 ++++
Total cost: 1.03830, Reconstruction: 0.80411, Clustering: 0.23419,
Fine-tuning epoch 18 ++++
Total cost: 1.02455, Reconstruction: 0.79366, Clustering: 0.23089,
Fine-tuning epoch 19 ++++
Total cost: 1.01726, Reconstruction: 0.78733, Clustering: 0.22993,
Fine-tuning epoch 20 ++++
Total cost: 1.00665, Reconstruction: 0.77846, Clustering: 0.22819,
Fine-tuning epoch 21 ++++
Total cost: 1.00208, Reconstruction: 0.77330, Clustering: 0.22878,
Fine-tuning epoch 22 ++++
Total cost: 0.99151, Reconstruction: 0.76525, Clustering: 0.22627,
Fine-tuning epoch 23 ++++
Total cost: 0.98794, Reconstruction: 0.76164, Clustering: 0.22630,
Fine-tuning epoch 24 ++++
Total cost: 0.98254, Reconstruction: 0.75693, Clustering: 0.22560,
Fine-tuning epoch 25 ++++
Total cost: 0.96949, Reconstruction: 0.74668, Clustering: 0.22280,
Fine-tuning epoch 26 ++++
Total cost: 0.96455, Reconstruction: 0.74229, Clustering: 0.22227,
Fine-tuning epoch 27 ++++
Total cost: 0.96189, Reconstruction: 0.73981, Clustering: 0.22208,
Fine-tuning epoch 28 ++++
Total cost: 0.95658, Reconstruction: 0.73451, Clustering: 0.22207,
Fine-tuning epoch 29 ++++
Total cost: 0.94944, Reconstruction: 0.72837, Clustering: 0.22107,
Fine-tuning epoch 30 ++++
Total cost: 0.94955, Reconstruction: 0.72807, Clustering: 0.22148,
Fine-tuning epoch 31 ++++
Total cost: 0.93929, Reconstruction: 0.72060, Clustering: 0.21869,
Fine-tuning epoch 32 ++++
Total cost: 0.93405, Reconstruction: 0.71566, Clustering: 0.21839,
Fine-tuning epoch 33 ++++
Total cost: 0.92739, Reconstruction: 0.70997, Clustering: 0.21742,
Fine-tuning epoch 34 ++++
Total cost: 0.92247, Reconstruction: 0.70625, Clustering: 0.21622,
Fine-tuning epoch 35 ++++
Total cost: 0.91240, Reconstruction: 0.69773, Clustering: 0.21466,
Fine-tuning epoch 36 ++++
Total cost: 0.91273, Reconstruction: 0.69682, Clustering: 0.21591,
Fine-tuning epoch 37 ++++
Total cost: 0.90461, Reconstruction: 0.69128, Clustering: 0.21333,
Fine-tuning epoch 38 ++++
Total cost: 0.90104, Reconstruction: 0.68714, Clustering: 0.21390,
Fine-tuning epoch 39 ++++
Total cost: 0.89437, Reconstruction: 0.68180, Clustering: 0.21257,
Fine-tuning epoch 40 ++++
Total cost: 0.89477, Reconstruction: 0.68210, Clustering: 0.21267,
Fine-tuning epoch 41 ++++
Total cost: 0.88209, Reconstruction: 0.67163, Clustering: 0.21047,
Fine-tuning epoch 42 ++++
Total cost: 0.88178, Reconstruction: 0.67102, Clustering: 0.21076,
Fine-tuning epoch 43 ++++
Total cost: 0.87310, Reconstruction: 0.66424, Clustering: 0.20885,
Fine-tuning epoch 44 ++++
Total cost: 0.87205, Reconstruction: 0.66260, Clustering: 0.20946,
Fine-tuning epoch 45 ++++
Total cost: 0.86929, Reconstruction: 0.66001, Clustering: 0.20928,
Fine-tuning epoch 46 ++++
Total cost: 0.85978, Reconstruction: 0.65213, Clustering: 0.20764,
Fine-tuning epoch 47 ++++
Total cost: 0.85692, Reconstruction: 0.65015, Clustering: 0.20677,
Fine-tuning epoch 48 ++++
Total cost: 0.85442, Reconstruction: 0.64787, Clustering: 0.20656,
Fine-tuning epoch 49 ++++
Total cost: 0.85094, Reconstruction: 0.64433, Clustering: 0.20661,
Fine-tuning epoch 50 ++++
Total cost: 0.85051, Reconstruction: 0.64440, Clustering: 0.20610,
Average squared 2-D reconstruction error: 0.6444
NMI for deep clustering: 0.58
ARI for deep clustering: 0.42
ACC for deep clustering: 0.55
The training code for file multi_layer_km.pyc ran for 24.74m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.14556900561
Pre-training layer 0, epoch 1, cost  0.980163006434
Pre-training layer 0, epoch 2, cost  0.789792965138
Pre-training layer 0, epoch 3, cost  0.699360448336
Pre-training layer 0, epoch 4, cost  0.64539952501
Pre-training layer 0, epoch 5, cost  0.607781332889
Pre-training layer 0, epoch 6, cost  0.579191348834
Pre-training layer 0, epoch 7, cost  0.556365431192
Pre-training layer 0, epoch 8, cost  0.537432898127
Pre-training layer 0, epoch 9, cost  0.521198585746
Pre-training layer 0, epoch 10, cost  0.507061832289
Pre-training layer 0, epoch 11, cost  0.494767490751
Pre-training layer 0, epoch 12, cost  0.483916176576
Pre-training layer 0, epoch 13, cost  0.474178679682
Pre-training layer 0, epoch 14, cost  0.465272593407
Pre-training layer 0, epoch 15, cost  0.457179846442
Pre-training layer 0, epoch 16, cost  0.449768134417
Pre-training layer 0, epoch 17, cost  0.442930100815
Pre-training layer 0, epoch 18, cost  0.436578042085
Pre-training layer 0, epoch 19, cost  0.430676137488
Pre-training layer 0, epoch 20, cost  0.425161059879
Pre-training layer 0, epoch 21, cost  0.419983681984
Pre-training layer 0, epoch 22, cost  0.4151242438
Pre-training layer 0, epoch 23, cost  0.410561655799
Pre-training layer 0, epoch 24, cost  0.40627203152
Pre-training layer 0, epoch 25, cost  0.402192574943
Pre-training layer 0, epoch 26, cost  0.398328110998
Pre-training layer 0, epoch 27, cost  0.394676686791
Pre-training layer 0, epoch 28, cost  0.391186649226
Pre-training layer 0, epoch 29, cost  0.387871742443
Pre-training layer 0, epoch 30, cost  0.384717403876
Pre-training layer 0, epoch 31, cost  0.381700231455
Pre-training layer 0, epoch 32, cost  0.378823088226
Pre-training layer 0, epoch 33, cost  0.376067226801
Pre-training layer 0, epoch 34, cost  0.373415868911
Pre-training layer 0, epoch 35, cost  0.370865689551
Pre-training layer 0, epoch 36, cost  0.368417143945
Pre-training layer 0, epoch 37, cost  0.366050712862
Pre-training layer 0, epoch 38, cost  0.363771968108
Pre-training layer 0, epoch 39, cost  0.361596587325
Pre-training layer 0, epoch 40, cost  0.359496859979
Pre-training layer 0, epoch 41, cost  0.357463037812
Pre-training layer 0, epoch 42, cost  0.35549889749
Pre-training layer 0, epoch 43, cost  0.353584366695
Pre-training layer 0, epoch 44, cost  0.351742913518
Pre-training layer 0, epoch 45, cost  0.349957321346
Pre-training layer 0, epoch 46, cost  0.348231823947
Pre-training layer 0, epoch 47, cost  0.346564222986
Pre-training layer 0, epoch 48, cost  0.344939015136
Pre-training layer 0, epoch 49, cost  0.343367557142
Pre-training layer 1, epoch 0, cost  3.87540000924
Pre-training layer 1, epoch 1, cost  1.01126185516
Pre-training layer 1, epoch 2, cost  0.728752211276
Pre-training layer 1, epoch 3, cost  0.607690702434
Pre-training layer 1, epoch 4, cost  0.53871195552
Pre-training layer 1, epoch 5, cost  0.491140725455
Pre-training layer 1, epoch 6, cost  0.456010855441
Pre-training layer 1, epoch 7, cost  0.428698904434
Pre-training layer 1, epoch 8, cost  0.406349715269
Pre-training layer 1, epoch 9, cost  0.3873048549
Pre-training layer 1, epoch 10, cost  0.370214384105
Pre-training layer 1, epoch 11, cost  0.356232627987
Pre-training layer 1, epoch 12, cost  0.344029106305
Pre-training layer 1, epoch 13, cost  0.332730097339
Pre-training layer 1, epoch 14, cost  0.322792561806
Pre-training layer 1, epoch 15, cost  0.313842754853
Pre-training layer 1, epoch 16, cost  0.305643929087
Pre-training layer 1, epoch 17, cost  0.29826201889
Pre-training layer 1, epoch 18, cost  0.291360468411
Pre-training layer 1, epoch 19, cost  0.285205975453
Pre-training layer 1, epoch 20, cost  0.279455391734
Pre-training layer 1, epoch 21, cost  0.274081798121
Pre-training layer 1, epoch 22, cost  0.268941754169
Pre-training layer 1, epoch 23, cost  0.264304444475
Pre-training layer 1, epoch 24, cost  0.260155390428
Pre-training layer 1, epoch 25, cost  0.255799391195
Pre-training layer 1, epoch 26, cost  0.251932252712
Pre-training layer 1, epoch 27, cost  0.248220915377
Pre-training layer 1, epoch 28, cost  0.24484132947
Pre-training layer 1, epoch 29, cost  0.241612548041
Pre-training layer 1, epoch 30, cost  0.238429718093
Pre-training layer 1, epoch 31, cost  0.235556374358
Pre-training layer 1, epoch 32, cost  0.232938143998
Pre-training layer 1, epoch 33, cost  0.230129477783
Pre-training layer 1, epoch 34, cost  0.227602542827
Pre-training layer 1, epoch 35, cost  0.225329624914
Pre-training layer 1, epoch 36, cost  0.222759690007
Pre-training layer 1, epoch 37, cost  0.221171660323
Pre-training layer 1, epoch 38, cost  0.21867189271
Pre-training layer 1, epoch 39, cost  0.216495967964
Pre-training layer 1, epoch 40, cost  0.214554703633
Pre-training layer 1, epoch 41, cost  0.212665492747
Pre-training layer 1, epoch 42, cost  0.210944004465
Pre-training layer 1, epoch 43, cost  0.209236659149
Pre-training layer 1, epoch 44, cost  0.207708265552
Pre-training layer 1, epoch 45, cost  0.206060255382
Pre-training layer 1, epoch 46, cost  0.204544393657
Pre-training layer 1, epoch 47, cost  0.203178392383
Pre-training layer 1, epoch 48, cost  0.201649221373
Pre-training layer 1, epoch 49, cost  0.200392572696
Pre-training layer 2, epoch 0, cost  4.80076814099
Pre-training layer 2, epoch 1, cost  1.39548163396
Pre-training layer 2, epoch 2, cost  1.06000104121
Pre-training layer 2, epoch 3, cost  0.898408522273
Pre-training layer 2, epoch 4, cost  0.803697726277
Pre-training layer 2, epoch 5, cost  0.723655301819
Pre-training layer 2, epoch 6, cost  0.688152894912
Pre-training layer 2, epoch 7, cost  0.641564385529
Pre-training layer 2, epoch 8, cost  0.618124823435
Pre-training layer 2, epoch 9, cost  0.599169532911
Pre-training layer 2, epoch 10, cost  0.573411667737
Pre-training layer 2, epoch 11, cost  0.559122033094
Pre-training layer 2, epoch 12, cost  0.53887721577
Pre-training layer 2, epoch 13, cost  0.531152822616
Pre-training layer 2, epoch 14, cost  0.52019244265
Pre-training layer 2, epoch 15, cost  0.50994778366
Pre-training layer 2, epoch 16, cost  0.50398651929
Pre-training layer 2, epoch 17, cost  0.494985152426
Pre-training layer 2, epoch 18, cost  0.48378223971
Pre-training layer 2, epoch 19, cost  0.480245163904
Pre-training layer 2, epoch 20, cost  0.47765034076
Pre-training layer 2, epoch 21, cost  0.467215613702
Pre-training layer 2, epoch 22, cost  0.462601685671
Pre-training layer 2, epoch 23, cost  0.459061248134
Pre-training layer 2, epoch 24, cost  0.456032087287
Pre-training layer 2, epoch 25, cost  0.452736885283
Pre-training layer 2, epoch 26, cost  0.450382555547
Pre-training layer 2, epoch 27, cost  0.446834326839
Pre-training layer 2, epoch 28, cost  0.444492154292
Pre-training layer 2, epoch 29, cost  0.441080731909
Pre-training layer 2, epoch 30, cost  0.436913509191
Pre-training layer 2, epoch 31, cost  0.435817609615
Pre-training layer 2, epoch 32, cost  0.43365053352
Pre-training layer 2, epoch 33, cost  0.430544914351
Pre-training layer 2, epoch 34, cost  0.429943969042
Pre-training layer 2, epoch 35, cost  0.426809891061
Pre-training layer 2, epoch 36, cost  0.425296925883
Pre-training layer 2, epoch 37, cost  0.423981288571
Pre-training layer 2, epoch 38, cost  0.421881453845
Pre-training layer 2, epoch 39, cost  0.420867452664
Pre-training layer 2, epoch 40, cost  0.419312719865
Pre-training layer 2, epoch 41, cost  0.418113477767
Pre-training layer 2, epoch 42, cost  0.416789868885
Pre-training layer 2, epoch 43, cost  0.415634840254
Pre-training layer 2, epoch 44, cost  0.415144542899
Pre-training layer 2, epoch 45, cost  0.414135297707
Pre-training layer 2, epoch 46, cost  0.412785205782
Pre-training layer 2, epoch 47, cost  0.41165291869
Pre-training layer 2, epoch 48, cost  0.410919228036
Pre-training layer 2, epoch 49, cost  0.410227795591
Pre-training layer 3, epoch 0, cost  3.60392058242
Pre-training layer 3, epoch 1, cost  0.697685549062
Pre-training layer 3, epoch 2, cost  0.444124682221
Pre-training layer 3, epoch 3, cost  0.314258241792
Pre-training layer 3, epoch 4, cost  0.239949012141
Pre-training layer 3, epoch 5, cost  0.20246811499
Pre-training layer 3, epoch 6, cost  0.168175922867
Pre-training layer 3, epoch 7, cost  0.144944040241
Pre-training layer 3, epoch 8, cost  0.130577677663
Pre-training layer 3, epoch 9, cost  0.117261619875
Pre-training layer 3, epoch 10, cost  0.107027681137
Pre-training layer 3, epoch 11, cost  0.0995182762915
Pre-training layer 3, epoch 12, cost  0.0925115102165
Pre-training layer 3, epoch 13, cost  0.0854325810073
Pre-training layer 3, epoch 14, cost  0.0807015937375
Pre-training layer 3, epoch 15, cost  0.0762989605575
Pre-training layer 3, epoch 16, cost  0.0722753786303
Pre-training layer 3, epoch 17, cost  0.0685094126929
Pre-training layer 3, epoch 18, cost  0.0654829985382
Pre-training layer 3, epoch 19, cost  0.0625995671897
Pre-training layer 3, epoch 20, cost  0.059943554502
Pre-training layer 3, epoch 21, cost  0.0575175981583
Pre-training layer 3, epoch 22, cost  0.0550891222569
Pre-training layer 3, epoch 23, cost  0.0525353594734
Pre-training layer 3, epoch 24, cost  0.0502375543263
Pre-training layer 3, epoch 25, cost  0.0487904536062
Pre-training layer 3, epoch 26, cost  0.0476994050716
Pre-training layer 3, epoch 27, cost  0.0459099930151
Pre-training layer 3, epoch 28, cost  0.0437721558355
Pre-training layer 3, epoch 29, cost  0.042938035591
Pre-training layer 3, epoch 30, cost  0.0412381472188
Pre-training layer 3, epoch 31, cost  0.040019252096
Pre-training layer 3, epoch 32, cost  0.0387781469268
Pre-training layer 3, epoch 33, cost  0.0376695035789
Pre-training layer 3, epoch 34, cost  0.036365255477
Pre-training layer 3, epoch 35, cost  0.0356394439175
Pre-training layer 3, epoch 36, cost  0.0342873162544
Pre-training layer 3, epoch 37, cost  0.0334672448899
Pre-training layer 3, epoch 38, cost  0.0326758898338
Pre-training layer 3, epoch 39, cost  0.0316291001095
Pre-training layer 3, epoch 40, cost  0.0307468391312
Pre-training layer 3, epoch 41, cost  0.0300398999214
Pre-training layer 3, epoch 42, cost  0.0293455032595
Pre-training layer 3, epoch 43, cost  0.028614566499
Pre-training layer 3, epoch 44, cost  0.0278727814851
Pre-training layer 3, epoch 45, cost  0.0271466944324
Pre-training layer 3, epoch 46, cost  0.0263922685241
Pre-training layer 3, epoch 47, cost  0.0255359393355
Pre-training layer 3, epoch 48, cost  0.0245076452012
Pre-training layer 3, epoch 49, cost  0.0240158625453
Pre-training layer 4, epoch 0, cost  4.21417292371
Pre-training layer 4, epoch 1, cost  1.16614577761
Pre-training layer 4, epoch 2, cost  0.962752856544
Pre-training layer 4, epoch 3, cost  0.928465784703
Pre-training layer 4, epoch 4, cost  0.911492052876
Pre-training layer 4, epoch 5, cost  0.899068096295
Pre-training layer 4, epoch 6, cost  0.890325519143
Pre-training layer 4, epoch 7, cost  0.883364934636
Pre-training layer 4, epoch 8, cost  0.877716789361
Pre-training layer 4, epoch 9, cost  0.873006863459
Pre-training layer 4, epoch 10, cost  0.868940450955
Pre-training layer 4, epoch 11, cost  0.865450694487
Pre-training layer 4, epoch 12, cost  0.862274136212
Pre-training layer 4, epoch 13, cost  0.859499511643
Pre-training layer 4, epoch 14, cost  0.857002320822
Pre-training layer 4, epoch 15, cost  0.854720016083
Pre-training layer 4, epoch 16, cost  0.85265435399
Pre-training layer 4, epoch 17, cost  0.850758169392
Pre-training layer 4, epoch 18, cost  0.849017668648
Pre-training layer 4, epoch 19, cost  0.847399498434
Pre-training layer 4, epoch 20, cost  0.845921574926
Pre-training layer 4, epoch 21, cost  0.844525190173
Pre-training layer 4, epoch 22, cost  0.843240193531
Pre-training layer 4, epoch 23, cost  0.842061654906
Pre-training layer 4, epoch 24, cost  0.840946980266
Pre-training layer 4, epoch 25, cost  0.839918589467
Pre-training layer 4, epoch 26, cost  0.838943469231
Pre-training layer 4, epoch 27, cost  0.838063799007
Pre-training layer 4, epoch 28, cost  0.837178929875
Pre-training layer 4, epoch 29, cost  0.836372665682
Pre-training layer 4, epoch 30, cost  0.835605581574
Pre-training layer 4, epoch 31, cost  0.834893781829
Pre-training layer 4, epoch 32, cost  0.83420107129
Pre-training layer 4, epoch 33, cost  0.833549175748
Pre-training layer 4, epoch 34, cost  0.832933120204
Pre-training layer 4, epoch 35, cost  0.832332967703
Pre-training layer 4, epoch 36, cost  0.831775356776
Pre-training layer 4, epoch 37, cost  0.831243130664
Pre-training layer 4, epoch 38, cost  0.830730742127
Pre-training layer 4, epoch 39, cost  0.830251277406
Pre-training layer 4, epoch 40, cost  0.829773691152
Pre-training layer 4, epoch 41, cost  0.829349769863
Pre-training layer 4, epoch 42, cost  0.828917276112
Pre-training layer 4, epoch 43, cost  0.82851582443
Pre-training layer 4, epoch 44, cost  0.828122116827
Pre-training layer 4, epoch 45, cost  0.827751189069
Pre-training layer 4, epoch 46, cost  0.827369421766
Pre-training layer 4, epoch 47, cost  0.82702330099
Pre-training layer 4, epoch 48, cost  0.826688114326
Pre-training layer 4, epoch 49, cost  0.826383100984
Pre-training layer 5, epoch 0, cost  5.4589394467
Pre-training layer 5, epoch 1, cost  3.46043174185
Pre-training layer 5, epoch 2, cost  3.44563934008
Pre-training layer 5, epoch 3, cost  3.43921372901
Pre-training layer 5, epoch 4, cost  3.43534657927
Pre-training layer 5, epoch 5, cost  3.43304865233
Pre-training layer 5, epoch 6, cost  3.43154230233
Pre-training layer 5, epoch 7, cost  3.43034394877
Pre-training layer 5, epoch 8, cost  3.42922651358
Pre-training layer 5, epoch 9, cost  3.42807125371
Pre-training layer 5, epoch 10, cost  3.42679454806
Pre-training layer 5, epoch 11, cost  3.42530423368
Pre-training layer 5, epoch 12, cost  3.42348250004
Pre-training layer 5, epoch 13, cost  3.42116251671
Pre-training layer 5, epoch 14, cost  3.4180882453
Pre-training layer 5, epoch 15, cost  3.4138651916
Pre-training layer 5, epoch 16, cost  3.40792697836
Pre-training layer 5, epoch 17, cost  3.39974697746
Pre-training layer 5, epoch 18, cost  3.38999330351
Pre-training layer 5, epoch 19, cost  3.38171708093
Pre-training layer 5, epoch 20, cost  3.37683848713
Pre-training layer 5, epoch 21, cost  3.37410240099
Pre-training layer 5, epoch 22, cost  3.37231939168
Pre-training layer 5, epoch 23, cost  3.37102065718
Pre-training layer 5, epoch 24, cost  3.37000517616
Pre-training layer 5, epoch 25, cost  3.36917263193
Pre-training layer 5, epoch 26, cost  3.3684650135
Pre-training layer 5, epoch 27, cost  3.36784596635
Pre-training layer 5, epoch 28, cost  3.36729446604
Pre-training layer 5, epoch 29, cost  3.36679449092
Pre-training layer 5, epoch 30, cost  3.36633584433
Pre-training layer 5, epoch 31, cost  3.36591207696
Pre-training layer 5, epoch 32, cost  3.36551697206
Pre-training layer 5, epoch 33, cost  3.36514620547
Pre-training layer 5, epoch 34, cost  3.36479667581
Pre-training layer 5, epoch 35, cost  3.36446615403
Pre-training layer 5, epoch 36, cost  3.36415220845
Pre-training layer 5, epoch 37, cost  3.36385265817
Pre-training layer 5, epoch 38, cost  3.36356687684
Pre-training layer 5, epoch 39, cost  3.3632930762
Pre-training layer 5, epoch 40, cost  3.36303096263
Pre-training layer 5, epoch 41, cost  3.36277890255
Pre-training layer 5, epoch 42, cost  3.36253651007
Pre-training layer 5, epoch 43, cost  3.36230332542
Pre-training layer 5, epoch 44, cost  3.36207829891
Pre-training layer 5, epoch 45, cost  3.36186101365
Pre-training layer 5, epoch 46, cost  3.36165116813
Pre-training layer 5, epoch 47, cost  3.36144858096
Pre-training layer 5, epoch 48, cost  3.36125246027
Pre-training layer 5, epoch 49, cost  3.36106238965
The pretraining code for file multi_layer_km.pyc ran for 25.78m
Initial NMI for deep clustering: 0.51
ARI for deep clustering: 0.38
... getting the finetuning functions
ACC for deep clustering: 0.54
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 4.56632, Reconstruction: 4.36214, Clustering: 0.20418,
Fine-tuning epoch 2 ++++
Total cost: 4.46748, Reconstruction: 4.36744, Clustering: 0.10004,
Fine-tuning epoch 3 ++++
Total cost: 4.43859, Reconstruction: 4.36744, Clustering: 0.07114,
Fine-tuning epoch 4 ++++
Total cost: 4.43123, Reconstruction: 4.36744, Clustering: 0.06379,
Fine-tuning epoch 5 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 6 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 7 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 8 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 9 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 10 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 11 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 12 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 13 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 14 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 15 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 16 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 17 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 18 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 19 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 20 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 21 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 22 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 23 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 24 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 25 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 26 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 27 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 28 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 29 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 30 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 31 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 32 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 33 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 34 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 35 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 36 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 37 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 38 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 39 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 40 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 41 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 42 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 43 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 44 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 45 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Fine-tuning epoch 46 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 47 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 48 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 49 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Fine-tuning epoch 50 ++++
Total cost: nan, Reconstruction: nan, Clustering: nan,
Number of predicted cluster mismatch with ground truth.
Average squared 2-D reconstruction error: nan
NMI for deep clustering: -0.00
ARI for deep clustering: 0.00
ACC for deep clustering: 0.00
Number of predicted cluster mismatch with ground truth.
The training code for file multi_layer_km.pyc ran for 24.80m
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  3.15173357589
Pre-training layer 0, epoch 1, cost  0.983274745514
Pre-training layer 0, epoch 2, cost  0.791949719897
Pre-training layer 0, epoch 3, cost  0.705114442101
Pre-training layer 0, epoch 4, cost  0.652149299334
Pre-training layer 0, epoch 5, cost  0.614886821852
Pre-training layer 0, epoch 6, cost  0.586204306121
Pre-training layer 0, epoch 7, cost  0.56310974936
Pre-training layer 0, epoch 8, cost  0.543635060017
Pre-training layer 0, epoch 9, cost  0.527270366611
Pre-training layer 0, epoch 10, cost  0.513116707726
Pre-training layer 0, epoch 11, cost  0.500832129226
Pre-training layer 0, epoch 12, cost  0.489738609178
Pre-training layer 0, epoch 13, cost  0.479881695184
Pre-training layer 0, epoch 14, cost  0.471014107328
Pre-training layer 0, epoch 15, cost  0.462925503599
Pre-training layer 0, epoch 16, cost  0.455536252906
Pre-training layer 0, epoch 17, cost  0.44873055281
Pre-training layer 0, epoch 18, cost  0.442377321308
Pre-training layer 0, epoch 19, cost  0.436546868261
Pre-training layer 0, epoch 20, cost  0.43110747699
Pre-training layer 0, epoch 21, cost  0.426015529498
Pre-training layer 0, epoch 22, cost  0.421242900814
Pre-training layer 0, epoch 23, cost  0.416774008867
Pre-training layer 0, epoch 24, cost  0.412551826388
Pre-training layer 0, epoch 25, cost  0.408551851194
Pre-training layer 0, epoch 26, cost  0.404761256844
Pre-training layer 0, epoch 27, cost  0.401165186034
Pre-training layer 0, epoch 28, cost  0.397734114167
Pre-training layer 0, epoch 29, cost  0.394454409044
Pre-training layer 0, epoch 30, cost  0.391139998217
Pre-training layer 0, epoch 31, cost  0.387733107287
Pre-training layer 0, epoch 32, cost  0.384767622603
Pre-training layer 0, epoch 33, cost  0.381975328549
Pre-training layer 0, epoch 34, cost  0.379312342452
Pre-training layer 0, epoch 35, cost  0.37675226392
Pre-training layer 0, epoch 36, cost  0.374287529317
Pre-training layer 0, epoch 37, cost  0.371924462965
Pre-training layer 0, epoch 38, cost  0.369645324214
Pre-training layer 0, epoch 39, cost  0.367440747249
Pre-training layer 0, epoch 40, cost  0.365318873337
Pre-training layer 0, epoch 41, cost  0.363276062734
Pre-training layer 0, epoch 42, cost  0.361288670327
Pre-training layer 0, epoch 43, cost  0.35936328631
Pre-training layer 0, epoch 44, cost  0.357512929247
Pre-training layer 0, epoch 45, cost  0.355712435448
Pre-training layer 0, epoch 46, cost  0.353974311499
Pre-training layer 0, epoch 47, cost  0.352276253175
Pre-training layer 0, epoch 48, cost  0.350631467979
Pre-training layer 0, epoch 49, cost  0.349025913327
Pre-training layer 1, epoch 0, cost  3.89423329579
Pre-training layer 1, epoch 1, cost  1.03112225019
Pre-training layer 1, epoch 2, cost  0.74667290049
Pre-training layer 1, epoch 3, cost  0.624263133078
Pre-training layer 1, epoch 4, cost  0.552803261132
Pre-training layer 1, epoch 5, cost  0.503605124863
Pre-training layer 1, epoch 6, cost  0.467736293607
Pre-training layer 1, epoch 7, cost  0.439591346891
Pre-training layer 1, epoch 8, cost  0.41596908252
Pre-training layer 1, epoch 9, cost  0.3958955686
Pre-training layer 1, epoch 10, cost  0.37943676427
Pre-training layer 1, epoch 11, cost  0.364912466511
Pre-training layer 1, epoch 12, cost  0.352421933216
Pre-training layer 1, epoch 13, cost  0.34086386425
Pre-training layer 1, epoch 14, cost  0.330512619311
Pre-training layer 1, epoch 15, cost  0.320816144362
Pre-training layer 1, epoch 16, cost  0.312759478879
Pre-training layer 1, epoch 17, cost  0.304746557439
Pre-training layer 1, epoch 18, cost  0.29771640421
Pre-training layer 1, epoch 19, cost  0.291810379952
Pre-training layer 1, epoch 20, cost  0.285331696838
Pre-training layer 1, epoch 21, cost  0.280086219917
Pre-training layer 1, epoch 22, cost  0.274448368338
Pre-training layer 1, epoch 23, cost  0.269878974144
Pre-training layer 1, epoch 24, cost  0.265366925542
Pre-training layer 1, epoch 25, cost  0.261145324937
Pre-training layer 1, epoch 26, cost  0.256716351485
Pre-training layer 1, epoch 27, cost  0.253179944229
Pre-training layer 1, epoch 28, cost  0.249945992021
Pre-training layer 1, epoch 29, cost  0.246279945047
Pre-training layer 1, epoch 30, cost  0.243297236059
Pre-training layer 1, epoch 31, cost  0.240093646625
Pre-training layer 1, epoch 32, cost  0.237242127439
Pre-training layer 1, epoch 33, cost  0.234408362665
Pre-training layer 1, epoch 34, cost  0.23195080199
Pre-training layer 1, epoch 35, cost  0.229464397489
Pre-training layer 1, epoch 36, cost  0.227084496606
Pre-training layer 1, epoch 37, cost  0.224861710606
Pre-training layer 1, epoch 38, cost  0.222628130069
Pre-training layer 1, epoch 39, cost  0.220926799202
Pre-training layer 1, epoch 40, cost  0.21872987531
Pre-training layer 1, epoch 41, cost  0.216835336703
Pre-training layer 1, epoch 42, cost  0.214967651556
Pre-training layer 1, epoch 43, cost  0.213531260573
Pre-training layer 1, epoch 44, cost  0.211996369481
Pre-training layer 1, epoch 45, cost  0.210142896781
Pre-training layer 1, epoch 46, cost  0.208572041989
Pre-training layer 1, epoch 47, cost  0.207109831102
Pre-training layer 1, epoch 48, cost  0.205728925424
Pre-training layer 1, epoch 49, cost  0.204357896823
Pre-training layer 2, epoch 0, cost  4.8509558342
Pre-training layer 2, epoch 1, cost  1.42571938176
Pre-training layer 2, epoch 2, cost  1.08780633694
Pre-training layer 2, epoch 3, cost  0.922990450611
Pre-training layer 2, epoch 4, cost  0.818045575366
Pre-training layer 2, epoch 5, cost  0.754719028864
Pre-training layer 2, epoch 6, cost  0.710639070766
Pre-training layer 2, epoch 7, cost  0.667100896612
Pre-training layer 2, epoch 8, cost  0.638448627172
Pre-training layer 2, epoch 9, cost  0.619349382874
Pre-training layer 2, epoch 10, cost  0.588521956722
Pre-training layer 2, epoch 11, cost  0.585116900943
Pre-training layer 2, epoch 12, cost  0.55833247064
Pre-training layer 2, epoch 13, cost  0.551154202123
Pre-training layer 2, epoch 14, cost  0.540200455469
Pre-training layer 2, epoch 15, cost  0.53143917613
Pre-training layer 2, epoch 16, cost  0.524955864672
Pre-training layer 2, epoch 17, cost  0.514898325111
Pre-training layer 2, epoch 18, cost  0.503922514157
Pre-training layer 2, epoch 19, cost  0.499193231123
Pre-training layer 2, epoch 20, cost  0.497732216488
Pre-training layer 2, epoch 21, cost  0.487086397208
Pre-training layer 2, epoch 22, cost  0.482747190621
Pre-training layer 2, epoch 23, cost  0.479821570039
Pre-training layer 2, epoch 24, cost  0.476585057841
Pre-training layer 2, epoch 25, cost  0.472869870262
Pre-training layer 2, epoch 26, cost  0.469298123608
Pre-training layer 2, epoch 27, cost  0.463684675834
Pre-training layer 2, epoch 28, cost  0.460751635758
Pre-training layer 2, epoch 29, cost  0.462596846678
Pre-training layer 2, epoch 30, cost  0.453246215954
Pre-training layer 2, epoch 31, cost  0.457414286026
Pre-training layer 2, epoch 32, cost  0.450303945258
Pre-training layer 2, epoch 33, cost  0.450179757267
Pre-training layer 2, epoch 34, cost  0.449412717035
Pre-training layer 2, epoch 35, cost  0.444518357737
Pre-training layer 2, epoch 36, cost  0.443923565342
Pre-training layer 2, epoch 37, cost  0.444156085518
Pre-training layer 2, epoch 38, cost  0.441652162485
Pre-training layer 2, epoch 39, cost  0.43986134153
Pre-training layer 2, epoch 40, cost  0.438456949848
Pre-training layer 2, epoch 41, cost  0.437819072221
Pre-training layer 2, epoch 42, cost  0.436572905771
Pre-training layer 2, epoch 43, cost  0.435288790908
Pre-training layer 2, epoch 44, cost  0.434133236023
Pre-training layer 2, epoch 45, cost  0.43306368572
Pre-training layer 2, epoch 46, cost  0.432005218683
Pre-training layer 2, epoch 47, cost  0.430888347232
Pre-training layer 2, epoch 48, cost  0.429758193629
Pre-training layer 2, epoch 49, cost  0.428722529998
Pre-training layer 3, epoch 0, cost  3.59503910978
Pre-training layer 3, epoch 1, cost  0.699724806082
Pre-training layer 3, epoch 2, cost  0.441423474538
Pre-training layer 3, epoch 3, cost  0.311359412855
Pre-training layer 3, epoch 4, cost  0.239302415594
Pre-training layer 3, epoch 5, cost  0.193033732791
Pre-training layer 3, epoch 6, cost  0.163712433798
Pre-training layer 3, epoch 7, cost  0.141726473698
Pre-training layer 3, epoch 8, cost  0.124833373122
Pre-training layer 3, epoch 9, cost  0.112169928656
Pre-training layer 3, epoch 10, cost  0.101760494756
Pre-training layer 3, epoch 11, cost  0.0934058145281
Pre-training layer 3, epoch 12, cost  0.0881805160518
Pre-training layer 3, epoch 13, cost  0.0827332596587
Pre-training layer 3, epoch 14, cost  0.0773179470311
Pre-training layer 3, epoch 15, cost  0.0732321978155
Pre-training layer 3, epoch 16, cost  0.0693476195928
Pre-training layer 3, epoch 17, cost  0.0656996492224
Pre-training layer 3, epoch 18, cost  0.0624833027012
Pre-training layer 3, epoch 19, cost  0.059486725832
Pre-training layer 3, epoch 20, cost  0.0567730554874
Pre-training layer 3, epoch 21, cost  0.0544524671448
Pre-training layer 3, epoch 22, cost  0.0524919888882
Pre-training layer 3, epoch 23, cost  0.0507144388184
Pre-training layer 3, epoch 24, cost  0.0488311383295
Pre-training layer 3, epoch 25, cost  0.0468620950959
Pre-training layer 3, epoch 26, cost  0.045135521274
Pre-training layer 3, epoch 27, cost  0.0437310823451
Pre-training layer 3, epoch 28, cost  0.042204075606
Pre-training layer 3, epoch 29, cost  0.0408496045823
Pre-training layer 3, epoch 30, cost  0.0395572705195
Pre-training layer 3, epoch 31, cost  0.0383131661409
Pre-training layer 3, epoch 32, cost  0.0371519280365
Pre-training layer 3, epoch 33, cost  0.0360471377517
Pre-training layer 3, epoch 34, cost  0.0350017041068
Pre-training layer 3, epoch 35, cost  0.0339852534821
Pre-training layer 3, epoch 36, cost  0.0330316885146
Pre-training layer 3, epoch 37, cost  0.0321242251296
Pre-training layer 3, epoch 38, cost  0.0312532748567
Pre-training layer 3, epoch 39, cost  0.0304153820413
Pre-training layer 3, epoch 40, cost  0.029591704313
Pre-training layer 3, epoch 41, cost  0.0288066289025
Pre-training layer 3, epoch 42, cost  0.0280388269445
Pre-training layer 3, epoch 43, cost  0.0272869701572
Pre-training layer 3, epoch 44, cost  0.0265765374365
Pre-training layer 3, epoch 45, cost  0.025984934107
Pre-training layer 3, epoch 46, cost  0.0255368195518
Pre-training layer 3, epoch 47, cost  0.025205080055
Pre-training layer 3, epoch 48, cost  0.0248175919076
Pre-training layer 3, epoch 49, cost  0.0242450528409
Pre-training layer 4, epoch 0, cost  4.19564149239
Pre-training layer 4, epoch 1, cost  1.16942050065
Pre-training layer 4, epoch 2, cost  0.970555057641
Pre-training layer 4, epoch 3, cost  0.932995746406
Pre-training layer 4, epoch 4, cost  0.914239715617
Pre-training layer 4, epoch 5, cost  0.901561115374
Pre-training layer 4, epoch 6, cost  0.892303103711
Pre-training layer 4, epoch 7, cost  0.884938509866
Pre-training layer 4, epoch 8, cost  0.878903143843
Pre-training layer 4, epoch 9, cost  0.873737731129
Pre-training layer 4, epoch 10, cost  0.86933687993
Pre-training layer 4, epoch 11, cost  0.865561010832
Pre-training layer 4, epoch 12, cost  0.86224496687
Pre-training layer 4, epoch 13, cost  0.859316873311
Pre-training layer 4, epoch 14, cost  0.856662773738
Pre-training layer 4, epoch 15, cost  0.854291352177
Pre-training layer 4, epoch 16, cost  0.852078446616
Pre-training layer 4, epoch 17, cost  0.850117248216
Pre-training layer 4, epoch 18, cost  0.848277032933
Pre-training layer 4, epoch 19, cost  0.846611697449
Pre-training layer 4, epoch 20, cost  0.845029683604
Pre-training layer 4, epoch 21, cost  0.843621227746
Pre-training layer 4, epoch 22, cost  0.842280909701
Pre-training layer 4, epoch 23, cost  0.841006831757
Pre-training layer 4, epoch 24, cost  0.839833190908
Pre-training layer 4, epoch 25, cost  0.838762401177
Pre-training layer 4, epoch 26, cost  0.837742211608
Pre-training layer 4, epoch 27, cost  0.836793970365
Pre-training layer 4, epoch 28, cost  0.83585312973
Pre-training layer 4, epoch 29, cost  0.835012733214
Pre-training layer 4, epoch 30, cost  0.834189523679
Pre-training layer 4, epoch 31, cost  0.833426114546
Pre-training layer 4, epoch 32, cost  0.832721609979
Pre-training layer 4, epoch 33, cost  0.832024261202
Pre-training layer 4, epoch 34, cost  0.831377418737
Pre-training layer 4, epoch 35, cost  0.830754151717
Pre-training layer 4, epoch 36, cost  0.830171288305
Pre-training layer 4, epoch 37, cost  0.829589607309
Pre-training layer 4, epoch 38, cost  0.829080591155
Pre-training layer 4, epoch 39, cost  0.828565680149
Pre-training layer 4, epoch 40, cost  0.828088853685
Pre-training layer 4, epoch 41, cost  0.827634516881
Pre-training layer 4, epoch 42, cost  0.827197053136
Pre-training layer 4, epoch 43, cost  0.826774532078
Pre-training layer 4, epoch 44, cost  0.826371584446
Pre-training layer 4, epoch 45, cost  0.825982379896
Pre-training layer 4, epoch 46, cost  0.825628500667
Pre-training layer 4, epoch 47, cost  0.825253611206
Pre-training layer 4, epoch 48, cost  0.824926877143
Pre-training layer 4, epoch 49, cost  0.824582938785
Pre-training layer 5, epoch 0, cost  5.39546532691
Pre-training layer 5, epoch 1, cost  3.39217109646
Pre-training layer 5, epoch 2, cost  3.37764647928
Pre-training layer 5, epoch 3, cost  3.37344920082
Pre-training layer 5, epoch 4, cost  3.37126837867
Pre-training layer 5, epoch 5, cost  3.36978553964
Pre-training layer 5, epoch 6, cost  3.36859583871
Pre-training layer 5, epoch 7, cost  3.36752407927
Pre-training layer 5, epoch 8, cost  3.36647651964
Pre-training layer 5, epoch 9, cost  3.36538033782
Pre-training layer 5, epoch 10, cost  3.36417338076
Pre-training layer 5, epoch 11, cost  3.3627764847
Pre-training layer 5, epoch 12, cost  3.36108823443
Pre-training layer 5, epoch 13, cost  3.35896156567
Pre-training layer 5, epoch 14, cost  3.35617483735
Pre-training layer 5, epoch 15, cost  3.35238092325
Pre-training layer 5, epoch 16, cost  3.34705056186
Pre-training layer 5, epoch 17, cost  3.33954106377
Pre-training layer 5, epoch 18, cost  3.32986470503
Pre-training layer 5, epoch 19, cost  3.32044619022
Pre-training layer 5, epoch 20, cost  3.31439004973
Pre-training layer 5, epoch 21, cost  3.31113902061
Pre-training layer 5, epoch 22, cost  3.3091391778
Pre-training layer 5, epoch 23, cost  3.3077327289
Pre-training layer 5, epoch 24, cost  3.30666068398
Pre-training layer 5, epoch 25, cost  3.30579903395
Pre-training layer 5, epoch 26, cost  3.30507845186
Pre-training layer 5, epoch 27, cost  3.30445776364
Pre-training layer 5, epoch 28, cost  3.30391050908
Pre-training layer 5, epoch 29, cost  3.30342017147
Pre-training layer 5, epoch 30, cost  3.30297418996
Pre-training layer 5, epoch 31, cost  3.30256447303
Pre-training layer 5, epoch 32, cost  3.3021850207
Pre-training layer 5, epoch 33, cost  3.30183097335
Pre-training layer 5, epoch 34, cost  3.30149900014
Pre-training layer 5, epoch 35, cost  3.30118622742
Pre-training layer 5, epoch 36, cost  3.30089003528
Pre-training layer 5, epoch 37, cost  3.3006091767
Pre-training layer 5, epoch 38, cost  3.30034170322
Pre-training layer 5, epoch 39, cost  3.3000867476
Pre-training layer 5, epoch 40, cost  3.29984272133
Pre-training layer 5, epoch 41, cost  3.29960938213
Pre-training layer 5, epoch 42, cost  3.29938541235
Pre-training layer 5, epoch 43, cost  3.29917012969
Pre-training layer 5, epoch 44, cost  3.29896318186
Pre-training layer 5, epoch 45, cost  3.29876348502
Pre-training layer 5, epoch 46, cost  3.29857120776
Pre-training layer 5, epoch 47, cost  3.29838560664
Pre-training layer 5, epoch 48, cost  3.2982063682
Pre-training layer 5, epoch 49, cost  3.29803355672
The pretraining code for file multi_layer_km.pyc ran for 25.77m
Initial NMI for deep clustering: 0.52
ARI for deep clustering: 0.39
ACC for deep clustering: 0.55
... getting the finetuning functions
... finetunning the model
Fine-tuning epoch 1 ++++
Total cost: 4.25037, Reconstruction: 4.05373, Clustering: 0.19663,
Fine-tuning epoch 2 ++++
Total cost: 1.95519, Reconstruction: 1.74932, Clustering: 0.20587,
Fine-tuning epoch 3 ++++
Total cost: 1.67347, Reconstruction: 1.42269, Clustering: 0.25078,
Fine-tuning epoch 4 ++++
Total cost: 1.54183, Reconstruction: 1.28717, Clustering: 0.25466,
Fine-tuning epoch 5 ++++
Total cost: 1.44256, Reconstruction: 1.19036, Clustering: 0.25220,
Fine-tuning epoch 6 ++++
Total cost: 1.37264, Reconstruction: 1.12352, Clustering: 0.24912,
Fine-tuning epoch 7 ++++
Total cost: 1.31735, Reconstruction: 1.07282, Clustering: 0.24453,
Fine-tuning epoch 8 ++++
Total cost: 1.28018, Reconstruction: 1.03823, Clustering: 0.24195,
Fine-tuning epoch 9 ++++
Total cost: 1.24666, Reconstruction: 1.00813, Clustering: 0.23853,
Fine-tuning epoch 10 ++++
Total cost: 1.21201, Reconstruction: 0.97662, Clustering: 0.23539,
Fine-tuning epoch 11 ++++
Total cost: 1.18943, Reconstruction: 0.95544, Clustering: 0.23398,
Fine-tuning epoch 12 ++++
Total cost: 1.16551, Reconstruction: 0.93433, Clustering: 0.23118,
Fine-tuning epoch 13 ++++
Total cost: 1.15343, Reconstruction: 0.92208, Clustering: 0.23135,
Fine-tuning epoch 14 ++++
Total cost: 1.13403, Reconstruction: 0.90573, Clustering: 0.22830,
Fine-tuning epoch 15 ++++
Total cost: 1.12282, Reconstruction: 0.89550, Clustering: 0.22732,
Fine-tuning epoch 16 ++++
Total cost: 1.09909, Reconstruction: 0.87421, Clustering: 0.22488,
Fine-tuning epoch 17 ++++
Total cost: 1.08722, Reconstruction: 0.86329, Clustering: 0.22393,
Fine-tuning epoch 18 ++++
Total cost: 1.07680, Reconstruction: 0.85348, Clustering: 0.22332,
Fine-tuning epoch 19 ++++
Total cost: 1.06859, Reconstruction: 0.84634, Clustering: 0.22225,
Fine-tuning epoch 20 ++++
Total cost: 1.05858, Reconstruction: 0.83788, Clustering: 0.22070,
Fine-tuning epoch 21 ++++
Total cost: 1.04927, Reconstruction: 0.83053, Clustering: 0.21874,
Fine-tuning epoch 22 ++++
Total cost: 1.04778, Reconstruction: 0.82752, Clustering: 0.22026,
Fine-tuning epoch 23 ++++
Total cost: 1.04086, Reconstruction: 0.82222, Clustering: 0.21864,
Fine-tuning epoch 24 ++++
Total cost: 1.03138, Reconstruction: 0.81312, Clustering: 0.21826,
Fine-tuning epoch 25 ++++
Total cost: 1.02680, Reconstruction: 0.80844, Clustering: 0.21836,
Fine-tuning epoch 26 ++++
Total cost: 1.01879, Reconstruction: 0.80196, Clustering: 0.21683,
Fine-tuning epoch 27 ++++
Total cost: 1.02111, Reconstruction: 0.80265, Clustering: 0.21846,
Fine-tuning epoch 28 ++++
Total cost: 1.01325, Reconstruction: 0.79606, Clustering: 0.21719,
Fine-tuning epoch 29 ++++
Total cost: 1.00354, Reconstruction: 0.78759, Clustering: 0.21595,
Fine-tuning epoch 30 ++++
Total cost: 0.99871, Reconstruction: 0.78258, Clustering: 0.21612,
Fine-tuning epoch 31 ++++
Total cost: 0.99770, Reconstruction: 0.78132, Clustering: 0.21638,
Fine-tuning epoch 32 ++++
Total cost: 0.99476, Reconstruction: 0.77774, Clustering: 0.21702,
Fine-tuning epoch 33 ++++
Total cost: 0.98755, Reconstruction: 0.77198, Clustering: 0.21557,
Fine-tuning epoch 34 ++++
Total cost: 0.98065, Reconstruction: 0.76481, Clustering: 0.21585,
Fine-tuning epoch 35 ++++
Total cost: 0.97665, Reconstruction: 0.76118, Clustering: 0.21547,
Fine-tuning epoch 36 ++++
Total cost: 0.97254, Reconstruction: 0.75748, Clustering: 0.21506,
Fine-tuning epoch 37 ++++
Total cost: 0.97080, Reconstruction: 0.75569, Clustering: 0.21511,
Fine-tuning epoch 38 ++++
Total cost: 0.96305, Reconstruction: 0.74933, Clustering: 0.21372,
Fine-tuning epoch 39 ++++
Total cost: 0.95269, Reconstruction: 0.73941, Clustering: 0.21328,
Fine-tuning epoch 40 ++++
Total cost: 0.95040, Reconstruction: 0.73841, Clustering: 0.21198,
Fine-tuning epoch 41 ++++
Total cost: 0.94578, Reconstruction: 0.73438, Clustering: 0.21140,
Fine-tuning epoch 42 ++++
Total cost: 0.94325, Reconstruction: 0.73149, Clustering: 0.21176,
Fine-tuning epoch 43 ++++
Total cost: 0.93504, Reconstruction: 0.72448, Clustering: 0.21056,
Fine-tuning epoch 44 ++++
Total cost: 0.93004, Reconstruction: 0.72064, Clustering: 0.20941,
Fine-tuning epoch 45 ++++
Total cost: 0.92695, Reconstruction: 0.71711, Clustering: 0.20983,
Fine-tuning epoch 46 ++++
Total cost: 0.92138, Reconstruction: 0.71192, Clustering: 0.20946,
Fine-tuning epoch 47 ++++
Total cost: 0.92170, Reconstruction: 0.71127, Clustering: 0.21042,
Fine-tuning epoch 48 ++++
Total cost: 0.91757, Reconstruction: 0.70928, Clustering: 0.20829,
Fine-tuning epoch 49 ++++
Total cost: 0.90476, Reconstruction: 0.69868, Clustering: 0.20608,
Fine-tuning epoch 50 ++++
Total cost: 0.89922, Reconstruction: 0.69342, Clustering: 0.20580,
Average squared 2-D reconstruction error: 0.6934
NMI for deep clustering: 0.58
ARI for deep clustering: 0.41
ACC for deep clustering: 0.56
The training code for file multi_layer_km.pyc ran for 24.78m